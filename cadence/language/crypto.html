<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-cadence/language/crypto">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.0">
<title data-rh="true">Crypto | Flow docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://onflow.github.io/img/FlowDocs_Logo_FlowLogo_Horizontal_Green_BlackText.svg"><meta data-rh="true" name="twitter:image" content="https://onflow.github.io/img/FlowDocs_Logo_FlowLogo_Horizontal_Green_BlackText.svg"><meta data-rh="true" property="og:url" content="https://onflow.github.io/cadence/language/crypto"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Crypto | Flow docs"><meta data-rh="true" name="description" content="Hashing"><meta data-rh="true" property="og:description" content="Hashing"><link data-rh="true" rel="icon" href="/favicon.ico"><link data-rh="true" rel="canonical" href="https://onflow.github.io/cadence/language/crypto"><link data-rh="true" rel="alternate" href="https://onflow.github.io/cadence/language/crypto" hreflang="en"><link data-rh="true" rel="alternate" href="https://onflow.github.io/cadence/language/crypto" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://DKF9ZIO5WM-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Flow docs" href="/opensearch.xml">




<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous">
<script src="/mixpanel.js" async onload="window.mixpanel.init(&#39;776159d170484f49f19c3c2f7339f297&#39;);
window.mixpanel.track(&#39;Page Viewed&#39;, {
  &#39;Page Name&#39;: document.title,
  &#39;Page URL&#39;: window.location.pathname,
});

window.document.addEventListener(&#39;click&#39;, function (event) {
  var target = event.target;

  // Check if the clicked element is a link with an href attribute
  if (target.tagName === &#39;A&#39; &amp;&amp; target.hasAttribute(&#39;href&#39;)) {
    if (window.mixpanel) {
      window.mixpanel.track(&#39;Link clicked&#39;, {
        href: target.getAttribute(&#39;href&#39;),
        id: target.id,
        class: target.className,
      });
    }
  }
});"></script><link rel="stylesheet" href="/assets/css/styles.6b5203ff.css">
<link rel="preload" href="/assets/js/runtime~main.f07e2fdc.js" as="script">
<link rel="preload" href="/assets/js/main.0728fa61.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/flow-docs-logo-dark.png" alt="Flow Developer Portal Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/flow-docs-logo-light.png" alt="Flow Developer Portal Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Docs</b></a><a class="navbar__item navbar__link" href="/learn">Learn</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/quickstarts">Quickstarts</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/documentation">Documentation</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/onflow" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://onflow.org/discord" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/1.Learn/1.Introduction/1.Overview of Flow Blockchain">1.Learn</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/2.Try/flow-playground">2.Try</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/3.Build/1.Getting Started/1.Flow Developer Account Setup">3.Build</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/cadence">Documentation</a><button aria-label="Toggle the collapsible sidebar category &#x27;Documentation&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/FAQ">FAQ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/anti-patterns">Cadence Anti-Patterns</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/contract-upgrades">Contract Upgrades with Incompatible Changes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/design-patterns">Cadence Design Patterns</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/development">Development</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/goland">GoLand</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence">Introduction to Cadence</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/json-cadence-spec">JSON-Cadence Data Interchange Format</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/cadence/language">The Cadence Programming Language</a><button aria-label="Toggle the collapsible sidebar category &#x27;The Cadence Programming Language&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/language/access-control">Access control</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/language/accounts">Accounts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/language/attachments">Attachments</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/language/built-in-functions">Built-in Functions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/language/capability-based-access-control">Capability-based Access Control</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/language/composite-types">Composite Types</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/language/constants-and-variables">Constants and Variable Declarations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/language/contract-updatability">Contract Updatability</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/language/contracts">Contracts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/language/control-flow">Control Flow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/language/core-events">Core Events</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/cadence/language/crypto">Crypto</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/language/enumerations">Enumerations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/language/environment-information">Environment Information</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/language/events">Events</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/language/functions">Functions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/language/glossary">glossary</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/language/imports">Imports</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/language/interfaces">Interfaces</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/language/operators">Operators</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/language/references">References</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/language/resources">Resources</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/language/restricted-types">Restricted Types</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/language/run-time-types">Run-time Types</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/language/scope">Scope</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/language/syntax">Syntax</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/language/transactions">Transactions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/language/type-annotations">Type Annotations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/language/type-hierarchy">Type Hierarchy</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/language/type-inference">Type Inference</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/language/type-safety">Type Safety</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/language/values-and-types">Values and Types</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/measuring-time">Measuring Time In Cadence</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/releasing">Release Process</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/security-best-practices">Security Best Practices</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/solidity-to-cadence">Guide for Solidity developers</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cadence/styleguide/project-development-tips">styleguide</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/subtyping">subtyping</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/syntax-highlighting">Syntax Highlighting Cadence</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/testing-framework">Cadence Testing Framework</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/cadence/tutorial/01-first-steps">tutorial</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cadence/why">why</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/documentation">documentation</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/flow">Introduction to Flow</a><button aria-label="Toggle the collapsible sidebar category &#x27;Introduction to Flow&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/hybrid-custody">Hybrid Custody Overview</a><button aria-label="Toggle the collapsible sidebar category &#x27;Hybrid Custody Overview&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/intro">intro</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/mobile">Flow Mobile Overview</a><button aria-label="Toggle the collapsible sidebar category &#x27;Flow Mobile Overview&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/nodes">Hello Node Operator!</a><button aria-label="Toggle the collapsible sidebar category &#x27;Hello Node Operator!&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/quickstarts">quickstarts</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/tools/emulator">tools</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/cadence"><span itemprop="name">Documentation</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/cadence/language"><span itemprop="name">The Cadence Programming Language</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Crypto</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Crypto</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="hashing">Hashing<a href="#hashing" class="hash-link" aria-label="Direct link to Hashing" title="Direct link to Hashing">​</a></h2><p>The built-in enum <code>HashAlgorithm</code> provides the set of hashing algorithms that
are supported by the language natively.</p><div class="language-cadence codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cadence codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">pub enum HashAlgorithm: UInt8 {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /// SHA2_256 is SHA-2 with a 256-bit digest (also referred to as SHA256).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    pub case SHA2_256 = 1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /// SHA2_384 is SHA-2 with a 384-bit digest (also referred to as  SHA384).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    pub case SHA2_384 = 2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /// SHA3_256 is SHA-3 with a 256-bit digest.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    pub case SHA3_256 = 3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /// SHA3_384 is SHA-3 with a 384-bit digest.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    pub case SHA3_384 = 4</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /// KMAC128_BLS_BLS12_381 is an instance of KECCAK Message Authentication Code (KMAC128) mac algorithm.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /// Although this is a MAC algorithm, KMAC is included in this list as it can be used hash </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /// when the key is used a non-public customizer.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /// KMAC128_BLS_BLS12_381 is used in particular as the hashing algorithm for the BLS signature scheme on the curve BLS12-381.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /// It is a customized version of KMAC128 that is compatible with the hashing to curve</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /// used in BLS signatures. </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /// It is the same hasher used by signatures in the internal Flow protocol. </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    pub case KMAC128_BLS_BLS12_381 = 5</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /// KECCAK_256 is the legacy Keccak algorithm with a 256-bits digest, as per the original submission to the NIST SHA3 competition.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /// KECCAK_256 is different than SHA3 and is used by Ethereum.  </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    pub case KECCAK_256 = 6</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /// Returns the hash of the given data</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    pub fun hash(_ data: [UInt8]): [UInt8]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /// Returns the hash of the given data and tag</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    pub fun hashWithTag(_ data: [UInt8], tag: string): [UInt8]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The hash algorithms provide two ways to hash input data into digests, <code>hash</code> and <code>hashWithTag</code>. </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="hashing-1">Hashing<a href="#hashing-1" class="hash-link" aria-label="Direct link to Hashing" title="Direct link to Hashing">​</a></h2><p><code>hash</code> hashes the input data using the chosen hashing algorithm.
<code>KMAC</code> is the only MAC algorithm on the list
and configured with specific parameters (detailed in <a href="#KMAC128-for-BLS">KMAC128 for BLS</a>)</p><p>For example, to compute a SHA3-256 digest:</p><div class="language-cadence codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cadence codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">let data: [UInt8] = [1, 2, 3]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">let digest = HashAlgorithm.SHA3_256.hash(data)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="hashing-with-a-domain-tag">Hashing with a domain tag<a href="#hashing-with-a-domain-tag" class="hash-link" aria-label="Direct link to Hashing with a domain tag" title="Direct link to Hashing with a domain tag">​</a></h2><p><code>hashWithTag</code> hashes the input data along with an input tag.
It allows instanciating independent hashing functions customized with a domain separation tag (DST).
For most of the hashing algorithms, mixing the data with the tag is done by pre-fixing the data with the tag and
hashing the result.</p><ul><li><code>SHA2_256</code>, <code>SHA2_384</code>, <code>SHA3_256</code>, <code>SHA3_384</code>, <code>KECCAK_256</code>:
If the tag is non-empty, the hashed message is <code>bytes(tag) || data</code> where <code>bytes()</code> is the UTF-8 encoding of the input string,
padded with zeros till 32 bytes.
Therefore tags must not exceed 32 bytes.
If the tag used is empty, no data prefix is applied, and the hashed message is simply <code>data</code> (same as <code>hash</code> output).</li><li><code>KMAC128_BLS_BLS12_381</code>: refer to <a href="#KMAC128-for-BLS">KMAC128 for BLS</a> for details.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="kmac128-for-bls">KMAC128 for BLS<a href="#kmac128-for-bls" class="hash-link" aria-label="Direct link to KMAC128 for BLS" title="Direct link to KMAC128 for BLS">​</a></h3><p><code>KMAC128_BLS_BLS12_381</code> is an instance of the cSHAKE-based KMAC128.
Although this is a MAC algorithm, KMAC can be used as a hash when the key is used as a non-private customizer.
<code>KMAC128_BLS_BLS12_381</code> is used in particular as the hashing algorithm for the BLS signature scheme on the curve BLS12-381.
It is a customized instance of KMAC128 and is compatible with the hashing to curve used by BLS signatures.
It is the same hasher used by the internal Flow protocol, and can be used to verify Flow protocol signatures on-chain. </p><p>To define the MAC instance, <code>KMAC128(customizer, key, data, length)</code> is instanciated with the following parameters
(as referred to by the NIST <a href="https://nvlpubs.nist.gov/nistpubs/specialpublications/nist.sp.800-185.pdf" target="_blank" rel="noopener noreferrer">SHA-3 Derived Functions</a>):</p><ul><li><code>customizer</code> is the UTF-8 encoding of <code>&quot;H2C&quot;</code>.</li><li><code>key</code> is the UTF-8 encoding of <code>&quot;FLOW--V00-CS00-with-BLS_SIG_BLS12381G1_XOF:KMAC128_SSWU_RO_POP_&quot;</code> when <code>hash</code> is used. It includes the input <code>tag</code>
when <code>hashWithTag</code> is used and key becomes the UTF-8 encoding of <code>&quot;FLOW-&quot; || tag || &quot;-V00-CS00-with-BLS_SIG_BLS12381G1_XOF:KMAC128_SSWU_RO_POP_&quot;</code>.</li><li><code>data</code> is the input data to hash.</li><li><code>length</code> is 1024 bytes.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="signing-algorithms">Signing Algorithms<a href="#signing-algorithms" class="hash-link" aria-label="Direct link to Signing Algorithms" title="Direct link to Signing Algorithms">​</a></h2><p>The built-in enum <code>SignatureAlgorithm</code> provides the set of signing algorithms that
are supported by the language natively.</p><div class="language-cadence codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cadence codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">pub enum SignatureAlgorithm: UInt8 {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /// ECDSA_P256 is ECDSA on the NIST P-256 curve.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    pub case ECDSA_P256 = 1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /// ECDSA_secp256k1 is ECDSA on the secp256k1 curve.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    pub case ECDSA_secp256k1 = 2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /// BLS_BLS12_381 is BLS signature scheme on the BLS12-381 curve.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /// The scheme is set-up so that signatures are in G_1 (subgroup of the curve over the prime field)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /// while public keys are in G_2 (subgroup of the curve over the prime field extension).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    pub case BLS_BLS12_381 = 3</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="publickey">PublicKey<a href="#publickey" class="hash-link" aria-label="Direct link to PublicKey" title="Direct link to PublicKey">​</a></h2><p><code>PublicKey</code> is a built-in structure that represents a cryptographic public key of a signature scheme.</p><div class="language-cadence codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cadence codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">struct PublicKey {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    let publicKey: [UInt8]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    let signatureAlgorithm: SignatureAlgorithm</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /// Verifies a signature under the given tag, data and public key.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /// It uses the given hash algorithm to hash the tag and data.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    pub fun verify(</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        signature: [UInt8],</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        signedData: [UInt8],</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        domainSeparationTag: String,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        hashAlgorithm: HashAlgorithm</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ): Bool</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /// Verifies the proof of possession of the private key.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /// This function is only implemented if the signature algorithm</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /// of the public key is BLS (BLS_BLS12_381).</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /// If called with any other signature algorithm, the program aborts</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    pub fun verifyPoP(_ proof: [UInt8]): Bool</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>PublicKey</code> supports two methods <code>verify</code> and <code>verifyPoP</code>.
<code>verifyPoP</code> will be covered under <a href="#proof-of-possession-pop">BLS multi-signature</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="public-key-construction">Public Key construction<a href="#public-key-construction" class="hash-link" aria-label="Direct link to Public Key construction" title="Direct link to Public Key construction">​</a></h3><p>A <code>PublicKey</code> can be constructed using the raw key and the signing algorithm.</p><div class="language-cadence codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cadence codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">let publicKey = PublicKey(</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    publicKey: &quot;010203&quot;.decodeHex(),</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    signatureAlgorithm: SignatureAlgorithm.ECDSA_P256</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The raw key value depends on the supported signature scheme:</p><ul><li><p><code>ECDSA_P256</code> and <code>ECDSA_secp256k1</code>:
The public key is an uncompressed curve point <code>(X,Y)</code> where <code>X</code> and <code>Y</code> are two prime field elements.
The raw key is represented as <code>bytes(X) || bytes(Y)</code>, where <code>||</code> is the concatenation operation,
and <code>bytes()</code> is the bytes big-endian encoding left padded by zeros to the byte-length of the field prime.
The raw public key is 64-bytes long.</p></li><li><p><code>BLS_BLS_12_381</code>:
The public key is a G_2 element (on the curve over the prime field extension).
The encoding follows the compressed serialization defined in the
<a href="https://www.ietf.org/archive/id/draft-irtf-cfrg-pairing-friendly-curves-08.html#name-point-serialization-procedu" target="_blank" rel="noopener noreferrer">IETF draft-irtf-cfrg-pairing-friendly-curves-08</a>.
A public key is 96-bytes long.</p></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="public-key-validation">Public Key validation<a href="#public-key-validation" class="hash-link" aria-label="Direct link to Public Key validation" title="Direct link to Public Key validation">​</a></h3><p>A public key is validated at the time of creation. Only valid public keys can be created.
The validation of the public key depends on the supported signature scheme:</p><ul><li><p><code>ECDSA_P256</code> and <code>ECDSA_secp256k1</code>:
The given <code>X</code> and <code>Y</code> coordinates are correctly serialized, represent valid prime field elements, and the resulting
point is on the correct curve (no subgroup check needed since the cofactor of both supported curves is 1).</p></li><li><p><code>BLS_BLS_12_381</code>:
The given key is correctly serialized following the compressed serialization in <a href="https://www.ietf.org/archive/id/draft-irtf-cfrg-pairing-friendly-curves-08.html#name-point-serialization-procedu" target="_blank" rel="noopener noreferrer">IETF draft-irtf-cfrg-pairing-friendly-curves-08</a>.
The coordinates represent valid prime field extension elements. The resulting point is on the curve, and is on the correct subgroup G_2.
Note that the point at infinity is accepted and yields the identity public key. Such identity key can be useful when aggregating multiple keys.</p></li></ul><div type="info"><p>🚧 Status: Accepting the BLS identity key is going to be available in the upcoming release of Cadence on Mainnet.</p></div><p>Since the validation happens only at the time of creation, public keys are immutable.</p><div class="language-cadence codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cadence codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">publicKey.signatureAlgorithm = SignatureAlgorithm.ECDSA_secp256k1   // Not allowed</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">publicKey.publicKey = []                                            // Not allowed</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">publicKey.publicKey[2] = 4      // No effect</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Invalid public keys cannot be constructed so public keys are always valid.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="signature-verification">Signature verification<a href="#signature-verification" class="hash-link" aria-label="Direct link to Signature verification" title="Direct link to Signature verification">​</a></h3><p>A signature can be verified using the <code>verify</code> function of the <code>PublicKey</code>:</p><div class="language-cadence codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cadence codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">let pk = PublicKey(</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    publicKey: &quot;96142CE0C5ECD869DC88C8960E286AF1CE1B29F329BA4964213934731E65A1DE480FD43EF123B9633F0A90434C6ACE0A98BB9A999231DB3F477F9D3623A6A4ED&quot;.decodeHex(),</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    signatureAlgorithm: SignatureAlgorithm.ECDSA_P256</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">let signature = &quot;108EF718F153CFDC516D8040ABF2C8CC7AECF37C6F6EF357C31DFE1F7AC79C9D0145D1A2F08A48F1A2489A84C725D6A7AB3E842D9DC5F8FE8E659FFF5982310D&quot;.decodeHex()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">let message : [UInt8] = [1, 2, 3]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">let isValid = pk.verify(</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    signature: signature,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    signedData: message,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    domainSeparationTag: &quot;&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    hashAlgorithm: HashAlgorithm.SHA2_256</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// `isValid` is false</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The inputs to <code>verify</code> depend on the signature scheme used:</p><ul><li>ECDSA (<code>ECDSA_P256</code> and <code>ECDSA_secp256k1</code>):<ul><li><code>signature</code> expects the couple <code>(r,s)</code>. It is serialized as <code>bytes(r) || bytes(s)</code>, where <code>||</code> is the concatenation operation,
and <code>bytes()</code> is the bytes big-endian encoding left padded by zeros to the byte-length of the curve order.
The signature is 64 bytes-long for both curves. </li><li><code>signedData</code> is the arbitrary message to verify the signature against.</li><li><code>domainSeparationTag</code> is the expected domain tag. Multiple valid tag values can be used (check <a href="#hashing"><code>hashWithTag</code></a> for more details).</li><li><code>hashAlgorithm</code> is either <code>SHA2_256</code>, <code>SHA3_256</code> or <code>KECCAK_256</code>. It is the algorithm used to hash the message along with the given tag (check the <code>hashWithTag</code><a href="#hashing">function</a> for more details).</li></ul></li></ul><p>As noted in <a href="#hashing"><code>hashWithTag</code></a> for <code>SHA2_256</code>, <code>SHA3_256</code> and <code>KECCAK_256</code>, using an empty <code>tag</code> results in hashing the input data only. If a signature verification
needs to be done against data without any domain tag, this can be done by using an empty domain tag <code>&quot;&quot;</code>.</p><p>ECDSA verification is implemented as defined in ANS X9.62 (also referred by <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-4.pdf" target="_blank" rel="noopener noreferrer">FIPS 186-4</a> and <a href="https://www.secg.org/sec1-v2.pdf" target="_blank" rel="noopener noreferrer">SEC 1, Version 2.0</a>).
A valid signature would be generated using the expected <code>signedData</code>, <code>domainSeparationTag</code> and <code>hashAlgorithm</code> used to verify. </p><ul><li>BLS (<code>BLS_BLS_12_381</code>):<ul><li><code>signature</code> expects a G_1 point (on the curve over the prime field).
The encoding follows the compressed serialization defined in the <a href="https://www.ietf.org/archive/id/draft-irtf-cfrg-pairing-friendly-curves-08.html#name-point-serialization-procedu" target="_blank" rel="noopener noreferrer">IETF draft-irtf-cfrg-pairing-friendly-curves-08</a>.
A signature is 48-bytes long. </li><li><code>signedData</code> is the arbitrary message to verify the signature against.</li><li><code>domainSeparationTag</code> is the expected domain tag. All tags are accepted (check <a href="#KMAC128-for-BLS">KMAC128 for BLS</a>).</li><li><code>hashAlgorithm</code> only accepts <code>KMAC128_BLS_BLS12_381</code>. It is the algorithm used to hash the message along with the given tag (check <a href="#KMAC128-for-BLS">KMAC128 for BLS</a>).</li></ul></li></ul><p>BLS verification performs the necessary membership check on the signature while the membership check of the public key is performed at the creation of the <code>PublicKey</code> object
and is not repeated during the signature verification. In order to prevent equivocation issues, a verification under the identity public key always returns <code>false</code>.</p><div type="info"><p>🚧 Status: Returning <code>false</code> when verifying against a BLS identity key is going to be available in the upcoming release of Cadence on Mainnet.
Currently, BLS identity keys can only be constructed as an output of <code>aggregatePublicKeys</code>.</p></div><p>The verificaction uses a hash-to-curve algorithm to hash the <code>signedData</code> into a <code>G_1</code> point, following the <code>hash_to_curve</code> method described in the <a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-hash-to-curve-14#section-3" target="_blank" rel="noopener noreferrer">draft-irtf-cfrg-hash-to-curve-14</a>.
While KMAC128 is used as a hash-to-field method resulting in two field elements, the mapping to curve is implemented using the <a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-hash-to-curve-14#section-6.6.3" target="_blank" rel="noopener noreferrer">simplified SWU</a>.</p><p>A valid signature would be generated using the expected <code>signedData</code> and <code>domainSeparationTag</code>, as well the same hashing to curve process. </p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="bls-multi-signature">BLS multi-signature<a href="#bls-multi-signature" class="hash-link" aria-label="Direct link to BLS multi-signature" title="Direct link to BLS multi-signature">​</a></h2><p>BLS signature scheme allows efficient multi-signature features. Multiple signatures can be aggregated
into a single signature which can be verified against an aggregated public key. This allows authenticating
multiple signers with a single signature verification.
While BLS provides multiple aggregation techniques,
Cadence supports basic aggregation tools that cover a wide list of use-cases.
These tools are defined in the built-in <code>BLS</code> contract, which does not need to be imported.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="proof-of-possession-pop">Proof of Possession (PoP)<a href="#proof-of-possession-pop" class="hash-link" aria-label="Direct link to Proof of Possession (PoP)" title="Direct link to Proof of Possession (PoP)">​</a></h3><p>Multi-signature verification in BLS requires a defense against rogue public-key attacks. Multiple ways are
available to protect BLS verification. Cadence provides the proof of possession of private key as a defense tool.
The proof of possession of private key is a BLS signature over the public key itself.
The PoP signature follows the same requirements of a BLS signature (detailed in <a href="#Signature-verification">Signature verification</a>),
except it uses a special domain separation tag. The key expected to be used in KMAC128 is the UTF-8 encoding of <code>&quot;BLS_POP_BLS12381G1_XOF:KMAC128_SSWU_RO_POP_&quot;</code>.
The expected message to be signed by the PoP is the serialization of the BLS public key corresponding to the signing private key (<a href="#PublicKey">serialization details</a>).
The PoP can only be verified using the <code>PublicKey</code> method <code>verifyPoP</code>. </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="bls-signature-aggregation">BLS signature aggregation<a href="#bls-signature-aggregation" class="hash-link" aria-label="Direct link to BLS signature aggregation" title="Direct link to BLS signature aggregation">​</a></h3><div class="language-cadence codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cadence codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">fun aggregateSignatures(_ signatures: [[UInt8]]): [UInt8]?</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Aggregates multiple BLS signatures into one.
Signatures could be generated from the same or distinct messages, they
could also be the aggregation of other signatures.
The order of the signatures in the slice does not matter since the aggregation is commutative.
There is no subgroup membership check performed on the input signatures.
If the array is empty or if decoding one of the signatures fails, the program aborts.</p><p>The output signature can be verified against an aggregated public key to authenticate multiple
signers at once. Since the <code>verify</code> method accepts a single data to verify against, it is only possible to
verfiy multiple signatures of the same message. </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="bls-public-key-aggregation">BLS public key aggregation<a href="#bls-public-key-aggregation" class="hash-link" aria-label="Direct link to BLS public key aggregation" title="Direct link to BLS public key aggregation">​</a></h3><div class="language-cadence codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cadence codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">fun aggregatePublicKeys(_ publicKeys: [PublicKey]): PublicKey?</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Aggregates multiple BLS public keys into one.</p><p>The order of the public keys in the slice does not matter since the aggregation is commutative.
The input keys are guaranteed to be in the correct subgroup since subgroup membership is checked
at the key creation time.
If the array is empty or any of the input keys is not a BLS key, the program aborts.
Note that the identity public key is a valid input to this function and it represents the
identity element of aggregation. </p><p>The output public key can be used to verify aggregated signatures to authenticate multiple
signers at once. Since the <code>verify</code> method accepts a single data to verify against, it is only possible to
verfiy multiple signatures of the same message.
The identity public key is a possible output of the function, though signature verifications
against identity result in <code>false</code>.</p><p>In order to prevent rogue key attacks when verifying aggregated signatures, it is important to verfiy the
PoP of each individual key involved in the aggregation process.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="crypto-contract">Crypto Contract<a href="#crypto-contract" class="hash-link" aria-label="Direct link to Crypto Contract" title="Direct link to Crypto Contract">​</a></h2><p>The built-in contract <code>Crypto</code> can be used to perform cryptographic operations.
The contract can be imported using <code>import Crypto</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="key-lists">Key Lists<a href="#key-lists" class="hash-link" aria-label="Direct link to Key Lists" title="Direct link to Key Lists">​</a></h3><p>The crypto contract also allows creating key lists to be used for multi-signature verification.
For example, to verify two signatures with equal weights for some signed data:</p><div class="language-cadence codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cadence codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">import Crypto</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pub fun test main() {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    let keyList = Crypto.KeyList()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    let publicKeyA = PublicKey(</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        publicKey:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            &quot;db04940e18ec414664ccfd31d5d2d4ece3985acb8cb17a2025b2f1673427267968e52e2bbf3599059649d4b2cce98fdb8a3048e68abf5abe3e710129e90696ca&quot;.decodeHex(),</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        signatureAlgorithm: SignatureAlgorithm.ECDSA_P256</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    keyList.add(</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        publicKeyA,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        hashAlgorithm: HashAlgorithm.SHA3_256,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        weight: 0.5</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    let publicKeyB = PublicKey(</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        publicKey:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            &quot;df9609ee588dd4a6f7789df8d56f03f545d4516f0c99b200d73b9a3afafc14de5d21a4fc7a2a2015719dc95c9e756cfa44f2a445151aaf42479e7120d83df956&quot;.decodeHex(),</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        signatureAlgorithm: SignatureAlgorithm.ECDSA_P256</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    keyList.add(</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        publicKeyB,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        hashAlgorithm: HashAlgorithm.SHA3_256,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        weight: 0.5</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    let signatureSet = [</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Crypto.KeyListSignature(</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            keyIndex: 0,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            signature:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                &quot;8870a8cbe6f44932ba59e0d15a706214cc4ad2538deb12c0cf718d86f32c47765462a92ce2da15d4a29eb4e2b6fa05d08c7db5d5b2a2cd8c2cb98ded73da31f6&quot;.decodeHex()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        ),</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        Crypto.KeyListSignature(</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            keyIndex: 1,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            signature:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                &quot;bbdc5591c3f937a730d4f6c0a6fde61a0a6ceaa531ccb367c3559335ab9734f4f2b9da8adbe371f1f7da913b5a3fdd96a871e04f078928ca89a83d841c72fadf&quot;.decodeHex()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // &quot;foo&quot;, encoded as UTF-8, in hex representation</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    let signedData = &quot;666f6f&quot;.decodeHex()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    let isValid = keyList.verify(</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        signatureSet: signatureSet,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        signedData: signedData</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The API of the Crypto contract related to key lists is:</p><div class="language-cadence codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-cadence codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">pub struct KeyListEntry {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    pub let keyIndex: Int</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    pub let publicKey: PublicKey</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    pub let hashAlgorithm: HashAlgorithm</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    pub let weight: UFix64</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    pub let isRevoked: Bool</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    init(</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        keyIndex: Int,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        publicKey: PublicKey,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        hashAlgorithm: HashAlgorithm,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        weight: UFix64,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        isRevoked: Bool</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pub struct KeyList {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    init()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /// Adds a new key with the given weight</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    pub fun add(</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        _ publicKey: PublicKey,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        hashAlgorithm: HashAlgorithm,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        weight: UFix64</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /// Returns the key at the given index, if it exists.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /// Revoked keys are always returned, but they have `isRevoked` field set to true</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    pub fun get(keyIndex: Int): KeyListEntry?</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /// Marks the key at the given index revoked, but does not delete it</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    pub fun revoke(keyIndex: Int)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    /// Returns true if the given signatures are valid for the given signed data</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    pub fun verify(</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        signatureSet: [KeyListSignature],</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        signedData: [UInt8]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    ): Bool</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pub struct KeyListSignature {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    pub let keyIndex: Int</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    pub let signature: [UInt8]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    pub init(keyIndex: Int, signature: [UInt8])</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2023-04-27T17:59:46.000Z">Apr 27, 2023</time></b> by <b>Tom Haile</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/cadence/language/core-events"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Core Events</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/cadence/language/enumerations"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Enumerations</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#hashing" class="table-of-contents__link toc-highlight">Hashing</a></li><li><a href="#hashing-1" class="table-of-contents__link toc-highlight">Hashing</a></li><li><a href="#hashing-with-a-domain-tag" class="table-of-contents__link toc-highlight">Hashing with a domain tag</a><ul><li><a href="#kmac128-for-bls" class="table-of-contents__link toc-highlight">KMAC128 for BLS</a></li></ul></li><li><a href="#signing-algorithms" class="table-of-contents__link toc-highlight">Signing Algorithms</a></li><li><a href="#publickey" class="table-of-contents__link toc-highlight">PublicKey</a><ul><li><a href="#public-key-construction" class="table-of-contents__link toc-highlight">Public Key construction</a></li><li><a href="#public-key-validation" class="table-of-contents__link toc-highlight">Public Key validation</a></li><li><a href="#signature-verification" class="table-of-contents__link toc-highlight">Signature verification</a></li></ul></li><li><a href="#bls-multi-signature" class="table-of-contents__link toc-highlight">BLS multi-signature</a><ul><li><a href="#proof-of-possession-pop" class="table-of-contents__link toc-highlight">Proof of Possession (PoP)</a></li><li><a href="#bls-signature-aggregation" class="table-of-contents__link toc-highlight">BLS signature aggregation</a></li><li><a href="#bls-public-key-aggregation" class="table-of-contents__link toc-highlight">BLS public key aggregation</a></li></ul></li><li><a href="#crypto-contract" class="table-of-contents__link toc-highlight">Crypto Contract</a><ul><li><a href="#key-lists" class="table-of-contents__link toc-highlight">Key Lists</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Documentation</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/getting-started">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/tools">SDK&#x27;s &amp; Tools</a></li><li class="footer__item"><a class="footer__link-item" href="/learn">Learning Resources</a></li><li class="footer__item"><a class="footer__link-item" href="/cadence">Cadence</a></li><li class="footer__item"><a class="footer__link-item" href="/mobile">Mobile</a></li><li class="footer__item"><a class="footer__link-item" href="/tools/fcl-js">FCL</a></li><li class="footer__item"><a class="footer__link-item" href="/tools/flow-js-testing">JS Testing Library</a></li><li class="footer__item"><a class="footer__link-item" href="/tools/flow-cli">CLI</a></li><li class="footer__item"><a class="footer__link-item" href="/tools/emulator">Emulator</a></li><li class="footer__item"><a href="https://github.com/onflow/fcl-dev-wallet" target="_blank" rel="noopener noreferrer" class="footer__link-item">Dev Wallet<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/tools/vscode-extension">VS Code Extension</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/community">Ecosystem</a></li><li class="footer__item"><a href="https://port.onflow.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Flow Port<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/onflow/developer-grants" target="_blank" rel="noopener noreferrer" class="footer__link-item">Developer Grants<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://flow.com/flow-responsible-disclosure" target="_blank" rel="noopener noreferrer" class="footer__link-item">Responsible Disclosure<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://forum.onflow.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Forum<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.flowverse.co/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Flowverse<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://academy.ecdao.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Emerald Academy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://floats.city/" target="_blank" rel="noopener noreferrer" class="footer__link-item">FLOATs (Attendance NFTs)<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Start Building</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://play.onflow.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Flow Playground<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/learn/kitty-items">Kitty Items</a></li><li class="footer__item"><a class="footer__link-item" href="/cadence/tutorial">Cadence Tutorials</a></li><li class="footer__item"><a href="https://open-cadence.onflow.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Cadence Cookbook<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/flow/core-contracts">Core Contracts &amp; Standards</a></li><li class="footer__item"><a href="https://academy.ecdao.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Emerald DAO Bootcamp<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Network</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://status.onflow.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Network Status<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://flowscan.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Flowscan Mainnet<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://testnet.flowscan.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Flowscan Testnet<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/nodes/node-operation/past-sporks">Past Sporks</a></li><li class="footer__item"><a class="footer__link-item" href="/nodes/node-operation/upcoming-sporks">Upcoming Sporks</a></li><li class="footer__item"><a class="footer__link-item" href="/nodes/node-operation">Node Operation</a></li><li class="footer__item"><a class="footer__link-item" href="/nodes/node-operation/spork">Spork Information</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/onflow" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://onflow.org/discord" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://forum.onflow.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Forum<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://onflow.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">OnFlow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Flow, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.f07e2fdc.js"></script>
<script src="/assets/js/main.0728fa61.js"></script>
</body>
</html>