"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[9543],{45230:(e,o,t)=>{t.r(o),t.d(o,{CH:()=>d,assets:()=>l,chCodeConfig:()=>u,contentTitle:()=>i,default:()=>h,frontMatter:()=>c,metadata:()=>a,toc:()=>p});t(67294);var n=t(85893),r=t(11151),s=t(59794);const c={title:"Crypto",sidebar_position:30},i=void 0,a={unversionedId:"cadence/language/crypto",id:"version-stable/cadence/language/crypto",title:"Crypto",description:"Hashing",source:"@site/versioned_docs/version-stable/cadence/language/crypto.mdx",sourceDirName:"cadence/language",slug:"/cadence/language/crypto",permalink:"/docs/cadence/language/crypto",draft:!1,editUrl:"https://github.com/onflow/docs/tree/main/docs/cadence/language/crypto.mdx",tags:[],version:"stable",lastUpdatedBy:"Gregor G",lastUpdatedAt:1693945828,formattedLastUpdatedAt:"Sep 5, 2023",sidebarPosition:30,frontMatter:{title:"Crypto",sidebar_position:30},sidebar:"cadence",previous:{title:"Environment Information",permalink:"/docs/cadence/language/environment-information"},next:{title:"Type Hierarchy",permalink:"/docs/cadence/language/type-hierarchy"}},l={},p=[{value:"Hashing",id:"hashing",level:2},{value:"Hashing",id:"hashing-1",level:2},{value:"Hashing with a domain tag",id:"hashing-with-a-domain-tag",level:2},{value:"KMAC128 for BLS",id:"kmac128-for-bls",level:3},{value:"Signing Algorithms",id:"signing-algorithms",level:2},{value:"PublicKey",id:"publickey",level:2},{value:"Public Key construction",id:"public-key-construction",level:3},{value:"Public Key validation",id:"public-key-validation",level:3},{value:"Signature verification",id:"signature-verification",level:3},{value:"BLS multi-signature",id:"bls-multi-signature",level:2},{value:"Proof of Possession (PoP)",id:"proof-of-possession-pop",level:3},{value:"BLS signature aggregation",id:"bls-signature-aggregation",level:3},{value:"BLS public key aggregation",id:"bls-public-key-aggregation",level:3},{value:"Crypto Contract",id:"crypto-contract",level:2},{value:"Key Lists",id:"key-lists",level:3}],d={annotations:s.ds,Code:s.EK},u={staticMediaQuery:"not screen, (max-width: 768px)",theme:{name:"nord",type:"dark",semanticHighlighting:!0,colors:{focusBorder:"#3b4252",foreground:"#d8dee9","activityBar.background":"#2e3440","activityBar.dropBackground":"#3b4252","activityBar.foreground":"#d8dee9","activityBar.activeBorder":"#88c0d0","activityBar.activeBackground":"#3b4252","activityBarBadge.background":"#88c0d0","activityBarBadge.foreground":"#2e3440","badge.foreground":"#2e3440","badge.background":"#88c0d0","button.background":"#88c0d0ee","button.foreground":"#2e3440","button.hoverBackground":"#88c0d0","button.secondaryBackground":"#434c5e","button.secondaryForeground":"#d8dee9","button.secondaryHoverBackground":"#4c566a","charts.red":"#bf616a","charts.blue":"#81a1c1","charts.yellow":"#ebcb8b","charts.orange":"#d08770","charts.green":"#a3be8c","charts.purple":"#b48ead","charts.foreground":"#d8dee9","charts.lines":"#88c0d0","debugConsole.infoForeground":"#88c0d0","debugConsole.warningForeground":"#ebcb8b","debugConsole.errorForeground":"#bf616a","debugConsole.sourceForeground":"#616e88","debugConsoleInputIcon.foreground":"#81a1c1","debugExceptionWidget.background":"#4c566a","debugExceptionWidget.border":"#2e3440","debugToolBar.background":"#3b4252",descriptionForeground:"#d8dee9e6","diffEditor.insertedTextBackground":"#81a1c133","diffEditor.removedTextBackground":"#bf616a4d","dropdown.background":"#3b4252","dropdown.border":"#3b4252","dropdown.foreground":"#d8dee9","editorActiveLineNumber.foreground":"#d8dee9cc","editorCursor.foreground":"#d8dee9","editorHint.border":"#ebcb8b00","editorHint.foreground":"#ebcb8b","editorIndentGuide.background":"#434c5eb3","editorIndentGuide.activeBackground":"#4c566a","editorInlayHint.background":"#434c5e","editorInlayHint.foreground":"#d8dee9","editorLineNumber.foreground":"#4c566a","editorLineNumber.activeForeground":"#d8dee9","editorWhitespace.foreground":"#4c566ab3","editorWidget.background":"#2e3440","editorWidget.border":"#3b4252","editor.background":"#2e3440","editor.foreground":"#d8dee9","editor.hoverHighlightBackground":"#3b4252","editor.findMatchBackground":"#88c0d066","editor.findMatchHighlightBackground":"#88c0d033","editor.findRangeHighlightBackground":"#88c0d033","editor.lineHighlightBackground":"#3b4252","editor.lineHighlightBorder":"#3b4252","editor.inactiveSelectionBackground":"#434c5ecc","editor.inlineValuesBackground":"#4c566a","editor.inlineValuesForeground":"#eceff4","editor.selectionBackground":"#434c5ecc","editor.selectionHighlightBackground":"#434c5ecc","editor.rangeHighlightBackground":"#434c5e52","editor.wordHighlightBackground":"#81a1c166","editor.wordHighlightStrongBackground":"#81a1c199","editor.stackFrameHighlightBackground":"#5e81ac","editor.focusedStackFrameHighlightBackground":"#5e81ac","editorError.foreground":"#bf616a","editorError.border":"#bf616a00","editorWarning.foreground":"#ebcb8b","editorWarning.border":"#ebcb8b00","editorBracketMatch.background":"#2e344000","editorBracketMatch.border":"#88c0d0","editorBracketHighlight.foreground1":"#8fbcbb","editorBracketHighlight.foreground2":"#88c0d0","editorBracketHighlight.foreground3":"#81a1c1","editorBracketHighlight.foreground4":"#5e81ac","editorBracketHighlight.foreground5":"#8fbcbb","editorBracketHighlight.foreground6":"#88c0d0","editorBracketHighlight.unexpectedBracket.foreground":"#bf616a","editorCodeLens.foreground":"#4c566a","editorGroup.background":"#2e3440","editorGroup.border":"#3b425201","editorGroup.dropBackground":"#3b425299","editorGroupHeader.border":"#3b425200","editorGroupHeader.noTabsBackground":"#2e3440","editorGroupHeader.tabsBackground":"#2e3440","editorGroupHeader.tabsBorder":"#3b425200","editorGutter.background":"#2e3440","editorGutter.modifiedBackground":"#ebcb8b","editorGutter.addedBackground":"#a3be8c","editorGutter.deletedBackground":"#bf616a","editorHoverWidget.background":"#3b4252","editorHoverWidget.border":"#3b4252","editorLink.activeForeground":"#88c0d0","editorMarkerNavigation.background":"#5e81acc0","editorMarkerNavigationError.background":"#bf616ac0","editorMarkerNavigationWarning.background":"#ebcb8bc0","editorOverviewRuler.border":"#3b4252","editorOverviewRuler.currentContentForeground":"#3b4252","editorOverviewRuler.incomingContentForeground":"#3b4252","editorOverviewRuler.findMatchForeground":"#88c0d066","editorOverviewRuler.rangeHighlightForeground":"#88c0d066","editorOverviewRuler.selectionHighlightForeground":"#88c0d066","editorOverviewRuler.wordHighlightForeground":"#88c0d066","editorOverviewRuler.wordHighlightStrongForeground":"#88c0d066","editorOverviewRuler.modifiedForeground":"#ebcb8b","editorOverviewRuler.addedForeground":"#a3be8c","editorOverviewRuler.deletedForeground":"#bf616a","editorOverviewRuler.errorForeground":"#bf616a","editorOverviewRuler.warningForeground":"#ebcb8b","editorOverviewRuler.infoForeground":"#81a1c1","editorRuler.foreground":"#434c5e","editorSuggestWidget.background":"#2e3440","editorSuggestWidget.border":"#3b4252","editorSuggestWidget.foreground":"#d8dee9","editorSuggestWidget.focusHighlightForeground":"#88c0d0","editorSuggestWidget.highlightForeground":"#88c0d0","editorSuggestWidget.selectedBackground":"#434c5e","editorSuggestWidget.selectedForeground":"#d8dee9","extensionButton.prominentForeground":"#d8dee9","extensionButton.prominentBackground":"#434c5e","extensionButton.prominentHoverBackground":"#4c566a",errorForeground:"#bf616a","gitDecoration.modifiedResourceForeground":"#ebcb8b","gitDecoration.deletedResourceForeground":"#bf616a","gitDecoration.untrackedResourceForeground":"#a3be8c","gitDecoration.ignoredResourceForeground":"#d8dee966","gitDecoration.conflictingResourceForeground":"#5e81ac","gitDecoration.submoduleResourceForeground":"#8fbcbb","gitDecoration.stageDeletedResourceForeground":"#bf616a","gitDecoration.stageModifiedResourceForeground":"#ebcb8b","input.background":"#3b4252","input.foreground":"#d8dee9","input.placeholderForeground":"#d8dee999","input.border":"#3b4252","inputOption.activeBackground":"#5e81ac","inputOption.activeBorder":"#5e81ac","inputOption.activeForeground":"#eceff4","inputValidation.errorBackground":"#bf616a","inputValidation.errorBorder":"#bf616a","inputValidation.infoBackground":"#81a1c1","inputValidation.infoBorder":"#81a1c1","inputValidation.warningBackground":"#d08770","inputValidation.warningBorder":"#d08770","keybindingLabel.background":"#4c566a","keybindingLabel.border":"#4c566a","keybindingLabel.bottomBorder":"#4c566a","keybindingLabel.foreground":"#d8dee9","list.activeSelectionBackground":"#88c0d0","list.activeSelectionForeground":"#2e3440","list.inactiveSelectionBackground":"#434c5e","list.inactiveSelectionForeground":"#d8dee9","list.inactiveFocusBackground":"#434c5ecc","list.hoverForeground":"#eceff4","list.focusForeground":"#d8dee9","list.focusBackground":"#88c0d099","list.focusHighlightForeground":"#eceff4","list.hoverBackground":"#3b4252","list.dropBackground":"#88c0d099","list.highlightForeground":"#88c0d0","list.errorForeground":"#bf616a","list.warningForeground":"#ebcb8b","merge.currentHeaderBackground":"#81a1c166","merge.currentContentBackground":"#81a1c14d","merge.incomingHeaderBackground":"#8fbcbb66","merge.incomingContentBackground":"#8fbcbb4d","merge.border":"#3b425200","minimap.background":"#2e3440","minimap.errorHighlight":"#bf616acc","minimap.findMatchHighlight":"#88c0d0","minimap.selectionHighlight":"#88c0d0cc","minimap.warningHighlight":"#ebcb8bcc","minimapGutter.addedBackground":"#a3be8c","minimapGutter.deletedBackground":"#bf616a","minimapGutter.modifiedBackground":"#ebcb8b","minimapSlider.activeBackground":"#434c5eaa","minimapSlider.background":"#434c5e99","minimapSlider.hoverBackground":"#434c5eaa","notification.background":"#3b4252","notification.buttonBackground":"#434c5e","notification.buttonForeground":"#d8dee9","notification.buttonHoverBackground":"#4c566a","notification.errorBackground":"#bf616a","notification.errorForeground":"#2e3440","notification.foreground":"#d8dee9","notification.infoBackground":"#88c0d0","notification.infoForeground":"#2e3440","notification.warningBackground":"#ebcb8b","notification.warningForeground":"#2e3440","notificationCenter.border":"#3b425200","notificationCenterHeader.background":"#2e3440","notificationCenterHeader.foreground":"#88c0d0","notificationLink.foreground":"#88c0d0","notifications.background":"#3b4252","notifications.border":"#2e3440","notifications.foreground":"#d8dee9","notificationToast.border":"#3b425200","panel.background":"#2e3440","panel.border":"#3b4252","panelTitle.activeBorder":"#88c0d000","panelTitle.activeForeground":"#88c0d0","panelTitle.inactiveForeground":"#d8dee9","peekView.border":"#4c566a","peekViewEditor.background":"#2e3440","peekViewEditorGutter.background":"#2e3440","peekViewEditor.matchHighlightBackground":"#88c0d04d","peekViewResult.background":"#2e3440","peekViewResult.fileForeground":"#88c0d0","peekViewResult.lineForeground":"#d8dee966","peekViewResult.matchHighlightBackground":"#88c0d0cc","peekViewResult.selectionBackground":"#434c5e","peekViewResult.selectionForeground":"#d8dee9","peekViewTitle.background":"#3b4252","peekViewTitleDescription.foreground":"#d8dee9","peekViewTitleLabel.foreground":"#88c0d0","pickerGroup.border":"#3b4252","pickerGroup.foreground":"#88c0d0","progressBar.background":"#88c0d0","quickInputList.focusBackground":"#88c0d0","quickInputList.focusForeground":"#2e3440","sash.hoverBorder":"#88c0d0","scrollbar.shadow":"#00000066","scrollbarSlider.activeBackground":"#434c5eaa","scrollbarSlider.background":"#434c5e99","scrollbarSlider.hoverBackground":"#434c5eaa","selection.background":"#88c0d099","sideBar.background":"#2e3440","sideBar.foreground":"#d8dee9","sideBar.border":"#3b4252","sideBarSectionHeader.background":"#3b4252","sideBarSectionHeader.foreground":"#d8dee9","sideBarTitle.foreground":"#d8dee9","statusBar.background":"#3b4252","statusBar.debuggingBackground":"#5e81ac","statusBar.debuggingForeground":"#d8dee9","statusBar.noFolderForeground":"#d8dee9","statusBar.noFolderBackground":"#3b4252","statusBar.foreground":"#d8dee9","statusBarItem.activeBackground":"#4c566a","statusBarItem.hoverBackground":"#434c5e","statusBarItem.prominentBackground":"#3b4252","statusBarItem.prominentHoverBackground":"#434c5e","statusBarItem.errorBackground":"#3b4252","statusBarItem.errorForeground":"#bf616a","statusBarItem.warningBackground":"#ebcb8b","statusBarItem.warningForeground":"#2e3440","statusBar.border":"#3b425200","tab.activeBackground":"#3b4252","tab.activeForeground":"#d8dee9","tab.border":"#3b425200","tab.activeBorder":"#88c0d000","tab.unfocusedActiveBorder":"#88c0d000","tab.inactiveBackground":"#2e3440","tab.inactiveForeground":"#d8dee966","tab.unfocusedActiveForeground":"#d8dee999","tab.unfocusedInactiveForeground":"#d8dee966","tab.hoverBackground":"#3b4252cc","tab.unfocusedHoverBackground":"#3b4252b3","tab.hoverBorder":"#88c0d000","tab.unfocusedHoverBorder":"#88c0d000","tab.activeBorderTop":"#88c0d000","tab.unfocusedActiveBorderTop":"#88c0d000","tab.lastPinnedBorder":"#4c566a","terminal.background":"#2e3440","terminal.foreground":"#d8dee9","terminal.ansiBlack":"#3b4252","terminal.ansiRed":"#bf616a","terminal.ansiGreen":"#a3be8c","terminal.ansiYellow":"#ebcb8b","terminal.ansiBlue":"#81a1c1","terminal.ansiMagenta":"#b48ead","terminal.ansiCyan":"#88c0d0","terminal.ansiWhite":"#e5e9f0","terminal.ansiBrightBlack":"#4c566a","terminal.ansiBrightRed":"#bf616a","terminal.ansiBrightGreen":"#a3be8c","terminal.ansiBrightYellow":"#ebcb8b","terminal.ansiBrightBlue":"#81a1c1","terminal.ansiBrightMagenta":"#b48ead","terminal.ansiBrightCyan":"#8fbcbb","terminal.ansiBrightWhite":"#eceff4","terminal.tab.activeBorder":"#88c0d0","textBlockQuote.background":"#3b4252","textBlockQuote.border":"#81a1c1","textCodeBlock.background":"#4c566a","textLink.activeForeground":"#88c0d0","textLink.foreground":"#88c0d0","textPreformat.foreground":"#8fbcbb","textSeparator.foreground":"#eceff4","titleBar.activeBackground":"#2e3440","titleBar.activeForeground":"#d8dee9","titleBar.border":"#2e344000","titleBar.inactiveBackground":"#2e3440","titleBar.inactiveForeground":"#d8dee966","tree.indentGuidesStroke":"#616e88","walkThrough.embeddedEditorBackground":"#2e3440","welcomePage.buttonBackground":"#434c5e","welcomePage.buttonHoverBackground":"#4c566a","widget.shadow":"#00000066"},tokenColors:[{settings:{foreground:"#d8dee9ff",background:"#2e3440ff"}},{scope:"emphasis",settings:{fontStyle:"italic"}},{scope:"strong",settings:{fontStyle:"bold"}},{name:"Comment",scope:"comment",settings:{foreground:"#616E88"}},{name:"Constant Character",scope:"constant.character",settings:{foreground:"#EBCB8B"}},{name:"Constant Character Escape",scope:"constant.character.escape",settings:{foreground:"#EBCB8B"}},{name:"Constant Language",scope:"constant.language",settings:{foreground:"#81A1C1"}},{name:"Constant Numeric",scope:"constant.numeric",settings:{foreground:"#B48EAD"}},{name:"Constant Regexp",scope:"constant.regexp",settings:{foreground:"#EBCB8B"}},{name:"Entity Name Class/Type",scope:["entity.name.class","entity.name.type.class"],settings:{foreground:"#8FBCBB"}},{name:"Entity Name Function",scope:"entity.name.function",settings:{foreground:"#88C0D0"}},{name:"Entity Name Tag",scope:"entity.name.tag",settings:{foreground:"#81A1C1"}},{name:"Entity Other Attribute Name",scope:"entity.other.attribute-name",settings:{foreground:"#8FBCBB"}},{name:"Entity Other Inherited Class",scope:"entity.other.inherited-class",settings:{fontStyle:"bold",foreground:"#8FBCBB"}},{name:"Invalid Deprecated",scope:"invalid.deprecated",settings:{foreground:"#D8DEE9",background:"#EBCB8B"}},{name:"Invalid Illegal",scope:"invalid.illegal",settings:{foreground:"#D8DEE9",background:"#BF616A"}},{name:"Keyword",scope:"keyword",settings:{foreground:"#81A1C1"}},{name:"Keyword Operator",scope:"keyword.operator",settings:{foreground:"#81A1C1"}},{name:"Keyword Other New",scope:"keyword.other.new",settings:{foreground:"#81A1C1"}},{name:"Markup Bold",scope:"markup.bold",settings:{fontStyle:"bold"}},{name:"Markup Changed",scope:"markup.changed",settings:{foreground:"#EBCB8B"}},{name:"Markup Deleted",scope:"markup.deleted",settings:{foreground:"#BF616A"}},{name:"Markup Inserted",scope:"markup.inserted",settings:{foreground:"#A3BE8C"}},{name:"Meta Preprocessor",scope:"meta.preprocessor",settings:{foreground:"#5E81AC"}},{name:"Punctuation",scope:"punctuation",settings:{foreground:"#ECEFF4"}},{name:"Punctuation Definition Parameters",scope:["punctuation.definition.method-parameters","punctuation.definition.function-parameters","punctuation.definition.parameters"],settings:{foreground:"#ECEFF4"}},{name:"Punctuation Definition Tag",scope:"punctuation.definition.tag",settings:{foreground:"#81A1C1"}},{name:"Punctuation Definition Comment",scope:["punctuation.definition.comment","punctuation.end.definition.comment","punctuation.start.definition.comment"],settings:{foreground:"#616E88"}},{name:"Punctuation Section",scope:"punctuation.section",settings:{foreground:"#ECEFF4"}},{name:"Punctuation Section Embedded",scope:["punctuation.section.embedded.begin","punctuation.section.embedded.end"],settings:{foreground:"#81A1C1"}},{name:"Punctuation Terminator",scope:"punctuation.terminator",settings:{foreground:"#81A1C1"}},{name:"Punctuation Variable",scope:"punctuation.definition.variable",settings:{foreground:"#81A1C1"}},{name:"Storage",scope:"storage",settings:{foreground:"#81A1C1"}},{name:"String",scope:"string",settings:{foreground:"#A3BE8C"}},{name:"String Regexp",scope:"string.regexp",settings:{foreground:"#EBCB8B"}},{name:"Support Class",scope:"support.class",settings:{foreground:"#8FBCBB"}},{name:"Support Constant",scope:"support.constant",settings:{foreground:"#81A1C1"}},{name:"Support Function",scope:"support.function",settings:{foreground:"#88C0D0"}},{name:"Support Function Construct",scope:"support.function.construct",settings:{foreground:"#81A1C1"}},{name:"Support Type",scope:"support.type",settings:{foreground:"#8FBCBB"}},{name:"Support Type Exception",scope:"support.type.exception",settings:{foreground:"#8FBCBB"}},{name:"Token Debug",scope:"token.debug-token",settings:{foreground:"#b48ead"}},{name:"Token Error",scope:"token.error-token",settings:{foreground:"#bf616a"}},{name:"Token Info",scope:"token.info-token",settings:{foreground:"#88c0d0"}},{name:"Token Warning",scope:"token.warn-token",settings:{foreground:"#ebcb8b"}},{name:"Variable",scope:"variable.other",settings:{foreground:"#D8DEE9"}},{name:"Variable Language",scope:"variable.language",settings:{foreground:"#81A1C1"}},{name:"Variable Parameter",scope:"variable.parameter",settings:{foreground:"#D8DEE9"}},{name:"[C/CPP] Punctuation Separator Pointer-Access",scope:"punctuation.separator.pointer-access.c",settings:{foreground:"#81A1C1"}},{name:"[C/CPP] Meta Preprocessor Include",scope:["source.c meta.preprocessor.include","source.c string.quoted.other.lt-gt.include"],settings:{foreground:"#8FBCBB"}},{name:"[C/CPP] Conditional Directive",scope:["source.cpp keyword.control.directive.conditional","source.cpp punctuation.definition.directive","source.c keyword.control.directive.conditional","source.c punctuation.definition.directive"],settings:{foreground:"#5E81AC",fontStyle:"bold"}},{name:"[CSS] Constant Other Color RGB Value",scope:"source.css constant.other.color.rgb-value",settings:{foreground:"#B48EAD"}},{name:"[CSS](Function) Meta Property-Value",scope:"source.css meta.property-value",settings:{foreground:"#88C0D0"}},{name:"[CSS] Media Queries",scope:["source.css keyword.control.at-rule.media","source.css keyword.control.at-rule.media punctuation.definition.keyword"],settings:{foreground:"#D08770"}},{name:"[CSS] Punctuation Definition Keyword",scope:"source.css punctuation.definition.keyword",settings:{foreground:"#81A1C1"}},{name:"[CSS] Support Type Property Name",scope:"source.css support.type.property-name",settings:{foreground:"#D8DEE9"}},{name:"[diff] Meta Range Context",scope:"source.diff meta.diff.range.context",settings:{foreground:"#8FBCBB"}},{name:"[diff] Meta Header From-File",scope:"source.diff meta.diff.header.from-file",settings:{foreground:"#8FBCBB"}},{name:"[diff] Punctuation Definition From-File",scope:"source.diff punctuation.definition.from-file",settings:{foreground:"#8FBCBB"}},{name:"[diff] Punctuation Definition Range",scope:"source.diff punctuation.definition.range",settings:{foreground:"#8FBCBB"}},{name:"[diff] Punctuation Definition Separator",scope:"source.diff punctuation.definition.separator",settings:{foreground:"#81A1C1"}},{name:"[Elixir](JakeBecker.elixir-ls) module names",scope:"entity.name.type.module.elixir",settings:{foreground:"#8FBCBB"}},{name:"[Elixir](JakeBecker.elixir-ls) module attributes",scope:"variable.other.readwrite.module.elixir",settings:{foreground:"#D8DEE9",fontStyle:"bold"}},{name:"[Elixir](JakeBecker.elixir-ls) atoms",scope:"constant.other.symbol.elixir",settings:{foreground:"#D8DEE9",fontStyle:"bold"}},{name:"[Elixir](JakeBecker.elixir-ls) modules",scope:"variable.other.constant.elixir",settings:{foreground:"#8FBCBB"}},{name:"[Go] String Format Placeholder",scope:"source.go constant.other.placeholder.go",settings:{foreground:"#EBCB8B"}},{name:"[Java](JavaDoc) Comment Block Documentation HTML Entities",scope:"source.java comment.block.documentation.javadoc punctuation.definition.entity.html",settings:{foreground:"#81A1C1"}},{name:"[Java](JavaDoc) Constant Other",scope:"source.java constant.other",settings:{foreground:"#D8DEE9"}},{name:"[Java](JavaDoc) Keyword Other Documentation",scope:"source.java keyword.other.documentation",settings:{foreground:"#8FBCBB"}},{name:"[Java](JavaDoc) Keyword Other Documentation Author",scope:"source.java keyword.other.documentation.author.javadoc",settings:{foreground:"#8FBCBB"}},{name:"[Java](JavaDoc) Keyword Other Documentation Directive/Custom",scope:["source.java keyword.other.documentation.directive","source.java keyword.other.documentation.custom"],settings:{foreground:"#8FBCBB"}},{name:"[Java](JavaDoc) Keyword Other Documentation See",scope:"source.java keyword.other.documentation.see.javadoc",settings:{foreground:"#8FBCBB"}},{name:"[Java] Meta Method-Call",scope:"source.java meta.method-call meta.method",settings:{foreground:"#88C0D0"}},{name:"[Java](JavaDoc) Meta Tag Template Link",scope:["source.java meta.tag.template.link.javadoc","source.java string.other.link.title.javadoc"],settings:{foreground:"#8FBCBB"}},{name:"[Java](JavaDoc) Meta Tag Template Value",scope:"source.java meta.tag.template.value.javadoc",settings:{foreground:"#88C0D0"}},{name:"[Java](JavaDoc) Punctuation Definition Keyword",scope:"source.java punctuation.definition.keyword.javadoc",settings:{foreground:"#8FBCBB"}},{name:"[Java](JavaDoc) Punctuation Definition Tag",scope:["source.java punctuation.definition.tag.begin.javadoc","source.java punctuation.definition.tag.end.javadoc"],settings:{foreground:"#616E88"}},{name:"[Java] Storage Modifier Import",scope:"source.java storage.modifier.import",settings:{foreground:"#8FBCBB"}},{name:"[Java] Storage Modifier Package",scope:"source.java storage.modifier.package",settings:{foreground:"#8FBCBB"}},{name:"[Java] Storage Type",scope:"source.java storage.type",settings:{foreground:"#8FBCBB"}},{name:"[Java] Storage Type Annotation",scope:"source.java storage.type.annotation",settings:{foreground:"#D08770"}},{name:"[Java] Storage Type Generic",scope:"source.java storage.type.generic",settings:{foreground:"#8FBCBB"}},{name:"[Java] Storage Type Primitive",scope:"source.java storage.type.primitive",settings:{foreground:"#81A1C1"}},{name:"[JavaScript] Decorator",scope:["source.js punctuation.decorator","source.js meta.decorator variable.other.readwrite","source.js meta.decorator entity.name.function"],settings:{foreground:"#D08770"}},{name:"[JavaScript] Meta Object-Literal Key",scope:"source.js meta.object-literal.key",settings:{foreground:"#88C0D0"}},{name:"[JavaScript](JSDoc) Storage Type Class",scope:"source.js storage.type.class.jsdoc",settings:{foreground:"#8FBCBB"}},{name:"[JavaScript] String Template Literals Punctuation",scope:["source.js string.quoted.template punctuation.quasi.element.begin","source.js string.quoted.template punctuation.quasi.element.end","source.js string.template punctuation.definition.template-expression"],settings:{foreground:"#81A1C1"}},{name:"[JavaScript] Interpolated String Template Punctuation Functions",scope:"source.js string.quoted.template meta.method-call.with-arguments",settings:{foreground:"#ECEFF4"}},{name:"[JavaScript] String Template Literal Variable",scope:["source.js string.template meta.template.expression support.variable.property","source.js string.template meta.template.expression variable.other.object"],settings:{foreground:"#D8DEE9"}},{name:"[JavaScript] Support Type Primitive",scope:"source.js support.type.primitive",settings:{foreground:"#81A1C1"}},{name:"[JavaScript] Variable Other Object",scope:"source.js variable.other.object",settings:{foreground:"#D8DEE9"}},{name:"[JavaScript] Variable Other Read-Write Alias",scope:"source.js variable.other.readwrite.alias",settings:{foreground:"#8FBCBB"}},{name:"[JavaScript] Parentheses in Template Strings",scope:["source.js meta.embedded.line meta.brace.square","source.js meta.embedded.line meta.brace.round","source.js string.quoted.template meta.brace.square","source.js string.quoted.template meta.brace.round"],settings:{foreground:"#ECEFF4"}},{name:"[HTML] Constant Character Entity",scope:"text.html.basic constant.character.entity.html",settings:{foreground:"#EBCB8B"}},{name:"[HTML] Constant Other Inline-Data",scope:"text.html.basic constant.other.inline-data",settings:{foreground:"#D08770",fontStyle:"italic"}},{name:"[HTML] Meta Tag SGML Doctype",scope:"text.html.basic meta.tag.sgml.doctype",settings:{foreground:"#5E81AC"}},{name:"[HTML] Punctuation Definition Entity",scope:"text.html.basic punctuation.definition.entity",settings:{foreground:"#81A1C1"}},{name:"[INI] Entity Name Section Group-Title",scope:"source.properties entity.name.section.group-title.ini",settings:{foreground:"#88C0D0"}},{name:"[INI] Punctuation Separator Key-Value",scope:"source.properties punctuation.separator.key-value.ini",settings:{foreground:"#81A1C1"}},{name:"[Markdown] Markup Fenced Code Block",scope:["text.html.markdown markup.fenced_code.block","text.html.markdown markup.fenced_code.block punctuation.definition"],settings:{foreground:"#8FBCBB"}},{name:"[Markdown] Markup Heading",scope:"markup.heading",settings:{foreground:"#88C0D0"}},{name:"[Markdown] Markup Inline",scope:["text.html.markdown markup.inline.raw","text.html.markdown markup.inline.raw punctuation.definition.raw"],settings:{foreground:"#8FBCBB"}},{name:"[Markdown] Markup Italic",scope:"text.html.markdown markup.italic",settings:{fontStyle:"italic"}},{name:"[Markdown] Markup Link",scope:"text.html.markdown markup.underline.link",settings:{fontStyle:"underline"}},{name:"[Markdown] Markup List Numbered/Unnumbered",scope:"text.html.markdown beginning.punctuation.definition.list",settings:{foreground:"#81A1C1"}},{name:"[Markdown] Markup Quote Punctuation Definition",scope:"text.html.markdown beginning.punctuation.definition.quote",settings:{foreground:"#8FBCBB"}},{name:"[Markdown] Markup Quote Punctuation Definition",scope:"text.html.markdown markup.quote",settings:{foreground:"#616E88"}},{name:"[Markdown] Markup Math Constant",scope:"text.html.markdown constant.character.math.tex",settings:{foreground:"#81A1C1"}},{name:"[Markdown] Markup Math Definition Marker",scope:["text.html.markdown punctuation.definition.math.begin","text.html.markdown punctuation.definition.math.end"],settings:{foreground:"#5E81AC"}},{name:"[Markdown] Markup Math Function Definition Marker",scope:"text.html.markdown punctuation.definition.function.math.tex",settings:{foreground:"#88C0D0"}},{name:"[Markdown] Markup Math Operator",scope:"text.html.markdown punctuation.math.operator.latex",settings:{foreground:"#81A1C1"}},{name:"[Markdown] Punctuation Definition Heading",scope:"text.html.markdown punctuation.definition.heading",settings:{foreground:"#81A1C1"}},{name:"[Markdown] Punctuation Definition Constant/String",scope:["text.html.markdown punctuation.definition.constant","text.html.markdown punctuation.definition.string"],settings:{foreground:"#81A1C1"}},{name:"[Markdown] String Other Link Description/Title",scope:["text.html.markdown constant.other.reference.link","text.html.markdown string.other.link.description","text.html.markdown string.other.link.title"],settings:{foreground:"#88C0D0"}},{name:"[Perl] Perl Sigils",scope:"source.perl punctuation.definition.variable",settings:{foreground:"#D8DEE9"}},{name:"[PHP] Meta Function-Call Object",scope:["source.php meta.function-call","source.php meta.function-call.object"],settings:{foreground:"#88C0D0"}},{name:"[Python] Decorator",scope:["source.python entity.name.function.decorator","source.python meta.function.decorator support.type"],settings:{foreground:"#D08770"}},{name:"[Python] Function Call",scope:"source.python meta.function-call.generic",settings:{foreground:"#88C0D0"}},{name:"[Python] Support Type",scope:"source.python support.type",settings:{foreground:"#88C0D0"}},{name:"[Python] Function Parameter",scope:["source.python variable.parameter.function.language"],settings:{foreground:"#D8DEE9"}},{name:"[Python] Function Parameter Special",scope:["source.python meta.function.parameters variable.parameter.function.language.special.self"],settings:{foreground:"#81A1C1"}},{name:"[Rust] Entity types",scope:"source.rust entity.name.type",settings:{foreground:"#8FBCBB"}},{name:"[Rust] Macro",scope:"source.rust meta.macro entity.name.function",settings:{fontStyle:"bold",foreground:"#88C0D0"}},{name:"[Rust] Attributes",scope:["source.rust meta.attribute","source.rust meta.attribute punctuation","source.rust meta.attribute keyword.operator"],settings:{foreground:"#5E81AC"}},{name:"[Rust] Traits",scope:"source.rust entity.name.type.trait",settings:{fontStyle:"bold"}},{name:"[Rust] Interpolation Bracket Curly",scope:"source.rust punctuation.definition.interpolation",settings:{foreground:"#EBCB8B"}},{name:"[SCSS] Punctuation Definition Interpolation Bracket Curly",scope:["source.css.scss punctuation.definition.interpolation.begin.bracket.curly","source.css.scss punctuation.definition.interpolation.end.bracket.curly"],settings:{foreground:"#81A1C1"}},{name:"[SCSS] Variable Interpolation",scope:"source.css.scss variable.interpolation",settings:{foreground:"#D8DEE9",fontStyle:"italic"}},{name:"[TypeScript] Decorators",scope:["source.ts punctuation.decorator","source.ts meta.decorator variable.other.readwrite","source.ts meta.decorator entity.name.function","source.tsx punctuation.decorator","source.tsx meta.decorator variable.other.readwrite","source.tsx meta.decorator entity.name.function"],settings:{foreground:"#D08770"}},{name:"[TypeScript] Object-literal keys",scope:["source.ts meta.object-literal.key","source.tsx meta.object-literal.key"],settings:{foreground:"#D8DEE9"}},{name:"[TypeScript] Object-literal functions",scope:["source.ts meta.object-literal.key entity.name.function","source.tsx meta.object-literal.key entity.name.function"],settings:{foreground:"#88C0D0"}},{name:"[TypeScript] Type/Class",scope:["source.ts support.class","source.ts support.type","source.ts entity.name.type","source.ts entity.name.class","source.tsx support.class","source.tsx support.type","source.tsx entity.name.type","source.tsx entity.name.class"],settings:{foreground:"#8FBCBB"}},{name:"[TypeScript] Static Class Support",scope:["source.ts support.constant.math","source.ts support.constant.dom","source.ts support.constant.json","source.tsx support.constant.math","source.tsx support.constant.dom","source.tsx support.constant.json"],settings:{foreground:"#8FBCBB"}},{name:"[TypeScript] Variables",scope:["source.ts support.variable","source.tsx support.variable"],settings:{foreground:"#D8DEE9"}},{name:"[TypeScript] Parentheses in Template Strings",scope:["source.ts meta.embedded.line meta.brace.square","source.ts meta.embedded.line meta.brace.round","source.tsx meta.embedded.line meta.brace.square","source.tsx meta.embedded.line meta.brace.round"],settings:{foreground:"#ECEFF4"}},{name:"[XML] Entity Name Tag Namespace",scope:"text.xml entity.name.tag.namespace",settings:{foreground:"#8FBCBB"}},{name:"[XML] Keyword Other Doctype",scope:"text.xml keyword.other.doctype",settings:{foreground:"#5E81AC"}},{name:"[XML] Meta Tag Preprocessor",scope:"text.xml meta.tag.preprocessor entity.name.tag",settings:{foreground:"#5E81AC"}},{name:"[XML] Entity Name Tag Namespace",scope:["text.xml string.unquoted.cdata","text.xml string.unquoted.cdata punctuation.definition.string"],settings:{foreground:"#D08770",fontStyle:"italic"}},{name:"[YAML] Entity Name Tag",scope:"source.yaml entity.name.tag",settings:{foreground:"#8FBCBB"}}]},lineNumbers:!0,showCopyButton:!0,autoImport:!0,skipLanguages:[],filepath:"/home/runner/work/docs/docs/versioned_docs/version-stable/cadence/language/crypto.mdx"};function g(e){const o=Object.assign({h2:"h2",p:"p",code:"code",a:"a",ul:"ul",li:"li",h3:"h3"},(0,r.ah)(),e.components),{Callout:t}=o;return d||y("CH",!1),d.Code||y("CH.Code",!0),t||y("Callout",!0),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.h2,{id:"hashing",children:"Hashing"}),"\n",(0,n.jsxs)(o.p,{children:["The built-in enum ",(0,n.jsx)(o.code,{children:"HashAlgorithm"})," provides the set of hashing algorithms that\nare supported by the language natively."]}),"\n",(0,n.jsx)(d.Code,{codeConfig:u,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"pub enum",props:{style:{color:"#81A1C1"}}},{content:" HashAlgorithm",props:{style:{color:"#D8DEE9FF"}}},{content:": ",props:{style:{color:"#ECEFF4"}}},{content:"UInt8 ",props:{style:{color:"#81A1C1"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    /// SHA2_256 is SHA-2 with a 256-bit digest (also referred to as SHA256).",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    pub case",props:{style:{color:"#81A1C1"}}},{content:" SHA2_256 ",props:{style:{color:"#D8DEE9FF"}}},{content:"= ",props:{style:{color:"#81A1C1"}}},{content:"1",props:{style:{color:"#B48EAD"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    /// SHA2_384 is SHA-2 with a 384-bit digest (also referred to as  SHA384).",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    pub case",props:{style:{color:"#81A1C1"}}},{content:" SHA2_384 ",props:{style:{color:"#D8DEE9FF"}}},{content:"= ",props:{style:{color:"#81A1C1"}}},{content:"2",props:{style:{color:"#B48EAD"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    /// SHA3_256 is SHA-3 with a 256-bit digest.",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    pub case",props:{style:{color:"#81A1C1"}}},{content:" SHA3_256 ",props:{style:{color:"#D8DEE9FF"}}},{content:"= ",props:{style:{color:"#81A1C1"}}},{content:"3",props:{style:{color:"#B48EAD"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    /// SHA3_384 is SHA-3 with a 384-bit digest.",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    pub case",props:{style:{color:"#81A1C1"}}},{content:" SHA3_384 ",props:{style:{color:"#D8DEE9FF"}}},{content:"= ",props:{style:{color:"#81A1C1"}}},{content:"4",props:{style:{color:"#B48EAD"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    /// KMAC128_BLS_BLS12_381 is an instance of KECCAK Message Authentication Code (KMAC128) mac algorithm.",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    /// Although this is a MAC algorithm, KMAC is included in this list as it can be used hash",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    /// when the key is used a non-public customizer.",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    /// KMAC128_BLS_BLS12_381 is used in particular as the hashing algorithm for the BLS signature scheme on the curve BLS12-381.",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    /// It is a customized version of KMAC128 that is compatible with the hashing to curve",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    /// used in BLS signatures.",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    /// It is the same hasher used by signatures in the internal Flow protocol.",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    pub case",props:{style:{color:"#81A1C1"}}},{content:" KMAC128_BLS_BLS12_381 ",props:{style:{color:"#D8DEE9FF"}}},{content:"= ",props:{style:{color:"#81A1C1"}}},{content:"5",props:{style:{color:"#B48EAD"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    /// KECCAK_256 is the legacy Keccak algorithm with a 256-bits digest, as per the original submission to the NIST SHA3 competition.",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    /// KECCAK_256 is different than SHA3 and is used by Ethereum.",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    pub case",props:{style:{color:"#81A1C1"}}},{content:" KECCAK_256 ",props:{style:{color:"#D8DEE9FF"}}},{content:"= ",props:{style:{color:"#81A1C1"}}},{content:"6",props:{style:{color:"#B48EAD"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    /// Returns the hash of the given data",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    pub fun ",props:{style:{color:"#81A1C1"}}},{content:"hash",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#ECEFF4"}}},{content:"_ ",props:{style:{color:"#88C0D0"}}},{content:"data",props:{style:{color:"#D8DEE9"}}},{content:": [",props:{style:{color:"#D8DEE9FF"}}},{content:"UInt8",props:{style:{color:"#81A1C1"}}},{content:"]",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}},{content:":",props:{style:{color:"#81A1C1"}}},{content:" [",props:{style:{color:"#D8DEE9FF"}}},{content:"UInt8",props:{style:{color:"#81A1C1"}}},{content:"]",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    /// Returns the hash of the given data and tag",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    pub fun ",props:{style:{color:"#81A1C1"}}},{content:"hashWithTag",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#ECEFF4"}}},{content:"_ ",props:{style:{color:"#88C0D0"}}},{content:"data",props:{style:{color:"#D8DEE9"}}},{content:": [",props:{style:{color:"#D8DEE9FF"}}},{content:"UInt8",props:{style:{color:"#81A1C1"}}},{content:"], ",props:{style:{color:"#D8DEE9FF"}}},{content:"tag",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"string",props:{style:{color:"#81A1C1"}}},{content:")",props:{style:{color:"#ECEFF4"}}},{content:":",props:{style:{color:"#81A1C1"}}},{content:" [",props:{style:{color:"#D8DEE9FF"}}},{content:"UInt8",props:{style:{color:"#81A1C1"}}},{content:"]",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"}",props:{style:{color:"#ECEFF4"}}}]}],lang:"cadence"},annotations:[]}]}),"\n",(0,n.jsxs)(o.p,{children:["The hash algorithms provide two ways to hash input data into digests, ",(0,n.jsx)(o.code,{children:"hash"})," and ",(0,n.jsx)(o.code,{children:"hashWithTag"}),"."]}),"\n",(0,n.jsx)(o.h2,{id:"hashing-1",children:"Hashing"}),"\n",(0,n.jsxs)(o.p,{children:[(0,n.jsx)(o.code,{children:"hash"})," hashes the input data using the chosen hashing algorithm.\n",(0,n.jsx)(o.code,{children:"KMAC"})," is the only MAC algorithm on the list\nand configured with specific parameters (detailed in ",(0,n.jsx)(o.a,{href:"#KMAC128-for-BLS",children:"KMAC128 for BLS"}),")"]}),"\n",(0,n.jsx)(o.p,{children:"For example, to compute a SHA3-256 digest:"}),"\n",(0,n.jsx)(d.Code,{codeConfig:u,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"let",props:{style:{color:"#81A1C1"}}},{content:" data: [",props:{style:{color:"#D8DEE9FF"}}},{content:"UInt8",props:{style:{color:"#81A1C1"}}},{content:"] = [",props:{style:{color:"#D8DEE9FF"}}},{content:"1",props:{style:{color:"#B48EAD"}}},{content:", ",props:{style:{color:"#D8DEE9FF"}}},{content:"2",props:{style:{color:"#B48EAD"}}},{content:", ",props:{style:{color:"#D8DEE9FF"}}},{content:"3",props:{style:{color:"#B48EAD"}}},{content:"]",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"let",props:{style:{color:"#81A1C1"}}},{content:" digest = HashAlgorithm.SHA3_256.",props:{style:{color:"#D8DEE9FF"}}},{content:"hash",props:{style:{color:"#88C0D0"}}},{content:"(data",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]}],lang:"cadence"},annotations:[]}]}),"\n",(0,n.jsx)(o.h2,{id:"hashing-with-a-domain-tag",children:"Hashing with a domain tag"}),"\n",(0,n.jsxs)(o.p,{children:[(0,n.jsx)(o.code,{children:"hashWithTag"})," hashes the input data along with an input tag.\nIt allows instanciating independent hashing functions customized with a domain separation tag (DST).\nFor most of the hashing algorithms, mixing the data with the tag is done by pre-fixing the data with the tag and\nhashing the result."]}),"\n",(0,n.jsxs)(o.ul,{children:["\n",(0,n.jsxs)(o.li,{children:[(0,n.jsx)(o.code,{children:"SHA2_256"}),", ",(0,n.jsx)(o.code,{children:"SHA2_384"}),", ",(0,n.jsx)(o.code,{children:"SHA3_256"}),", ",(0,n.jsx)(o.code,{children:"SHA3_384"}),", ",(0,n.jsx)(o.code,{children:"KECCAK_256"}),":\nIf the tag is non-empty, the hashed message is ",(0,n.jsx)(o.code,{children:"bytes(tag) || data"})," where ",(0,n.jsx)(o.code,{children:"bytes()"})," is the UTF-8 encoding of the input string,\npadded with zeros till 32 bytes.\nTherefore tags must not exceed 32 bytes.\nIf the tag used is empty, no data prefix is applied, and the hashed message is simply ",(0,n.jsx)(o.code,{children:"data"})," (same as ",(0,n.jsx)(o.code,{children:"hash"})," output)."]}),"\n",(0,n.jsxs)(o.li,{children:[(0,n.jsx)(o.code,{children:"KMAC128_BLS_BLS12_381"}),": refer to ",(0,n.jsx)(o.a,{href:"#KMAC128-for-BLS",children:"KMAC128 for BLS"})," for details."]}),"\n"]}),"\n",(0,n.jsx)(o.h3,{id:"kmac128-for-bls",children:"KMAC128 for BLS"}),"\n",(0,n.jsxs)(o.p,{children:[(0,n.jsx)(o.code,{children:"KMAC128_BLS_BLS12_381"})," is an instance of the cSHAKE-based KMAC128.\nAlthough this is a MAC algorithm, KMAC can be used as a hash when the key is used as a non-private customizer.\n",(0,n.jsx)(o.code,{children:"KMAC128_BLS_BLS12_381"})," is used in particular as the hashing algorithm for the BLS signature scheme on the curve BLS12-381.\nIt is a customized instance of KMAC128 and is compatible with the hashing to curve used by BLS signatures.\nIt is the same hasher used by the internal Flow protocol, and can be used to verify Flow protocol signatures on-chain."]}),"\n",(0,n.jsxs)(o.p,{children:["To define the MAC instance, ",(0,n.jsx)(o.code,{children:"KMAC128(customizer, key, data, length)"})," is instanciated with the following parameters\n(as referred to by the NIST ",(0,n.jsx)(o.a,{href:"https://nvlpubs.nist.gov/nistpubs/specialpublications/nist.sp.800-185.pdf",children:"SHA-3 Derived Functions"}),"):"]}),"\n",(0,n.jsxs)(o.ul,{children:["\n",(0,n.jsxs)(o.li,{children:[(0,n.jsx)(o.code,{children:"customizer"})," is the UTF-8 encoding of ",(0,n.jsx)(o.code,{children:'"H2C"'}),"."]}),"\n",(0,n.jsxs)(o.li,{children:[(0,n.jsx)(o.code,{children:"key"})," is the UTF-8 encoding of ",(0,n.jsx)(o.code,{children:'"FLOW--V00-CS00-with-BLS_SIG_BLS12381G1_XOF:KMAC128_SSWU_RO_POP_"'})," when ",(0,n.jsx)(o.code,{children:"hash"})," is used. It includes the input ",(0,n.jsx)(o.code,{children:"tag"}),"\nwhen ",(0,n.jsx)(o.code,{children:"hashWithTag"})," is used and key becomes the UTF-8 encoding of ",(0,n.jsx)(o.code,{children:'"FLOW-" || tag || "-V00-CS00-with-BLS_SIG_BLS12381G1_XOF:KMAC128_SSWU_RO_POP_"'}),"."]}),"\n",(0,n.jsxs)(o.li,{children:[(0,n.jsx)(o.code,{children:"data"})," is the input data to hash."]}),"\n",(0,n.jsxs)(o.li,{children:[(0,n.jsx)(o.code,{children:"length"})," is 1024 bytes."]}),"\n"]}),"\n",(0,n.jsx)(o.h2,{id:"signing-algorithms",children:"Signing Algorithms"}),"\n",(0,n.jsxs)(o.p,{children:["The built-in enum ",(0,n.jsx)(o.code,{children:"SignatureAlgorithm"})," provides the set of signing algorithms that\nare supported by the language natively."]}),"\n",(0,n.jsx)(d.Code,{codeConfig:u,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"pub enum",props:{style:{color:"#81A1C1"}}},{content:" SignatureAlgorithm",props:{style:{color:"#D8DEE9FF"}}},{content:": ",props:{style:{color:"#ECEFF4"}}},{content:"UInt8 ",props:{style:{color:"#81A1C1"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    /// ECDSA_P256 is ECDSA on the NIST P-256 curve.",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    pub case",props:{style:{color:"#81A1C1"}}},{content:" ECDSA_P256 ",props:{style:{color:"#D8DEE9FF"}}},{content:"= ",props:{style:{color:"#81A1C1"}}},{content:"1",props:{style:{color:"#B48EAD"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    /// ECDSA_secp256k1 is ECDSA on the secp256k1 curve.",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    pub case",props:{style:{color:"#81A1C1"}}},{content:" ECDSA_secp256k1 ",props:{style:{color:"#D8DEE9FF"}}},{content:"= ",props:{style:{color:"#81A1C1"}}},{content:"2",props:{style:{color:"#B48EAD"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    /// BLS_BLS12_381 is BLS signature scheme on the BLS12-381 curve.",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    /// The scheme is set-up so that signatures are in G_1 (subgroup of the curve over the prime field)",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    /// while public keys are in G_2 (subgroup of the curve over the prime field extension).",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    pub case",props:{style:{color:"#81A1C1"}}},{content:" BLS_BLS12_381 ",props:{style:{color:"#D8DEE9FF"}}},{content:"= ",props:{style:{color:"#81A1C1"}}},{content:"3",props:{style:{color:"#B48EAD"}}}]},{tokens:[{content:"}",props:{style:{color:"#ECEFF4"}}}]}],lang:"cadence"},annotations:[]}]}),"\n",(0,n.jsx)(o.h2,{id:"publickey",children:"PublicKey"}),"\n",(0,n.jsxs)(o.p,{children:[(0,n.jsx)(o.code,{children:"PublicKey"})," is a built-in structure that represents a cryptographic public key of a signature scheme."]}),"\n",(0,n.jsx)(d.Code,{codeConfig:u,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"struct",props:{style:{color:"#81A1C1"}}},{content:" PublicKey ",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    let",props:{style:{color:"#81A1C1"}}},{content:" publicKey: [",props:{style:{color:"#D8DEE9FF"}}},{content:"UInt8",props:{style:{color:"#81A1C1"}}},{content:"]",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    let",props:{style:{color:"#81A1C1"}}},{content:" signatureAlgorithm: ",props:{style:{color:"#D8DEE9FF"}}},{content:"SignatureAlgorithm",props:{style:{color:"#81A1C1"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    /// Verifies a signature under the given tag, data and public key.",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    /// It uses the given hash algorithm to hash the tag and data.",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    pub fun ",props:{style:{color:"#81A1C1"}}},{content:"verify",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        signature",props:{style:{color:"#88C0D0"}}},{content:": [",props:{style:{color:"#D8DEE9FF"}}},{content:"UInt8",props:{style:{color:"#81A1C1"}}},{content:"],",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        signedData",props:{style:{color:"#88C0D0"}}},{content:": [",props:{style:{color:"#D8DEE9FF"}}},{content:"UInt8",props:{style:{color:"#81A1C1"}}},{content:"],",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        domainSeparationTag",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"String",props:{style:{color:"#81A1C1"}}},{content:",",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        hashAlgorithm",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"HashAlgorithm",props:{style:{color:"#81A1C1"}}}]},{tokens:[{content:"    )",props:{style:{color:"#ECEFF4"}}},{content:": Bool",props:{style:{color:"#81A1C1"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    /// Verifies the proof of possession of the private key.",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    /// This function is only implemented if the signature algorithm",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    /// of the public key is BLS (BLS_BLS12_381).",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    /// If called with any other signature algorithm, the program aborts",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    pub fun ",props:{style:{color:"#81A1C1"}}},{content:"verifyPoP",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#ECEFF4"}}},{content:"_ ",props:{style:{color:"#88C0D0"}}},{content:"proof",props:{style:{color:"#D8DEE9"}}},{content:": [",props:{style:{color:"#D8DEE9FF"}}},{content:"UInt8",props:{style:{color:"#81A1C1"}}},{content:"]",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}},{content:": Bool",props:{style:{color:"#81A1C1"}}}]},{tokens:[{content:"}",props:{style:{color:"#ECEFF4"}}}]}],lang:"cadence"},annotations:[]}]}),"\n",(0,n.jsxs)(o.p,{children:[(0,n.jsx)(o.code,{children:"PublicKey"})," supports two methods ",(0,n.jsx)(o.code,{children:"verify"})," and ",(0,n.jsx)(o.code,{children:"verifyPoP"}),".\n",(0,n.jsx)(o.code,{children:"verifyPoP"})," will be covered under ",(0,n.jsx)(o.a,{href:"#proof-of-possession-pop",children:"BLS multi-signature"}),"."]}),"\n",(0,n.jsx)(o.h3,{id:"public-key-construction",children:"Public Key construction"}),"\n",(0,n.jsxs)(o.p,{children:["A ",(0,n.jsx)(o.code,{children:"PublicKey"})," can be constructed using the raw key and the signing algorithm."]}),"\n",(0,n.jsx)(d.Code,{codeConfig:u,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"let",props:{style:{color:"#81A1C1"}}},{content:" publicKey = ",props:{style:{color:"#D8DEE9FF"}}},{content:"PublicKey",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    publicKey",props:{style:{color:"#88C0D0"}}},{content:': "',props:{style:{color:"#ECEFF4"}}},{content:"010203",props:{style:{color:"#A3BE8C"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:".",props:{style:{color:"#D8DEE9FF"}}},{content:"decodeHex",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}},{content:",",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    signatureAlgorithm",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" SignatureAlgorithm.ECDSA_P256",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:")",props:{style:{color:"#ECEFF4"}}}]}],lang:"cadence"},annotations:[]}]}),"\n",(0,n.jsx)(o.p,{children:"The raw key value depends on the supported signature scheme:"}),"\n",(0,n.jsxs)(o.ul,{children:["\n",(0,n.jsxs)(o.li,{children:["\n",(0,n.jsxs)(o.p,{children:[(0,n.jsx)(o.code,{children:"ECDSA_P256"})," and ",(0,n.jsx)(o.code,{children:"ECDSA_secp256k1"}),":\nThe public key is an uncompressed curve point ",(0,n.jsx)(o.code,{children:"(X,Y)"})," where ",(0,n.jsx)(o.code,{children:"X"})," and ",(0,n.jsx)(o.code,{children:"Y"})," are two prime field elements.\nThe raw key is represented as ",(0,n.jsx)(o.code,{children:"bytes(X) || bytes(Y)"}),", where ",(0,n.jsx)(o.code,{children:"||"})," is the concatenation operation,\nand ",(0,n.jsx)(o.code,{children:"bytes()"})," is the bytes big-endian encoding left padded by zeros to the byte-length of the field prime.\nThe raw public key is 64-bytes long."]}),"\n"]}),"\n",(0,n.jsxs)(o.li,{children:["\n",(0,n.jsxs)(o.p,{children:[(0,n.jsx)(o.code,{children:"BLS_BLS_12_381"}),":\nThe public key is a G_2 element (on the curve over the prime field extension).\nThe encoding follows the compressed serialization defined in the\n",(0,n.jsx)(o.a,{href:"https://www.ietf.org/archive/id/draft-irtf-cfrg-pairing-friendly-curves-08.html#name-point-serialization-procedu",children:"IETF draft-irtf-cfrg-pairing-friendly-curves-08"}),".\nA public key is 96-bytes long."]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(o.h3,{id:"public-key-validation",children:"Public Key validation"}),"\n",(0,n.jsx)(o.p,{children:"A public key is validated at the time of creation. Only valid public keys can be created.\nThe validation of the public key depends on the supported signature scheme:"}),"\n",(0,n.jsxs)(o.ul,{children:["\n",(0,n.jsxs)(o.li,{children:["\n",(0,n.jsxs)(o.p,{children:[(0,n.jsx)(o.code,{children:"ECDSA_P256"})," and ",(0,n.jsx)(o.code,{children:"ECDSA_secp256k1"}),":\nThe given ",(0,n.jsx)(o.code,{children:"X"})," and ",(0,n.jsx)(o.code,{children:"Y"})," coordinates are correctly serialized, represent valid prime field elements, and the resulting\npoint is on the correct curve (no subgroup check needed since the cofactor of both supported curves is 1)."]}),"\n"]}),"\n",(0,n.jsxs)(o.li,{children:["\n",(0,n.jsxs)(o.p,{children:[(0,n.jsx)(o.code,{children:"BLS_BLS_12_381"}),":\nThe given key is correctly serialized following the compressed serialization in ",(0,n.jsx)(o.a,{href:"https://www.ietf.org/archive/id/draft-irtf-cfrg-pairing-friendly-curves-08.html#name-point-serialization-procedu",children:"IETF draft-irtf-cfrg-pairing-friendly-curves-08"}),".\nThe coordinates represent valid prime field extension elements. The resulting point is on the curve, and is on the correct subgroup G_2.\nNote that the point at infinity is accepted and yields the identity public key. Such identity key can be useful when aggregating multiple keys."]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(t,{type:"info",children:(0,n.jsx)(o.p,{children:"\ud83d\udea7 Status: Accepting the BLS identity key is going to be available in the upcoming release of Cadence on Mainnet."})}),"\n",(0,n.jsx)(o.p,{children:"Since the validation happens only at the time of creation, public keys are immutable."}),"\n",(0,n.jsx)(d.Code,{codeConfig:u,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"publicKey.signatureAlgorithm ",props:{style:{color:"#D8DEE9FF"}}},{content:"=",props:{style:{color:"#81A1C1"}}},{content:" SignatureAlgorithm.ECDSA_secp256k1   ",props:{style:{color:"#D8DEE9FF"}}},{content:"// Not allowed",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"publicKey.publicKey ",props:{style:{color:"#D8DEE9FF"}}},{content:"=",props:{style:{color:"#81A1C1"}}},{content:" []                                            ",props:{style:{color:"#D8DEE9FF"}}},{content:"// Not allowed",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"publicKey.publicKey[",props:{style:{color:"#D8DEE9FF"}}},{content:"2",props:{style:{color:"#B48EAD"}}},{content:"] ",props:{style:{color:"#D8DEE9FF"}}},{content:"= ",props:{style:{color:"#81A1C1"}}},{content:"4      ",props:{style:{color:"#B48EAD"}}},{content:"// No effect",props:{style:{color:"#616E88"}}}]}],lang:"cadence"},annotations:[]}]}),"\n",(0,n.jsx)(o.p,{children:"Invalid public keys cannot be constructed so public keys are always valid."}),"\n",(0,n.jsx)(o.h3,{id:"signature-verification",children:"Signature verification"}),"\n",(0,n.jsxs)(o.p,{children:["A signature can be verified using the ",(0,n.jsx)(o.code,{children:"verify"})," function of the ",(0,n.jsx)(o.code,{children:"PublicKey"}),":"]}),"\n",(0,n.jsx)(d.Code,{codeConfig:u,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"let",props:{style:{color:"#81A1C1"}}},{content:" pk = ",props:{style:{color:"#D8DEE9FF"}}},{content:"PublicKey",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    publicKey",props:{style:{color:"#88C0D0"}}},{content:': "',props:{style:{color:"#ECEFF4"}}},{content:"96142CE0C5ECD869DC88C8960E286AF1CE1B29F329BA4964213934731E65A1DE480FD43EF123B9633F0A90434C6ACE0A98BB9A999231DB3F477F9D3623A6A4ED",props:{style:{color:"#A3BE8C"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:".",props:{style:{color:"#D8DEE9FF"}}},{content:"decodeHex",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}},{content:",",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    signatureAlgorithm",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" SignatureAlgorithm.ECDSA_P256",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"let",props:{style:{color:"#81A1C1"}}},{content:" signature = ",props:{style:{color:"#D8DEE9FF"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"108EF718F153CFDC516D8040ABF2C8CC7AECF37C6F6EF357C31DFE1F7AC79C9D0145D1A2F08A48F1A2489A84C725D6A7AB3E842D9DC5F8FE8E659FFF5982310D",props:{style:{color:"#A3BE8C"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:".",props:{style:{color:"#D8DEE9FF"}}},{content:"decodeHex",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"let",props:{style:{color:"#81A1C1"}}},{content:" message : [",props:{style:{color:"#D8DEE9FF"}}},{content:"UInt8",props:{style:{color:"#81A1C1"}}},{content:"] = [",props:{style:{color:"#D8DEE9FF"}}},{content:"1",props:{style:{color:"#B48EAD"}}},{content:", ",props:{style:{color:"#D8DEE9FF"}}},{content:"2",props:{style:{color:"#B48EAD"}}},{content:", ",props:{style:{color:"#D8DEE9FF"}}},{content:"3",props:{style:{color:"#B48EAD"}}},{content:"]",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"let",props:{style:{color:"#81A1C1"}}},{content:" isValid = pk.",props:{style:{color:"#D8DEE9FF"}}},{content:"verify",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    signature",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" signature,",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    signedData",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" message,",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    domainSeparationTag",props:{style:{color:"#88C0D0"}}},{content:': ""',props:{style:{color:"#ECEFF4"}}},{content:",",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    hashAlgorithm",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" HashAlgorithm.SHA2_256",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"// `isValid` is false",props:{style:{color:"#616E88"}}}]}],lang:"cadence"},annotations:[]}]}),"\n",(0,n.jsxs)(o.p,{children:["The inputs to ",(0,n.jsx)(o.code,{children:"verify"})," depend on the signature scheme used:"]}),"\n",(0,n.jsxs)(o.ul,{children:["\n",(0,n.jsxs)(o.li,{children:["ECDSA (",(0,n.jsx)(o.code,{children:"ECDSA_P256"})," and ",(0,n.jsx)(o.code,{children:"ECDSA_secp256k1"}),"):","\n",(0,n.jsxs)(o.ul,{children:["\n",(0,n.jsxs)(o.li,{children:[(0,n.jsx)(o.code,{children:"signature"})," expects the couple ",(0,n.jsx)(o.code,{children:"(r,s)"}),". It is serialized as ",(0,n.jsx)(o.code,{children:"bytes(r) || bytes(s)"}),", where ",(0,n.jsx)(o.code,{children:"||"})," is the concatenation operation,\nand ",(0,n.jsx)(o.code,{children:"bytes()"})," is the bytes big-endian encoding left padded by zeros to the byte-length of the curve order.\nThe signature is 64 bytes-long for both curves."]}),"\n",(0,n.jsxs)(o.li,{children:[(0,n.jsx)(o.code,{children:"signedData"})," is the arbitrary message to verify the signature against."]}),"\n",(0,n.jsxs)(o.li,{children:[(0,n.jsx)(o.code,{children:"domainSeparationTag"})," is the expected domain tag. Multiple valid tag values can be used (check ",(0,n.jsx)(o.a,{href:"#hashing",children:(0,n.jsx)(o.code,{children:"hashWithTag"})})," for more details)."]}),"\n",(0,n.jsxs)(o.li,{children:[(0,n.jsx)(o.code,{children:"hashAlgorithm"})," is either ",(0,n.jsx)(o.code,{children:"SHA2_256"}),", ",(0,n.jsx)(o.code,{children:"SHA3_256"})," or ",(0,n.jsx)(o.code,{children:"KECCAK_256"}),". It is the algorithm used to hash the message along with the given tag (check the ",(0,n.jsx)(o.code,{children:"hashWithTag"}),(0,n.jsx)(o.a,{href:"#hashing",children:"function"})," for more details)."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(o.p,{children:["As noted in ",(0,n.jsx)(o.a,{href:"#hashing",children:(0,n.jsx)(o.code,{children:"hashWithTag"})})," for ",(0,n.jsx)(o.code,{children:"SHA2_256"}),", ",(0,n.jsx)(o.code,{children:"SHA3_256"})," and ",(0,n.jsx)(o.code,{children:"KECCAK_256"}),", using an empty ",(0,n.jsx)(o.code,{children:"tag"})," results in hashing the input data only. If a signature verification\nneeds to be done against data without any domain tag, this can be done by using an empty domain tag ",(0,n.jsx)(o.code,{children:'""'}),"."]}),"\n",(0,n.jsxs)(o.p,{children:["ECDSA verification is implemented as defined in ANS X9.62 (also referred by ",(0,n.jsx)(o.a,{href:"https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-4.pdf",children:"FIPS 186-4"})," and ",(0,n.jsx)(o.a,{href:"https://www.secg.org/sec1-v2.pdf",children:"SEC 1, Version 2.0"}),").\nA valid signature would be generated using the expected ",(0,n.jsx)(o.code,{children:"signedData"}),", ",(0,n.jsx)(o.code,{children:"domainSeparationTag"})," and ",(0,n.jsx)(o.code,{children:"hashAlgorithm"})," used to verify."]}),"\n",(0,n.jsxs)(o.ul,{children:["\n",(0,n.jsxs)(o.li,{children:["BLS (",(0,n.jsx)(o.code,{children:"BLS_BLS_12_381"}),"):","\n",(0,n.jsxs)(o.ul,{children:["\n",(0,n.jsxs)(o.li,{children:[(0,n.jsx)(o.code,{children:"signature"})," expects a G_1 point (on the curve over the prime field).\nThe encoding follows the compressed serialization defined in the ",(0,n.jsx)(o.a,{href:"https://www.ietf.org/archive/id/draft-irtf-cfrg-pairing-friendly-curves-08.html#name-point-serialization-procedu",children:"IETF draft-irtf-cfrg-pairing-friendly-curves-08"}),".\nA signature is 48-bytes long."]}),"\n",(0,n.jsxs)(o.li,{children:[(0,n.jsx)(o.code,{children:"signedData"})," is the arbitrary message to verify the signature against."]}),"\n",(0,n.jsxs)(o.li,{children:[(0,n.jsx)(o.code,{children:"domainSeparationTag"})," is the expected domain tag. All tags are accepted (check ",(0,n.jsx)(o.a,{href:"#KMAC128-for-BLS",children:"KMAC128 for BLS"}),")."]}),"\n",(0,n.jsxs)(o.li,{children:[(0,n.jsx)(o.code,{children:"hashAlgorithm"})," only accepts ",(0,n.jsx)(o.code,{children:"KMAC128_BLS_BLS12_381"}),". It is the algorithm used to hash the message along with the given tag (check ",(0,n.jsx)(o.a,{href:"#KMAC128-for-BLS",children:"KMAC128 for BLS"}),")."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(o.p,{children:["BLS verification performs the necessary membership check on the signature while the membership check of the public key is performed at the creation of the ",(0,n.jsx)(o.code,{children:"PublicKey"})," object\nand is not repeated during the signature verification. In order to prevent equivocation issues, a verification under the identity public key always returns ",(0,n.jsx)(o.code,{children:"false"}),"."]}),"\n",(0,n.jsx)(t,{type:"info",children:(0,n.jsxs)(o.p,{children:["\ud83d\udea7 Status: Returning ",(0,n.jsx)(o.code,{children:"false"})," when verifying against a BLS identity key is going to be available in the upcoming release of Cadence on Mainnet.\nCurrently, BLS identity keys can only be constructed as an output of ",(0,n.jsx)(o.code,{children:"aggregatePublicKeys"}),"."]})}),"\n",(0,n.jsxs)(o.p,{children:["The verificaction uses a hash-to-curve algorithm to hash the ",(0,n.jsx)(o.code,{children:"signedData"})," into a ",(0,n.jsx)(o.code,{children:"G_1"})," point, following the ",(0,n.jsx)(o.code,{children:"hash_to_curve"})," method described in the ",(0,n.jsx)(o.a,{href:"https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-hash-to-curve-14#section-3",children:"draft-irtf-cfrg-hash-to-curve-14"}),".\nWhile KMAC128 is used as a hash-to-field method resulting in two field elements, the mapping to curve is implemented using the ",(0,n.jsx)(o.a,{href:"https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-hash-to-curve-14#section-6.6.3",children:"simplified SWU"}),"."]}),"\n",(0,n.jsxs)(o.p,{children:["A valid signature would be generated using the expected ",(0,n.jsx)(o.code,{children:"signedData"})," and ",(0,n.jsx)(o.code,{children:"domainSeparationTag"}),", as well the same hashing to curve process."]}),"\n",(0,n.jsx)(o.h2,{id:"bls-multi-signature",children:"BLS multi-signature"}),"\n",(0,n.jsxs)(o.p,{children:["BLS signature scheme allows efficient multi-signature features. Multiple signatures can be aggregated\ninto a single signature which can be verified against an aggregated public key. This allows authenticating\nmultiple signers with a single signature verification.\nWhile BLS provides multiple aggregation techniques,\nCadence supports basic aggregation tools that cover a wide list of use-cases.\nThese tools are defined in the built-in ",(0,n.jsx)(o.code,{children:"BLS"})," contract, which does not need to be imported."]}),"\n",(0,n.jsx)(o.h3,{id:"proof-of-possession-pop",children:"Proof of Possession (PoP)"}),"\n",(0,n.jsxs)(o.p,{children:["Multi-signature verification in BLS requires a defense against rogue public-key attacks. Multiple ways are\navailable to protect BLS verification. Cadence provides the proof of possession of private key as a defense tool.\nThe proof of possession of private key is a BLS signature over the public key itself.\nThe PoP signature follows the same requirements of a BLS signature (detailed in ",(0,n.jsx)(o.a,{href:"#Signature-verification",children:"Signature verification"}),"),\nexcept it uses a special domain separation tag. The key expected to be used in KMAC128 is the UTF-8 encoding of ",(0,n.jsx)(o.code,{children:'"BLS_POP_BLS12381G1_XOF:KMAC128_SSWU_RO_POP_"'}),".\nThe expected message to be signed by the PoP is the serialization of the BLS public key corresponding to the signing private key (",(0,n.jsx)(o.a,{href:"#PublicKey",children:"serialization details"}),").\nThe PoP can only be verified using the ",(0,n.jsx)(o.code,{children:"PublicKey"})," method ",(0,n.jsx)(o.code,{children:"verifyPoP"}),"."]}),"\n",(0,n.jsx)(o.h3,{id:"bls-signature-aggregation",children:"BLS signature aggregation"}),"\n",(0,n.jsx)(d.Code,{codeConfig:u,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"fun ",props:{style:{color:"#81A1C1"}}},{content:"aggregateSignatures",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#ECEFF4"}}},{content:"_ ",props:{style:{color:"#88C0D0"}}},{content:"signatures",props:{style:{color:"#D8DEE9"}}},{content:": [[",props:{style:{color:"#D8DEE9FF"}}},{content:"UInt8",props:{style:{color:"#81A1C1"}}},{content:"]]",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}},{content:":",props:{style:{color:"#81A1C1"}}},{content:" [",props:{style:{color:"#D8DEE9FF"}}},{content:"UInt8",props:{style:{color:"#81A1C1"}}},{content:"]?",props:{style:{color:"#D8DEE9FF"}}}]}],lang:"cadence"},annotations:[]}]}),"\n",(0,n.jsx)(o.p,{children:"Aggregates multiple BLS signatures into one.\nSignatures could be generated from the same or distinct messages, they\ncould also be the aggregation of other signatures.\nThe order of the signatures in the slice does not matter since the aggregation is commutative.\nThere is no subgroup membership check performed on the input signatures.\nIf the array is empty or if decoding one of the signatures fails, the program aborts."}),"\n",(0,n.jsxs)(o.p,{children:["The output signature can be verified against an aggregated public key to authenticate multiple\nsigners at once. Since the ",(0,n.jsx)(o.code,{children:"verify"})," method accepts a single data to verify against, it is only possible to\nverfiy multiple signatures of the same message."]}),"\n",(0,n.jsx)(o.h3,{id:"bls-public-key-aggregation",children:"BLS public key aggregation"}),"\n",(0,n.jsx)(d.Code,{codeConfig:u,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"fun ",props:{style:{color:"#81A1C1"}}},{content:"aggregatePublicKeys",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#ECEFF4"}}},{content:"_ ",props:{style:{color:"#88C0D0"}}},{content:"publicKeys",props:{style:{color:"#D8DEE9"}}},{content:": [",props:{style:{color:"#D8DEE9FF"}}},{content:"PublicKey",props:{style:{color:"#81A1C1"}}},{content:"]",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}},{content:": PublicKey",props:{style:{color:"#81A1C1"}}},{content:"?",props:{style:{color:"#D8DEE9FF"}}}]}],lang:"cadence"},annotations:[]}]}),"\n",(0,n.jsx)(o.p,{children:"Aggregates multiple BLS public keys into one."}),"\n",(0,n.jsx)(o.p,{children:"The order of the public keys in the slice does not matter since the aggregation is commutative.\nThe input keys are guaranteed to be in the correct subgroup since subgroup membership is checked\nat the key creation time.\nIf the array is empty or any of the input keys is not a BLS key, the program aborts.\nNote that the identity public key is a valid input to this function and it represents the\nidentity element of aggregation."}),"\n",(0,n.jsxs)(o.p,{children:["The output public key can be used to verify aggregated signatures to authenticate multiple\nsigners at once. Since the ",(0,n.jsx)(o.code,{children:"verify"})," method accepts a single data to verify against, it is only possible to\nverfiy multiple signatures of the same message.\nThe identity public key is a possible output of the function, though signature verifications\nagainst identity result in ",(0,n.jsx)(o.code,{children:"false"}),"."]}),"\n",(0,n.jsx)(o.p,{children:"In order to prevent rogue key attacks when verifying aggregated signatures, it is important to verfiy the\nPoP of each individual key involved in the aggregation process."}),"\n",(0,n.jsx)(o.h2,{id:"crypto-contract",children:"Crypto Contract"}),"\n",(0,n.jsxs)(o.p,{children:["The built-in contract ",(0,n.jsx)(o.code,{children:"Crypto"})," can be used to perform cryptographic operations.\nThe contract can be imported using ",(0,n.jsx)(o.code,{children:"import Crypto"}),"."]}),"\n",(0,n.jsx)(o.h3,{id:"key-lists",children:"Key Lists"}),"\n",(0,n.jsx)(o.p,{children:"The crypto contract also allows creating key lists to be used for multi-signature verification.\nFor example, to verify two signatures with equal weights for some signed data:"}),"\n",(0,n.jsx)(d.Code,{codeConfig:u,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"import",props:{style:{color:"#81A1C1"}}},{content:" Crypto",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"pub fun ",props:{style:{color:"#81A1C1"}}},{content:"test",props:{style:{color:"#88C0D0"}}},{content:" main",props:{style:{color:"#D8DEE9FF"}}},{content:"() {",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    let",props:{style:{color:"#81A1C1"}}},{content:" keyList = Crypto.",props:{style:{color:"#D8DEE9FF"}}},{content:"KeyList",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    let",props:{style:{color:"#81A1C1"}}},{content:" publicKeyA = ",props:{style:{color:"#D8DEE9FF"}}},{content:"PublicKey",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        publicKey",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:'            "',props:{style:{color:"#ECEFF4"}}},{content:"db04940e18ec414664ccfd31d5d2d4ece3985acb8cb17a2025b2f1673427267968e52e2bbf3599059649d4b2cce98fdb8a3048e68abf5abe3e710129e90696ca",props:{style:{color:"#A3BE8C"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:".",props:{style:{color:"#D8DEE9FF"}}},{content:"decodeHex",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}},{content:",",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        signatureAlgorithm",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" SignatureAlgorithm.ECDSA_P256",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    )",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    keyList.",props:{style:{color:"#D8DEE9FF"}}},{content:"add",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        publicKeyA,",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        hashAlgorithm",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" HashAlgorithm.SHA3_256,",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        weight",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#ECEFF4"}}},{content:"0",props:{style:{color:"#B48EAD"}}},{content:".",props:{style:{color:"#D8DEE9FF"}}},{content:"5",props:{style:{color:"#B48EAD"}}}]},{tokens:[{content:"    )",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    let",props:{style:{color:"#81A1C1"}}},{content:" publicKeyB = ",props:{style:{color:"#D8DEE9FF"}}},{content:"PublicKey",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        publicKey",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:'            "',props:{style:{color:"#ECEFF4"}}},{content:"df9609ee588dd4a6f7789df8d56f03f545d4516f0c99b200d73b9a3afafc14de5d21a4fc7a2a2015719dc95c9e756cfa44f2a445151aaf42479e7120d83df956",props:{style:{color:"#A3BE8C"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:".",props:{style:{color:"#D8DEE9FF"}}},{content:"decodeHex",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}},{content:",",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        signatureAlgorithm",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" SignatureAlgorithm.ECDSA_P256",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    )",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    keyList.",props:{style:{color:"#D8DEE9FF"}}},{content:"add",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        publicKeyB,",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        hashAlgorithm",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" HashAlgorithm.SHA3_256,",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        weight",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#ECEFF4"}}},{content:"0",props:{style:{color:"#B48EAD"}}},{content:".",props:{style:{color:"#D8DEE9FF"}}},{content:"5",props:{style:{color:"#B48EAD"}}}]},{tokens:[{content:"    )",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    let",props:{style:{color:"#81A1C1"}}},{content:" signatureSet = [",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        Crypto.",props:{style:{color:"#D8DEE9FF"}}},{content:"KeyListSignature",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"            keyIndex",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#ECEFF4"}}},{content:"0",props:{style:{color:"#B48EAD"}}},{content:",",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"            signature",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:'                "',props:{style:{color:"#ECEFF4"}}},{content:"8870a8cbe6f44932ba59e0d15a706214cc4ad2538deb12c0cf718d86f32c47765462a92ce2da15d4a29eb4e2b6fa05d08c7db5d5b2a2cd8c2cb98ded73da31f6",props:{style:{color:"#A3BE8C"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:".",props:{style:{color:"#D8DEE9FF"}}},{content:"decodeHex",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        )",props:{style:{color:"#ECEFF4"}}},{content:",",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        Crypto.",props:{style:{color:"#D8DEE9FF"}}},{content:"KeyListSignature",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"            keyIndex",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#ECEFF4"}}},{content:"1",props:{style:{color:"#B48EAD"}}},{content:",",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"            signature",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:'                "',props:{style:{color:"#ECEFF4"}}},{content:"bbdc5591c3f937a730d4f6c0a6fde61a0a6ceaa531ccb367c3559335ab9734f4f2b9da8adbe371f1f7da913b5a3fdd96a871e04f078928ca89a83d841c72fadf",props:{style:{color:"#A3BE8C"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:".",props:{style:{color:"#D8DEE9FF"}}},{content:"decodeHex",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        )",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    ]",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:'    // "foo", encoded as UTF-8, in hex representation',props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    let",props:{style:{color:"#81A1C1"}}},{content:" signedData = ",props:{style:{color:"#D8DEE9FF"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"666f6f",props:{style:{color:"#A3BE8C"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:".",props:{style:{color:"#D8DEE9FF"}}},{content:"decodeHex",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    let",props:{style:{color:"#81A1C1"}}},{content:" isValid = keyList.",props:{style:{color:"#D8DEE9FF"}}},{content:"verify",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        signatureSet",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" signatureSet,",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        signedData",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" signedData",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    )",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"}",props:{style:{color:"#ECEFF4"}}}]}],lang:"cadence"},annotations:[]}]}),"\n",(0,n.jsx)(o.p,{children:"The API of the Crypto contract related to key lists is:"}),"\n",(0,n.jsx)(d.Code,{codeConfig:u,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"pub struct",props:{style:{color:"#81A1C1"}}},{content:" KeyListEntry ",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    pub let",props:{style:{color:"#81A1C1"}}},{content:" keyIndex: ",props:{style:{color:"#D8DEE9FF"}}},{content:"Int",props:{style:{color:"#81A1C1"}}}]},{tokens:[{content:"    pub let",props:{style:{color:"#81A1C1"}}},{content:" publicKey: ",props:{style:{color:"#D8DEE9FF"}}},{content:"PublicKey",props:{style:{color:"#81A1C1"}}}]},{tokens:[{content:"    pub let",props:{style:{color:"#81A1C1"}}},{content:" hashAlgorithm: ",props:{style:{color:"#D8DEE9FF"}}},{content:"HashAlgorithm",props:{style:{color:"#81A1C1"}}}]},{tokens:[{content:"    pub let",props:{style:{color:"#81A1C1"}}},{content:" weight: ",props:{style:{color:"#D8DEE9FF"}}},{content:"UFix64",props:{style:{color:"#81A1C1"}}}]},{tokens:[{content:"    pub let",props:{style:{color:"#81A1C1"}}},{content:" isRevoked: ",props:{style:{color:"#D8DEE9FF"}}},{content:"Bool",props:{style:{color:"#81A1C1"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    init",props:{style:{color:"#81A1C1"}}},{content:"(",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        keyIndex",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"Int",props:{style:{color:"#81A1C1"}}},{content:",",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        publicKey",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"PublicKey",props:{style:{color:"#81A1C1"}}},{content:",",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        hashAlgorithm",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"HashAlgorithm",props:{style:{color:"#81A1C1"}}},{content:",",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        weight",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"UFix64",props:{style:{color:"#81A1C1"}}},{content:",",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        isRevoked",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"Bool",props:{style:{color:"#81A1C1"}}}]},{tokens:[{content:"    )",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"}",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"pub struct",props:{style:{color:"#81A1C1"}}},{content:" KeyList ",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    init",props:{style:{color:"#81A1C1"}}},{content:"()",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    /// Adds a new key with the given weight",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    pub fun ",props:{style:{color:"#81A1C1"}}},{content:"add",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        _ ",props:{style:{color:"#88C0D0"}}},{content:"publicKey",props:{style:{color:"#D8DEE9"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"PublicKey",props:{style:{color:"#81A1C1"}}},{content:",",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        hashAlgorithm",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"HashAlgorithm",props:{style:{color:"#81A1C1"}}},{content:",",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        weight",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"UFix64",props:{style:{color:"#81A1C1"}}}]},{tokens:[{content:"    )",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    /// Returns the key at the given index, if it exists.",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    /// Revoked keys are always returned, but they have `isRevoked` field set to true",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    pub fun ",props:{style:{color:"#81A1C1"}}},{content:"get",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#ECEFF4"}}},{content:"keyIndex",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"Int",props:{style:{color:"#81A1C1"}}},{content:")",props:{style:{color:"#ECEFF4"}}},{content:": KeyListEntry",props:{style:{color:"#81A1C1"}}},{content:"?",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    /// Marks the key at the given index revoked, but does not delete it",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    pub fun ",props:{style:{color:"#81A1C1"}}},{content:"revoke",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#ECEFF4"}}},{content:"keyIndex",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"Int",props:{style:{color:"#81A1C1"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    /// Returns true if the given signatures are valid for the given signed data",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    pub fun ",props:{style:{color:"#81A1C1"}}},{content:"verify",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        signatureSet",props:{style:{color:"#88C0D0"}}},{content:": [",props:{style:{color:"#D8DEE9FF"}}},{content:"KeyListSignature",props:{style:{color:"#81A1C1"}}},{content:"],",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        signedData",props:{style:{color:"#88C0D0"}}},{content:": [",props:{style:{color:"#D8DEE9FF"}}},{content:"UInt8",props:{style:{color:"#81A1C1"}}},{content:"]",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    )",props:{style:{color:"#ECEFF4"}}},{content:": Bool",props:{style:{color:"#81A1C1"}}}]},{tokens:[{content:"}",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"pub struct",props:{style:{color:"#81A1C1"}}},{content:" KeyListSignature ",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    pub let",props:{style:{color:"#81A1C1"}}},{content:" keyIndex: ",props:{style:{color:"#D8DEE9FF"}}},{content:"Int",props:{style:{color:"#81A1C1"}}}]},{tokens:[{content:"    pub let",props:{style:{color:"#81A1C1"}}},{content:" signature: [",props:{style:{color:"#D8DEE9FF"}}},{content:"UInt8",props:{style:{color:"#81A1C1"}}},{content:"]",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    pub init",props:{style:{color:"#81A1C1"}}},{content:"(",props:{style:{color:"#ECEFF4"}}},{content:"keyIndex",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"Int",props:{style:{color:"#81A1C1"}}},{content:", ",props:{style:{color:"#D8DEE9FF"}}},{content:"signature",props:{style:{color:"#88C0D0"}}},{content:": [",props:{style:{color:"#D8DEE9FF"}}},{content:"UInt8",props:{style:{color:"#81A1C1"}}},{content:"]",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"}",props:{style:{color:"#ECEFF4"}}}]}],lang:"cadence"},annotations:[]}]})]})}const h=function(e){void 0===e&&(e={});const{wrapper:o}=Object.assign({},(0,r.ah)(),e.components);return o?(0,n.jsx)(o,Object.assign({},e,{children:(0,n.jsx)(g,e)})):g(e)};function y(e,o){throw new Error("Expected "+(o?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}}}]);