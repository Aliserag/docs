"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[66294],{22285:(e,o,t)=>{t.r(o),t.d(o,{CH:()=>d,assets:()=>i,chCodeConfig:()=>u,contentTitle:()=>a,default:()=>y,frontMatter:()=>c,metadata:()=>l,toc:()=>p});t(67294);var n=t(85893),r=t(11151),s=t(59794);const c={title:"Cadence Design Patterns",sidebar_position:1,sidebar_label:"Design Patterns"},a=void 0,l={unversionedId:"build/best-practices/design-patterns",id:"build/best-practices/design-patterns",title:"Cadence Design Patterns",description:"This is a selection of software design patterns developed by core Flow developers",source:"@site/docs/build/best-practices/design-patterns.md",sourceDirName:"build/best-practices",slug:"/build/best-practices/design-patterns",permalink:"/docs/next/build/best-practices/design-patterns",draft:!1,editUrl:"https://github.com/onflow/docs/tree/main/docs/build/best-practices/design-patterns.md",tags:[],version:"current",lastUpdatedBy:"Tom Haile",lastUpdatedAt:1694818810,formattedLastUpdatedAt:"Sep 15, 2023",sidebarPosition:1,frontMatter:{title:"Cadence Design Patterns",sidebar_position:1,sidebar_label:"Design Patterns"},sidebar:"build",previous:{title:"Working With Parent Accounts",permalink:"/docs/next/build/advanced-concepts/account-linking/parent-accounts"},next:{title:"Anti-Patterns",permalink:"/docs/next/build/best-practices/anti-patterns"}},i={},p=[{value:"Use named value fields for constants instead of hard-coding",id:"use-named-value-fields-for-constants-instead-of-hard-coding",level:2},{value:"Problem",id:"problem",level:3},{value:"Solution",id:"solution",level:3},{value:"Script-Accessible public field/function",id:"script-accessible-public-fieldfunction",level:2},{value:"Problem",id:"problem-1",level:3},{value:"Solution",id:"solution-1",level:3},{value:"Script-Accessible report",id:"script-accessible-report",level:2},{value:"Problem",id:"problem-2",level:3},{value:"Solution",id:"solution-2",level:3},{value:"Example Code",id:"example-code",level:3},{value:"Init Singleton",id:"init-singleton",level:2},{value:"Problem",id:"problem-3",level:3},{value:"Solution",id:"solution-3",level:3},{value:"Use descriptive names for fields, paths, functions and variables",id:"use-descriptive-names-for-fields-paths-functions-and-variables",level:2},{value:"Problem",id:"problem-4",level:3},{value:"Solution",id:"solution-4",level:3},{value:"Example",id:"example",level:3},{value:"Include concrete types in type constraints, especially &quot;Any&quot; types",id:"include-concrete-types-in-type-constraints-especially-any-types",level:2},{value:"Problem",id:"problem-5",level:3},{value:"Solution",id:"solution-5",level:3},{value:"Plural names for arrays and maps are preferable",id:"plural-names-for-arrays-and-maps-are-preferable",level:2},{value:"Use transaction post-conditions when applicable",id:"use-transaction-post-conditions-when-applicable",level:2},{value:"Problem",id:"problem-6",level:3},{value:"Solution",id:"solution-6",level:3},{value:"Example",id:"example-1",level:3},{value:"Avoid excessive load and save storage operations (prefer in-place mutations)",id:"avoid-excessive-load-and-save-storage-operations-prefer-in-place-mutations",level:2},{value:"Problem",id:"problem-7",level:3},{value:"Solution",id:"solution-7",level:3},{value:"Example",id:"example-2",level:3},{value:"Capability Bootstrapping",id:"capability-bootstrapping",level:2},{value:"Problem",id:"problem-8",level:3},{value:"Solution",id:"solution-8",level:3},{value:"Capability Revocation",id:"capability-revocation",level:2},{value:"Problem",id:"problem-9",level:3},{value:"Solution",id:"solution-9",level:3},{value:"Check for existing links before creating new ones",id:"check-for-existing-links-before-creating-new-ones",level:2},{value:"Example",id:"example-3",level:3}],d={annotations:s.ds,Code:s.EK},u={staticMediaQuery:"not screen, (max-width: 768px)",theme:{name:"nord",type:"dark",semanticHighlighting:!0,colors:{focusBorder:"#3b4252",foreground:"#d8dee9","activityBar.background":"#2e3440","activityBar.dropBackground":"#3b4252","activityBar.foreground":"#d8dee9","activityBar.activeBorder":"#88c0d0","activityBar.activeBackground":"#3b4252","activityBarBadge.background":"#88c0d0","activityBarBadge.foreground":"#2e3440","badge.foreground":"#2e3440","badge.background":"#88c0d0","button.background":"#88c0d0ee","button.foreground":"#2e3440","button.hoverBackground":"#88c0d0","button.secondaryBackground":"#434c5e","button.secondaryForeground":"#d8dee9","button.secondaryHoverBackground":"#4c566a","charts.red":"#bf616a","charts.blue":"#81a1c1","charts.yellow":"#ebcb8b","charts.orange":"#d08770","charts.green":"#a3be8c","charts.purple":"#b48ead","charts.foreground":"#d8dee9","charts.lines":"#88c0d0","debugConsole.infoForeground":"#88c0d0","debugConsole.warningForeground":"#ebcb8b","debugConsole.errorForeground":"#bf616a","debugConsole.sourceForeground":"#616e88","debugConsoleInputIcon.foreground":"#81a1c1","debugExceptionWidget.background":"#4c566a","debugExceptionWidget.border":"#2e3440","debugToolBar.background":"#3b4252",descriptionForeground:"#d8dee9e6","diffEditor.insertedTextBackground":"#81a1c133","diffEditor.removedTextBackground":"#bf616a4d","dropdown.background":"#3b4252","dropdown.border":"#3b4252","dropdown.foreground":"#d8dee9","editorActiveLineNumber.foreground":"#d8dee9cc","editorCursor.foreground":"#d8dee9","editorHint.border":"#ebcb8b00","editorHint.foreground":"#ebcb8b","editorIndentGuide.background":"#434c5eb3","editorIndentGuide.activeBackground":"#4c566a","editorInlayHint.background":"#434c5e","editorInlayHint.foreground":"#d8dee9","editorLineNumber.foreground":"#4c566a","editorLineNumber.activeForeground":"#d8dee9","editorWhitespace.foreground":"#4c566ab3","editorWidget.background":"#2e3440","editorWidget.border":"#3b4252","editor.background":"#2e3440","editor.foreground":"#d8dee9","editor.hoverHighlightBackground":"#3b4252","editor.findMatchBackground":"#88c0d066","editor.findMatchHighlightBackground":"#88c0d033","editor.findRangeHighlightBackground":"#88c0d033","editor.lineHighlightBackground":"#3b4252","editor.lineHighlightBorder":"#3b4252","editor.inactiveSelectionBackground":"#434c5ecc","editor.inlineValuesBackground":"#4c566a","editor.inlineValuesForeground":"#eceff4","editor.selectionBackground":"#434c5ecc","editor.selectionHighlightBackground":"#434c5ecc","editor.rangeHighlightBackground":"#434c5e52","editor.wordHighlightBackground":"#81a1c166","editor.wordHighlightStrongBackground":"#81a1c199","editor.stackFrameHighlightBackground":"#5e81ac","editor.focusedStackFrameHighlightBackground":"#5e81ac","editorError.foreground":"#bf616a","editorError.border":"#bf616a00","editorWarning.foreground":"#ebcb8b","editorWarning.border":"#ebcb8b00","editorBracketMatch.background":"#2e344000","editorBracketMatch.border":"#88c0d0","editorBracketHighlight.foreground1":"#8fbcbb","editorBracketHighlight.foreground2":"#88c0d0","editorBracketHighlight.foreground3":"#81a1c1","editorBracketHighlight.foreground4":"#5e81ac","editorBracketHighlight.foreground5":"#8fbcbb","editorBracketHighlight.foreground6":"#88c0d0","editorBracketHighlight.unexpectedBracket.foreground":"#bf616a","editorCodeLens.foreground":"#4c566a","editorGroup.background":"#2e3440","editorGroup.border":"#3b425201","editorGroup.dropBackground":"#3b425299","editorGroupHeader.border":"#3b425200","editorGroupHeader.noTabsBackground":"#2e3440","editorGroupHeader.tabsBackground":"#2e3440","editorGroupHeader.tabsBorder":"#3b425200","editorGutter.background":"#2e3440","editorGutter.modifiedBackground":"#ebcb8b","editorGutter.addedBackground":"#a3be8c","editorGutter.deletedBackground":"#bf616a","editorHoverWidget.background":"#3b4252","editorHoverWidget.border":"#3b4252","editorLink.activeForeground":"#88c0d0","editorMarkerNavigation.background":"#5e81acc0","editorMarkerNavigationError.background":"#bf616ac0","editorMarkerNavigationWarning.background":"#ebcb8bc0","editorOverviewRuler.border":"#3b4252","editorOverviewRuler.currentContentForeground":"#3b4252","editorOverviewRuler.incomingContentForeground":"#3b4252","editorOverviewRuler.findMatchForeground":"#88c0d066","editorOverviewRuler.rangeHighlightForeground":"#88c0d066","editorOverviewRuler.selectionHighlightForeground":"#88c0d066","editorOverviewRuler.wordHighlightForeground":"#88c0d066","editorOverviewRuler.wordHighlightStrongForeground":"#88c0d066","editorOverviewRuler.modifiedForeground":"#ebcb8b","editorOverviewRuler.addedForeground":"#a3be8c","editorOverviewRuler.deletedForeground":"#bf616a","editorOverviewRuler.errorForeground":"#bf616a","editorOverviewRuler.warningForeground":"#ebcb8b","editorOverviewRuler.infoForeground":"#81a1c1","editorRuler.foreground":"#434c5e","editorSuggestWidget.background":"#2e3440","editorSuggestWidget.border":"#3b4252","editorSuggestWidget.foreground":"#d8dee9","editorSuggestWidget.focusHighlightForeground":"#88c0d0","editorSuggestWidget.highlightForeground":"#88c0d0","editorSuggestWidget.selectedBackground":"#434c5e","editorSuggestWidget.selectedForeground":"#d8dee9","extensionButton.prominentForeground":"#d8dee9","extensionButton.prominentBackground":"#434c5e","extensionButton.prominentHoverBackground":"#4c566a",errorForeground:"#bf616a","gitDecoration.modifiedResourceForeground":"#ebcb8b","gitDecoration.deletedResourceForeground":"#bf616a","gitDecoration.untrackedResourceForeground":"#a3be8c","gitDecoration.ignoredResourceForeground":"#d8dee966","gitDecoration.conflictingResourceForeground":"#5e81ac","gitDecoration.submoduleResourceForeground":"#8fbcbb","gitDecoration.stageDeletedResourceForeground":"#bf616a","gitDecoration.stageModifiedResourceForeground":"#ebcb8b","input.background":"#3b4252","input.foreground":"#d8dee9","input.placeholderForeground":"#d8dee999","input.border":"#3b4252","inputOption.activeBackground":"#5e81ac","inputOption.activeBorder":"#5e81ac","inputOption.activeForeground":"#eceff4","inputValidation.errorBackground":"#bf616a","inputValidation.errorBorder":"#bf616a","inputValidation.infoBackground":"#81a1c1","inputValidation.infoBorder":"#81a1c1","inputValidation.warningBackground":"#d08770","inputValidation.warningBorder":"#d08770","keybindingLabel.background":"#4c566a","keybindingLabel.border":"#4c566a","keybindingLabel.bottomBorder":"#4c566a","keybindingLabel.foreground":"#d8dee9","list.activeSelectionBackground":"#88c0d0","list.activeSelectionForeground":"#2e3440","list.inactiveSelectionBackground":"#434c5e","list.inactiveSelectionForeground":"#d8dee9","list.inactiveFocusBackground":"#434c5ecc","list.hoverForeground":"#eceff4","list.focusForeground":"#d8dee9","list.focusBackground":"#88c0d099","list.focusHighlightForeground":"#eceff4","list.hoverBackground":"#3b4252","list.dropBackground":"#88c0d099","list.highlightForeground":"#88c0d0","list.errorForeground":"#bf616a","list.warningForeground":"#ebcb8b","merge.currentHeaderBackground":"#81a1c166","merge.currentContentBackground":"#81a1c14d","merge.incomingHeaderBackground":"#8fbcbb66","merge.incomingContentBackground":"#8fbcbb4d","merge.border":"#3b425200","minimap.background":"#2e3440","minimap.errorHighlight":"#bf616acc","minimap.findMatchHighlight":"#88c0d0","minimap.selectionHighlight":"#88c0d0cc","minimap.warningHighlight":"#ebcb8bcc","minimapGutter.addedBackground":"#a3be8c","minimapGutter.deletedBackground":"#bf616a","minimapGutter.modifiedBackground":"#ebcb8b","minimapSlider.activeBackground":"#434c5eaa","minimapSlider.background":"#434c5e99","minimapSlider.hoverBackground":"#434c5eaa","notification.background":"#3b4252","notification.buttonBackground":"#434c5e","notification.buttonForeground":"#d8dee9","notification.buttonHoverBackground":"#4c566a","notification.errorBackground":"#bf616a","notification.errorForeground":"#2e3440","notification.foreground":"#d8dee9","notification.infoBackground":"#88c0d0","notification.infoForeground":"#2e3440","notification.warningBackground":"#ebcb8b","notification.warningForeground":"#2e3440","notificationCenter.border":"#3b425200","notificationCenterHeader.background":"#2e3440","notificationCenterHeader.foreground":"#88c0d0","notificationLink.foreground":"#88c0d0","notifications.background":"#3b4252","notifications.border":"#2e3440","notifications.foreground":"#d8dee9","notificationToast.border":"#3b425200","panel.background":"#2e3440","panel.border":"#3b4252","panelTitle.activeBorder":"#88c0d000","panelTitle.activeForeground":"#88c0d0","panelTitle.inactiveForeground":"#d8dee9","peekView.border":"#4c566a","peekViewEditor.background":"#2e3440","peekViewEditorGutter.background":"#2e3440","peekViewEditor.matchHighlightBackground":"#88c0d04d","peekViewResult.background":"#2e3440","peekViewResult.fileForeground":"#88c0d0","peekViewResult.lineForeground":"#d8dee966","peekViewResult.matchHighlightBackground":"#88c0d0cc","peekViewResult.selectionBackground":"#434c5e","peekViewResult.selectionForeground":"#d8dee9","peekViewTitle.background":"#3b4252","peekViewTitleDescription.foreground":"#d8dee9","peekViewTitleLabel.foreground":"#88c0d0","pickerGroup.border":"#3b4252","pickerGroup.foreground":"#88c0d0","progressBar.background":"#88c0d0","quickInputList.focusBackground":"#88c0d0","quickInputList.focusForeground":"#2e3440","sash.hoverBorder":"#88c0d0","scrollbar.shadow":"#00000066","scrollbarSlider.activeBackground":"#434c5eaa","scrollbarSlider.background":"#434c5e99","scrollbarSlider.hoverBackground":"#434c5eaa","selection.background":"#88c0d099","sideBar.background":"#2e3440","sideBar.foreground":"#d8dee9","sideBar.border":"#3b4252","sideBarSectionHeader.background":"#3b4252","sideBarSectionHeader.foreground":"#d8dee9","sideBarTitle.foreground":"#d8dee9","statusBar.background":"#3b4252","statusBar.debuggingBackground":"#5e81ac","statusBar.debuggingForeground":"#d8dee9","statusBar.noFolderForeground":"#d8dee9","statusBar.noFolderBackground":"#3b4252","statusBar.foreground":"#d8dee9","statusBarItem.activeBackground":"#4c566a","statusBarItem.hoverBackground":"#434c5e","statusBarItem.prominentBackground":"#3b4252","statusBarItem.prominentHoverBackground":"#434c5e","statusBarItem.errorBackground":"#3b4252","statusBarItem.errorForeground":"#bf616a","statusBarItem.warningBackground":"#ebcb8b","statusBarItem.warningForeground":"#2e3440","statusBar.border":"#3b425200","tab.activeBackground":"#3b4252","tab.activeForeground":"#d8dee9","tab.border":"#3b425200","tab.activeBorder":"#88c0d000","tab.unfocusedActiveBorder":"#88c0d000","tab.inactiveBackground":"#2e3440","tab.inactiveForeground":"#d8dee966","tab.unfocusedActiveForeground":"#d8dee999","tab.unfocusedInactiveForeground":"#d8dee966","tab.hoverBackground":"#3b4252cc","tab.unfocusedHoverBackground":"#3b4252b3","tab.hoverBorder":"#88c0d000","tab.unfocusedHoverBorder":"#88c0d000","tab.activeBorderTop":"#88c0d000","tab.unfocusedActiveBorderTop":"#88c0d000","tab.lastPinnedBorder":"#4c566a","terminal.background":"#2e3440","terminal.foreground":"#d8dee9","terminal.ansiBlack":"#3b4252","terminal.ansiRed":"#bf616a","terminal.ansiGreen":"#a3be8c","terminal.ansiYellow":"#ebcb8b","terminal.ansiBlue":"#81a1c1","terminal.ansiMagenta":"#b48ead","terminal.ansiCyan":"#88c0d0","terminal.ansiWhite":"#e5e9f0","terminal.ansiBrightBlack":"#4c566a","terminal.ansiBrightRed":"#bf616a","terminal.ansiBrightGreen":"#a3be8c","terminal.ansiBrightYellow":"#ebcb8b","terminal.ansiBrightBlue":"#81a1c1","terminal.ansiBrightMagenta":"#b48ead","terminal.ansiBrightCyan":"#8fbcbb","terminal.ansiBrightWhite":"#eceff4","terminal.tab.activeBorder":"#88c0d0","textBlockQuote.background":"#3b4252","textBlockQuote.border":"#81a1c1","textCodeBlock.background":"#4c566a","textLink.activeForeground":"#88c0d0","textLink.foreground":"#88c0d0","textPreformat.foreground":"#8fbcbb","textSeparator.foreground":"#eceff4","titleBar.activeBackground":"#2e3440","titleBar.activeForeground":"#d8dee9","titleBar.border":"#2e344000","titleBar.inactiveBackground":"#2e3440","titleBar.inactiveForeground":"#d8dee966","tree.indentGuidesStroke":"#616e88","walkThrough.embeddedEditorBackground":"#2e3440","welcomePage.buttonBackground":"#434c5e","welcomePage.buttonHoverBackground":"#4c566a","widget.shadow":"#00000066"},tokenColors:[{settings:{foreground:"#d8dee9ff",background:"#2e3440ff"}},{scope:"emphasis",settings:{fontStyle:"italic"}},{scope:"strong",settings:{fontStyle:"bold"}},{name:"Comment",scope:"comment",settings:{foreground:"#616E88"}},{name:"Constant Character",scope:"constant.character",settings:{foreground:"#EBCB8B"}},{name:"Constant Character Escape",scope:"constant.character.escape",settings:{foreground:"#EBCB8B"}},{name:"Constant Language",scope:"constant.language",settings:{foreground:"#81A1C1"}},{name:"Constant Numeric",scope:"constant.numeric",settings:{foreground:"#B48EAD"}},{name:"Constant Regexp",scope:"constant.regexp",settings:{foreground:"#EBCB8B"}},{name:"Entity Name Class/Type",scope:["entity.name.class","entity.name.type.class"],settings:{foreground:"#8FBCBB"}},{name:"Entity Name Function",scope:"entity.name.function",settings:{foreground:"#88C0D0"}},{name:"Entity Name Tag",scope:"entity.name.tag",settings:{foreground:"#81A1C1"}},{name:"Entity Other Attribute Name",scope:"entity.other.attribute-name",settings:{foreground:"#8FBCBB"}},{name:"Entity Other Inherited Class",scope:"entity.other.inherited-class",settings:{fontStyle:"bold",foreground:"#8FBCBB"}},{name:"Invalid Deprecated",scope:"invalid.deprecated",settings:{foreground:"#D8DEE9",background:"#EBCB8B"}},{name:"Invalid Illegal",scope:"invalid.illegal",settings:{foreground:"#D8DEE9",background:"#BF616A"}},{name:"Keyword",scope:"keyword",settings:{foreground:"#81A1C1"}},{name:"Keyword Operator",scope:"keyword.operator",settings:{foreground:"#81A1C1"}},{name:"Keyword Other New",scope:"keyword.other.new",settings:{foreground:"#81A1C1"}},{name:"Markup Bold",scope:"markup.bold",settings:{fontStyle:"bold"}},{name:"Markup Changed",scope:"markup.changed",settings:{foreground:"#EBCB8B"}},{name:"Markup Deleted",scope:"markup.deleted",settings:{foreground:"#BF616A"}},{name:"Markup Inserted",scope:"markup.inserted",settings:{foreground:"#A3BE8C"}},{name:"Meta Preprocessor",scope:"meta.preprocessor",settings:{foreground:"#5E81AC"}},{name:"Punctuation",scope:"punctuation",settings:{foreground:"#ECEFF4"}},{name:"Punctuation Definition Parameters",scope:["punctuation.definition.method-parameters","punctuation.definition.function-parameters","punctuation.definition.parameters"],settings:{foreground:"#ECEFF4"}},{name:"Punctuation Definition Tag",scope:"punctuation.definition.tag",settings:{foreground:"#81A1C1"}},{name:"Punctuation Definition Comment",scope:["punctuation.definition.comment","punctuation.end.definition.comment","punctuation.start.definition.comment"],settings:{foreground:"#616E88"}},{name:"Punctuation Section",scope:"punctuation.section",settings:{foreground:"#ECEFF4"}},{name:"Punctuation Section Embedded",scope:["punctuation.section.embedded.begin","punctuation.section.embedded.end"],settings:{foreground:"#81A1C1"}},{name:"Punctuation Terminator",scope:"punctuation.terminator",settings:{foreground:"#81A1C1"}},{name:"Punctuation Variable",scope:"punctuation.definition.variable",settings:{foreground:"#81A1C1"}},{name:"Storage",scope:"storage",settings:{foreground:"#81A1C1"}},{name:"String",scope:"string",settings:{foreground:"#A3BE8C"}},{name:"String Regexp",scope:"string.regexp",settings:{foreground:"#EBCB8B"}},{name:"Support Class",scope:"support.class",settings:{foreground:"#8FBCBB"}},{name:"Support Constant",scope:"support.constant",settings:{foreground:"#81A1C1"}},{name:"Support Function",scope:"support.function",settings:{foreground:"#88C0D0"}},{name:"Support Function Construct",scope:"support.function.construct",settings:{foreground:"#81A1C1"}},{name:"Support Type",scope:"support.type",settings:{foreground:"#8FBCBB"}},{name:"Support Type Exception",scope:"support.type.exception",settings:{foreground:"#8FBCBB"}},{name:"Token Debug",scope:"token.debug-token",settings:{foreground:"#b48ead"}},{name:"Token Error",scope:"token.error-token",settings:{foreground:"#bf616a"}},{name:"Token Info",scope:"token.info-token",settings:{foreground:"#88c0d0"}},{name:"Token Warning",scope:"token.warn-token",settings:{foreground:"#ebcb8b"}},{name:"Variable",scope:"variable.other",settings:{foreground:"#D8DEE9"}},{name:"Variable Language",scope:"variable.language",settings:{foreground:"#81A1C1"}},{name:"Variable Parameter",scope:"variable.parameter",settings:{foreground:"#D8DEE9"}},{name:"[C/CPP] Punctuation Separator Pointer-Access",scope:"punctuation.separator.pointer-access.c",settings:{foreground:"#81A1C1"}},{name:"[C/CPP] Meta Preprocessor Include",scope:["source.c meta.preprocessor.include","source.c string.quoted.other.lt-gt.include"],settings:{foreground:"#8FBCBB"}},{name:"[C/CPP] Conditional Directive",scope:["source.cpp keyword.control.directive.conditional","source.cpp punctuation.definition.directive","source.c keyword.control.directive.conditional","source.c punctuation.definition.directive"],settings:{foreground:"#5E81AC",fontStyle:"bold"}},{name:"[CSS] Constant Other Color RGB Value",scope:"source.css constant.other.color.rgb-value",settings:{foreground:"#B48EAD"}},{name:"[CSS](Function) Meta Property-Value",scope:"source.css meta.property-value",settings:{foreground:"#88C0D0"}},{name:"[CSS] Media Queries",scope:["source.css keyword.control.at-rule.media","source.css keyword.control.at-rule.media punctuation.definition.keyword"],settings:{foreground:"#D08770"}},{name:"[CSS] Punctuation Definition Keyword",scope:"source.css punctuation.definition.keyword",settings:{foreground:"#81A1C1"}},{name:"[CSS] Support Type Property Name",scope:"source.css support.type.property-name",settings:{foreground:"#D8DEE9"}},{name:"[diff] Meta Range Context",scope:"source.diff meta.diff.range.context",settings:{foreground:"#8FBCBB"}},{name:"[diff] Meta Header From-File",scope:"source.diff meta.diff.header.from-file",settings:{foreground:"#8FBCBB"}},{name:"[diff] Punctuation Definition From-File",scope:"source.diff punctuation.definition.from-file",settings:{foreground:"#8FBCBB"}},{name:"[diff] Punctuation Definition Range",scope:"source.diff punctuation.definition.range",settings:{foreground:"#8FBCBB"}},{name:"[diff] Punctuation Definition Separator",scope:"source.diff punctuation.definition.separator",settings:{foreground:"#81A1C1"}},{name:"[Elixir](JakeBecker.elixir-ls) module names",scope:"entity.name.type.module.elixir",settings:{foreground:"#8FBCBB"}},{name:"[Elixir](JakeBecker.elixir-ls) module attributes",scope:"variable.other.readwrite.module.elixir",settings:{foreground:"#D8DEE9",fontStyle:"bold"}},{name:"[Elixir](JakeBecker.elixir-ls) atoms",scope:"constant.other.symbol.elixir",settings:{foreground:"#D8DEE9",fontStyle:"bold"}},{name:"[Elixir](JakeBecker.elixir-ls) modules",scope:"variable.other.constant.elixir",settings:{foreground:"#8FBCBB"}},{name:"[Go] String Format Placeholder",scope:"source.go constant.other.placeholder.go",settings:{foreground:"#EBCB8B"}},{name:"[Java](JavaDoc) Comment Block Documentation HTML Entities",scope:"source.java comment.block.documentation.javadoc punctuation.definition.entity.html",settings:{foreground:"#81A1C1"}},{name:"[Java](JavaDoc) Constant Other",scope:"source.java constant.other",settings:{foreground:"#D8DEE9"}},{name:"[Java](JavaDoc) Keyword Other Documentation",scope:"source.java keyword.other.documentation",settings:{foreground:"#8FBCBB"}},{name:"[Java](JavaDoc) Keyword Other Documentation Author",scope:"source.java keyword.other.documentation.author.javadoc",settings:{foreground:"#8FBCBB"}},{name:"[Java](JavaDoc) Keyword Other Documentation Directive/Custom",scope:["source.java keyword.other.documentation.directive","source.java keyword.other.documentation.custom"],settings:{foreground:"#8FBCBB"}},{name:"[Java](JavaDoc) Keyword Other Documentation See",scope:"source.java keyword.other.documentation.see.javadoc",settings:{foreground:"#8FBCBB"}},{name:"[Java] Meta Method-Call",scope:"source.java meta.method-call meta.method",settings:{foreground:"#88C0D0"}},{name:"[Java](JavaDoc) Meta Tag Template Link",scope:["source.java meta.tag.template.link.javadoc","source.java string.other.link.title.javadoc"],settings:{foreground:"#8FBCBB"}},{name:"[Java](JavaDoc) Meta Tag Template Value",scope:"source.java meta.tag.template.value.javadoc",settings:{foreground:"#88C0D0"}},{name:"[Java](JavaDoc) Punctuation Definition Keyword",scope:"source.java punctuation.definition.keyword.javadoc",settings:{foreground:"#8FBCBB"}},{name:"[Java](JavaDoc) Punctuation Definition Tag",scope:["source.java punctuation.definition.tag.begin.javadoc","source.java punctuation.definition.tag.end.javadoc"],settings:{foreground:"#616E88"}},{name:"[Java] Storage Modifier Import",scope:"source.java storage.modifier.import",settings:{foreground:"#8FBCBB"}},{name:"[Java] Storage Modifier Package",scope:"source.java storage.modifier.package",settings:{foreground:"#8FBCBB"}},{name:"[Java] Storage Type",scope:"source.java storage.type",settings:{foreground:"#8FBCBB"}},{name:"[Java] Storage Type Annotation",scope:"source.java storage.type.annotation",settings:{foreground:"#D08770"}},{name:"[Java] Storage Type Generic",scope:"source.java storage.type.generic",settings:{foreground:"#8FBCBB"}},{name:"[Java] Storage Type Primitive",scope:"source.java storage.type.primitive",settings:{foreground:"#81A1C1"}},{name:"[JavaScript] Decorator",scope:["source.js punctuation.decorator","source.js meta.decorator variable.other.readwrite","source.js meta.decorator entity.name.function"],settings:{foreground:"#D08770"}},{name:"[JavaScript] Meta Object-Literal Key",scope:"source.js meta.object-literal.key",settings:{foreground:"#88C0D0"}},{name:"[JavaScript](JSDoc) Storage Type Class",scope:"source.js storage.type.class.jsdoc",settings:{foreground:"#8FBCBB"}},{name:"[JavaScript] String Template Literals Punctuation",scope:["source.js string.quoted.template punctuation.quasi.element.begin","source.js string.quoted.template punctuation.quasi.element.end","source.js string.template punctuation.definition.template-expression"],settings:{foreground:"#81A1C1"}},{name:"[JavaScript] Interpolated String Template Punctuation Functions",scope:"source.js string.quoted.template meta.method-call.with-arguments",settings:{foreground:"#ECEFF4"}},{name:"[JavaScript] String Template Literal Variable",scope:["source.js string.template meta.template.expression support.variable.property","source.js string.template meta.template.expression variable.other.object"],settings:{foreground:"#D8DEE9"}},{name:"[JavaScript] Support Type Primitive",scope:"source.js support.type.primitive",settings:{foreground:"#81A1C1"}},{name:"[JavaScript] Variable Other Object",scope:"source.js variable.other.object",settings:{foreground:"#D8DEE9"}},{name:"[JavaScript] Variable Other Read-Write Alias",scope:"source.js variable.other.readwrite.alias",settings:{foreground:"#8FBCBB"}},{name:"[JavaScript] Parentheses in Template Strings",scope:["source.js meta.embedded.line meta.brace.square","source.js meta.embedded.line meta.brace.round","source.js string.quoted.template meta.brace.square","source.js string.quoted.template meta.brace.round"],settings:{foreground:"#ECEFF4"}},{name:"[HTML] Constant Character Entity",scope:"text.html.basic constant.character.entity.html",settings:{foreground:"#EBCB8B"}},{name:"[HTML] Constant Other Inline-Data",scope:"text.html.basic constant.other.inline-data",settings:{foreground:"#D08770",fontStyle:"italic"}},{name:"[HTML] Meta Tag SGML Doctype",scope:"text.html.basic meta.tag.sgml.doctype",settings:{foreground:"#5E81AC"}},{name:"[HTML] Punctuation Definition Entity",scope:"text.html.basic punctuation.definition.entity",settings:{foreground:"#81A1C1"}},{name:"[INI] Entity Name Section Group-Title",scope:"source.properties entity.name.section.group-title.ini",settings:{foreground:"#88C0D0"}},{name:"[INI] Punctuation Separator Key-Value",scope:"source.properties punctuation.separator.key-value.ini",settings:{foreground:"#81A1C1"}},{name:"[Markdown] Markup Fenced Code Block",scope:["text.html.markdown markup.fenced_code.block","text.html.markdown markup.fenced_code.block punctuation.definition"],settings:{foreground:"#8FBCBB"}},{name:"[Markdown] Markup Heading",scope:"markup.heading",settings:{foreground:"#88C0D0"}},{name:"[Markdown] Markup Inline",scope:["text.html.markdown markup.inline.raw","text.html.markdown markup.inline.raw punctuation.definition.raw"],settings:{foreground:"#8FBCBB"}},{name:"[Markdown] Markup Italic",scope:"text.html.markdown markup.italic",settings:{fontStyle:"italic"}},{name:"[Markdown] Markup Link",scope:"text.html.markdown markup.underline.link",settings:{fontStyle:"underline"}},{name:"[Markdown] Markup List Numbered/Unnumbered",scope:"text.html.markdown beginning.punctuation.definition.list",settings:{foreground:"#81A1C1"}},{name:"[Markdown] Markup Quote Punctuation Definition",scope:"text.html.markdown beginning.punctuation.definition.quote",settings:{foreground:"#8FBCBB"}},{name:"[Markdown] Markup Quote Punctuation Definition",scope:"text.html.markdown markup.quote",settings:{foreground:"#616E88"}},{name:"[Markdown] Markup Math Constant",scope:"text.html.markdown constant.character.math.tex",settings:{foreground:"#81A1C1"}},{name:"[Markdown] Markup Math Definition Marker",scope:["text.html.markdown punctuation.definition.math.begin","text.html.markdown punctuation.definition.math.end"],settings:{foreground:"#5E81AC"}},{name:"[Markdown] Markup Math Function Definition Marker",scope:"text.html.markdown punctuation.definition.function.math.tex",settings:{foreground:"#88C0D0"}},{name:"[Markdown] Markup Math Operator",scope:"text.html.markdown punctuation.math.operator.latex",settings:{foreground:"#81A1C1"}},{name:"[Markdown] Punctuation Definition Heading",scope:"text.html.markdown punctuation.definition.heading",settings:{foreground:"#81A1C1"}},{name:"[Markdown] Punctuation Definition Constant/String",scope:["text.html.markdown punctuation.definition.constant","text.html.markdown punctuation.definition.string"],settings:{foreground:"#81A1C1"}},{name:"[Markdown] String Other Link Description/Title",scope:["text.html.markdown constant.other.reference.link","text.html.markdown string.other.link.description","text.html.markdown string.other.link.title"],settings:{foreground:"#88C0D0"}},{name:"[Perl] Perl Sigils",scope:"source.perl punctuation.definition.variable",settings:{foreground:"#D8DEE9"}},{name:"[PHP] Meta Function-Call Object",scope:["source.php meta.function-call","source.php meta.function-call.object"],settings:{foreground:"#88C0D0"}},{name:"[Python] Decorator",scope:["source.python entity.name.function.decorator","source.python meta.function.decorator support.type"],settings:{foreground:"#D08770"}},{name:"[Python] Function Call",scope:"source.python meta.function-call.generic",settings:{foreground:"#88C0D0"}},{name:"[Python] Support Type",scope:"source.python support.type",settings:{foreground:"#88C0D0"}},{name:"[Python] Function Parameter",scope:["source.python variable.parameter.function.language"],settings:{foreground:"#D8DEE9"}},{name:"[Python] Function Parameter Special",scope:["source.python meta.function.parameters variable.parameter.function.language.special.self"],settings:{foreground:"#81A1C1"}},{name:"[Rust] Entity types",scope:"source.rust entity.name.type",settings:{foreground:"#8FBCBB"}},{name:"[Rust] Macro",scope:"source.rust meta.macro entity.name.function",settings:{fontStyle:"bold",foreground:"#88C0D0"}},{name:"[Rust] Attributes",scope:["source.rust meta.attribute","source.rust meta.attribute punctuation","source.rust meta.attribute keyword.operator"],settings:{foreground:"#5E81AC"}},{name:"[Rust] Traits",scope:"source.rust entity.name.type.trait",settings:{fontStyle:"bold"}},{name:"[Rust] Interpolation Bracket Curly",scope:"source.rust punctuation.definition.interpolation",settings:{foreground:"#EBCB8B"}},{name:"[SCSS] Punctuation Definition Interpolation Bracket Curly",scope:["source.css.scss punctuation.definition.interpolation.begin.bracket.curly","source.css.scss punctuation.definition.interpolation.end.bracket.curly"],settings:{foreground:"#81A1C1"}},{name:"[SCSS] Variable Interpolation",scope:"source.css.scss variable.interpolation",settings:{foreground:"#D8DEE9",fontStyle:"italic"}},{name:"[TypeScript] Decorators",scope:["source.ts punctuation.decorator","source.ts meta.decorator variable.other.readwrite","source.ts meta.decorator entity.name.function","source.tsx punctuation.decorator","source.tsx meta.decorator variable.other.readwrite","source.tsx meta.decorator entity.name.function"],settings:{foreground:"#D08770"}},{name:"[TypeScript] Object-literal keys",scope:["source.ts meta.object-literal.key","source.tsx meta.object-literal.key"],settings:{foreground:"#D8DEE9"}},{name:"[TypeScript] Object-literal functions",scope:["source.ts meta.object-literal.key entity.name.function","source.tsx meta.object-literal.key entity.name.function"],settings:{foreground:"#88C0D0"}},{name:"[TypeScript] Type/Class",scope:["source.ts support.class","source.ts support.type","source.ts entity.name.type","source.ts entity.name.class","source.tsx support.class","source.tsx support.type","source.tsx entity.name.type","source.tsx entity.name.class"],settings:{foreground:"#8FBCBB"}},{name:"[TypeScript] Static Class Support",scope:["source.ts support.constant.math","source.ts support.constant.dom","source.ts support.constant.json","source.tsx support.constant.math","source.tsx support.constant.dom","source.tsx support.constant.json"],settings:{foreground:"#8FBCBB"}},{name:"[TypeScript] Variables",scope:["source.ts support.variable","source.tsx support.variable"],settings:{foreground:"#D8DEE9"}},{name:"[TypeScript] Parentheses in Template Strings",scope:["source.ts meta.embedded.line meta.brace.square","source.ts meta.embedded.line meta.brace.round","source.tsx meta.embedded.line meta.brace.square","source.tsx meta.embedded.line meta.brace.round"],settings:{foreground:"#ECEFF4"}},{name:"[XML] Entity Name Tag Namespace",scope:"text.xml entity.name.tag.namespace",settings:{foreground:"#8FBCBB"}},{name:"[XML] Keyword Other Doctype",scope:"text.xml keyword.other.doctype",settings:{foreground:"#5E81AC"}},{name:"[XML] Meta Tag Preprocessor",scope:"text.xml meta.tag.preprocessor entity.name.tag",settings:{foreground:"#5E81AC"}},{name:"[XML] Entity Name Tag Namespace",scope:["text.xml string.unquoted.cdata","text.xml string.unquoted.cdata punctuation.definition.string"],settings:{foreground:"#D08770",fontStyle:"italic"}},{name:"[YAML] Entity Name Tag",scope:"source.yaml entity.name.tag",settings:{foreground:"#8FBCBB"}}]},lineNumbers:!0,showCopyButton:!0,autoImport:!0,skipLanguages:[],filepath:"/home/runner/work/docs/docs/docs/build/best-practices/design-patterns.md"};function g(e){const o=Object.assign({p:"p",a:"a",h1:"h1",h2:"h2",h3:"h3",code:"code",strong:"strong"},(0,r.ah)(),e.components);return d||h("CH",!1),d.Code||h("CH.Code",!0),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.p,{children:"This is a selection of software design patterns developed by core Flow developers\nwhile writing Cadence code for deployment to Flow Mainnet."}),"\n",(0,n.jsx)(o.p,{children:"Many of these design patters apply to most other programming languages, but some are specific to Cadence."}),"\n",(0,n.jsxs)(o.p,{children:[(0,n.jsx)(o.a,{href:"https://en.wikipedia.org/wiki/Software_design_pattern",children:"Design patterns"})," are building blocks for software development.\nThey may provide a solution to a problem that you encounter when writing smart contracts in Cadence.\nIf they do not clearly fit, these patterns may not be the right solution for a given situation or problem.\nThey are not meant to be rules to be followed strictly, especially where a better solution presents itself."]}),"\n",(0,n.jsx)(o.h1,{id:"general",children:"General"}),"\n",(0,n.jsx)(o.p,{children:"These are general patterns to follow when writing smart contracts."}),"\n",(0,n.jsx)(o.h2,{id:"use-named-value-fields-for-constants-instead-of-hard-coding",children:"Use named value fields for constants instead of hard-coding"}),"\n",(0,n.jsx)(o.h3,{id:"problem",children:"Problem"}),"\n",(0,n.jsxs)(o.p,{children:["Your contracts, resources, and scripts all have to refer to the same value.\nA number, a string, a storage path, etc.\nEntering these values manually in transactions and scripts is a potential source of error.\nSee ",(0,n.jsx)(o.a,{href:"https://en.wikipedia.org/wiki/Magic_number_(programming)",children:"Wikipedia's page on magic numbers"})]}),"\n",(0,n.jsx)(o.h3,{id:"solution",children:"Solution"}),"\n",(0,n.jsxs)(o.p,{children:["Add a public (",(0,n.jsx)(o.code,{children:"access(all)"}),"), constant (",(0,n.jsx)(o.code,{children:"let"}),") field, e.g. a ",(0,n.jsx)(o.code,{children:"Path"})," , to the contract responsible for the value,\nand set it in the contract's initializer.\nRefer to that value via this public field rather than specifying it manually."]}),"\n",(0,n.jsx)(o.p,{children:"Example Snippet:"}),"\n",(0,n.jsx)(d.Code,{codeConfig:u,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"// BAD Practice: Do not hard code storage paths",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"contract",props:{style:{color:"#81A1C1"}}},{content:" NamedFields ",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"resource",props:{style:{color:"#81A1C1"}}},{content:" Test ",props:{style:{color:"#D8DEE9FF"}}},{content:"{}",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    init",props:{style:{color:"#81A1C1"}}},{content:"() {",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        // BAD: Hard-coded storage path",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        self",props:{style:{color:"#81A1C1"}}},{content:".account.",props:{style:{color:"#D8DEE9FF"}}},{content:"save",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"<-",props:{style:{color:"#81A1C1"}}},{content:"create ",props:{style:{color:"#D8DEE9FF"}}},{content:"Test",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}},{content:", ",props:{style:{color:"#D8DEE9FF"}}},{content:"to",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#ECEFF4"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"storage",props:{style:{color:"#D8DEE9FF"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"testStorage",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"}",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"// GOOD practice: Instead, use a field",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"//",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"contract",props:{style:{color:"#81A1C1"}}},{content:" NamedFields ",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"resource",props:{style:{color:"#81A1C1"}}},{content:" Test ",props:{style:{color:"#D8DEE9FF"}}},{content:"{}",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    // GOOD: field storage path",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"let",props:{style:{color:"#81A1C1"}}},{content:" TestStoragePath: ",props:{style:{color:"#D8DEE9FF"}}},{content:"StoragePath",props:{style:{color:"#81A1C1"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    init",props:{style:{color:"#81A1C1"}}},{content:"() {",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        // assign and access the field here and in transactions",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        self",props:{style:{color:"#81A1C1"}}},{content:".TestStoragePath ",props:{style:{color:"#D8DEE9FF"}}},{content:"= /",props:{style:{color:"#81A1C1"}}},{content:"storage",props:{style:{color:"#D8DEE9FF"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"testStorage",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        self",props:{style:{color:"#81A1C1"}}},{content:".account.",props:{style:{color:"#D8DEE9FF"}}},{content:"save",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"<-",props:{style:{color:"#81A1C1"}}},{content:"create ",props:{style:{color:"#D8DEE9FF"}}},{content:"Test",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}},{content:", ",props:{style:{color:"#D8DEE9FF"}}},{content:"to",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#ECEFF4"}}},{content:"self",props:{style:{color:"#81A1C1"}}},{content:".TestStoragePath",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"}",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]}],lang:"cadence"},annotations:[]}]}),"\n",(0,n.jsx)(o.p,{children:(0,n.jsx)(o.a,{href:"https://github.com/onflow/flow-core-contracts/blob/master/contracts/LockedTokens.cdc#L718",children:"Example Code"})}),"\n",(0,n.jsx)(o.h2,{id:"script-accessible-public-fieldfunction",children:"Script-Accessible public field/function"}),"\n",(0,n.jsx)(o.p,{children:"Data availability is important in a blockchain environment.\nIt is useful to publicize information about your smart contract and the assets it controls\nso other smart contracts and apps can easily query it."}),"\n",(0,n.jsx)(o.h3,{id:"problem-1",children:"Problem"}),"\n",(0,n.jsx)(o.p,{children:"Your contract, resource or struct has a field or resource that will need to be read and used on or off-chain, often in bulk."}),"\n",(0,n.jsx)(o.h3,{id:"solution-1",children:"Solution"}),"\n",(0,n.jsxs)(o.p,{children:["Make sure that the field can be accessed from a script (using a ",(0,n.jsx)(o.code,{children:"PublicAccount"}),")\nrather than requiring a transaction (using an ",(0,n.jsx)(o.code,{children:"AuthAccount"}),").\nThis saves the time and fees required to read a property using a transaction.\nMaking the field or function ",(0,n.jsx)(o.code,{children:"access(all)"})," and exposing it via a ",(0,n.jsx)(o.code,{children:"/public/"})," capability will allow this."]}),"\n",(0,n.jsx)(o.p,{children:"Be careful not to expose any data or functionality that should be kept private when doing so."}),"\n",(0,n.jsx)(o.p,{children:"Example:"}),"\n",(0,n.jsx)(d.Code,{codeConfig:u,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"// BAD: Field is private, so it cannot be read by the public",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"access",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"self",props:{style:{color:"#81A1C1"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"let",props:{style:{color:"#81A1C1"}}},{content:" totalSupply: ",props:{style:{color:"#D8DEE9FF"}}},{content:"UFix64",props:{style:{color:"#81A1C1"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"// GOOD: Field is public, so it can be read and used by anyone",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"let",props:{style:{color:"#81A1C1"}}},{content:" totalSupply: ",props:{style:{color:"#D8DEE9FF"}}},{content:"UFix64",props:{style:{color:"#81A1C1"}}}]}],lang:"cadence"},annotations:[]}]}),"\n",(0,n.jsx)(o.h2,{id:"script-accessible-report",children:"Script-Accessible report"}),"\n",(0,n.jsx)(o.h3,{id:"problem-2",children:"Problem"}),"\n",(0,n.jsx)(o.p,{children:"Your contract has a resource that you wish to access fields of.\nResources are often stored in private places and are hard to access.\nAdditionally, scripts cannot return resources to the external context,\nso a struct must be used to hold the data."}),"\n",(0,n.jsx)(o.h3,{id:"solution-2",children:"Solution"}),"\n",(0,n.jsx)(o.p,{children:"Return a reference to a resource if the data from a single resource is all that is needed.\nOtherwise, declare a struct to hold the data that you wish to return from the script.\nWrite a function that fills out the fields of this struct with the data\nfrom the resource that you wish to access.\nThen call this on the resource that you wish to access the fields of in a script,\nand return the struct from the script."}),"\n",(0,n.jsxs)(o.p,{children:["See ",(0,n.jsx)(o.a,{href:"#script-accessible-public-fieldfunction",children:"Script-Accessible public field/function"}),", above, for how best to expose this capability."]}),"\n",(0,n.jsx)(o.h3,{id:"example-code",children:"Example Code"}),"\n",(0,n.jsx)(d.Code,{codeConfig:u,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"contract",props:{style:{color:"#81A1C1"}}},{content:" AContract ",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"let",props:{style:{color:"#81A1C1"}}},{content:" BResourceStoragePath: ",props:{style:{color:"#D8DEE9FF"}}},{content:"StoragePath",props:{style:{color:"#81A1C1"}}}]},{tokens:[{content:"    access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"let",props:{style:{color:"#81A1C1"}}},{content:" BResourcePublicPath: ",props:{style:{color:"#D8DEE9FF"}}},{content:"PublicPath",props:{style:{color:"#81A1C1"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    init",props:{style:{color:"#81A1C1"}}},{content:"() {",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        self",props:{style:{color:"#81A1C1"}}},{content:".BResourceStoragePath ",props:{style:{color:"#D8DEE9FF"}}},{content:"= /",props:{style:{color:"#81A1C1"}}},{content:"storage",props:{style:{color:"#D8DEE9FF"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"BResource",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        self",props:{style:{color:"#81A1C1"}}},{content:".BResourcePublicPath ",props:{style:{color:"#D8DEE9FF"}}},{content:"= /",props:{style:{color:"#81A1C1"}}},{content:"public",props:{style:{color:"#D8DEE9FF"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"BResource",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    // Resource definition",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"resource",props:{style:{color:"#81A1C1"}}},{content:" BResource ",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"var",props:{style:{color:"#81A1C1"}}},{content:" c: ",props:{style:{color:"#D8DEE9FF"}}},{content:"UInt64",props:{style:{color:"#81A1C1"}}}]},{tokens:[{content:"        access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"var",props:{style:{color:"#81A1C1"}}},{content:" d: ",props:{style:{color:"#D8DEE9FF"}}},{content:"String",props:{style:{color:"#81A1C1"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        // Generate a struct with the same fields",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        // to return when a script wants to see the fields of the resource",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        // without having to return the actual resource",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"fun ",props:{style:{color:"#81A1C1"}}},{content:"generateReport",props:{style:{color:"#88C0D0"}}},{content:"()",props:{style:{color:"#ECEFF4"}}},{content:": BReportStruct ",props:{style:{color:"#81A1C1"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"            return ",props:{style:{color:"#81A1C1"}}},{content:"BReportStruct",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"c",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#ECEFF4"}}},{content:"self",props:{style:{color:"#81A1C1"}}},{content:".c, ",props:{style:{color:"#D8DEE9FF"}}},{content:"d",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#ECEFF4"}}},{content:"self",props:{style:{color:"#81A1C1"}}},{content:".d",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        init",props:{style:{color:"#81A1C1"}}},{content:"(",props:{style:{color:"#ECEFF4"}}},{content:"c",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"UInt64",props:{style:{color:"#81A1C1"}}},{content:", ",props:{style:{color:"#D8DEE9FF"}}},{content:"d",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"String",props:{style:{color:"#81A1C1"}}},{content:") {",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"            self",props:{style:{color:"#81A1C1"}}},{content:".c ",props:{style:{color:"#D8DEE9FF"}}},{content:"=",props:{style:{color:"#81A1C1"}}},{content:" c",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"            self",props:{style:{color:"#81A1C1"}}},{content:".d ",props:{style:{color:"#D8DEE9FF"}}},{content:"=",props:{style:{color:"#81A1C1"}}},{content:" d",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    // Define a struct with the same fields as the resource",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"struct",props:{style:{color:"#81A1C1"}}},{content:" BReportStruct ",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"var",props:{style:{color:"#81A1C1"}}},{content:" c: ",props:{style:{color:"#D8DEE9FF"}}},{content:"UInt64",props:{style:{color:"#81A1C1"}}}]},{tokens:[{content:"        access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"var",props:{style:{color:"#81A1C1"}}},{content:" d: ",props:{style:{color:"#D8DEE9FF"}}},{content:"String",props:{style:{color:"#81A1C1"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        init",props:{style:{color:"#81A1C1"}}},{content:"(",props:{style:{color:"#ECEFF4"}}},{content:"c",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"UInt64",props:{style:{color:"#81A1C1"}}},{content:", ",props:{style:{color:"#D8DEE9FF"}}},{content:"d",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"String",props:{style:{color:"#81A1C1"}}},{content:") {",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"            self",props:{style:{color:"#81A1C1"}}},{content:".c ",props:{style:{color:"#D8DEE9FF"}}},{content:"=",props:{style:{color:"#81A1C1"}}},{content:" c",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"            self",props:{style:{color:"#81A1C1"}}},{content:".d ",props:{style:{color:"#D8DEE9FF"}}},{content:"=",props:{style:{color:"#81A1C1"}}},{content:" d",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"}",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"...",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"// Transaction",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"import",props:{style:{color:"#81A1C1"}}},{content:" AContract ",props:{style:{color:"#D8DEE9FF"}}},{content:"from",props:{style:{color:"#81A1C1"}}},{content:" 0xAContract",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"transaction ",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        prepare",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"acct",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" AuthAccount",props:{style:{color:"#D8DEE9FF"}}},{content:") {",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"            //...",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"            acct.link",props:{style:{color:"#D8DEE9FF"}}},{content:"<",props:{style:{color:"#81A1C1"}}},{content:"&AContract.BResource",props:{style:{color:"#D8DEE9FF"}}},{content:">",props:{style:{color:"#81A1C1"}}},{content:"(AContract.BResourcePublicPath, target: AContract.BResourceStoragePath)",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"}",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"// Script",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"import",props:{style:{color:"#81A1C1"}}},{content:" AContract ",props:{style:{color:"#D8DEE9FF"}}},{content:"from",props:{style:{color:"#81A1C1"}}},{content:" 0xAContract",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"// Return the struct with a script",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"fun ",props:{style:{color:"#81A1C1"}}},{content:"main",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#ECEFF4"}}},{content:"account",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"Address",props:{style:{color:"#81A1C1"}}},{content:")",props:{style:{color:"#ECEFF4"}}},{content:": AContract",props:{style:{color:"#81A1C1"}}},{content:".",props:{style:{color:"#D8DEE9FF"}}},{content:"BReportStruct ",props:{style:{color:"#81A1C1"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    // borrow the resource",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    let",props:{style:{color:"#81A1C1"}}},{content:" b = ",props:{style:{color:"#D8DEE9FF"}}},{content:"getAccount",props:{style:{color:"#88C0D0"}}},{content:"(account",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        .",props:{style:{color:"#D8DEE9FF"}}},{content:"getCapability",props:{style:{color:"#88C0D0"}}},{content:"(AContract.BResourcePublicPath",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        .borrow",props:{style:{color:"#D8DEE9FF"}}},{content:"<",props:{style:{color:"#81A1C1"}}},{content:"&AContract.BResource",props:{style:{color:"#D8DEE9FF"}}},{content:">",props:{style:{color:"#81A1C1"}}},{content:"()",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    // return the struct",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    return",props:{style:{color:"#81A1C1"}}},{content:" b.",props:{style:{color:"#D8DEE9FF"}}},{content:"generateReport",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"}",props:{style:{color:"#ECEFF4"}}}]}],lang:"cadence"},annotations:[]}]}),"\n",(0,n.jsx)(o.h2,{id:"init-singleton",children:"Init Singleton"}),"\n",(0,n.jsx)(o.h3,{id:"problem-3",children:"Problem"}),"\n",(0,n.jsx)(o.p,{children:"An admin resource must be created and delivered to a specified account.\nThere should not be a function to do this, as that would allow anyone to create an admin resource."}),"\n",(0,n.jsx)(o.h3,{id:"solution-3",children:"Solution"}),"\n",(0,n.jsxs)(o.p,{children:["Create any one-off resources in the contract's ",(0,n.jsx)(o.code,{children:"init()"})," function\nand deliver them to an address or ",(0,n.jsx)(o.code,{children:"AuthAccount"})," specified as an argument."]}),"\n",(0,n.jsx)(o.p,{children:"See how this is done in the LockedTokens contract init function:"}),"\n",(0,n.jsx)(o.p,{children:(0,n.jsx)(o.a,{href:"https://github.com/onflow/flow-core-contracts/blob/master/contracts/LockedTokens.cdc#L718",children:"LockedTokens.cdc"})}),"\n",(0,n.jsx)(o.p,{children:"and in the transaction that is used to deploy it:"}),"\n",(0,n.jsx)(o.p,{children:(0,n.jsx)(o.a,{href:"https://github.com/onflow/flow-core-contracts/blob/master/transactions/lockedTokens/admin/admin_deploy_contract.cdc",children:"admin_deploy_contract.cdc"})}),"\n",(0,n.jsx)(o.h2,{id:"use-descriptive-names-for-fields-paths-functions-and-variables",children:"Use descriptive names for fields, paths, functions and variables"}),"\n",(0,n.jsx)(o.h3,{id:"problem-4",children:"Problem"}),"\n",(0,n.jsx)(o.p,{children:"Smart contracts often are vitally important pieces of a project and often have many other\nsmart contracts and applications that rely on them.\nTherefore, they need to be clearly written and easy to understand."}),"\n",(0,n.jsx)(o.h3,{id:"solution-4",children:"Solution"}),"\n",(0,n.jsx)(o.p,{children:"All fields, functions, types, variables, etc., need to have names that clearly describe what they are used for."}),"\n",(0,n.jsxs)(o.p,{children:[(0,n.jsx)(o.code,{children:"account"})," / ",(0,n.jsx)(o.code,{children:"accounts"})," is better than ",(0,n.jsx)(o.code,{children:"array"})," / ",(0,n.jsx)(o.code,{children:"element"}),"."]}),"\n",(0,n.jsxs)(o.p,{children:[(0,n.jsx)(o.code,{children:"providerAccount"})," / ",(0,n.jsx)(o.code,{children:"tokenRecipientAccount"})," is better than ",(0,n.jsx)(o.code,{children:"acct1"})," / ",(0,n.jsx)(o.code,{children:"acct2"}),"."]}),"\n",(0,n.jsxs)(o.p,{children:[(0,n.jsx)(o.code,{children:"/storage/bestPracticesDocsCollectionPath"})," is better than ",(0,n.jsx)(o.code,{children:"/storage/collection"})]}),"\n",(0,n.jsx)(o.h3,{id:"example",children:"Example"}),"\n",(0,n.jsx)(d.Code,{codeConfig:u,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"// BAD: Unclear naming",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"//",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"contract",props:{style:{color:"#81A1C1"}}},{content:" Tax ",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    // Do not use abbreviations unless absolutely necessary",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"var",props:{style:{color:"#81A1C1"}}},{content:" pcnt: ",props:{style:{color:"#D8DEE9FF"}}},{content:"UFix64",props:{style:{color:"#81A1C1"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    // Not clear what the function is calculating or what the parameter should be",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"fun ",props:{style:{color:"#81A1C1"}}},{content:"calculate",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#ECEFF4"}}},{content:"num",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"UFix64",props:{style:{color:"#81A1C1"}}},{content:")",props:{style:{color:"#ECEFF4"}}},{content:": UFix64 ",props:{style:{color:"#81A1C1"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        // What total is this referring to?",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        let",props:{style:{color:"#81A1C1"}}},{content:" total = num ",props:{style:{color:"#D8DEE9FF"}}},{content:"+",props:{style:{color:"#81A1C1"}}},{content:" (num ",props:{style:{color:"#D8DEE9FF"}}},{content:"* self",props:{style:{color:"#81A1C1"}}},{content:".pcnt)",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        return",props:{style:{color:"#81A1C1"}}},{content:" total",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"}",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"// GOOD: Clear naming",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"//",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"contract",props:{style:{color:"#81A1C1"}}},{content:" TaxUtilities ",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    // Clearly states what the field is for",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"var",props:{style:{color:"#81A1C1"}}},{content:" taxPercentage: ",props:{style:{color:"#D8DEE9FF"}}},{content:"UFix64",props:{style:{color:"#81A1C1"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    // Clearly states that this function calculates the",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    // total cost after tax",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"fun ",props:{style:{color:"#81A1C1"}}},{content:"calculateTotalCostPlusTax",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#ECEFF4"}}},{content:"preTaxCost",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"UFix64",props:{style:{color:"#81A1C1"}}},{content:")",props:{style:{color:"#ECEFF4"}}},{content:": UFix64 ",props:{style:{color:"#81A1C1"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        let",props:{style:{color:"#81A1C1"}}},{content:" postTaxCost = preTaxCost ",props:{style:{color:"#D8DEE9FF"}}},{content:"+",props:{style:{color:"#81A1C1"}}},{content:" (preTaxCost ",props:{style:{color:"#D8DEE9FF"}}},{content:"* self",props:{style:{color:"#81A1C1"}}},{content:".taxPercentage)",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        return",props:{style:{color:"#81A1C1"}}},{content:" postTaxCost",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"}",props:{style:{color:"#ECEFF4"}}}]}],lang:"cadence"},annotations:[]}]}),"\n",(0,n.jsx)(o.h2,{id:"include-concrete-types-in-type-constraints-especially-any-types",children:'Include concrete types in type constraints, especially "Any" types'}),"\n",(0,n.jsx)(o.h3,{id:"problem-5",children:"Problem"}),"\n",(0,n.jsx)(o.p,{children:"When specifying type constraints for capabilities or borrows, concrete types often do not get specified,\nmaking it unclear if the developer actually intended it to be unspecified or not.\nPaths also use a shared namespace between contracts, so an account may have stored a different object\nin a path that you would expect to be used for something else.\nTherefore, it is important to be explicit when getting objects or references to resources."}),"\n",(0,n.jsx)(o.h3,{id:"solution-5",children:"Solution"}),"\n",(0,n.jsxs)(o.p,{children:["A good example of when the code should specify the type is checking the FLOW balance:\nThe code must borrow ",(0,n.jsx)(o.code,{children:"&FlowToken.Vault"}),", in order to ensure that it gets a FLOW token balance,\nand not just ",(0,n.jsx)(o.code,{children:"&{FungibleToken.Balance}"}),", any balance \u2013 the user could store another object\nthat conforms to the balance interface and return whatever value as the amount."]}),"\n",(0,n.jsx)(o.h2,{id:"plural-names-for-arrays-and-maps-are-preferable",children:"Plural names for arrays and maps are preferable"}),"\n",(0,n.jsxs)(o.p,{children:["e.g. ",(0,n.jsx)(o.code,{children:"accounts"})," rather than ",(0,n.jsx)(o.code,{children:"account"})," for an array of accounts."]}),"\n",(0,n.jsx)(o.p,{children:"This signals that the field or variable is not scalar.\nIt also makes it easier to use the singular form for a variable name during iteration."}),"\n",(0,n.jsx)(o.h2,{id:"use-transaction-post-conditions-when-applicable",children:"Use transaction post-conditions when applicable"}),"\n",(0,n.jsx)(o.h3,{id:"problem-6",children:"Problem"}),"\n",(0,n.jsx)(o.p,{children:"Transactions can contain any amount of valid Cadence code and access many contracts and accounts.\nThe power of resources and capabilities means that there may be some behaviors of programs that are not expected."}),"\n",(0,n.jsx)(o.h3,{id:"solution-6",children:"Solution"}),"\n",(0,n.jsx)(o.p,{children:"It is usually safe to include post-conditions in transactions to verify the intended outcome."}),"\n",(0,n.jsx)(o.h3,{id:"example-1",children:"Example"}),"\n",(0,n.jsx)(o.p,{children:"This could be used when purchasing an NFT to verify that the NFT was deposited in your account's collection."}),"\n",(0,n.jsx)(d.Code,{codeConfig:u,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"// Psuedo-code",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"transaction ",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"let",props:{style:{color:"#81A1C1"}}},{content:" buyerCollectionRef: &",props:{style:{color:"#D8DEE9FF"}}},{content:"NonFungibleToken",props:{style:{color:"#81A1C1"}}},{content:".",props:{style:{color:"#D8DEE9FF"}}},{content:"Collection",props:{style:{color:"#81A1C1"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    prepare",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"acct",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" AuthAccount",props:{style:{color:"#D8DEE9FF"}}},{content:") {",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        // Get tokens to buy and a collection to deposit the bought NFT to",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        let",props:{style:{color:"#81A1C1"}}},{content:" temporaryVault <- vaultRef.",props:{style:{color:"#D8DEE9FF"}}},{content:"withdraw",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"amount",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#ECEFF4"}}},{content:"10",props:{style:{color:"#B48EAD"}}},{content:".",props:{style:{color:"#D8DEE9FF"}}},{content:"0",props:{style:{color:"#B48EAD"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        let",props:{style:{color:"#81A1C1"}}},{content:" self.",props:{style:{color:"#D8DEE9FF"}}},{content:"buyerCollectionRef",props:{style:{color:"#81A1C1"}}},{content:" = acct.",props:{style:{color:"#D8DEE9FF"}}},{content:"borrow",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"from",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#ECEFF4"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"storage",props:{style:{color:"#D8DEE9FF"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"Collection",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        // purchase, supplying the buyers collection reference",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        saleRef.",props:{style:{color:"#D8DEE9FF"}}},{content:"purchase",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"tokenID",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#ECEFF4"}}},{content:"1",props:{style:{color:"#B48EAD"}}},{content:", ",props:{style:{color:"#D8DEE9FF"}}},{content:"recipient",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#ECEFF4"}}},{content:"self",props:{style:{color:"#81A1C1"}}},{content:".buyerCollectionRef, ",props:{style:{color:"#D8DEE9FF"}}},{content:"buyTokens",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#ECEFF4"}}},{content:"<-",props:{style:{color:"#81A1C1"}}},{content:"temporaryVault",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    post ",props:{style:{color:"#81A1C1"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        // verify that the buyer now owns the NFT",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        self",props:{style:{color:"#81A1C1"}}},{content:".buyerCollectionRef.",props:{style:{color:"#D8DEE9FF"}}},{content:"idExists",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"1",props:{style:{color:"#B48EAD"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"== true",props:{style:{color:"#81A1C1"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"Bought NFT ID was not deposited into the buyers collection",props:{style:{color:"#A3BE8C"}}},{content:'"',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"}",props:{style:{color:"#ECEFF4"}}}]}],lang:"cadence"},annotations:[]}]}),"\n",(0,n.jsx)(o.h2,{id:"avoid-excessive-load-and-save-storage-operations-prefer-in-place-mutations",children:"Avoid excessive load and save storage operations (prefer in-place mutations)"}),"\n",(0,n.jsx)(o.h3,{id:"problem-7",children:"Problem"}),"\n",(0,n.jsxs)(o.p,{children:["When modifying data in account storage, ",(0,n.jsx)(o.code,{children:"load()"})," and ",(0,n.jsx)(o.code,{children:"save()"})," are costly operations.\nThis can quickly cause your transaction to reach the gas limit or slow down the network."]}),"\n",(0,n.jsx)(o.p,{children:"This also applies to contract objects and their fields (which are implicitly stored in storage, i.e. read from/written to),\nor nested resources. Loading them from their fields just to modify them and save them back\nis just as costly."}),"\n",(0,n.jsx)(o.p,{children:"For example, a collection contains a dictionary of NFTs. There is no need to move the whole dictionary out of the field,\nupdate the dictionary on the stack (e.g. adding or removing an NFT),\nand then move the whole dictionary back to the field, it can be updated in-place.\nThe same goes for a more complex data structure like a dictionary of nested resources:\nEach resource can be updated in-place by taking a reference to the nested object instead of loading and saving."}),"\n",(0,n.jsx)(o.h3,{id:"solution-7",children:"Solution"}),"\n",(0,n.jsxs)(o.p,{children:["For making modifications to values in storage or accessing stored objects,\n",(0,n.jsx)(o.code,{children:"borrow()"})," should always be used to access them instead of ",(0,n.jsx)(o.code,{children:"load"})," or ",(0,n.jsx)(o.code,{children:"save"})," unless absolutely necessary.\n",(0,n.jsx)(o.code,{children:"borrow()"})," returns a reference to the object at the storage path instead of having to load the entire object.\nThis reference can be assigned to or can be used to access fields or call methods on stored objects."]}),"\n",(0,n.jsx)(o.h3,{id:"example-2",children:"Example"}),"\n",(0,n.jsx)(d.Code,{codeConfig:u,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"// BAD: Loads and stores a resource to use it",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"//",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"transaction ",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    prepare",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"acct",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" AuthAccount",props:{style:{color:"#D8DEE9FF"}}},{content:") {",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        // Removes the vault from storage, a costly operation",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        let",props:{style:{color:"#81A1C1"}}},{content:" vault <- acct.load",props:{style:{color:"#D8DEE9FF"}}},{content:"<",props:{style:{color:"#81A1C1"}}},{content:"@ExampleToken.Vault",props:{style:{color:"#D8DEE9FF"}}},{content:">",props:{style:{color:"#81A1C1"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"from",props:{style:{color:"#81A1C1"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"storage",props:{style:{color:"#D8DEE9FF"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"exampleToken)",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        // Withdraws tokens",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        let",props:{style:{color:"#81A1C1"}}},{content:" burnVault <- vault.",props:{style:{color:"#D8DEE9FF"}}},{content:"withdraw",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"amount",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#ECEFF4"}}},{content:"10",props:{style:{color:"#B48EAD"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        destroy",props:{style:{color:"#81A1C1"}}},{content:" burnVault",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        // Saves the used vault back to storage, another costly operation",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        acct.",props:{style:{color:"#D8DEE9FF"}}},{content:"save",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"to",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#ECEFF4"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"storage",props:{style:{color:"#D8DEE9FF"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"exampleToken",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"}",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"// GOOD: Uses borrow instead to avoid costly operations",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"//",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"transaction ",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    prepare",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"acct",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" AuthAccount",props:{style:{color:"#D8DEE9FF"}}},{content:") {",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        // Borrows a reference to the stored vault, much less costly operation",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        let",props:{style:{color:"#81A1C1"}}},{content:" vault <- acct.borrow",props:{style:{color:"#D8DEE9FF"}}},{content:"<",props:{style:{color:"#81A1C1"}}},{content:"&ExampleToken.Vault",props:{style:{color:"#D8DEE9FF"}}},{content:">",props:{style:{color:"#81A1C1"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"from",props:{style:{color:"#81A1C1"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"storage",props:{style:{color:"#D8DEE9FF"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"exampleToken)",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        let",props:{style:{color:"#81A1C1"}}},{content:" burnVault <- vault.",props:{style:{color:"#D8DEE9FF"}}},{content:"withdraw",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"amount",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#ECEFF4"}}},{content:"10",props:{style:{color:"#B48EAD"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        destroy",props:{style:{color:"#81A1C1"}}},{content:" burnVault",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        // No `save` required because we only used a reference",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"}",props:{style:{color:"#ECEFF4"}}}]}],lang:"cadence"},annotations:[]}]}),"\n",(0,n.jsx)(o.h1,{id:"capabilities",children:"Capabilities"}),"\n",(0,n.jsx)(o.h2,{id:"capability-bootstrapping",children:"Capability Bootstrapping"}),"\n",(0,n.jsx)(o.h3,{id:"problem-8",children:"Problem"}),"\n",(0,n.jsxs)(o.p,{children:["An account must be given a ",(0,n.jsx)(o.a,{href:"/docs/next/cadence/language/capabilities",children:"capability"}),"\nto a resource or contract in another account. To create, i.e. link the capability,\nthe transaction must be signed by a key which has access to the target account."]}),"\n",(0,n.jsx)(o.p,{children:"To transfer / deliver the capability to the other account, the transaction also needs write access to that one.\nIt is not as easy to produce a single transaction which is authorized by two accounts\nas it is to produce a typical transaction which is authorized by one account."}),"\n",(0,n.jsx)(o.p,{children:"This prevents a single transaction from fetching the capability\nfrom one account and delivering it to the other."}),"\n",(0,n.jsx)(o.h3,{id:"solution-8",children:"Solution"}),"\n",(0,n.jsxs)(o.p,{children:["The solution to the bootstrapping problem in Cadence is provided by the ",(0,n.jsx)(o.a,{href:"/docs/next/cadence/language/accounts/inbox",children:"Inbox API"})]}),"\n",(0,n.jsxs)(o.p,{children:["Account A (which we will call the provider) creates the capability they wish to send to B (which we will call the recipient),\nand stores this capability on their account in a place where the recipient can access it using the ",(0,n.jsx)(o.code,{children:"Inbox.publish"})," function on their account.\nThey choose a name for the capability that the recipient can later use to identify it, and specify the recipient's address when calling ",(0,n.jsx)(o.code,{children:"publish"}),".\nThis call to ",(0,n.jsx)(o.code,{children:"publish"})," will emit an ",(0,n.jsx)(o.code,{children:"InboxValuePublished"})," event that the recipient can listen for off-chain to know that the Capability is ready for them to claim."]}),"\n",(0,n.jsxs)(o.p,{children:["The recipient then later can use the ",(0,n.jsx)(o.code,{children:"Inbox.claim"})," function to securely grab the capability from the provider's account.\nThey must provide the name and type with which the capability was published, as well as the address of the provider's account\n(all of this information is available in the ",(0,n.jsx)(o.code,{children:"InboxValuePublished"})," event emitted on ",(0,n.jsx)(o.code,{children:"publish"}),").\nThis will remove the capability from the provider's account and emit an ",(0,n.jsx)(o.code,{children:"InboxValueClaimed"})," event that the provider can listen for off-chain."]}),"\n",(0,n.jsxs)(o.p,{children:["One important caveat to this is that the published capability is stored on the provider's account until the recipient claims it,\nso the provider can also use the ",(0,n.jsx)(o.code,{children:"Inbox.unpublish"})," function to remove the capability from their account if they no longer wish to pay for storage for it.\nThis also requires the name and type which the capability was published,\nand emits an ",(0,n.jsx)(o.code,{children:"InboxValueUnpublished"})," event that the recipient can listen for off-chain."]}),"\n",(0,n.jsx)(o.p,{children:"It is also important to note that the recipient becomes the owner of the capability object once they have claimed it,\nand can thus store it or copy it anywhere they have access to.\nThis means providers should only publish capabilities to recipients they trust to use them properly,\nor limit the type with which the capability is authorized in order to only give recipients access to the functionality\nthat the provider is willing to allow them to copy."}),"\n",(0,n.jsx)(o.h2,{id:"capability-revocation",children:"Capability Revocation"}),"\n",(0,n.jsx)(o.h3,{id:"problem-9",children:"Problem"}),"\n",(0,n.jsx)(o.p,{children:"A capability provided by one account to a second account must able to be revoked\nby the first account without the co-operation of the second."}),"\n",(0,n.jsxs)(o.p,{children:["See the ",(0,n.jsx)(o.a,{href:"https://github.com/onflow/flow/pull/798",children:"Capability Controller FLIP"})," for a proposal to improve this in the future."]}),"\n",(0,n.jsx)(o.h3,{id:"solution-9",children:"Solution"}),"\n",(0,n.jsxs)(o.p,{children:["The first account should create the capability as a link to a capability in ",(0,n.jsx)(o.code,{children:"/private/"}),",\nwhich then links to a resource in ",(0,n.jsx)(o.code,{children:"/storage/"}),". That second-order link is then handed\nto the second account as the capability for them to use."]}),"\n",(0,n.jsxs)(o.p,{children:[(0,n.jsx)(o.strong,{children:"Account 1:"})," ",(0,n.jsx)(o.code,{children:"/private/capability"})," \u2192 ",(0,n.jsx)(o.code,{children:"/storage/resource"})]}),"\n",(0,n.jsxs)(o.p,{children:[(0,n.jsx)(o.code,{children:"/private/revokableLink"})," -> ",(0,n.jsx)(o.code,{children:"/private/capability"})]}),"\n",(0,n.jsxs)(o.p,{children:[(0,n.jsx)(o.strong,{children:"Account 2:"})," ",(0,n.jsx)(o.code,{children:"/storage/capability -> (Capability(\u2192Account 1: /private/revokableLink))"})]}),"\n",(0,n.jsxs)(o.p,{children:["If the first account wants to revoke access to the resource in storage,\nthey should delete the ",(0,n.jsx)(o.code,{children:"/private/"})," link that the second account's capability refers to.\nCapabilities use paths rather than resource identifiers, so this will break the capability."]}),"\n",(0,n.jsx)(o.p,{children:"The first account should be careful not to create another link at the same location\nin its private storage once the capability has been revoked,\notherwise this will restore the second account's capability."}),"\n",(0,n.jsx)(o.h2,{id:"check-for-existing-links-before-creating-new-ones",children:"Check for existing links before creating new ones"}),"\n",(0,n.jsxs)(o.p,{children:["When linking a capability, the link might be already present.\nIn that case, Cadence will not panic with a runtime error but the link function will return nil.\nThe documentation states that: The link function does not check if the target path is valid/exists\nat the time the capability is created and does not check if the target value conforms to the given type.\nIn that sense, it is a good practice to check if the link does already exist with ",(0,n.jsx)(o.code,{children:"AuthAccount.getLinkTarget"}),"\nbefore creating it with ",(0,n.jsx)(o.code,{children:"AuthAccount.link()"}),".\n",(0,n.jsx)(o.code,{children:"AuthAccount.getLinkTarget"})," will return nil if the link does not exist."]}),"\n",(0,n.jsx)(o.h3,{id:"example-3",children:"Example"}),"\n",(0,n.jsx)(d.Code,{codeConfig:u,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"transaction ",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    prepare",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"signer",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" AuthAccount",props:{style:{color:"#D8DEE9FF"}}},{content:") {",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        // Create a public capability to the Vault that only exposes",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        // the deposit function through the Receiver interface",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        //",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        // Check to see if there is a link already and unlink it if there is",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        if",props:{style:{color:"#81A1C1"}}},{content:" signer.",props:{style:{color:"#D8DEE9FF"}}},{content:"getLinkTarget",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"public",props:{style:{color:"#D8DEE9FF"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"exampleTokenReceiver",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"!= nil ",props:{style:{color:"#81A1C1"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"            signer.",props:{style:{color:"#D8DEE9FF"}}},{content:"unlink",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"public",props:{style:{color:"#D8DEE9FF"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"exampleTokenReceiver",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        signer.link",props:{style:{color:"#D8DEE9FF"}}},{content:"<",props:{style:{color:"#81A1C1"}}},{content:"&ExampleToken.Vault",props:{style:{color:"#D8DEE9FF"}}},{content:">",props:{style:{color:"#81A1C1"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"            /",props:{style:{color:"#81A1C1"}}},{content:"public",props:{style:{color:"#D8DEE9FF"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"exampleTokenReceiver,",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"            target: ",props:{style:{color:"#D8DEE9FF"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"storage",props:{style:{color:"#D8DEE9FF"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"exampleTokenVault",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        )",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"}",props:{style:{color:"#ECEFF4"}}}]}],lang:"cadence"},annotations:[]}]})]})}const y=function(e){void 0===e&&(e={});const{wrapper:o}=Object.assign({},(0,r.ah)(),e.components);return o?(0,n.jsx)(o,Object.assign({},e,{children:(0,n.jsx)(g,e)})):g(e)};function h(e,o){throw new Error("Expected "+(o?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}}}]);