"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[2734],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>h});var a=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=a.createContext({}),c=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},p=function(e){var t=c(e.components);return a.createElement(l.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,l=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),u=c(n),m=o,h=u["".concat(l,".").concat(m)]||u[m]||d[m]||r;return n?a.createElement(h,s(s({ref:t},p),{},{components:n})):a.createElement(h,s({ref:t},p))}));function h(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,s=new Array(r);s[0]=m;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i[u]="string"==typeof e?e:o,s[1]=i;for(var c=2;c<r;c++)s[c]=n[c];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},98959:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>d,frontMatter:()=>r,metadata:()=>i,toc:()=>c});var a=n(87462),o=(n(67294),n(3905));const r={title:"Update",description:"Update modified contracts on the testnet",sidebar_title:"Update"},s=void 0,i={unversionedId:"1.Learn/Kitty-items/update",id:"1.Learn/Kitty-items/update",title:"Update",description:"Update modified contracts on the testnet",source:"@site/docs/1.Learn/Kitty-items/update.md",sourceDirName:"1.Learn/Kitty-items",slug:"/1.Learn/Kitty-items/update",permalink:"/1.Learn/Kitty-items/update",draft:!1,tags:[],version:"current",lastUpdatedBy:"Tom Haile",lastUpdatedAt:1682618007,formattedLastUpdatedAt:"Apr 27, 2023",frontMatter:{title:"Update",description:"Update modified contracts on the testnet",sidebar_title:"Update"},sidebar:"tutorialSidebar",previous:{title:"Start",permalink:"/1.Learn/Kitty-items/start"},next:{title:"Flow Playground",permalink:"/2.Try/flow-playground"}},l={},c=[{value:"Video Walkthrough",id:"video-walkthrough",level:2},{value:"Start on testnet",id:"start-on-testnet",level:2},{value:"Update contract on the testnet",id:"update-contract-on-the-testnet",level:3},{value:"Run the update transaction on the testnet",id:"run-the-update-transaction-on-the-testnet",level:2},{value:"Optional: Mint new sunglasses NFT on testnet",id:"optional-mint-new-sunglasses-nft-on-testnet",level:2}],p={toc:c},u="wrapper";function d(e){let{components:t,...n}=e;return(0,o.kt)(u,(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"In the ",(0,o.kt)("a",{parentName:"p",href:"/kitty-items/start/"},"first step")," of this tutorial, you started the project on the testnet. The script uploaded the initial contracts on the network for you."),(0,o.kt)("p",null,"Now that you implemented and tested your changes locally on the emulator, it is time to deploy your modified smart contracts to the testnet."),(0,o.kt)("h2",{id:"video-walkthrough"},"Video Walkthrough"),(0,o.kt)("iframe",{width:"100%",height:"450",src:"https://www.youtube.com/embed/v-r1Ucg8hHk",title:"YouTube video player",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:!0}),(0,o.kt)("h2",{id:"start-on-testnet"},"Start on testnet"),(0,o.kt)("p",null,"Run the project on the testnet again. The script will use the account you initially created:"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("strong",{parentName:"p"},"Important"),": You do not need to stop the previous process. By running the next command, existing services will be configured to communicate with the testnet instead of the emulator.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"npm run dev:testnet\n")),(0,o.kt)("p",null,"You will be asked if you want to use the existing account credentials. Enter ",(0,o.kt)("inlineCode",{parentName:"p"},"Y")," to continue:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"? Use existing testnet credentials in env.testnet ? (Y/n) Y\n")),(0,o.kt)("p",null,"Once all services are up and running, you will see the same logs you saw in the ",(0,o.kt)("a",{parentName:"p",href:"/kitty-items/start/"},"second step"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"\u2714 API server started\n\u2139 Kitty Items API is running at: http://localhost:3000\n\u2139 View log output: npx pm2 logs api\n\n\u2714 Storefront web app started\n\u2139 Kitty Items Web App is running at: http://localhost:3001\n\u2139 View log output: npx pm2 logs web\n\nKITTY ITEMS HAS STARTED\n\n\nVisit: http://localhost:3001\n\n\nView your account and transactions here:\nhttps://testnet.flowscan.org/account/0xa4c19ed9d691743c\n\nExplore your account here:\nhttps://flow-view-source.com/testnet/account/0xa4c19ed9d691743c\n\n? Would you like to view the logs for all processes? (Y/n)\n")),(0,o.kt)("p",null,"Open up the last link to explore your testnet account via flow-view-source. On the left side navigation, locate the Kitty Items contract."),(0,o.kt)("p",null,"Keep this page open - we will get back to it once we are done!"),(0,o.kt)("h3",{id:"update-contract-on-the-testnet"},"Update contract on the testnet"),(0,o.kt)("p",null,"Next, redeploy the contracts to the testnet by running the following command in your terminal, inside the root folder of your project:"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("strong",{parentName:"p"},"Note"),": You will notice that the previous script execution finished once all services successfully started. You do not need to stop the previous process. You can run the next command in the same terminal without impact on the services running in the background.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"npm run update:testnet\n")),(0,o.kt)("p",null,"The script will update the changed contract:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-sh"},"Deploying 1 contracts for accounts: testnet-account\n\nKittyItems -> 0x580b8132bc817403 (ba7f...bdc88)\n\n\u2728 All contracts deployed successfully\n")),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("strong",{parentName:"p"},"Note"),": You may notice that this time only one contract was updated. This is because the other 3 contracts were already deployed outside of this project.")),(0,o.kt)("p",null,"Go back to the flow-view-source page and refresh the contract view. Scroll down verify the changes you made to your contract. For instance, you should see ",(0,o.kt)("inlineCode",{parentName:"p"},"shades")," case in the ",(0,o.kt)("inlineCode",{parentName:"p"},"Kind")," enum."),(0,o.kt)("h2",{id:"run-the-update-transaction-on-the-testnet"},"Run the update transaction on the testnet"),(0,o.kt)("p",null,"Finally, run the following command to send the transaction to update the contract with the new ",(0,o.kt)("inlineCode",{parentName:"p"},"shades")," images on the testnet."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"npx dotenv -e .env.testnet -- flow transactions send --signer testnet-account ./cadence/transactions/kittyItems/add_nft_images_for_new_kind.cdc -f flow.json -f flow.testnet.json -n testnet\n")),(0,o.kt)("p",null,"You should see the following response. Take note of the Status - it should be ",(0,o.kt)("inlineCode",{parentName:"p"},"\u2705 SEALED"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"Transaction ID: 60f0271a0ab31173f577300a058d644f5752f1fea844bc1ec6c89eafc8708737\n\nStatus          \u2705 SEALED\nID              60f0271a0ab31173f577300a058d644f5752f1fea844bc1ec6c89eafc8708737\nPayer           36e0834a80d3a360\nAuthorizers     [36e0834a80d3a360]\n\nProposal Key:\n    Address     36e0834a80d3a360\n    Index       0\n    Sequence    5\n\nNo Payload Signatures\n\nEnvelope Signature 0: 36e0834a80d3a360\nSignatures (minimized, use --include signatures)\n\nEvents:\n    Index       0\n    Type        A.36e0834a80d3a360.KittyItems.ImagesAddedForNewKind\n    Tx ID       60f0271a0ab31173f577300a058d644f5752f1fea844bc1ec6c89eafc8708737\n    Values\n                - kind (UInt8): 5\n\n    Index       1\n    Type        A.7e60df042a9c0868.FlowToken.TokensWithdrawn\n    Tx ID       60f0271a0ab31173f577300a058d644f5752f1fea844bc1ec6c89eafc8708737\n    Values\n                - amount (UFix64): 0.00001000\n                - from (Address?): 0x36e0834a80d3a360\n\n    Index       2\n    Type        A.7e60df042a9c0868.FlowToken.TokensDeposited\n    Tx ID       60f0271a0ab31173f577300a058d644f5752f1fea844bc1ec6c89eafc8708737\n    Values\n                - amount (UFix64): 0.00001000\n                - to (Address?): 0x912d5440f7e3769e\n\n    Index       3\n    Type        A.912d5440f7e3769e.FlowFees.FeesDeducted\n    Tx ID       60f0271a0ab31173f577300a058d644f5752f1fea844bc1ec6c89eafc8708737\n    Values\n                - amount (UFix64): 0.00001000\n                - inclusionEffort (UFix64): 1.00000000\n                - executionEffort (UFix64): 0.00000012\n")),(0,o.kt)("p",null,"As indicated, the transaction was sealed and you are ready to mint your new KittyItems NFT on the testnet!"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"\ud83c\udf89 Congratulations on completing this tutorial! Because you made it to the very end, we're rewarding you with a unique ",(0,o.kt)("a",{parentName:"strong",href:"https://floats.city/andrea.find/event/198577460"},"FLOAT NFT"),"!")),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("strong",{parentName:"p"},"Important"),": To claim your NFT, open ",(0,o.kt)("a",{parentName:"p",href:"https://floats.city/andrea.find/event/198577460"},"this FLOAT event"),". You will be asked to connect a wallet. Once done, you need to enter a ",(0,o.kt)("strong",{parentName:"p"},"secret code"),". Open the ",(0,o.kt)("inlineCode",{parentName:"p"},"add_nft_images_for_new_kind.cdc")," file you created in ",(0,o.kt)("a",{parentName:"p",href:"/kitty-items/modify/#create-a-transaction-to-update-the-list-of-images-for-your-new-kind"},"this previous step"),". Locate the comment before ",(0,o.kt)("inlineCode",{parentName:"p"},"execute{}"),". Use this code to claim your NFT \ud83e\udd2b")),(0,o.kt)("p",null,"To summarize, you should now understand how to ..."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"deploy and update smart contracts"),(0,o.kt)("li",{parentName:"ul"},"mint and transfer NFTs"),(0,o.kt)("li",{parentName:"ul"},"add a new kind of NFT to the marketplace"),(0,o.kt)("li",{parentName:"ul"},"interact with the Flow blockchain from within a web application")),(0,o.kt)("h2",{id:"optional-mint-new-sunglasses-nft-on-testnet"},"Optional: Mint new sunglasses NFT on testnet"),(0,o.kt)("p",null,"To verify that everything works as expected, you can mint one of the new NFTs on the testnet."),(0,o.kt)("p",null,"Open the Kitty Items web application: ",(0,o.kt)("a",{parentName:"p",href:"http://localhost:3001/"},(0,o.kt)("inlineCode",{parentName:"a"},"http://localhost:3001/")),". This time, the ",(0,o.kt)("strong",{parentName:"p"},"web application is wired up to interact with testnet smart contracts")," you updated. Repeat ",(0,o.kt)("a",{parentName:"p",href:"/kitty-items/modify/#mint-new-sunglasses-nft"},"the instructions from the last step"),"."))}d.isMDXComponent=!0}}]);