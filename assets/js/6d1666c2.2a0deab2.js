"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[6569],{3905:(e,n,t)=>{t.d(n,{Zo:()=>c,kt:()=>g});var a=t(67294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function l(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?l(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)t=l[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)t=l[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var s=a.createContext({}),p=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},c=function(e){var n=p(e.components);return a.createElement(s.Provider,{value:n},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},m=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,l=e.originalType,s=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),u=p(t),m=r,g=u["".concat(s,".").concat(m)]||u[m]||d[m]||l;return t?a.createElement(g,o(o({ref:n},c),{},{components:t})):a.createElement(g,o({ref:n},c))}));function g(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var l=t.length,o=new Array(l);o[0]=m;var i={};for(var s in n)hasOwnProperty.call(n,s)&&(i[s]=n[s]);i.originalType=e,i[u]="string"==typeof e?e:r,o[1]=i;for(var p=2;p<l;p++)o[p]=t[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,t)}m.displayName="MDXCreateElement"},42770:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>o,default:()=>d,frontMatter:()=>l,metadata:()=>i,toc:()=>p});var a=t(87462),r=(t(67294),t(3905));const l={title:"Send Complex Transaction with the Flow CLI",sidebar_title:"Build a Complex Transaction",description:"How to build and send a complex Flow transaction from the command line"},o=void 0,i={unversionedId:"Tooling/flow-cli/complex-transactions",id:"Tooling/flow-cli/complex-transactions",title:"Send Complex Transaction with the Flow CLI",description:"How to build and send a complex Flow transaction from the command line",source:"@site/docs/Tooling/flow-cli/complex-transactions.md",sourceDirName:"Tooling/flow-cli",slug:"/Tooling/flow-cli/complex-transactions",permalink:"/docs/Tooling/flow-cli/complex-transactions",draft:!1,tags:[],version:"current",lastUpdatedBy:"Alex",lastUpdatedAt:1683062072,formattedLastUpdatedAt:"May 2, 2023",frontMatter:{title:"Send Complex Transaction with the Flow CLI",sidebar_title:"Build a Complex Transaction",description:"How to build and send a complex Flow transaction from the command line"},sidebar:"tutorialSidebar",previous:{title:"Build a Transaction with the Flow CLI",permalink:"/docs/Tooling/flow-cli/build-transactions"},next:{title:"Flow CLI Configuration",permalink:"/docs/Tooling/flow-cli/configuration"}},s={},p=[{value:"Examples",id:"examples",level:2},{value:"Single payer, proposer and authorizer",id:"single-payer-proposer-and-authorizer",level:3},{value:"Single payer and proposer, multiple authorizers",id:"single-payer-and-proposer-multiple-authorizers",level:3},{value:"Different payer, proposer and authorizer",id:"different-payer-proposer-and-authorizer",level:3},{value:"Single payer, proposer and authorizer but multiple keys",id:"single-payer-proposer-and-authorizer-but-multiple-keys",level:3},{value:"Configuration",id:"configuration",level:3}],c={toc:p},u="wrapper";function d(e){let{components:n,...t}=e;return(0,r.kt)(u,(0,a.Z)({},c,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Simple Transactions")),(0,r.kt)("p",null,"Sending a transaction using the Flow CLI can simply be\nachieved by using the ",(0,r.kt)("a",{parentName:"p",href:"/tools/flow-cli/send-transactions"},"send command documented here"),"."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Complex Transactions")),(0,r.kt)("p",null,"If you would like to build more complex transactions the Flow CLI provides\ncommands to build, sign and send transactions allowing you to specify different\nauthorizers, signers and proposers.  "),(0,r.kt)("p",null,"The process of sending a complex transactions includes three steps:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("a",{parentName:"li",href:"/tools/flow-cli/build-transactions"},"build a transaction")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("a",{parentName:"li",href:"/tools/flow-cli/sign-transaction"},"sign the built transaction")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("a",{parentName:"li",href:"/tools/flow-cli/send-signed-transactions"},"send signed transaction"))),(0,r.kt)("p",null,"Read more about each command flags and arguments in the above links."),(0,r.kt)("h2",{id:"examples"},"Examples"),(0,r.kt)("p",null,"We will describe common examples for complex transactions. All examples are using an ",(0,r.kt)("a",{parentName:"p",href:"/tools/flow-cli/complex-transactions#configuration"},"example configuration"),"."),(0,r.kt)("h3",{id:"single-payer-proposer-and-authorizer"},"Single payer, proposer and authorizer"),(0,r.kt)("p",null,"The simplest Flow transaction declares a single account as the proposer, payer and authorizer."),(0,r.kt)("p",null,"Build the transaction:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"> flow transactions build tx.cdc \n  --proposer alice \n  --payer alice \n  --authorizer alice \n  --filter payload --save tx1\n")),(0,r.kt)("p",null,"Sign the transaction:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"> flow transactions sign tx1 --signer alice \n  --filter payload --save tx2\n")),(0,r.kt)("p",null,"Submit the signed transaction:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"> flow transactions send-signed tx2\n")),(0,r.kt)("p",null,"Transaction content (",(0,r.kt)("inlineCode",{parentName:"p"},"tx.cdc"),"):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"transaction {\n    prepare(signer: AuthAccount) {}\n    execute { ... }\n}\n")),(0,r.kt)("h3",{id:"single-payer-and-proposer-multiple-authorizers"},"Single payer and proposer, multiple authorizers"),(0,r.kt)("p",null,"A transaction that declares same payer and proposer but multiple authorizers each required to sign the transaction. Please note that the order of signing is important, and ",(0,r.kt)("a",{parentName:"p",href:"https://docs.onflow.org/concepts/transaction-signing/#payer-signs-last"},"the payer must sign last"),"."),(0,r.kt)("p",null,"Build the transaction:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"> flow transactions build tx.cdc \n  --proposer alice\n  --payer alice\n  --authorizer bob\n  --authorizer charlie \n  --filter payload --save tx1\n")),(0,r.kt)("p",null,"Sign the transaction with authorizers:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"> flow transactions sign tx1 --signer bob\n  --filter payload --save tx2\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"> flow transactions sign tx2 --signer charlie\n  --filter payload --save tx3\n")),(0,r.kt)("p",null,"Sign the transaction with payer:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"> flow transactions sign tx3 --signer alice\n  --filter payload --save tx4\n")),(0,r.kt)("p",null,"Submit the signed transaction:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"> flow transactions send-signed tx4\n")),(0,r.kt)("p",null,"Transaction content (",(0,r.kt)("inlineCode",{parentName:"p"},"tx.cdc"),"):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"transaction {\n    prepare(bob: AuthAccount, charlie: AuthAccount) {}\n    execute { ... }\n}\n")),(0,r.kt)("h3",{id:"different-payer-proposer-and-authorizer"},"Different payer, proposer and authorizer"),(0,r.kt)("p",null,"A transaction that declares different payer, proposer and authorizer each signing separately.\nPlease note that the order of signing is important, and ",(0,r.kt)("a",{parentName:"p",href:"https://docs.onflow.org/concepts/transaction-signing/#payer-signs-last"},"the payer must sign last"),".  "),(0,r.kt)("p",null,"Build the transaction:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"> flow transactions build tx.cdc \n  --proposer alice \n  --payer bob \n  --authorizer charlie \n  --filter payload --save tx1\n")),(0,r.kt)("p",null,"Sign the transaction with proposer:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"> flow transactions sign tx1 --signer alice \n  --filter payload --save tx2\n")),(0,r.kt)("p",null,"Sign the transaction with authorizer:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"> flow transactions sign tx2 --signer charlie \n  --filter payload --save tx3\n")),(0,r.kt)("p",null,"Sign the transaction with payer:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"> flow transactions sign tx3 --signer bob \n  --filter payload --save tx4\n")),(0,r.kt)("p",null,"Submit the signed transaction:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"> flow transactions send-signed tx4\n")),(0,r.kt)("p",null,"Transaction content (",(0,r.kt)("inlineCode",{parentName:"p"},"tx.cdc"),"):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"transaction {\n    prepare(charlie: AuthAccount) {}\n    execute { ... }\n}\n")),(0,r.kt)("h3",{id:"single-payer-proposer-and-authorizer-but-multiple-keys"},"Single payer, proposer and authorizer but multiple keys"),(0,r.kt)("p",null,"A transaction that declares same payer, proposer and authorizer but the signer account has two keys with half weight, required to sign with both."),(0,r.kt)("p",null,"Build the transaction:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"> flow transactions build tx.cdc \n  --proposer dylan1 \n  --payer dylan1\n  --authorizer dylan1 \n  --filter payload --save tx1\n")),(0,r.kt)("p",null,"Sign the transaction with the first key:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"> flow transactions sign tx1 --signer dylan1 \n  --filter payload --save tx2\n")),(0,r.kt)("p",null,"Sign the transaction with the second key:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"> flow transactions sign tx2 --signer dylan2 \n  --filter payload --save tx3\n")),(0,r.kt)("p",null,"Submit the signed transaction:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"> flow transactions send-signed tx3\n")),(0,r.kt)("p",null,"Transaction content (",(0,r.kt)("inlineCode",{parentName:"p"},"tx.cdc"),"):"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"transaction {\n    prepare(signer: AuthAccount) {}\n    execute { ... }\n}\n")),(0,r.kt)("h3",{id:"configuration"},"Configuration"),(0,r.kt)("p",null,"This is an example configuration using mock values:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n    ... \n    "accounts": {\n        "alice": {\n            "address": "0x1",\n            "key": "111...111"\n        },\n        "bob": {\n            "address": "0x2",\n            "key": "222...222"\n        },\n        "charlie": {\n            "address": "0x3",\n            "key": "333...333"\n        },\n        "dylan1": {\n            "address": "0x4",\n            "key": "444...444"\n        },\n        "dylan2": {\n            "address": "0x4",\n            "key": "555...555"\n        }\n    }\n    ...\n}\n')))}d.isMDXComponent=!0}}]);