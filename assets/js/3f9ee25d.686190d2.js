"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[1947],{92277:(o,t,e)=>{e.r(t),e.d(t,{CH:()=>E,assets:()=>a,chCodeConfig:()=>y,contentTitle:()=>l,default:()=>d,frontMatter:()=>c,metadata:()=>p,toc:()=>i});e(67294);var n=e(85893),r=e(11151),s=e(59794);const c={title:"8. Marketplace"},l=void 0,p={unversionedId:"cadence/tutorial/marketplace-compose",id:"cadence/tutorial/marketplace-compose",title:"8. Marketplace",description:"In this tutorial, we're going to create a marketplace that uses both the fungible",source:"@site/docs/cadence/tutorial/08-marketplace-compose.mdx",sourceDirName:"cadence/tutorial",slug:"/cadence/tutorial/marketplace-compose",permalink:"/docs/next/cadence/tutorial/marketplace-compose",draft:!1,editUrl:"https://github.com/onflow/docs/tree/main/docs/cadence/tutorial/08-marketplace-compose.mdx",tags:[],version:"current",lastUpdatedBy:"Bastian M\xfcller",lastUpdatedAt:1694626417,formattedLastUpdatedAt:"Sep 13, 2023",sidebarPosition:8,frontMatter:{title:"8. Marketplace"},sidebar:"cadence",previous:{title:"7. Marketplace Setup",permalink:"/docs/next/cadence/tutorial/marketplace-setup"},next:{title:"9. Voting Contract",permalink:"/docs/next/cadence/tutorial/voting"}},a={},i=[{value:"Marketplace Design",id:"marketplace-design",level:2},{value:"Setting up an NFT <strong>Marketplace</strong>",id:"setting-up-an-nft-marketplace",level:2},{value:"Events",id:"events",level:3},{value:"Resource-Owned Capabilities",id:"resource-owned-capabilities",level:3},{value:"Using the Marketplace",id:"using-the-marketplace",level:2},{value:"Purchasing an NFT",id:"purchasing-an-nft",level:2},{value:"Verifying the NFT Was Purchased Correctly",id:"verifying-the-nft-was-purchased-correctly",level:2},{value:"Scaling the Marketplace",id:"scaling-the-marketplace",level:2},{value:"Creating a <strong>Marketplace for Any Generic NFT</strong>",id:"creating-a-marketplace-for-any-generic-nft",level:2},{value:"Composable Resources on Flow",id:"composable-resources-on-flow",level:2}],E={annotations:s.ds,Code:s.EK},y={staticMediaQuery:"not screen, (max-width: 768px)",theme:{name:"nord",type:"dark",semanticHighlighting:!0,colors:{focusBorder:"#3b4252",foreground:"#d8dee9","activityBar.background":"#2e3440","activityBar.dropBackground":"#3b4252","activityBar.foreground":"#d8dee9","activityBar.activeBorder":"#88c0d0","activityBar.activeBackground":"#3b4252","activityBarBadge.background":"#88c0d0","activityBarBadge.foreground":"#2e3440","badge.foreground":"#2e3440","badge.background":"#88c0d0","button.background":"#88c0d0ee","button.foreground":"#2e3440","button.hoverBackground":"#88c0d0","button.secondaryBackground":"#434c5e","button.secondaryForeground":"#d8dee9","button.secondaryHoverBackground":"#4c566a","charts.red":"#bf616a","charts.blue":"#81a1c1","charts.yellow":"#ebcb8b","charts.orange":"#d08770","charts.green":"#a3be8c","charts.purple":"#b48ead","charts.foreground":"#d8dee9","charts.lines":"#88c0d0","debugConsole.infoForeground":"#88c0d0","debugConsole.warningForeground":"#ebcb8b","debugConsole.errorForeground":"#bf616a","debugConsole.sourceForeground":"#616e88","debugConsoleInputIcon.foreground":"#81a1c1","debugExceptionWidget.background":"#4c566a","debugExceptionWidget.border":"#2e3440","debugToolBar.background":"#3b4252",descriptionForeground:"#d8dee9e6","diffEditor.insertedTextBackground":"#81a1c133","diffEditor.removedTextBackground":"#bf616a4d","dropdown.background":"#3b4252","dropdown.border":"#3b4252","dropdown.foreground":"#d8dee9","editorActiveLineNumber.foreground":"#d8dee9cc","editorCursor.foreground":"#d8dee9","editorHint.border":"#ebcb8b00","editorHint.foreground":"#ebcb8b","editorIndentGuide.background":"#434c5eb3","editorIndentGuide.activeBackground":"#4c566a","editorInlayHint.background":"#434c5e","editorInlayHint.foreground":"#d8dee9","editorLineNumber.foreground":"#4c566a","editorLineNumber.activeForeground":"#d8dee9","editorWhitespace.foreground":"#4c566ab3","editorWidget.background":"#2e3440","editorWidget.border":"#3b4252","editor.background":"#2e3440","editor.foreground":"#d8dee9","editor.hoverHighlightBackground":"#3b4252","editor.findMatchBackground":"#88c0d066","editor.findMatchHighlightBackground":"#88c0d033","editor.findRangeHighlightBackground":"#88c0d033","editor.lineHighlightBackground":"#3b4252","editor.lineHighlightBorder":"#3b4252","editor.inactiveSelectionBackground":"#434c5ecc","editor.inlineValuesBackground":"#4c566a","editor.inlineValuesForeground":"#eceff4","editor.selectionBackground":"#434c5ecc","editor.selectionHighlightBackground":"#434c5ecc","editor.rangeHighlightBackground":"#434c5e52","editor.wordHighlightBackground":"#81a1c166","editor.wordHighlightStrongBackground":"#81a1c199","editor.stackFrameHighlightBackground":"#5e81ac","editor.focusedStackFrameHighlightBackground":"#5e81ac","editorError.foreground":"#bf616a","editorError.border":"#bf616a00","editorWarning.foreground":"#ebcb8b","editorWarning.border":"#ebcb8b00","editorBracketMatch.background":"#2e344000","editorBracketMatch.border":"#88c0d0","editorBracketHighlight.foreground1":"#8fbcbb","editorBracketHighlight.foreground2":"#88c0d0","editorBracketHighlight.foreground3":"#81a1c1","editorBracketHighlight.foreground4":"#5e81ac","editorBracketHighlight.foreground5":"#8fbcbb","editorBracketHighlight.foreground6":"#88c0d0","editorBracketHighlight.unexpectedBracket.foreground":"#bf616a","editorCodeLens.foreground":"#4c566a","editorGroup.background":"#2e3440","editorGroup.border":"#3b425201","editorGroup.dropBackground":"#3b425299","editorGroupHeader.border":"#3b425200","editorGroupHeader.noTabsBackground":"#2e3440","editorGroupHeader.tabsBackground":"#2e3440","editorGroupHeader.tabsBorder":"#3b425200","editorGutter.background":"#2e3440","editorGutter.modifiedBackground":"#ebcb8b","editorGutter.addedBackground":"#a3be8c","editorGutter.deletedBackground":"#bf616a","editorHoverWidget.background":"#3b4252","editorHoverWidget.border":"#3b4252","editorLink.activeForeground":"#88c0d0","editorMarkerNavigation.background":"#5e81acc0","editorMarkerNavigationError.background":"#bf616ac0","editorMarkerNavigationWarning.background":"#ebcb8bc0","editorOverviewRuler.border":"#3b4252","editorOverviewRuler.currentContentForeground":"#3b4252","editorOverviewRuler.incomingContentForeground":"#3b4252","editorOverviewRuler.findMatchForeground":"#88c0d066","editorOverviewRuler.rangeHighlightForeground":"#88c0d066","editorOverviewRuler.selectionHighlightForeground":"#88c0d066","editorOverviewRuler.wordHighlightForeground":"#88c0d066","editorOverviewRuler.wordHighlightStrongForeground":"#88c0d066","editorOverviewRuler.modifiedForeground":"#ebcb8b","editorOverviewRuler.addedForeground":"#a3be8c","editorOverviewRuler.deletedForeground":"#bf616a","editorOverviewRuler.errorForeground":"#bf616a","editorOverviewRuler.warningForeground":"#ebcb8b","editorOverviewRuler.infoForeground":"#81a1c1","editorRuler.foreground":"#434c5e","editorSuggestWidget.background":"#2e3440","editorSuggestWidget.border":"#3b4252","editorSuggestWidget.foreground":"#d8dee9","editorSuggestWidget.focusHighlightForeground":"#88c0d0","editorSuggestWidget.highlightForeground":"#88c0d0","editorSuggestWidget.selectedBackground":"#434c5e","editorSuggestWidget.selectedForeground":"#d8dee9","extensionButton.prominentForeground":"#d8dee9","extensionButton.prominentBackground":"#434c5e","extensionButton.prominentHoverBackground":"#4c566a",errorForeground:"#bf616a","gitDecoration.modifiedResourceForeground":"#ebcb8b","gitDecoration.deletedResourceForeground":"#bf616a","gitDecoration.untrackedResourceForeground":"#a3be8c","gitDecoration.ignoredResourceForeground":"#d8dee966","gitDecoration.conflictingResourceForeground":"#5e81ac","gitDecoration.submoduleResourceForeground":"#8fbcbb","gitDecoration.stageDeletedResourceForeground":"#bf616a","gitDecoration.stageModifiedResourceForeground":"#ebcb8b","input.background":"#3b4252","input.foreground":"#d8dee9","input.placeholderForeground":"#d8dee999","input.border":"#3b4252","inputOption.activeBackground":"#5e81ac","inputOption.activeBorder":"#5e81ac","inputOption.activeForeground":"#eceff4","inputValidation.errorBackground":"#bf616a","inputValidation.errorBorder":"#bf616a","inputValidation.infoBackground":"#81a1c1","inputValidation.infoBorder":"#81a1c1","inputValidation.warningBackground":"#d08770","inputValidation.warningBorder":"#d08770","keybindingLabel.background":"#4c566a","keybindingLabel.border":"#4c566a","keybindingLabel.bottomBorder":"#4c566a","keybindingLabel.foreground":"#d8dee9","list.activeSelectionBackground":"#88c0d0","list.activeSelectionForeground":"#2e3440","list.inactiveSelectionBackground":"#434c5e","list.inactiveSelectionForeground":"#d8dee9","list.inactiveFocusBackground":"#434c5ecc","list.hoverForeground":"#eceff4","list.focusForeground":"#d8dee9","list.focusBackground":"#88c0d099","list.focusHighlightForeground":"#eceff4","list.hoverBackground":"#3b4252","list.dropBackground":"#88c0d099","list.highlightForeground":"#88c0d0","list.errorForeground":"#bf616a","list.warningForeground":"#ebcb8b","merge.currentHeaderBackground":"#81a1c166","merge.currentContentBackground":"#81a1c14d","merge.incomingHeaderBackground":"#8fbcbb66","merge.incomingContentBackground":"#8fbcbb4d","merge.border":"#3b425200","minimap.background":"#2e3440","minimap.errorHighlight":"#bf616acc","minimap.findMatchHighlight":"#88c0d0","minimap.selectionHighlight":"#88c0d0cc","minimap.warningHighlight":"#ebcb8bcc","minimapGutter.addedBackground":"#a3be8c","minimapGutter.deletedBackground":"#bf616a","minimapGutter.modifiedBackground":"#ebcb8b","minimapSlider.activeBackground":"#434c5eaa","minimapSlider.background":"#434c5e99","minimapSlider.hoverBackground":"#434c5eaa","notification.background":"#3b4252","notification.buttonBackground":"#434c5e","notification.buttonForeground":"#d8dee9","notification.buttonHoverBackground":"#4c566a","notification.errorBackground":"#bf616a","notification.errorForeground":"#2e3440","notification.foreground":"#d8dee9","notification.infoBackground":"#88c0d0","notification.infoForeground":"#2e3440","notification.warningBackground":"#ebcb8b","notification.warningForeground":"#2e3440","notificationCenter.border":"#3b425200","notificationCenterHeader.background":"#2e3440","notificationCenterHeader.foreground":"#88c0d0","notificationLink.foreground":"#88c0d0","notifications.background":"#3b4252","notifications.border":"#2e3440","notifications.foreground":"#d8dee9","notificationToast.border":"#3b425200","panel.background":"#2e3440","panel.border":"#3b4252","panelTitle.activeBorder":"#88c0d000","panelTitle.activeForeground":"#88c0d0","panelTitle.inactiveForeground":"#d8dee9","peekView.border":"#4c566a","peekViewEditor.background":"#2e3440","peekViewEditorGutter.background":"#2e3440","peekViewEditor.matchHighlightBackground":"#88c0d04d","peekViewResult.background":"#2e3440","peekViewResult.fileForeground":"#88c0d0","peekViewResult.lineForeground":"#d8dee966","peekViewResult.matchHighlightBackground":"#88c0d0cc","peekViewResult.selectionBackground":"#434c5e","peekViewResult.selectionForeground":"#d8dee9","peekViewTitle.background":"#3b4252","peekViewTitleDescription.foreground":"#d8dee9","peekViewTitleLabel.foreground":"#88c0d0","pickerGroup.border":"#3b4252","pickerGroup.foreground":"#88c0d0","progressBar.background":"#88c0d0","quickInputList.focusBackground":"#88c0d0","quickInputList.focusForeground":"#2e3440","sash.hoverBorder":"#88c0d0","scrollbar.shadow":"#00000066","scrollbarSlider.activeBackground":"#434c5eaa","scrollbarSlider.background":"#434c5e99","scrollbarSlider.hoverBackground":"#434c5eaa","selection.background":"#88c0d099","sideBar.background":"#2e3440","sideBar.foreground":"#d8dee9","sideBar.border":"#3b4252","sideBarSectionHeader.background":"#3b4252","sideBarSectionHeader.foreground":"#d8dee9","sideBarTitle.foreground":"#d8dee9","statusBar.background":"#3b4252","statusBar.debuggingBackground":"#5e81ac","statusBar.debuggingForeground":"#d8dee9","statusBar.noFolderForeground":"#d8dee9","statusBar.noFolderBackground":"#3b4252","statusBar.foreground":"#d8dee9","statusBarItem.activeBackground":"#4c566a","statusBarItem.hoverBackground":"#434c5e","statusBarItem.prominentBackground":"#3b4252","statusBarItem.prominentHoverBackground":"#434c5e","statusBarItem.errorBackground":"#3b4252","statusBarItem.errorForeground":"#bf616a","statusBarItem.warningBackground":"#ebcb8b","statusBarItem.warningForeground":"#2e3440","statusBar.border":"#3b425200","tab.activeBackground":"#3b4252","tab.activeForeground":"#d8dee9","tab.border":"#3b425200","tab.activeBorder":"#88c0d000","tab.unfocusedActiveBorder":"#88c0d000","tab.inactiveBackground":"#2e3440","tab.inactiveForeground":"#d8dee966","tab.unfocusedActiveForeground":"#d8dee999","tab.unfocusedInactiveForeground":"#d8dee966","tab.hoverBackground":"#3b4252cc","tab.unfocusedHoverBackground":"#3b4252b3","tab.hoverBorder":"#88c0d000","tab.unfocusedHoverBorder":"#88c0d000","tab.activeBorderTop":"#88c0d000","tab.unfocusedActiveBorderTop":"#88c0d000","tab.lastPinnedBorder":"#4c566a","terminal.background":"#2e3440","terminal.foreground":"#d8dee9","terminal.ansiBlack":"#3b4252","terminal.ansiRed":"#bf616a","terminal.ansiGreen":"#a3be8c","terminal.ansiYellow":"#ebcb8b","terminal.ansiBlue":"#81a1c1","terminal.ansiMagenta":"#b48ead","terminal.ansiCyan":"#88c0d0","terminal.ansiWhite":"#e5e9f0","terminal.ansiBrightBlack":"#4c566a","terminal.ansiBrightRed":"#bf616a","terminal.ansiBrightGreen":"#a3be8c","terminal.ansiBrightYellow":"#ebcb8b","terminal.ansiBrightBlue":"#81a1c1","terminal.ansiBrightMagenta":"#b48ead","terminal.ansiBrightCyan":"#8fbcbb","terminal.ansiBrightWhite":"#eceff4","terminal.tab.activeBorder":"#88c0d0","textBlockQuote.background":"#3b4252","textBlockQuote.border":"#81a1c1","textCodeBlock.background":"#4c566a","textLink.activeForeground":"#88c0d0","textLink.foreground":"#88c0d0","textPreformat.foreground":"#8fbcbb","textSeparator.foreground":"#eceff4","titleBar.activeBackground":"#2e3440","titleBar.activeForeground":"#d8dee9","titleBar.border":"#2e344000","titleBar.inactiveBackground":"#2e3440","titleBar.inactiveForeground":"#d8dee966","tree.indentGuidesStroke":"#616e88","walkThrough.embeddedEditorBackground":"#2e3440","welcomePage.buttonBackground":"#434c5e","welcomePage.buttonHoverBackground":"#4c566a","widget.shadow":"#00000066"},tokenColors:[{settings:{foreground:"#d8dee9ff",background:"#2e3440ff"}},{scope:"emphasis",settings:{fontStyle:"italic"}},{scope:"strong",settings:{fontStyle:"bold"}},{name:"Comment",scope:"comment",settings:{foreground:"#616E88"}},{name:"Constant Character",scope:"constant.character",settings:{foreground:"#EBCB8B"}},{name:"Constant Character Escape",scope:"constant.character.escape",settings:{foreground:"#EBCB8B"}},{name:"Constant Language",scope:"constant.language",settings:{foreground:"#81A1C1"}},{name:"Constant Numeric",scope:"constant.numeric",settings:{foreground:"#B48EAD"}},{name:"Constant Regexp",scope:"constant.regexp",settings:{foreground:"#EBCB8B"}},{name:"Entity Name Class/Type",scope:["entity.name.class","entity.name.type.class"],settings:{foreground:"#8FBCBB"}},{name:"Entity Name Function",scope:"entity.name.function",settings:{foreground:"#88C0D0"}},{name:"Entity Name Tag",scope:"entity.name.tag",settings:{foreground:"#81A1C1"}},{name:"Entity Other Attribute Name",scope:"entity.other.attribute-name",settings:{foreground:"#8FBCBB"}},{name:"Entity Other Inherited Class",scope:"entity.other.inherited-class",settings:{fontStyle:"bold",foreground:"#8FBCBB"}},{name:"Invalid Deprecated",scope:"invalid.deprecated",settings:{foreground:"#D8DEE9",background:"#EBCB8B"}},{name:"Invalid Illegal",scope:"invalid.illegal",settings:{foreground:"#D8DEE9",background:"#BF616A"}},{name:"Keyword",scope:"keyword",settings:{foreground:"#81A1C1"}},{name:"Keyword Operator",scope:"keyword.operator",settings:{foreground:"#81A1C1"}},{name:"Keyword Other New",scope:"keyword.other.new",settings:{foreground:"#81A1C1"}},{name:"Markup Bold",scope:"markup.bold",settings:{fontStyle:"bold"}},{name:"Markup Changed",scope:"markup.changed",settings:{foreground:"#EBCB8B"}},{name:"Markup Deleted",scope:"markup.deleted",settings:{foreground:"#BF616A"}},{name:"Markup Inserted",scope:"markup.inserted",settings:{foreground:"#A3BE8C"}},{name:"Meta Preprocessor",scope:"meta.preprocessor",settings:{foreground:"#5E81AC"}},{name:"Punctuation",scope:"punctuation",settings:{foreground:"#ECEFF4"}},{name:"Punctuation Definition Parameters",scope:["punctuation.definition.method-parameters","punctuation.definition.function-parameters","punctuation.definition.parameters"],settings:{foreground:"#ECEFF4"}},{name:"Punctuation Definition Tag",scope:"punctuation.definition.tag",settings:{foreground:"#81A1C1"}},{name:"Punctuation Definition Comment",scope:["punctuation.definition.comment","punctuation.end.definition.comment","punctuation.start.definition.comment"],settings:{foreground:"#616E88"}},{name:"Punctuation Section",scope:"punctuation.section",settings:{foreground:"#ECEFF4"}},{name:"Punctuation Section Embedded",scope:["punctuation.section.embedded.begin","punctuation.section.embedded.end"],settings:{foreground:"#81A1C1"}},{name:"Punctuation Terminator",scope:"punctuation.terminator",settings:{foreground:"#81A1C1"}},{name:"Punctuation Variable",scope:"punctuation.definition.variable",settings:{foreground:"#81A1C1"}},{name:"Storage",scope:"storage",settings:{foreground:"#81A1C1"}},{name:"String",scope:"string",settings:{foreground:"#A3BE8C"}},{name:"String Regexp",scope:"string.regexp",settings:{foreground:"#EBCB8B"}},{name:"Support Class",scope:"support.class",settings:{foreground:"#8FBCBB"}},{name:"Support Constant",scope:"support.constant",settings:{foreground:"#81A1C1"}},{name:"Support Function",scope:"support.function",settings:{foreground:"#88C0D0"}},{name:"Support Function Construct",scope:"support.function.construct",settings:{foreground:"#81A1C1"}},{name:"Support Type",scope:"support.type",settings:{foreground:"#8FBCBB"}},{name:"Support Type Exception",scope:"support.type.exception",settings:{foreground:"#8FBCBB"}},{name:"Token Debug",scope:"token.debug-token",settings:{foreground:"#b48ead"}},{name:"Token Error",scope:"token.error-token",settings:{foreground:"#bf616a"}},{name:"Token Info",scope:"token.info-token",settings:{foreground:"#88c0d0"}},{name:"Token Warning",scope:"token.warn-token",settings:{foreground:"#ebcb8b"}},{name:"Variable",scope:"variable.other",settings:{foreground:"#D8DEE9"}},{name:"Variable Language",scope:"variable.language",settings:{foreground:"#81A1C1"}},{name:"Variable Parameter",scope:"variable.parameter",settings:{foreground:"#D8DEE9"}},{name:"[C/CPP] Punctuation Separator Pointer-Access",scope:"punctuation.separator.pointer-access.c",settings:{foreground:"#81A1C1"}},{name:"[C/CPP] Meta Preprocessor Include",scope:["source.c meta.preprocessor.include","source.c string.quoted.other.lt-gt.include"],settings:{foreground:"#8FBCBB"}},{name:"[C/CPP] Conditional Directive",scope:["source.cpp keyword.control.directive.conditional","source.cpp punctuation.definition.directive","source.c keyword.control.directive.conditional","source.c punctuation.definition.directive"],settings:{foreground:"#5E81AC",fontStyle:"bold"}},{name:"[CSS] Constant Other Color RGB Value",scope:"source.css constant.other.color.rgb-value",settings:{foreground:"#B48EAD"}},{name:"[CSS](Function) Meta Property-Value",scope:"source.css meta.property-value",settings:{foreground:"#88C0D0"}},{name:"[CSS] Media Queries",scope:["source.css keyword.control.at-rule.media","source.css keyword.control.at-rule.media punctuation.definition.keyword"],settings:{foreground:"#D08770"}},{name:"[CSS] Punctuation Definition Keyword",scope:"source.css punctuation.definition.keyword",settings:{foreground:"#81A1C1"}},{name:"[CSS] Support Type Property Name",scope:"source.css support.type.property-name",settings:{foreground:"#D8DEE9"}},{name:"[diff] Meta Range Context",scope:"source.diff meta.diff.range.context",settings:{foreground:"#8FBCBB"}},{name:"[diff] Meta Header From-File",scope:"source.diff meta.diff.header.from-file",settings:{foreground:"#8FBCBB"}},{name:"[diff] Punctuation Definition From-File",scope:"source.diff punctuation.definition.from-file",settings:{foreground:"#8FBCBB"}},{name:"[diff] Punctuation Definition Range",scope:"source.diff punctuation.definition.range",settings:{foreground:"#8FBCBB"}},{name:"[diff] Punctuation Definition Separator",scope:"source.diff punctuation.definition.separator",settings:{foreground:"#81A1C1"}},{name:"[Elixir](JakeBecker.elixir-ls) module names",scope:"entity.name.type.module.elixir",settings:{foreground:"#8FBCBB"}},{name:"[Elixir](JakeBecker.elixir-ls) module attributes",scope:"variable.other.readwrite.module.elixir",settings:{foreground:"#D8DEE9",fontStyle:"bold"}},{name:"[Elixir](JakeBecker.elixir-ls) atoms",scope:"constant.other.symbol.elixir",settings:{foreground:"#D8DEE9",fontStyle:"bold"}},{name:"[Elixir](JakeBecker.elixir-ls) modules",scope:"variable.other.constant.elixir",settings:{foreground:"#8FBCBB"}},{name:"[Go] String Format Placeholder",scope:"source.go constant.other.placeholder.go",settings:{foreground:"#EBCB8B"}},{name:"[Java](JavaDoc) Comment Block Documentation HTML Entities",scope:"source.java comment.block.documentation.javadoc punctuation.definition.entity.html",settings:{foreground:"#81A1C1"}},{name:"[Java](JavaDoc) Constant Other",scope:"source.java constant.other",settings:{foreground:"#D8DEE9"}},{name:"[Java](JavaDoc) Keyword Other Documentation",scope:"source.java keyword.other.documentation",settings:{foreground:"#8FBCBB"}},{name:"[Java](JavaDoc) Keyword Other Documentation Author",scope:"source.java keyword.other.documentation.author.javadoc",settings:{foreground:"#8FBCBB"}},{name:"[Java](JavaDoc) Keyword Other Documentation Directive/Custom",scope:["source.java keyword.other.documentation.directive","source.java keyword.other.documentation.custom"],settings:{foreground:"#8FBCBB"}},{name:"[Java](JavaDoc) Keyword Other Documentation See",scope:"source.java keyword.other.documentation.see.javadoc",settings:{foreground:"#8FBCBB"}},{name:"[Java] Meta Method-Call",scope:"source.java meta.method-call meta.method",settings:{foreground:"#88C0D0"}},{name:"[Java](JavaDoc) Meta Tag Template Link",scope:["source.java meta.tag.template.link.javadoc","source.java string.other.link.title.javadoc"],settings:{foreground:"#8FBCBB"}},{name:"[Java](JavaDoc) Meta Tag Template Value",scope:"source.java meta.tag.template.value.javadoc",settings:{foreground:"#88C0D0"}},{name:"[Java](JavaDoc) Punctuation Definition Keyword",scope:"source.java punctuation.definition.keyword.javadoc",settings:{foreground:"#8FBCBB"}},{name:"[Java](JavaDoc) Punctuation Definition Tag",scope:["source.java punctuation.definition.tag.begin.javadoc","source.java punctuation.definition.tag.end.javadoc"],settings:{foreground:"#616E88"}},{name:"[Java] Storage Modifier Import",scope:"source.java storage.modifier.import",settings:{foreground:"#8FBCBB"}},{name:"[Java] Storage Modifier Package",scope:"source.java storage.modifier.package",settings:{foreground:"#8FBCBB"}},{name:"[Java] Storage Type",scope:"source.java storage.type",settings:{foreground:"#8FBCBB"}},{name:"[Java] Storage Type Annotation",scope:"source.java storage.type.annotation",settings:{foreground:"#D08770"}},{name:"[Java] Storage Type Generic",scope:"source.java storage.type.generic",settings:{foreground:"#8FBCBB"}},{name:"[Java] Storage Type Primitive",scope:"source.java storage.type.primitive",settings:{foreground:"#81A1C1"}},{name:"[JavaScript] Decorator",scope:["source.js punctuation.decorator","source.js meta.decorator variable.other.readwrite","source.js meta.decorator entity.name.function"],settings:{foreground:"#D08770"}},{name:"[JavaScript] Meta Object-Literal Key",scope:"source.js meta.object-literal.key",settings:{foreground:"#88C0D0"}},{name:"[JavaScript](JSDoc) Storage Type Class",scope:"source.js storage.type.class.jsdoc",settings:{foreground:"#8FBCBB"}},{name:"[JavaScript] String Template Literals Punctuation",scope:["source.js string.quoted.template punctuation.quasi.element.begin","source.js string.quoted.template punctuation.quasi.element.end","source.js string.template punctuation.definition.template-expression"],settings:{foreground:"#81A1C1"}},{name:"[JavaScript] Interpolated String Template Punctuation Functions",scope:"source.js string.quoted.template meta.method-call.with-arguments",settings:{foreground:"#ECEFF4"}},{name:"[JavaScript] String Template Literal Variable",scope:["source.js string.template meta.template.expression support.variable.property","source.js string.template meta.template.expression variable.other.object"],settings:{foreground:"#D8DEE9"}},{name:"[JavaScript] Support Type Primitive",scope:"source.js support.type.primitive",settings:{foreground:"#81A1C1"}},{name:"[JavaScript] Variable Other Object",scope:"source.js variable.other.object",settings:{foreground:"#D8DEE9"}},{name:"[JavaScript] Variable Other Read-Write Alias",scope:"source.js variable.other.readwrite.alias",settings:{foreground:"#8FBCBB"}},{name:"[JavaScript] Parentheses in Template Strings",scope:["source.js meta.embedded.line meta.brace.square","source.js meta.embedded.line meta.brace.round","source.js string.quoted.template meta.brace.square","source.js string.quoted.template meta.brace.round"],settings:{foreground:"#ECEFF4"}},{name:"[HTML] Constant Character Entity",scope:"text.html.basic constant.character.entity.html",settings:{foreground:"#EBCB8B"}},{name:"[HTML] Constant Other Inline-Data",scope:"text.html.basic constant.other.inline-data",settings:{foreground:"#D08770",fontStyle:"italic"}},{name:"[HTML] Meta Tag SGML Doctype",scope:"text.html.basic meta.tag.sgml.doctype",settings:{foreground:"#5E81AC"}},{name:"[HTML] Punctuation Definition Entity",scope:"text.html.basic punctuation.definition.entity",settings:{foreground:"#81A1C1"}},{name:"[INI] Entity Name Section Group-Title",scope:"source.properties entity.name.section.group-title.ini",settings:{foreground:"#88C0D0"}},{name:"[INI] Punctuation Separator Key-Value",scope:"source.properties punctuation.separator.key-value.ini",settings:{foreground:"#81A1C1"}},{name:"[Markdown] Markup Fenced Code Block",scope:["text.html.markdown markup.fenced_code.block","text.html.markdown markup.fenced_code.block punctuation.definition"],settings:{foreground:"#8FBCBB"}},{name:"[Markdown] Markup Heading",scope:"markup.heading",settings:{foreground:"#88C0D0"}},{name:"[Markdown] Markup Inline",scope:["text.html.markdown markup.inline.raw","text.html.markdown markup.inline.raw punctuation.definition.raw"],settings:{foreground:"#8FBCBB"}},{name:"[Markdown] Markup Italic",scope:"text.html.markdown markup.italic",settings:{fontStyle:"italic"}},{name:"[Markdown] Markup Link",scope:"text.html.markdown markup.underline.link",settings:{fontStyle:"underline"}},{name:"[Markdown] Markup List Numbered/Unnumbered",scope:"text.html.markdown beginning.punctuation.definition.list",settings:{foreground:"#81A1C1"}},{name:"[Markdown] Markup Quote Punctuation Definition",scope:"text.html.markdown beginning.punctuation.definition.quote",settings:{foreground:"#8FBCBB"}},{name:"[Markdown] Markup Quote Punctuation Definition",scope:"text.html.markdown markup.quote",settings:{foreground:"#616E88"}},{name:"[Markdown] Markup Math Constant",scope:"text.html.markdown constant.character.math.tex",settings:{foreground:"#81A1C1"}},{name:"[Markdown] Markup Math Definition Marker",scope:["text.html.markdown punctuation.definition.math.begin","text.html.markdown punctuation.definition.math.end"],settings:{foreground:"#5E81AC"}},{name:"[Markdown] Markup Math Function Definition Marker",scope:"text.html.markdown punctuation.definition.function.math.tex",settings:{foreground:"#88C0D0"}},{name:"[Markdown] Markup Math Operator",scope:"text.html.markdown punctuation.math.operator.latex",settings:{foreground:"#81A1C1"}},{name:"[Markdown] Punctuation Definition Heading",scope:"text.html.markdown punctuation.definition.heading",settings:{foreground:"#81A1C1"}},{name:"[Markdown] Punctuation Definition Constant/String",scope:["text.html.markdown punctuation.definition.constant","text.html.markdown punctuation.definition.string"],settings:{foreground:"#81A1C1"}},{name:"[Markdown] String Other Link Description/Title",scope:["text.html.markdown constant.other.reference.link","text.html.markdown string.other.link.description","text.html.markdown string.other.link.title"],settings:{foreground:"#88C0D0"}},{name:"[Perl] Perl Sigils",scope:"source.perl punctuation.definition.variable",settings:{foreground:"#D8DEE9"}},{name:"[PHP] Meta Function-Call Object",scope:["source.php meta.function-call","source.php meta.function-call.object"],settings:{foreground:"#88C0D0"}},{name:"[Python] Decorator",scope:["source.python entity.name.function.decorator","source.python meta.function.decorator support.type"],settings:{foreground:"#D08770"}},{name:"[Python] Function Call",scope:"source.python meta.function-call.generic",settings:{foreground:"#88C0D0"}},{name:"[Python] Support Type",scope:"source.python support.type",settings:{foreground:"#88C0D0"}},{name:"[Python] Function Parameter",scope:["source.python variable.parameter.function.language"],settings:{foreground:"#D8DEE9"}},{name:"[Python] Function Parameter Special",scope:["source.python meta.function.parameters variable.parameter.function.language.special.self"],settings:{foreground:"#81A1C1"}},{name:"[Rust] Entity types",scope:"source.rust entity.name.type",settings:{foreground:"#8FBCBB"}},{name:"[Rust] Macro",scope:"source.rust meta.macro entity.name.function",settings:{fontStyle:"bold",foreground:"#88C0D0"}},{name:"[Rust] Attributes",scope:["source.rust meta.attribute","source.rust meta.attribute punctuation","source.rust meta.attribute keyword.operator"],settings:{foreground:"#5E81AC"}},{name:"[Rust] Traits",scope:"source.rust entity.name.type.trait",settings:{fontStyle:"bold"}},{name:"[Rust] Interpolation Bracket Curly",scope:"source.rust punctuation.definition.interpolation",settings:{foreground:"#EBCB8B"}},{name:"[SCSS] Punctuation Definition Interpolation Bracket Curly",scope:["source.css.scss punctuation.definition.interpolation.begin.bracket.curly","source.css.scss punctuation.definition.interpolation.end.bracket.curly"],settings:{foreground:"#81A1C1"}},{name:"[SCSS] Variable Interpolation",scope:"source.css.scss variable.interpolation",settings:{foreground:"#D8DEE9",fontStyle:"italic"}},{name:"[TypeScript] Decorators",scope:["source.ts punctuation.decorator","source.ts meta.decorator variable.other.readwrite","source.ts meta.decorator entity.name.function","source.tsx punctuation.decorator","source.tsx meta.decorator variable.other.readwrite","source.tsx meta.decorator entity.name.function"],settings:{foreground:"#D08770"}},{name:"[TypeScript] Object-literal keys",scope:["source.ts meta.object-literal.key","source.tsx meta.object-literal.key"],settings:{foreground:"#D8DEE9"}},{name:"[TypeScript] Object-literal functions",scope:["source.ts meta.object-literal.key entity.name.function","source.tsx meta.object-literal.key entity.name.function"],settings:{foreground:"#88C0D0"}},{name:"[TypeScript] Type/Class",scope:["source.ts support.class","source.ts support.type","source.ts entity.name.type","source.ts entity.name.class","source.tsx support.class","source.tsx support.type","source.tsx entity.name.type","source.tsx entity.name.class"],settings:{foreground:"#8FBCBB"}},{name:"[TypeScript] Static Class Support",scope:["source.ts support.constant.math","source.ts support.constant.dom","source.ts support.constant.json","source.tsx support.constant.math","source.tsx support.constant.dom","source.tsx support.constant.json"],settings:{foreground:"#8FBCBB"}},{name:"[TypeScript] Variables",scope:["source.ts support.variable","source.tsx support.variable"],settings:{foreground:"#D8DEE9"}},{name:"[TypeScript] Parentheses in Template Strings",scope:["source.ts meta.embedded.line meta.brace.square","source.ts meta.embedded.line meta.brace.round","source.tsx meta.embedded.line meta.brace.square","source.tsx meta.embedded.line meta.brace.round"],settings:{foreground:"#ECEFF4"}},{name:"[XML] Entity Name Tag Namespace",scope:"text.xml entity.name.tag.namespace",settings:{foreground:"#8FBCBB"}},{name:"[XML] Keyword Other Doctype",scope:"text.xml keyword.other.doctype",settings:{foreground:"#5E81AC"}},{name:"[XML] Meta Tag Preprocessor",scope:"text.xml meta.tag.preprocessor entity.name.tag",settings:{foreground:"#5E81AC"}},{name:"[XML] Entity Name Tag Namespace",scope:["text.xml string.unquoted.cdata","text.xml string.unquoted.cdata punctuation.definition.string"],settings:{foreground:"#D08770",fontStyle:"italic"}},{name:"[YAML] Entity Name Tag",scope:"source.yaml entity.name.tag",settings:{foreground:"#8FBCBB"}}]},lineNumbers:!0,showCopyButton:!0,autoImport:!0,skipLanguages:[],filepath:"/home/runner/work/docs/docs/docs/cadence/tutorial/08-marketplace-compose.mdx"};function F(o){const t=Object.assign({p:"p",a:"a",hr:"hr",strong:"strong",ul:"ul",li:"li",ol:"ol",code:"code",h2:"h2",h3:"h3"},(0,r.ah)(),o.components),{Callout:e}=t;return E||u("CH",!1),E.Code||u("CH.Code",!0),e||u("Callout",!0),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(t.p,{children:["In this tutorial, we're going to create a marketplace that uses both the fungible\nand non-fungible token (NFTs) contracts that we have learned about in previous tutorials.\nThis is only for educational purposes and is not meant to be used in production\nSee a production-ready marketplace in the ",(0,n.jsx)(t.a,{href:"https://github.com/onflow/nft-storefront",children:"NFT storefront repo."}),"\nThis contract is already deployed to testnet and mainnet and can be used by anyone for any generic NFT sale!"]}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsxs)(e,{type:"success",children:[(0,n.jsx)(t.p,{children:"Open the starter code for this tutorial in the Flow Playground:"}),(0,n.jsx)("a",{href:"https://play.onflow.org/49ec2856-1258-4675-bac3-850b4bae1929",target:"_blank",children:(0,n.jsx)(t.p,{children:(0,n.jsx)(t.a,{href:"https://play.onflow.org/49ec2856-1258-4675-bac3-850b4bae1929",children:"https://play.onflow.org/49ec2856-1258-4675-bac3-850b4bae1929"})})}),(0,n.jsx)("br",{}),(0,n.jsxs)(t.p,{children:["The tutorial will be asking you to take various actions to interact with this code.\n",(0,n.jsx)(t.a,{href:"/docs/next/cadence/tutorial/marketplace-setup",children:"The marketplace setup guide"})," shows you how to get the playground set up to do this tutorial."]})]}),"\n",(0,n.jsx)(e,{type:"info",children:(0,n.jsx)(t.p,{children:"Instructions that require you to take action are always included in a callout box like this one.\nThese highlighted actions are all that you need to do to get your code running,\nbut reading the rest is necessary to understand the language's design."})}),"\n",(0,n.jsx)(t.p,{children:"Marketplaces are a popular application of blockchain technology and smart contracts.\nWhen there are NFTs in existence, users usually want to be able to buy and sell them with their fungible tokens."}),"\n",(0,n.jsxs)(t.p,{children:["Now that there is an example for both fungible and non-fungible tokens,\nwe can build a marketplace that uses both. This is referred to as ",(0,n.jsx)(t.strong,{children:"composability"}),":\nthe ability for developers to leverage shared resources, such as code or userbases,\nand use them as building blocks for new applications."]}),"\n",(0,n.jsx)(t.p,{children:"Flow is designed to enable composability because of the way that interfaces, resources and capabilities are designed."}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.a,{href:"../language/interfaces",children:"Interfaces"})," allow projects to support any generic type as long as it supports a standard set of functionality specified by an interface."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.a,{href:"../language/resources",children:"Resources"})," can be passed around and owned by accounts, contracts or even other resources, unlocking different use cases depending on where the resource is stored."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.a,{href:"../language/capability-based-access-control",children:"Capabilities"})," allow exposing user-defined sets of functionality through special objects that enforce strict security with Cadence's type system."]}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"The combination of these allows developers to do more with less, re-using known safe code and design patterns\nto create new, powerful, and unique interactions!"}),"\n",(0,n.jsx)(e,{type:"info",children:(0,n.jsx)(t.p,{children:"At some point before or after this tutorial, you should definitely check out the formal documentation\nlinked above about interfaces, resources, and capabilities. It will help complete your understanding\nof these complex, but powerful features."})}),"\n",(0,n.jsx)(t.p,{children:"To create a marketplace, we need to integrate the functionality of both fungible\nand non-fungible tokens into a single contract that gives users control over their money and assets.\nTo accomplish this, we're going to take you through these steps to create a composable smart contract and get comfortable with the marketplace:"}),"\n",(0,n.jsxs)(t.ol,{children:["\n",(0,n.jsx)(t.li,{children:"Ensure that your fungible token and non-fungible token contracts are deployed and set up correctly."}),"\n",(0,n.jsxs)(t.li,{children:["Deploy the marketplace type declarations to account ",(0,n.jsx)(t.code,{children:"0x03"}),"."]}),"\n",(0,n.jsx)(t.li,{children:"Create a marketplace object and store it in your account storage, putting an NFT up for sale and publishing a public capability for your sale."}),"\n",(0,n.jsx)(t.li,{children:"Use a different account to purchase the NFT from the sale."}),"\n",(0,n.jsx)(t.li,{children:"Run a script to verify that the NFT was purchased."}),"\n"]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.strong,{children:"Before proceeding with this tutorial"}),", you need to complete the ",(0,n.jsx)(t.a,{href:"/docs/next/cadence/tutorial/fungible-tokens",children:"Fungible Tokens"}),"\nand ",(0,n.jsx)(t.a,{href:"/docs/next/cadence/tutorial/non-fungible-tokens-1",children:"Non-Fungible Token"})," tutorials\nto understand the building blocks of this smart contract."]}),"\n",(0,n.jsx)(t.h2,{id:"marketplace-design",children:"Marketplace Design"}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.p,{children:"One way to implement a marketplace is to have a central smart contract that users deposit their NFTs and their price into,\nand have anyone come by and be able to buy the token for that price.\nThis approach is reasonable, but it centralizes the process and takes away options from the owners.\nWe want users to be able to maintain ownership of the NFTs that they are trying to sell while they are trying to sell them."}),"\n",(0,n.jsx)(t.p,{children:"Instead of taking this centralized approach, each user can list a sale from within their own account."}),"\n",(0,n.jsx)(t.p,{children:"Then, users could either provide a link to their sale to an application that can list it centrally on a website,\nor to a central sale aggregator smart contract if they want the entire transaction to stay on-chain.\nThis way, the owner of the token keeps custody of their token while it is on sale."}),"\n",(0,n.jsx)(e,{type:"info",children:(0,n.jsxs)(t.p,{children:["Before we start, we need to confirm the state of your accounts. ",(0,n.jsx)("br",{}),"\nIf you haven't already, please perform the steps in the ",(0,n.jsx)(t.a,{href:"/docs/next/cadence/tutorial/marketplace-setup",children:"marketplace setup guide"}),"\nto ensure that the Fungible Token and Non-Fungible Token contracts are deployed to account 1 and 2 and own some tokens.",(0,n.jsx)("br",{}),"\nYour accounts should look like this:"]})}),"\n",(0,n.jsx)("img",{src:"https://storage.googleapis.com/flow-resources/documentation-assets/cadence-tuts/accounts-nft-storage.png"}),"\n",(0,n.jsx)(e,{type:"info",children:(0,n.jsxs)(t.p,{children:["You can run the ",(0,n.jsx)(t.code,{children:"1. CheckSetupScript.cdc"})," script to ensure that your accounts are correctly set up:"]})}),"\n",(0,n.jsx)(E.Code,{codeConfig:y,northPanel:{tabs:["CheckSetupScript.cdc"],active:"CheckSetupScript.cdc",heightRatio:1},files:[{name:"CheckSetupScript.cdc",focus:"",code:{lines:[{tokens:[{content:"// CheckSetupScript.cdc",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"import",props:{style:{color:"#81A1C1"}}},{content:" ExampleToken ",props:{style:{color:"#D8DEE9FF"}}},{content:"from ",props:{style:{color:"#81A1C1"}}},{content:"0x01",props:{style:{color:"#B48EAD"}}}]},{tokens:[{content:"import",props:{style:{color:"#81A1C1"}}},{content:" ExampleNFT ",props:{style:{color:"#D8DEE9FF"}}},{content:"from ",props:{style:{color:"#81A1C1"}}},{content:"0x02",props:{style:{color:"#B48EAD"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"// This script checks that the accounts are set up correctly for the marketplace tutorial.",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"//",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"// Account 0x01: Vault Balance = 40, NFT.id = 1",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"// Account 0x02: Vault Balance = 20, No NFTs",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"fun ",props:{style:{color:"#81A1C1"}}},{content:"main",props:{style:{color:"#88C0D0"}}},{content:"() {",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    // Get the accounts' public account objects",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    let",props:{style:{color:"#81A1C1"}}},{content:" acct1 = ",props:{style:{color:"#D8DEE9FF"}}},{content:"getAccount",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"0x01",props:{style:{color:"#B48EAD"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    let",props:{style:{color:"#81A1C1"}}},{content:" acct2 = ",props:{style:{color:"#D8DEE9FF"}}},{content:"getAccount",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"0x02",props:{style:{color:"#B48EAD"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    // Get references to the account's receivers",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    // by getting their public capability",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    // and borrowing a reference from the capability",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    let",props:{style:{color:"#81A1C1"}}},{content:" acct1ReceiverRef = acct1.",props:{style:{color:"#D8DEE9FF"}}},{content:"getCapability",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"public",props:{style:{color:"#D8DEE9FF"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"CadenceFungibleTokenTutorialReceiver",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"                          .borrow",props:{style:{color:"#D8DEE9FF"}}},{content:"<",props:{style:{color:"#81A1C1"}}},{content:"&ExampleToken.Vault",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}},{content:"ExampleToken.Balance",props:{style:{color:"#D8DEE9FF"}}},{content:"}",props:{style:{color:"#ECEFF4"}}},{content:">",props:{style:{color:"#81A1C1"}}},{content:"()",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"                          ?? ",props:{style:{color:"#81A1C1"}}},{content:"panic",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"Could not borrow acct1 vault reference",props:{style:{color:"#A3BE8C"}}},{content:'")',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    let",props:{style:{color:"#81A1C1"}}},{content:" acct2ReceiverRef = acct2.",props:{style:{color:"#D8DEE9FF"}}},{content:"getCapability",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"public",props:{style:{color:"#D8DEE9FF"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"CadenceFungibleTokenTutorialReceiver",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"                          .borrow",props:{style:{color:"#D8DEE9FF"}}},{content:"<",props:{style:{color:"#81A1C1"}}},{content:"&ExampleToken.Vault",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}},{content:"ExampleToken.Balance",props:{style:{color:"#D8DEE9FF"}}},{content:"}",props:{style:{color:"#ECEFF4"}}},{content:">",props:{style:{color:"#81A1C1"}}},{content:"()",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"                          ?? ",props:{style:{color:"#81A1C1"}}},{content:"panic",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"Could not borrow acct2 vault reference",props:{style:{color:"#A3BE8C"}}},{content:'")',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    // Log the Vault balance of both accounts and ensure they are",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    // the correct numbers.",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    // Account 0x01 should have 40.",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    // Account 0x02 should have 20.",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    log",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"Account 1 Balance",props:{style:{color:"#A3BE8C"}}},{content:'")',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    log",props:{style:{color:"#88C0D0"}}},{content:"(acct1ReceiverRef.balance",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    log",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"Account 2 Balance",props:{style:{color:"#A3BE8C"}}},{content:'")',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    log",props:{style:{color:"#88C0D0"}}},{content:"(acct2ReceiverRef.balance",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    // verify that the balances are correct",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    if",props:{style:{color:"#81A1C1"}}},{content:" acct1ReceiverRef.balance ",props:{style:{color:"#D8DEE9FF"}}},{content:"!= ",props:{style:{color:"#81A1C1"}}},{content:"40",props:{style:{color:"#B48EAD"}}},{content:".",props:{style:{color:"#D8DEE9FF"}}},{content:"0 ",props:{style:{color:"#B48EAD"}}},{content:"||",props:{style:{color:"#81A1C1"}}},{content:" acct2ReceiverRef.balance ",props:{style:{color:"#D8DEE9FF"}}},{content:"!= ",props:{style:{color:"#81A1C1"}}},{content:"20",props:{style:{color:"#B48EAD"}}},{content:".",props:{style:{color:"#D8DEE9FF"}}},{content:"0 ",props:{style:{color:"#B48EAD"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        panic",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"Wrong balances!",props:{style:{color:"#A3BE8C"}}},{content:'")',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    // Find the public Receiver capability for their Collections",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    let",props:{style:{color:"#81A1C1"}}},{content:" acct1Capability = acct1.",props:{style:{color:"#D8DEE9FF"}}},{content:"getCapability",props:{style:{color:"#88C0D0"}}},{content:"(ExampleNFT.CollectionPublicPath",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    let",props:{style:{color:"#81A1C1"}}},{content:" acct2Capability = acct2.",props:{style:{color:"#D8DEE9FF"}}},{content:"getCapability",props:{style:{color:"#88C0D0"}}},{content:"(ExampleNFT.CollectionPublicPath",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    // borrow references from the capabilities",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    let",props:{style:{color:"#81A1C1"}}},{content:" nft1Ref = acct1Capability.borrow",props:{style:{color:"#D8DEE9FF"}}},{content:"<",props:{style:{color:"#81A1C1"}}},{content:"&",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}},{content:"ExampleNFT.NFTReceiver",props:{style:{color:"#D8DEE9FF"}}},{content:"}",props:{style:{color:"#ECEFF4"}}},{content:">",props:{style:{color:"#81A1C1"}}},{content:"()",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        ?? ",props:{style:{color:"#81A1C1"}}},{content:"panic",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"Could not borrow acct1 nft collection reference",props:{style:{color:"#A3BE8C"}}},{content:'")',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    let",props:{style:{color:"#81A1C1"}}},{content:" nft2Ref = acct2Capability.borrow",props:{style:{color:"#D8DEE9FF"}}},{content:"<",props:{style:{color:"#81A1C1"}}},{content:"&",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}},{content:"ExampleNFT.NFTReceiver",props:{style:{color:"#D8DEE9FF"}}},{content:"}",props:{style:{color:"#ECEFF4"}}},{content:">",props:{style:{color:"#81A1C1"}}},{content:"()",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        ?? ",props:{style:{color:"#81A1C1"}}},{content:"panic",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"Could not borrow acct2 nft collection reference",props:{style:{color:"#A3BE8C"}}},{content:'")',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    // Print both collections as arrays of IDs",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    log",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"Account 1 NFTs",props:{style:{color:"#A3BE8C"}}},{content:'")',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    log",props:{style:{color:"#88C0D0"}}},{content:"(nft1Ref.",props:{style:{color:"#D8DEE9FF"}}},{content:"getIDs",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"))",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    log",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"Account 2 NFTs",props:{style:{color:"#A3BE8C"}}},{content:'")',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    log",props:{style:{color:"#88C0D0"}}},{content:"(nft2Ref.",props:{style:{color:"#D8DEE9FF"}}},{content:"getIDs",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"))",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    // verify that the collections are correct",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    if",props:{style:{color:"#81A1C1"}}},{content:" nft1Ref.",props:{style:{color:"#D8DEE9FF"}}},{content:"getIDs",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}},{content:"[",props:{style:{color:"#D8DEE9FF"}}},{content:"0",props:{style:{color:"#B48EAD"}}},{content:"] ",props:{style:{color:"#D8DEE9FF"}}},{content:"!= ",props:{style:{color:"#81A1C1"}}},{content:"1 ",props:{style:{color:"#B48EAD"}}},{content:"||",props:{style:{color:"#81A1C1"}}},{content:" nft2Ref.",props:{style:{color:"#D8DEE9FF"}}},{content:"getIDs",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}},{content:".length ",props:{style:{color:"#D8DEE9FF"}}},{content:"!= ",props:{style:{color:"#81A1C1"}}},{content:"0 ",props:{style:{color:"#B48EAD"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        panic",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"Wrong Collections!",props:{style:{color:"#A3BE8C"}}},{content:'")',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"}",props:{style:{color:"#ECEFF4"}}}]}],lang:"cadence"},annotations:[]}]}),"\n",(0,n.jsxs)(t.p,{children:["You should see something similar to this output if your accounts are set up correctly.\nThey are in the same state that they would have been in if you followed\nthe ",(0,n.jsx)(t.a,{href:"/docs/next/cadence/tutorial/fungible-tokens",children:"Fungible Tokens"}),"\nand ",(0,n.jsx)(t.a,{href:"/docs/next/cadence/tutorial/non-fungible-tokens-1",children:"Non-Fungible Tokens"})," tutorials in succession:"]}),"\n",(0,n.jsx)(E.Code,{codeConfig:y,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:'"Account 1 Balance"',props:{}}]},{tokens:[{content:"40.00000000",props:{}}]},{tokens:[{content:'"Account 2 Balance"',props:{}}]},{tokens:[{content:"20.00000000",props:{}}]},{tokens:[{content:'"Account 1 NFTs"',props:{}}]},{tokens:[{content:"[1]",props:{}}]},{tokens:[{content:'"Account 2 NFTs"',props:{}}]},{tokens:[{content:"[]",props:{}}]}],lang:"text"},annotations:[]}]}),"\n",(0,n.jsx)(t.p,{children:"Now that your accounts are in the correct state, we can build a marketplace that enables the sale of NFT's between accounts."}),"\n",(0,n.jsxs)(t.h2,{id:"setting-up-an-nft-marketplace",children:["Setting up an NFT ",(0,n.jsx)(t.strong,{children:"Marketplace"})]}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsxs)(t.p,{children:["Every user who wants to sell an NFT will store an instance of a ",(0,n.jsx)(t.code,{children:"SaleCollection"})," resource in their account storage."]}),"\n",(0,n.jsx)(t.p,{children:"Time to deploy the marketplace contract:"}),"\n",(0,n.jsx)(e,{type:"info",children:(0,n.jsxs)(t.ol,{children:["\n",(0,n.jsxs)(t.li,{children:["Switch to the ExampleMarketplace contract (Contract 3).",(0,n.jsx)("br",{})]}),"\n",(0,n.jsxs)(t.li,{children:["With ",(0,n.jsx)(t.code,{children:"ExampleMarketplace.cdc"})," open, select account ",(0,n.jsx)(t.code,{children:"0x03"})," from the deployment modal in the bottom right and deploy."]}),"\n"]})}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.code,{children:"ExampleMarketplace.cdc"})," should contain the following contract definition:"]}),"\n",(0,n.jsx)(E.Code,{codeConfig:y,northPanel:{tabs:["ExampleMarketplace.cdc"],active:"ExampleMarketplace.cdc",heightRatio:1},files:[{name:"ExampleMarketplace.cdc",focus:"",code:{lines:[{tokens:[{content:"import",props:{style:{color:"#81A1C1"}}},{content:" ExampleToken ",props:{style:{color:"#D8DEE9FF"}}},{content:"from ",props:{style:{color:"#81A1C1"}}},{content:"0x01",props:{style:{color:"#B48EAD"}}}]},{tokens:[{content:"import",props:{style:{color:"#81A1C1"}}},{content:" ExampleNFT ",props:{style:{color:"#D8DEE9FF"}}},{content:"from ",props:{style:{color:"#81A1C1"}}},{content:"0x02",props:{style:{color:"#B48EAD"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"// ExampleMarketplace.cdc",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"//",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"// The ExampleMarketplace contract is a very basic sample implementation of an NFT ExampleMarketplace on Flow.",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"//",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"// This contract allows users to put their NFTs up for sale. Other users",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"// can purchase these NFTs with fungible tokens.",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"//",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"// Learn more about marketplaces in this tutorial: https://developers.flow.com/cadence/tutorial/marketplace-compose",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"//",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"// This contract is a learning tool and is not meant to be used in production.",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"// See the NFTStorefront contract for a generic marketplace smart contract that",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"// is used by many different projects on the Flow blockchain:",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"//",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"// https://github.com/onflow/nft-storefront",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"contract",props:{style:{color:"#81A1C1"}}},{content:" ExampleMarketplace ",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    // Event that is emitted when a new NFT is put up for sale",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"event",props:{style:{color:"#81A1C1"}}},{content:" ForSale",props:{style:{color:"#D8DEE9FF"}}},{content:"(",props:{style:{color:"#ECEFF4"}}},{content:"id",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"UInt64",props:{style:{color:"#81A1C1"}}},{content:", ",props:{style:{color:"#D8DEE9FF"}}},{content:"price",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"UFix64",props:{style:{color:"#81A1C1"}}},{content:", ",props:{style:{color:"#D8DEE9FF"}}},{content:"owner",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"Address",props:{style:{color:"#81A1C1"}}},{content:"?",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    // Event that is emitted when the price of an NFT changes",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"event",props:{style:{color:"#81A1C1"}}},{content:" PriceChanged",props:{style:{color:"#D8DEE9FF"}}},{content:"(",props:{style:{color:"#ECEFF4"}}},{content:"id",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"UInt64",props:{style:{color:"#81A1C1"}}},{content:", ",props:{style:{color:"#D8DEE9FF"}}},{content:"newPrice",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"UFix64",props:{style:{color:"#81A1C1"}}},{content:", ",props:{style:{color:"#D8DEE9FF"}}},{content:"owner",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"Address",props:{style:{color:"#81A1C1"}}},{content:"?",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    // Event that is emitted when a token is purchased",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"event",props:{style:{color:"#81A1C1"}}},{content:" TokenPurchased",props:{style:{color:"#D8DEE9FF"}}},{content:"(",props:{style:{color:"#ECEFF4"}}},{content:"id",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"UInt64",props:{style:{color:"#81A1C1"}}},{content:", ",props:{style:{color:"#D8DEE9FF"}}},{content:"price",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"UFix64",props:{style:{color:"#81A1C1"}}},{content:", ",props:{style:{color:"#D8DEE9FF"}}},{content:"seller",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"Address",props:{style:{color:"#81A1C1"}}},{content:"?, ",props:{style:{color:"#D8DEE9FF"}}},{content:"buyer",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"Address",props:{style:{color:"#81A1C1"}}},{content:"?",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    // Event that is emitted when a seller withdraws their NFT from the sale",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"event",props:{style:{color:"#81A1C1"}}},{content:" SaleCanceled",props:{style:{color:"#D8DEE9FF"}}},{content:"(",props:{style:{color:"#ECEFF4"}}},{content:"id",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"UInt64",props:{style:{color:"#81A1C1"}}},{content:", ",props:{style:{color:"#D8DEE9FF"}}},{content:"seller",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"Address",props:{style:{color:"#81A1C1"}}},{content:"?",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    // Interface that users will publish for their Sale collection",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    // that only exposes the methods that are supposed to be public",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    //",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"resource interface",props:{style:{color:"#81A1C1"}}},{content:" SalePublic ",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"fun ",props:{style:{color:"#81A1C1"}}},{content:"purchase",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#ECEFF4"}}},{content:"tokenID",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"UInt64",props:{style:{color:"#81A1C1"}}},{content:", ",props:{style:{color:"#D8DEE9FF"}}},{content:"recipient",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"Capability",props:{style:{color:"#81A1C1"}}},{content:"<&",props:{style:{color:"#D8DEE9FF"}}},{content:"AnyResource",props:{style:{color:"#81A1C1"}}},{content:"{",props:{style:{color:"#D8DEE9FF"}}},{content:"ExampleNFT",props:{style:{color:"#81A1C1"}}},{content:".",props:{style:{color:"#D8DEE9FF"}}},{content:"NFTReceiver",props:{style:{color:"#81A1C1"}}},{content:"}>, ",props:{style:{color:"#D8DEE9FF"}}},{content:"buyTokens",props:{style:{color:"#88C0D0"}}},{content:": @",props:{style:{color:"#D8DEE9FF"}}},{content:"ExampleToken",props:{style:{color:"#81A1C1"}}},{content:".",props:{style:{color:"#D8DEE9FF"}}},{content:"Vault",props:{style:{color:"#81A1C1"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"fun ",props:{style:{color:"#81A1C1"}}},{content:"idPrice",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#ECEFF4"}}},{content:"tokenID",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"UInt64",props:{style:{color:"#81A1C1"}}},{content:")",props:{style:{color:"#ECEFF4"}}},{content:": UFix64",props:{style:{color:"#81A1C1"}}},{content:"?",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"fun ",props:{style:{color:"#81A1C1"}}},{content:"getIDs",props:{style:{color:"#88C0D0"}}},{content:"()",props:{style:{color:"#ECEFF4"}}},{content:":",props:{style:{color:"#81A1C1"}}},{content:" [",props:{style:{color:"#D8DEE9FF"}}},{content:"UInt64",props:{style:{color:"#81A1C1"}}},{content:"]",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    // SaleCollection",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    //",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    // NFT Collection object that allows a user to put their NFT up for sale",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    // where others can send fungible tokens to purchase it",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    //",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"resource",props:{style:{color:"#81A1C1"}}},{content:" SaleCollection",props:{style:{color:"#D8DEE9FF"}}},{content:": ",props:{style:{color:"#ECEFF4"}}},{content:"SalePublic ",props:{style:{color:"#81A1C1"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        /// A capability for the owner's collection",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        access",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"self",props:{style:{color:"#81A1C1"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"var",props:{style:{color:"#81A1C1"}}},{content:" ownerCollection: ",props:{style:{color:"#D8DEE9FF"}}},{content:"Capability",props:{style:{color:"#81A1C1"}}},{content:"<&",props:{style:{color:"#D8DEE9FF"}}},{content:"ExampleNFT",props:{style:{color:"#81A1C1"}}},{content:".",props:{style:{color:"#D8DEE9FF"}}},{content:"Collection",props:{style:{color:"#81A1C1"}}},{content:">",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        // Dictionary of the prices for each NFT by ID",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        access",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"self",props:{style:{color:"#81A1C1"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"var",props:{style:{color:"#81A1C1"}}},{content:" prices: {",props:{style:{color:"#D8DEE9FF"}}},{content:"UInt64",props:{style:{color:"#81A1C1"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"UFix64",props:{style:{color:"#81A1C1"}}},{content:"}",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        // The fungible token vault of the owner of this sale.",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        // When someone buys a token, this resource can deposit",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        // tokens into their account.",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        access",props:{style:{color:"#88C0D0"}}},{content:"(account",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"let",props:{style:{color:"#81A1C1"}}},{content:" ownerVault: ",props:{style:{color:"#D8DEE9FF"}}},{content:"Capability",props:{style:{color:"#81A1C1"}}},{content:"<&",props:{style:{color:"#D8DEE9FF"}}},{content:"AnyResource",props:{style:{color:"#81A1C1"}}},{content:"{",props:{style:{color:"#D8DEE9FF"}}},{content:"ExampleToken",props:{style:{color:"#81A1C1"}}},{content:".",props:{style:{color:"#D8DEE9FF"}}},{content:"Receiver",props:{style:{color:"#81A1C1"}}},{content:"}>",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        init ",props:{style:{color:"#81A1C1"}}},{content:"(",props:{style:{color:"#ECEFF4"}}},{content:"ownerCollection",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"Capability",props:{style:{color:"#81A1C1"}}},{content:"<&",props:{style:{color:"#D8DEE9FF"}}},{content:"ExampleNFT",props:{style:{color:"#81A1C1"}}},{content:".",props:{style:{color:"#D8DEE9FF"}}},{content:"Collection",props:{style:{color:"#81A1C1"}}},{content:">,",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"              ownerVault",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"Capability",props:{style:{color:"#81A1C1"}}},{content:"<&",props:{style:{color:"#D8DEE9FF"}}},{content:"AnyResource",props:{style:{color:"#81A1C1"}}},{content:"{",props:{style:{color:"#D8DEE9FF"}}},{content:"ExampleToken",props:{style:{color:"#81A1C1"}}},{content:".",props:{style:{color:"#D8DEE9FF"}}},{content:"Receiver",props:{style:{color:"#81A1C1"}}},{content:"}>",props:{style:{color:"#D8DEE9FF"}}},{content:") {",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"            pre ",props:{style:{color:"#81A1C1"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"                // Check that the owner's collection capability is correct",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"                ownerCollection.",props:{style:{color:"#D8DEE9FF"}}},{content:"check",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}},{content:":",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:'                    "',props:{style:{color:"#ECEFF4"}}},{content:"Owner's NFT Collection Capability is invalid!",props:{style:{color:"#A3BE8C"}}},{content:'"',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"                // Check that the fungible token vault capability is correct",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"                ownerVault.",props:{style:{color:"#D8DEE9FF"}}},{content:"check",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}},{content:":",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:'                    "',props:{style:{color:"#ECEFF4"}}},{content:"Owner's Receiver Capability is invalid!",props:{style:{color:"#A3BE8C"}}},{content:'"',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"            }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"            self",props:{style:{color:"#81A1C1"}}},{content:".ownerCollection ",props:{style:{color:"#D8DEE9FF"}}},{content:"=",props:{style:{color:"#81A1C1"}}},{content:" ownerCollection",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"            self",props:{style:{color:"#81A1C1"}}},{content:".ownerVault ",props:{style:{color:"#D8DEE9FF"}}},{content:"=",props:{style:{color:"#81A1C1"}}},{content:" ownerVault",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"            self",props:{style:{color:"#81A1C1"}}},{content:".prices ",props:{style:{color:"#D8DEE9FF"}}},{content:"= ",props:{style:{color:"#81A1C1"}}},{content:"{}",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        // cancelSale gives the owner the opportunity to cancel a sale in the collection",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"fun ",props:{style:{color:"#81A1C1"}}},{content:"cancelSale",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#ECEFF4"}}},{content:"tokenID",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"UInt64",props:{style:{color:"#81A1C1"}}},{content:") {",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"            // remove the price",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"            self",props:{style:{color:"#81A1C1"}}},{content:".prices.",props:{style:{color:"#D8DEE9FF"}}},{content:"remove",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"key",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" tokenID",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"            self",props:{style:{color:"#81A1C1"}}},{content:".prices[tokenID] ",props:{style:{color:"#D8DEE9FF"}}},{content:"= nil",props:{style:{color:"#81A1C1"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"            // Nothing needs to be done with the actual token because it is already in the owner's collection",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        // listForSale lists an NFT for sale in this collection",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"fun ",props:{style:{color:"#81A1C1"}}},{content:"listForSale",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#ECEFF4"}}},{content:"tokenID",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"UInt64",props:{style:{color:"#81A1C1"}}},{content:", ",props:{style:{color:"#D8DEE9FF"}}},{content:"price",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"UFix64",props:{style:{color:"#81A1C1"}}},{content:") {",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"            pre ",props:{style:{color:"#81A1C1"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"                self",props:{style:{color:"#81A1C1"}}},{content:".ownerCollection.",props:{style:{color:"#D8DEE9FF"}}},{content:"borrow",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}},{content:"!",props:{style:{color:"#81A1C1"}}},{content:".",props:{style:{color:"#D8DEE9FF"}}},{content:"idExists",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"id",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" tokenID",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}},{content:":",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:'                    "',props:{style:{color:"#ECEFF4"}}},{content:"NFT to be listed does not exist in the owner's collection",props:{style:{color:"#A3BE8C"}}},{content:'"',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"            }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"            // store the price in the price array",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"            self",props:{style:{color:"#81A1C1"}}},{content:".prices[tokenID] ",props:{style:{color:"#D8DEE9FF"}}},{content:"=",props:{style:{color:"#81A1C1"}}},{content:" price",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"            emit ",props:{style:{color:"#81A1C1"}}},{content:"ForSale",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"id",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" tokenID, ",props:{style:{color:"#D8DEE9FF"}}},{content:"price",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" price, ",props:{style:{color:"#D8DEE9FF"}}},{content:"owner",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#ECEFF4"}}},{content:"self",props:{style:{color:"#81A1C1"}}},{content:".owner",props:{style:{color:"#D8DEE9FF"}}},{content:"?",props:{style:{color:"#81A1C1"}}},{content:".address",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        // changePrice changes the price of a token that is currently for sale",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"fun ",props:{style:{color:"#81A1C1"}}},{content:"changePrice",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#ECEFF4"}}},{content:"tokenID",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"UInt64",props:{style:{color:"#81A1C1"}}},{content:", ",props:{style:{color:"#D8DEE9FF"}}},{content:"newPrice",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"UFix64",props:{style:{color:"#81A1C1"}}},{content:") {",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"            self",props:{style:{color:"#81A1C1"}}},{content:".prices[tokenID] ",props:{style:{color:"#D8DEE9FF"}}},{content:"=",props:{style:{color:"#81A1C1"}}},{content:" newPrice",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"            emit ",props:{style:{color:"#81A1C1"}}},{content:"PriceChanged",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"id",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" tokenID, ",props:{style:{color:"#D8DEE9FF"}}},{content:"newPrice",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" newPrice, ",props:{style:{color:"#D8DEE9FF"}}},{content:"owner",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#ECEFF4"}}},{content:"self",props:{style:{color:"#81A1C1"}}},{content:".owner",props:{style:{color:"#D8DEE9FF"}}},{content:"?",props:{style:{color:"#81A1C1"}}},{content:".address",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        // purchase lets a user send tokens to purchase an NFT that is for sale",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"fun ",props:{style:{color:"#81A1C1"}}},{content:"purchase",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#ECEFF4"}}},{content:"tokenID",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"UInt64",props:{style:{color:"#81A1C1"}}},{content:", ",props:{style:{color:"#D8DEE9FF"}}},{content:"recipient",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"Capability",props:{style:{color:"#81A1C1"}}},{content:"<&",props:{style:{color:"#D8DEE9FF"}}},{content:"AnyResource",props:{style:{color:"#81A1C1"}}},{content:"{",props:{style:{color:"#D8DEE9FF"}}},{content:"ExampleNFT",props:{style:{color:"#81A1C1"}}},{content:".",props:{style:{color:"#D8DEE9FF"}}},{content:"NFTReceiver",props:{style:{color:"#81A1C1"}}},{content:"}>, ",props:{style:{color:"#D8DEE9FF"}}},{content:"buyTokens",props:{style:{color:"#88C0D0"}}},{content:": @",props:{style:{color:"#D8DEE9FF"}}},{content:"ExampleToken",props:{style:{color:"#81A1C1"}}},{content:".",props:{style:{color:"#D8DEE9FF"}}},{content:"Vault",props:{style:{color:"#81A1C1"}}},{content:") {",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"            pre ",props:{style:{color:"#81A1C1"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"                self",props:{style:{color:"#81A1C1"}}},{content:".prices[tokenID] ",props:{style:{color:"#D8DEE9FF"}}},{content:"!= nil",props:{style:{color:"#81A1C1"}}},{content:":",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:'                    "',props:{style:{color:"#ECEFF4"}}},{content:"No token matching this ID for sale!",props:{style:{color:"#A3BE8C"}}},{content:'"',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"                buyTokens.balance ",props:{style:{color:"#D8DEE9FF"}}},{content:">=",props:{style:{color:"#81A1C1"}}},{content:" (",props:{style:{color:"#D8DEE9FF"}}},{content:"self",props:{style:{color:"#81A1C1"}}},{content:".prices[tokenID] ",props:{style:{color:"#D8DEE9FF"}}},{content:"?? ",props:{style:{color:"#81A1C1"}}},{content:"0",props:{style:{color:"#B48EAD"}}},{content:".",props:{style:{color:"#D8DEE9FF"}}},{content:"0",props:{style:{color:"#B48EAD"}}},{content:"):",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:'                    "',props:{style:{color:"#ECEFF4"}}},{content:"Not enough tokens to by the NFT!",props:{style:{color:"#A3BE8C"}}},{content:'"',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"                recipient.borrow ",props:{style:{color:"#D8DEE9FF"}}},{content:"!= nil",props:{style:{color:"#81A1C1"}}},{content:":",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:'                    "',props:{style:{color:"#ECEFF4"}}},{content:"Invalid NFT receiver capability!",props:{style:{color:"#A3BE8C"}}},{content:'"',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"            }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"            // get the value out of the optional",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"            let",props:{style:{color:"#81A1C1"}}},{content:" price = ",props:{style:{color:"#D8DEE9FF"}}},{content:"self",props:{style:{color:"#81A1C1"}}},{content:".prices[tokenID]",props:{style:{color:"#D8DEE9FF"}}},{content:"!",props:{style:{color:"#81A1C1"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"            self",props:{style:{color:"#81A1C1"}}},{content:".prices[tokenID] ",props:{style:{color:"#D8DEE9FF"}}},{content:"= nil",props:{style:{color:"#81A1C1"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"            let",props:{style:{color:"#81A1C1"}}},{content:" vaultRef = ",props:{style:{color:"#D8DEE9FF"}}},{content:"self",props:{style:{color:"#81A1C1"}}},{content:".ownerVault.",props:{style:{color:"#D8DEE9FF"}}},{content:"borrow",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"                ?? ",props:{style:{color:"#81A1C1"}}},{content:"panic",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"Could not borrow reference to owner token vault",props:{style:{color:"#A3BE8C"}}},{content:'")',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"            // deposit the purchasing tokens into the owners vault",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"            vaultRef.",props:{style:{color:"#D8DEE9FF"}}},{content:"deposit",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"from",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#ECEFF4"}}},{content:"<-",props:{style:{color:"#81A1C1"}}},{content:"buyTokens",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"            // borrow a reference to the object that the receiver capability links to",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"            // We can force-cast the result here because it has already been checked in the pre-conditions",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"            let",props:{style:{color:"#81A1C1"}}},{content:" receiverReference = receiver.",props:{style:{color:"#D8DEE9FF"}}},{content:"borrow",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}},{content:"!",props:{style:{color:"#81A1C1"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"            // deposit the NFT into the buyers collection",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"            receiverReference.",props:{style:{color:"#D8DEE9FF"}}},{content:"deposit",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"token",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#ECEFF4"}}},{content:"<-self",props:{style:{color:"#81A1C1"}}},{content:".ownerCollection.",props:{style:{color:"#D8DEE9FF"}}},{content:"borrow",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}},{content:"!",props:{style:{color:"#81A1C1"}}},{content:".",props:{style:{color:"#D8DEE9FF"}}},{content:"withdraw",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"withdrawID",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" tokenID",props:{style:{color:"#D8DEE9FF"}}},{content:"))",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"            emit ",props:{style:{color:"#81A1C1"}}},{content:"TokenPurchased",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"id",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" tokenID, ",props:{style:{color:"#D8DEE9FF"}}},{content:"price",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" price, ",props:{style:{color:"#D8DEE9FF"}}},{content:"owner",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#ECEFF4"}}},{content:"self",props:{style:{color:"#81A1C1"}}},{content:".owner",props:{style:{color:"#D8DEE9FF"}}},{content:"?",props:{style:{color:"#81A1C1"}}},{content:".address, ",props:{style:{color:"#D8DEE9FF"}}},{content:"buyer",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" receiverReference.owner",props:{style:{color:"#D8DEE9FF"}}},{content:"?",props:{style:{color:"#81A1C1"}}},{content:".address",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        // idPrice returns the price of a specific token in the sale",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"fun ",props:{style:{color:"#81A1C1"}}},{content:"idPrice",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#ECEFF4"}}},{content:"tokenID",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"UInt64",props:{style:{color:"#81A1C1"}}},{content:")",props:{style:{color:"#ECEFF4"}}},{content:": UFix64",props:{style:{color:"#81A1C1"}}},{content:"? ",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"            return self",props:{style:{color:"#81A1C1"}}},{content:".prices[tokenID]",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        // getIDs returns an array of token IDs that are for sale",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"fun ",props:{style:{color:"#81A1C1"}}},{content:"getIDs",props:{style:{color:"#88C0D0"}}},{content:"()",props:{style:{color:"#ECEFF4"}}},{content:":",props:{style:{color:"#81A1C1"}}},{content:" [",props:{style:{color:"#D8DEE9FF"}}},{content:"UInt64",props:{style:{color:"#81A1C1"}}},{content:"] ",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"            return self",props:{style:{color:"#81A1C1"}}},{content:".prices.keys",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    // createCollection returns a new collection resource to the caller",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"fun ",props:{style:{color:"#81A1C1"}}},{content:"createSaleCollection",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#ECEFF4"}}},{content:"ownerCollection",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"Capability",props:{style:{color:"#81A1C1"}}},{content:"<&",props:{style:{color:"#D8DEE9FF"}}},{content:"ExampleNFT",props:{style:{color:"#81A1C1"}}},{content:".",props:{style:{color:"#D8DEE9FF"}}},{content:"Collection",props:{style:{color:"#81A1C1"}}},{content:">,",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"                                 ownerVault",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"Capability",props:{style:{color:"#81A1C1"}}},{content:"<&",props:{style:{color:"#D8DEE9FF"}}},{content:"AnyResource",props:{style:{color:"#81A1C1"}}},{content:"{",props:{style:{color:"#D8DEE9FF"}}},{content:"ExampleToken",props:{style:{color:"#81A1C1"}}},{content:".",props:{style:{color:"#D8DEE9FF"}}},{content:"Receiver",props:{style:{color:"#81A1C1"}}},{content:"}>",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}},{content:":",props:{style:{color:"#81A1C1"}}},{content:" @",props:{style:{color:"#D8DEE9FF"}}},{content:"SaleCollection ",props:{style:{color:"#81A1C1"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        return <- create ",props:{style:{color:"#81A1C1"}}},{content:"SaleCollection",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"ownerCollection",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" ownerCollection, ",props:{style:{color:"#D8DEE9FF"}}},{content:"ownerVault",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" ownerVault",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"}",props:{style:{color:"#ECEFF4"}}}]}],lang:"cadence"},annotations:[]}]}),"\n",(0,n.jsxs)(t.p,{children:["This marketplace contract has resources that function similarly to the NFT ",(0,n.jsx)(t.code,{children:"Collection"}),"\nthat was explained in ",(0,n.jsx)(t.a,{href:"/docs/next/cadence/tutorial/non-fungible-tokens-1",children:"Non-Fungible Tokens"}),", with a few differences and additions:"]}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["This marketplace contract has methods to add and remove NFTs, but instead of storing the NFT resource object in the sale collection,\nthe user provides a capability to their main collection that allows the listed NFT to be withdrawn and transferred when it is purchased.\nWhen a user wants to put their NFT up for sale, they do so by providing the ID and the price to the ",(0,n.jsx)(t.code,{children:"listForSale"})," function.\nThen, another user can call the ",(0,n.jsx)(t.code,{children:"purchase"})," method, sending their ",(0,n.jsx)(t.code,{children:"ExampleToken.Vault"})," that contains the currency they are using to make the purchase.\nThe buyer also includes a capability to their NFT ",(0,n.jsx)(t.code,{children:"ExampleNFT.Collection"})," so that the purchased token\ncan be immediately deposited into their collection when the purchase is made."]}),"\n",(0,n.jsxs)(t.li,{children:["This marketplace contract stores a capability: ",(0,n.jsx)(t.code,{children:"access(all) let ownerVault: Capability<&AnyResource{FungibleToken.Receiver}>"}),".\nThe owner of the sale saves a capability to their Fungible Token ",(0,n.jsx)(t.code,{children:"Receiver"})," within the sale.\nThis allows the sale resource to be able to immediately deposit the currency that was used to buy the NFT\ninto the owners ",(0,n.jsx)(t.code,{children:"Vault"})," when a purchase is made."]}),"\n",(0,n.jsx)(t.li,{children:"This marketplace contract includes events. Cadence supports defining events within contracts\nthat can be emitted when important actions happen. External apps can monitor these events to know the state of the smart contract."}),"\n"]}),"\n",(0,n.jsx)(E.Code,{codeConfig:y,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"    // Event that is emitted when a new NFT is put up for sale",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"event",props:{style:{color:"#81A1C1"}}},{content:" ForSale",props:{style:{color:"#D8DEE9FF"}}},{content:"(",props:{style:{color:"#ECEFF4"}}},{content:"id",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"UInt64",props:{style:{color:"#81A1C1"}}},{content:", ",props:{style:{color:"#D8DEE9FF"}}},{content:"price",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"UFix64",props:{style:{color:"#81A1C1"}}},{content:", ",props:{style:{color:"#D8DEE9FF"}}},{content:"owner",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"Address",props:{style:{color:"#81A1C1"}}},{content:"?",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    // Event that is emitted when the price of an NFT changes",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"event",props:{style:{color:"#81A1C1"}}},{content:" PriceChanged",props:{style:{color:"#D8DEE9FF"}}},{content:"(",props:{style:{color:"#ECEFF4"}}},{content:"id",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"UInt64",props:{style:{color:"#81A1C1"}}},{content:", ",props:{style:{color:"#D8DEE9FF"}}},{content:"newPrice",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"UFix64",props:{style:{color:"#81A1C1"}}},{content:", ",props:{style:{color:"#D8DEE9FF"}}},{content:"owner",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"Address",props:{style:{color:"#81A1C1"}}},{content:"?",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    // Event that is emitted when a token is purchased",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"event",props:{style:{color:"#81A1C1"}}},{content:" TokenPurchased",props:{style:{color:"#D8DEE9FF"}}},{content:"(",props:{style:{color:"#ECEFF4"}}},{content:"id",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"UInt64",props:{style:{color:"#81A1C1"}}},{content:", ",props:{style:{color:"#D8DEE9FF"}}},{content:"price",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"UFix64",props:{style:{color:"#81A1C1"}}},{content:", ",props:{style:{color:"#D8DEE9FF"}}},{content:"seller",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"Address",props:{style:{color:"#81A1C1"}}},{content:"?, ",props:{style:{color:"#D8DEE9FF"}}},{content:"buyer",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"Address",props:{style:{color:"#81A1C1"}}},{content:"?",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    // Event that is emitted when a seller withdraws their NFT from the sale",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"event",props:{style:{color:"#81A1C1"}}},{content:" SaleCanceled",props:{style:{color:"#D8DEE9FF"}}},{content:"(",props:{style:{color:"#ECEFF4"}}},{content:"id",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"UInt64",props:{style:{color:"#81A1C1"}}},{content:", ",props:{style:{color:"#D8DEE9FF"}}},{content:"seller",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"Address",props:{style:{color:"#81A1C1"}}},{content:"?",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]}],lang:"cadence"},annotations:[]}]}),"\n",(0,n.jsx)(t.p,{children:"This contract has a few new features and concepts that are important to cover:"}),"\n",(0,n.jsx)(t.h3,{id:"events",children:"Events"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.a,{href:"../language/events",children:"Events"})," are special values that can be emitted during the execution of a program.\nThey usually contain information to indicate that some important action has happened in a smart contract,\nsuch as an NFT transfer, a permission change, or many other different things.\nOff-chain applications can monitor events using a Flow SDK to know what is happening on-chain without having to query a smart contract directly."]}),"\n",(0,n.jsx)(t.p,{children:"Many applications want to maintain an off-chain record of what is happening on-chain so they can have faster performance\nwhen getting information about their users' accounts or generating analytics."}),"\n",(0,n.jsxs)(t.p,{children:["Events are declared by indicating ",(0,n.jsx)(t.a,{href:"../language/access-control",children:"the access level"}),", ",(0,n.jsx)(t.code,{children:"event"}),",\nand the name and parameters of the event, like a function declaration:"]}),"\n",(0,n.jsx)(E.Code,{codeConfig:y,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"event",props:{style:{color:"#81A1C1"}}},{content:" ForSale",props:{style:{color:"#D8DEE9FF"}}},{content:"(",props:{style:{color:"#ECEFF4"}}},{content:"id",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"UInt64",props:{style:{color:"#81A1C1"}}},{content:", ",props:{style:{color:"#D8DEE9FF"}}},{content:"price",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"UFix64",props:{style:{color:"#81A1C1"}}},{content:", ",props:{style:{color:"#D8DEE9FF"}}},{content:"owner",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"Address",props:{style:{color:"#81A1C1"}}},{content:"?",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]}],lang:"cadence"},annotations:[]}]}),"\n",(0,n.jsx)(t.p,{children:"Events cannot modify state at all; they indicate when important actions happen in the smart contract."}),"\n",(0,n.jsxs)(t.p,{children:["Events are emitted with the ",(0,n.jsx)(t.code,{children:"emit"})," keyword followed by the invocation of the event as if it were a function call."]}),"\n",(0,n.jsx)(E.Code,{codeConfig:y,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"emit ",props:{style:{color:"#81A1C1"}}},{content:"ForSale",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"id",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" tokenID, ",props:{style:{color:"#D8DEE9FF"}}},{content:"price",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" price, ",props:{style:{color:"#D8DEE9FF"}}},{content:"owner",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#ECEFF4"}}},{content:"self",props:{style:{color:"#81A1C1"}}},{content:".owner",props:{style:{color:"#D8DEE9FF"}}},{content:"?",props:{style:{color:"#81A1C1"}}},{content:".address",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]}],lang:"cadence"},annotations:[]}]}),"\n",(0,n.jsx)(t.p,{children:"External applications can monitor the blockchain to take action when certain events are emitted."}),"\n",(0,n.jsx)(t.h3,{id:"resource-owned-capabilities",children:"Resource-Owned Capabilities"}),"\n",(0,n.jsxs)(t.p,{children:["We have covered capabilities in previous ",(0,n.jsx)(t.a,{href:"/docs/next/cadence/tutorial/capabilities",children:"tutorials"}),",\nbut only the basics. Capabilities can be used for so much more!"]}),"\n",(0,n.jsxs)(t.p,{children:["As you hopefully understand, ",(0,n.jsx)(t.a,{href:"/docs/next/cadence/language/capability-based-access-control",children:"capabilites"}),"\nare links to private objects in account storage that specify and expose a subset in the public or private namespace of public or private paths\nwhere the Capability is linked."]}),"\n",(0,n.jsxs)(t.p,{children:["To create a capability, a user typically uses ",(0,n.jsxs)(t.a,{href:"/docs/next/cadence/language/accounts/",children:["the ",(0,n.jsx)(t.code,{children:"AuthAccount.link"})]}),"\nmethod to create a link to a resource in their private storage, specifying a type to link the capability as:"]}),"\n",(0,n.jsx)(E.Code,{codeConfig:y,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"// Create a public Receiver + Balance capability to the Vault",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"// acct is an `AuthAccount`",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"// The object being linked to has to be an `ExampleToken.Vault`,",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"// and the link only exposes the fields in the `ExampleToken.Receiver` and `ExampleToken.Balance` interfaces.",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"acct.link",props:{style:{color:"#D8DEE9FF"}}},{content:"<",props:{style:{color:"#81A1C1"}}},{content:"&ExampleToken.Vault",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}},{content:"ExampleToken.Receiver, ExampleToken.Balance",props:{style:{color:"#D8DEE9FF"}}},{content:"}",props:{style:{color:"#ECEFF4"}}},{content:">",props:{style:{color:"#81A1C1"}}}]},{tokens:[{content:"    (",props:{style:{color:"#D8DEE9FF"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"public",props:{style:{color:"#D8DEE9FF"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"CadenceFungibleTokenTutorialReceiver, target: ",props:{style:{color:"#D8DEE9FF"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"storage",props:{style:{color:"#D8DEE9FF"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"CadenceFungibleTokenTutorialVault)",props:{style:{color:"#D8DEE9FF"}}}]}],lang:"cadence"},annotations:[]}]}),"\n",(0,n.jsxs)(t.p,{children:["Then, users can get that capability if it was created ",(0,n.jsx)(t.a,{href:"../language/accounts/paths",children:"in a public path"}),",\nborrow it, and access the functionality that the owner specified."]}),"\n",(0,n.jsx)(E.Code,{codeConfig:y,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"// Get account 0x01's PublicAccount object",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"let",props:{style:{color:"#81A1C1"}}},{content:" publicAccount = ",props:{style:{color:"#D8DEE9FF"}}},{content:"getAccount",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"0x01",props:{style:{color:"#B48EAD"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"// Retrieve a Vault Receiver Capability from the account's public storage",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"let",props:{style:{color:"#81A1C1"}}},{content:" acct1Capability = acct.getCapability",props:{style:{color:"#D8DEE9FF"}}},{content:"<",props:{style:{color:"#81A1C1"}}},{content:"&AnyResource",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}},{content:"ExampleToken.Receiver",props:{style:{color:"#D8DEE9FF"}}},{content:"}",props:{style:{color:"#ECEFF4"}}},{content:">",props:{style:{color:"#81A1C1"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        /",props:{style:{color:"#81A1C1"}}},{content:"public",props:{style:{color:"#D8DEE9FF"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"CadenceFungibleTokenTutorialReceiver",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    )",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"// Borrow a reference",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"let",props:{style:{color:"#81A1C1"}}},{content:" acct1ReceiverRef = acct1Capability.",props:{style:{color:"#D8DEE9FF"}}},{content:"borrow",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    ?? ",props:{style:{color:"#81A1C1"}}},{content:"panic",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"Could not borrow a receiver reference to the vault",props:{style:{color:"#A3BE8C"}}},{content:'")',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"// Deposit tokens",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"acct1ReceiverRef.",props:{style:{color:"#D8DEE9FF"}}},{content:"deposit",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"from",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#ECEFF4"}}},{content:"<-",props:{style:{color:"#81A1C1"}}},{content:"tokens",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]}],lang:"cadence"},annotations:[]}]}),"\n",(0,n.jsx)(t.p,{children:"With the marketplace contract, we are utilizing a new feature of capabilities.\nCapabilities can be stored anywhere! Lots of functionality is contained within resources,\nand developers will sometimes want to be able to access some of the functionality of resources from within different resources or contracts."}),"\n",(0,n.jsx)(t.p,{children:"We store two different capabilities in the marketplace sale collection:"}),"\n",(0,n.jsx)(E.Code,{codeConfig:y,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"/// A capability for the owner's collection",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"access",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"self",props:{style:{color:"#81A1C1"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"var",props:{style:{color:"#81A1C1"}}},{content:" ownerCollection: ",props:{style:{color:"#D8DEE9FF"}}},{content:"Capability",props:{style:{color:"#81A1C1"}}},{content:"<&",props:{style:{color:"#D8DEE9FF"}}},{content:"ExampleNFT",props:{style:{color:"#81A1C1"}}},{content:".",props:{style:{color:"#D8DEE9FF"}}},{content:"Collection",props:{style:{color:"#81A1C1"}}},{content:">",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"// The fungible token vault of the owner of this sale.",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"// When someone buys a token, this resource can deposit",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"// tokens into their account.",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"access",props:{style:{color:"#88C0D0"}}},{content:"(account",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"let",props:{style:{color:"#81A1C1"}}},{content:" ownerVault: ",props:{style:{color:"#D8DEE9FF"}}},{content:"Capability",props:{style:{color:"#81A1C1"}}},{content:"<&",props:{style:{color:"#D8DEE9FF"}}},{content:"AnyResource",props:{style:{color:"#81A1C1"}}},{content:"{",props:{style:{color:"#D8DEE9FF"}}},{content:"ExampleToken",props:{style:{color:"#81A1C1"}}},{content:".",props:{style:{color:"#D8DEE9FF"}}},{content:"Receiver",props:{style:{color:"#81A1C1"}}},{content:"}>",props:{style:{color:"#D8DEE9FF"}}}]}],lang:"cadence"},annotations:[]}]}),"\n",(0,n.jsx)(t.p,{children:"If an object like a contract or resource owns a capability, they can borrow a reference to that capability at any time\nto access that functionality without having to get it from the owner's account every time."}),"\n",(0,n.jsxs)(t.p,{children:["This is especially important if the owner wants to expose some functionality that is only intended for one person,\nmeaning that the link for the capability is not stored in a public path.\nWe do that in this example, because the sale collection stores a capability that can access all of the functionality\nof the ",(0,n.jsx)(t.code,{children:"ExampleNFT.Collection"}),". It needs this because it withdraws the specified NFT in the ",(0,n.jsx)(t.code,{children:"purchase()"})," method to send to the buyer."]}),"\n",(0,n.jsxs)(t.p,{children:["It is important to remember that control of a capability does not equal ownership of the underlying resource.\nYou can use the capability to access that resource's functionality, but you can't use it to fake ownership.\nYou need the actual resource (identified by the prefixed ",(0,n.jsx)(t.code,{children:"@"})," symbol) to prove ownership."]}),"\n",(0,n.jsxs)(t.p,{children:["Additionally, these capabilities can be stored anywhere, but if a user decides that they no longer want the capability\nto be used, they can revoke it with the ",(0,n.jsx)(t.code,{children:"AuthAccount.unlink()"})," method so any capabilities that use that link are rendered invalid."]}),"\n",(0,n.jsxs)(t.p,{children:["One last piece to consider about capabilities is the decision about when to use them instead of storing the resource directly.\nThis tutorial used to have the ",(0,n.jsx)(t.code,{children:"SaleCollection"})," directly store the NFTs that were for sale, like so:"]}),"\n",(0,n.jsx)(E.Code,{codeConfig:y,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:"access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"resource",props:{style:{color:"#81A1C1"}}},{content:" SaleCollection",props:{style:{color:"#D8DEE9FF"}}},{content:": ",props:{style:{color:"#ECEFF4"}}},{content:"SalePublic ",props:{style:{color:"#81A1C1"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    /// Dictionary of NFT objects for sale",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    /// Maps ID to NFT resource object",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    /// Not recommended",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    access",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"self",props:{style:{color:"#81A1C1"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"var",props:{style:{color:"#81A1C1"}}},{content:" forSale: @{",props:{style:{color:"#D8DEE9FF"}}},{content:"UInt64",props:{style:{color:"#81A1C1"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"ExampleNFT",props:{style:{color:"#81A1C1"}}},{content:".",props:{style:{color:"#D8DEE9FF"}}},{content:"NFT",props:{style:{color:"#81A1C1"}}},{content:"}",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"}",props:{style:{color:"#ECEFF4"}}}]}],lang:"cadence"},annotations:[]}]}),"\n",(0,n.jsxs)(t.p,{children:["This is a logical way to do it, and illustrates another important concept in Cadence, that resources can own other resources!\nCheck out the ",(0,n.jsx)(t.a,{href:"/docs/next/cadence/tutorial/resources-compose",children:"Kitty Hats tutorial"})," for a little more exploration of this concept."]}),"\n",(0,n.jsx)(t.p,{children:"In this case however, nesting resources doesn't make sense. If a user decides to store their for-sale NFTs in a separate place from their main collection,\nthen those NFTs are not available to be shown to any app or smart contract that queries the main collection,\nso it is as if the owner doesn't actually own the NFT!"}),"\n",(0,n.jsx)(t.p,{children:"In cases like this, we usually recommend using a capability to the main collection so that the main collection can remain unchanged and fully usable by\nother smart contracts and apps. This also means that if a for-sale NFT gets transferred by some means other than a purchase, then you need a way to get\nrid of the stale listing. That is out of the scope of this tutorial though."}),"\n",(0,n.jsx)(t.p,{children:"Enough explaining! Lets execute some code!"}),"\n",(0,n.jsx)(t.h2,{id:"using-the-marketplace",children:"Using the Marketplace"}),"\n",(0,n.jsxs)(t.p,{children:["At this point, we should have an ",(0,n.jsx)(t.code,{children:"ExampleToken.Vault"})," and an ",(0,n.jsx)(t.code,{children:"Example.NFT.Collection"})," in both accounts' storage.\nAccount ",(0,n.jsx)(t.code,{children:"0x01"})," should have an NFT in their collection and the ",(0,n.jsx)(t.code,{children:"ExampleMarketplace"})," contract should be deployed to ",(0,n.jsx)(t.code,{children:"0x03"}),"."]}),"\n",(0,n.jsxs)(t.p,{children:["You can create a ",(0,n.jsx)(t.code,{children:"SaleCollection"})," and list account ",(0,n.jsx)(t.code,{children:"0x01"}),"'s token for sale by following these steps:"]}),"\n",(0,n.jsx)(e,{type:"info",children:(0,n.jsxs)(t.ol,{children:["\n",(0,n.jsxs)(t.li,{children:["Open Transaction 4, ",(0,n.jsx)(t.code,{children:"CreateSale.cdc"})," ",(0,n.jsx)("br",{})]}),"\n",(0,n.jsxs)(t.li,{children:["Select account ",(0,n.jsx)(t.code,{children:"0x01"})," as the only signer and click the ",(0,n.jsx)(t.code,{children:"Send"})," button to submit the transaction."]}),"\n"]})}),"\n",(0,n.jsx)(E.Code,{codeConfig:y,northPanel:{tabs:["Transaction4.cdc"],active:"Transaction4.cdc",heightRatio:1},files:[{name:"Transaction4.cdc",focus:"",code:{lines:[{tokens:[{content:"// CreateSale.cdc",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"import",props:{style:{color:"#81A1C1"}}},{content:" ExampleToken ",props:{style:{color:"#D8DEE9FF"}}},{content:"from ",props:{style:{color:"#81A1C1"}}},{content:"0x01",props:{style:{color:"#B48EAD"}}}]},{tokens:[{content:"import",props:{style:{color:"#81A1C1"}}},{content:" ExampleNFT ",props:{style:{color:"#D8DEE9FF"}}},{content:"from ",props:{style:{color:"#81A1C1"}}},{content:"0x02",props:{style:{color:"#B48EAD"}}}]},{tokens:[{content:"import",props:{style:{color:"#81A1C1"}}},{content:" ExampleMarketplace ",props:{style:{color:"#D8DEE9FF"}}},{content:"from ",props:{style:{color:"#81A1C1"}}},{content:"0x03",props:{style:{color:"#B48EAD"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"// This transaction creates a new Sale Collection object,",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"// lists an NFT for sale, puts it in account storage,",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"// and creates a public capability to the sale so that others can buy the token.",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"transaction ",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    prepare",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"acct",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" AuthAccount",props:{style:{color:"#D8DEE9FF"}}},{content:") {",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        // Borrow a reference to the stored Vault",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        let",props:{style:{color:"#81A1C1"}}},{content:" receiver = acct.getCapability",props:{style:{color:"#D8DEE9FF"}}},{content:"<",props:{style:{color:"#81A1C1"}}},{content:"&",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}},{content:"ExampleToken.Receiver",props:{style:{color:"#D8DEE9FF"}}},{content:"}",props:{style:{color:"#ECEFF4"}}},{content:">",props:{style:{color:"#81A1C1"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"public",props:{style:{color:"#D8DEE9FF"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"CadenceFungibleTokenTutorialReceiver)",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        // borrow a reference to the nftTutorialCollection in storage",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        let",props:{style:{color:"#81A1C1"}}},{content:" collectionCapability = acct.link",props:{style:{color:"#D8DEE9FF"}}},{content:"<",props:{style:{color:"#81A1C1"}}},{content:"&ExampleNFT.Collection",props:{style:{color:"#D8DEE9FF"}}},{content:">",props:{style:{color:"#81A1C1"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"/private/",props:{style:{color:"#81A1C1"}}},{content:"nftTutorialCollection, target: ExampleNFT.CollectionStoragePath)",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"          ?? ",props:{style:{color:"#81A1C1"}}},{content:"panic",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"Unable to create private link to NFT Collection",props:{style:{color:"#A3BE8C"}}},{content:'")',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        // Create a new Sale object,",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        // initializing it with the reference to the owner's vault",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        let",props:{style:{color:"#81A1C1"}}},{content:" sale <- ExampleMarketplace.",props:{style:{color:"#D8DEE9FF"}}},{content:"createSaleCollection",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"ownerCollection",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" collectionCapability, ",props:{style:{color:"#D8DEE9FF"}}},{content:"ownerVault",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" receiver",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        // List the token for sale by moving it into the sale object",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        sale.",props:{style:{color:"#D8DEE9FF"}}},{content:"listForSale",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"tokenID",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#ECEFF4"}}},{content:"1",props:{style:{color:"#B48EAD"}}},{content:", ",props:{style:{color:"#D8DEE9FF"}}},{content:"price",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#ECEFF4"}}},{content:"10",props:{style:{color:"#B48EAD"}}},{content:".",props:{style:{color:"#D8DEE9FF"}}},{content:"0",props:{style:{color:"#B48EAD"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        // Store the sale object in the account storage",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        acct.",props:{style:{color:"#D8DEE9FF"}}},{content:"save",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"<-",props:{style:{color:"#81A1C1"}}},{content:"sale, ",props:{style:{color:"#D8DEE9FF"}}},{content:"to",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#ECEFF4"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"storage",props:{style:{color:"#D8DEE9FF"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"NFTSale",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        // Create a public capability to the sale so that others can call its methods",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        acct.link",props:{style:{color:"#D8DEE9FF"}}},{content:"<",props:{style:{color:"#81A1C1"}}},{content:"&ExampleMarketplace.SaleCollection",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}},{content:"ExampleMarketplace.SalePublic",props:{style:{color:"#D8DEE9FF"}}},{content:"}",props:{style:{color:"#ECEFF4"}}},{content:">",props:{style:{color:"#81A1C1"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"public",props:{style:{color:"#D8DEE9FF"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"NFTSale, target: ",props:{style:{color:"#D8DEE9FF"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"storage",props:{style:{color:"#D8DEE9FF"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"NFTSale)",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        log",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"Sale Created for account 1. Selling NFT 1 for 10 tokens",props:{style:{color:"#A3BE8C"}}},{content:'")',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"}",props:{style:{color:"#ECEFF4"}}}]}],lang:"cadence"},annotations:[]}]}),"\n",(0,n.jsx)(t.p,{children:"This transaction:"}),"\n",(0,n.jsxs)(t.ol,{children:["\n",(0,n.jsxs)(t.li,{children:["Gets a ",(0,n.jsx)(t.code,{children:"Receiver"})," capability on the owners ",(0,n.jsx)(t.code,{children:"Vault"}),"."]}),"\n",(0,n.jsxs)(t.li,{children:["Gets a private ",(0,n.jsx)(t.code,{children:"ExampleNFT.Collection"})," Capability from the owner."]}),"\n",(0,n.jsxs)(t.li,{children:["Creates the ",(0,n.jsx)(t.code,{children:"SaleCollection"}),", which stores their ",(0,n.jsx)(t.code,{children:"Vault"})," and ",(0,n.jsx)(t.code,{children:"ExampleNFT.Collection"})," capabilities."]}),"\n",(0,n.jsxs)(t.li,{children:["Lists the token with ",(0,n.jsx)(t.code,{children:"ID = 1"})," for sale and sets its price as 10.0."]}),"\n",(0,n.jsxs)(t.li,{children:["Stores the ",(0,n.jsx)(t.code,{children:"SaleCollection"})," in their account storage and links a public capability that allows others to purchase any NFTs for sale."]}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"Let's run a script to ensure that the sale was created correctly."}),"\n",(0,n.jsxs)(t.ol,{children:["\n",(0,n.jsxs)(t.li,{children:["Open Script 2: ",(0,n.jsx)(t.code,{children:"GetSaleIDs.cdc"})]}),"\n",(0,n.jsxs)(t.li,{children:["Click the ",(0,n.jsx)(t.code,{children:"Execute"})," button to print the ID and price of the NFT that account ",(0,n.jsx)(t.code,{children:"0x01"})," has for sale."]}),"\n"]}),"\n",(0,n.jsx)(E.Code,{codeConfig:y,northPanel:{tabs:["GetSaleIDs.cdc"],active:"GetSaleIDs.cdc",heightRatio:1},files:[{name:"GetSaleIDs.cdc",focus:"",code:{lines:[{tokens:[{content:"// GetSaleIDs.cdc",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"import",props:{style:{color:"#81A1C1"}}},{content:" ExampleToken ",props:{style:{color:"#D8DEE9FF"}}},{content:"from ",props:{style:{color:"#81A1C1"}}},{content:"0x01",props:{style:{color:"#B48EAD"}}}]},{tokens:[{content:"import",props:{style:{color:"#81A1C1"}}},{content:" ExampleNFT ",props:{style:{color:"#D8DEE9FF"}}},{content:"from ",props:{style:{color:"#81A1C1"}}},{content:"0x02",props:{style:{color:"#B48EAD"}}}]},{tokens:[{content:"import",props:{style:{color:"#81A1C1"}}},{content:" ExampleMarketplace ",props:{style:{color:"#D8DEE9FF"}}},{content:"from ",props:{style:{color:"#81A1C1"}}},{content:"0x03",props:{style:{color:"#B48EAD"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"// This script prints the NFTs that account 0x01 has for sale.",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"fun ",props:{style:{color:"#81A1C1"}}},{content:"main",props:{style:{color:"#88C0D0"}}},{content:"() {",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    // Get the public account object for account 0x01",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    let",props:{style:{color:"#81A1C1"}}},{content:" account1 = ",props:{style:{color:"#D8DEE9FF"}}},{content:"getAccount",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"0x01",props:{style:{color:"#B48EAD"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    // Find the public Sale reference to their Collection",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    let",props:{style:{color:"#81A1C1"}}},{content:" acct1saleRef = account1.",props:{style:{color:"#D8DEE9FF"}}},{content:"getCapability",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"public",props:{style:{color:"#D8DEE9FF"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"NFTSale",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"                       .borrow",props:{style:{color:"#D8DEE9FF"}}},{content:"<",props:{style:{color:"#81A1C1"}}},{content:"&AnyResource",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}},{content:"ExampleMarketplace.SalePublic",props:{style:{color:"#D8DEE9FF"}}},{content:"}",props:{style:{color:"#ECEFF4"}}},{content:">",props:{style:{color:"#81A1C1"}}},{content:"()",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"                       ?? ",props:{style:{color:"#81A1C1"}}},{content:"panic",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"Could not borrow acct2 nft sale reference",props:{style:{color:"#A3BE8C"}}},{content:'")',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    // Los the NFTs that are for sale",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    log",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"Account 1 NFTs for sale",props:{style:{color:"#A3BE8C"}}},{content:'")',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    log",props:{style:{color:"#88C0D0"}}},{content:"(acct1saleRef.",props:{style:{color:"#D8DEE9FF"}}},{content:"getIDs",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"))",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    log",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"Price",props:{style:{color:"#A3BE8C"}}},{content:'")',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    log",props:{style:{color:"#88C0D0"}}},{content:"(acct1saleRef.",props:{style:{color:"#D8DEE9FF"}}},{content:"idPrice",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"tokenID",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#ECEFF4"}}},{content:"1",props:{style:{color:"#B48EAD"}}},{content:"))",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"}",props:{style:{color:"#ECEFF4"}}}]}],lang:"cadence"},annotations:[]}]}),"\n",(0,n.jsx)(t.p,{children:"This script should complete and print something like this:"}),"\n",(0,n.jsx)(E.Code,{codeConfig:y,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:'"Account 1 NFTs for sale"',props:{}}]},{tokens:[{content:"[1]",props:{}}]},{tokens:[{content:'"Price"',props:{}}]},{tokens:[{content:"10",props:{}}]}],lang:"text"},annotations:[]}]}),"\n",(0,n.jsx)(t.h2,{id:"purchasing-an-nft",children:"Purchasing an NFT"}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsxs)(t.p,{children:["The buyer can now purchase the seller's NFT by using the transaction in ",(0,n.jsx)(t.code,{children:"Transaction2.cdc"}),":"]}),"\n",(0,n.jsx)(e,{type:"info",children:(0,n.jsxs)(t.ol,{children:["\n",(0,n.jsxs)(t.li,{children:["Open Transaction 5: ",(0,n.jsx)(t.code,{children:"PurchaseSale.cdc"})," file",(0,n.jsx)("br",{})]}),"\n",(0,n.jsxs)(t.li,{children:["Select account ",(0,n.jsx)(t.code,{children:"0x02"})," as the only signer and click the ",(0,n.jsx)(t.code,{children:"Send"})," button"]}),"\n"]})}),"\n",(0,n.jsx)(E.Code,{codeConfig:y,northPanel:{tabs:["PurchaseSale.cdc"],active:"PurchaseSale.cdc",heightRatio:1},files:[{name:"PurchaseSale.cdc",focus:"",code:{lines:[{tokens:[{content:"// PurchaseSale.cdc",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"import",props:{style:{color:"#81A1C1"}}},{content:" ExampleToken ",props:{style:{color:"#D8DEE9FF"}}},{content:"from ",props:{style:{color:"#81A1C1"}}},{content:"0x01",props:{style:{color:"#B48EAD"}}}]},{tokens:[{content:"import",props:{style:{color:"#81A1C1"}}},{content:" ExampleNFT ",props:{style:{color:"#D8DEE9FF"}}},{content:"from ",props:{style:{color:"#81A1C1"}}},{content:"0x02",props:{style:{color:"#B48EAD"}}}]},{tokens:[{content:"import",props:{style:{color:"#81A1C1"}}},{content:" ExampleMarketplace ",props:{style:{color:"#D8DEE9FF"}}},{content:"from ",props:{style:{color:"#81A1C1"}}},{content:"0x03",props:{style:{color:"#B48EAD"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"// This transaction uses the signers Vault tokens to purchase an NFT",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"// from the Sale collection of account 0x01.",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"transaction ",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    // Capability to the buyer's NFT collection where they",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    // will store the bought NFT",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    let",props:{style:{color:"#81A1C1"}}},{content:" collectionCapability: ",props:{style:{color:"#D8DEE9FF"}}},{content:"Capability",props:{style:{color:"#81A1C1"}}},{content:"<&",props:{style:{color:"#D8DEE9FF"}}},{content:"AnyResource",props:{style:{color:"#81A1C1"}}},{content:"{",props:{style:{color:"#D8DEE9FF"}}},{content:"ExampleNFT",props:{style:{color:"#81A1C1"}}},{content:".",props:{style:{color:"#D8DEE9FF"}}},{content:"NFTReceiver",props:{style:{color:"#81A1C1"}}},{content:"}>",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    // Vault that will hold the tokens that will be used to",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    // but the NFT",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    let",props:{style:{color:"#81A1C1"}}},{content:" temporaryVault: @",props:{style:{color:"#D8DEE9FF"}}},{content:"ExampleToken",props:{style:{color:"#81A1C1"}}},{content:".",props:{style:{color:"#D8DEE9FF"}}},{content:"Vault",props:{style:{color:"#81A1C1"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    prepare",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"acct",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" AuthAccount",props:{style:{color:"#D8DEE9FF"}}},{content:") {",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        // get the references to the buyer's fungible token Vault and NFT Collection Receiver",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        self",props:{style:{color:"#81A1C1"}}},{content:".collectionCapability ",props:{style:{color:"#D8DEE9FF"}}},{content:"=",props:{style:{color:"#81A1C1"}}},{content:" acct.getCapability",props:{style:{color:"#D8DEE9FF"}}},{content:"<",props:{style:{color:"#81A1C1"}}},{content:"&AnyResource",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}},{content:"ExampleNFT.NFTReceiver",props:{style:{color:"#D8DEE9FF"}}},{content:"}",props:{style:{color:"#ECEFF4"}}},{content:">",props:{style:{color:"#81A1C1"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"from",props:{style:{color:"#81A1C1"}}},{content:": ExampleNFT.CollectionPublicPath)",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        let",props:{style:{color:"#81A1C1"}}},{content:" vaultRef = acct.borrow",props:{style:{color:"#D8DEE9FF"}}},{content:"<",props:{style:{color:"#81A1C1"}}},{content:"&ExampleToken.Vault",props:{style:{color:"#D8DEE9FF"}}},{content:">",props:{style:{color:"#81A1C1"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"from",props:{style:{color:"#81A1C1"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"storage",props:{style:{color:"#D8DEE9FF"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"CadenceFungibleTokenTutorialVault)",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"            ?? ",props:{style:{color:"#81A1C1"}}},{content:"panic",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"Could not borrow owner's vault reference",props:{style:{color:"#A3BE8C"}}},{content:'")',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        // withdraw tokens from the buyers Vault",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        self",props:{style:{color:"#81A1C1"}}},{content:".temporaryVault ",props:{style:{color:"#D8DEE9FF"}}},{content:"<-",props:{style:{color:"#81A1C1"}}},{content:" vaultRef.",props:{style:{color:"#D8DEE9FF"}}},{content:"withdraw",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"amount",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#ECEFF4"}}},{content:"10",props:{style:{color:"#B48EAD"}}},{content:".",props:{style:{color:"#D8DEE9FF"}}},{content:"0",props:{style:{color:"#B48EAD"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    execute ",props:{style:{color:"#81A1C1"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        // get the read-only account storage of the seller",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        let",props:{style:{color:"#81A1C1"}}},{content:" seller = ",props:{style:{color:"#D8DEE9FF"}}},{content:"getAccount",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"0x01",props:{style:{color:"#B48EAD"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        // get the reference to the seller's sale",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        let",props:{style:{color:"#81A1C1"}}},{content:" saleRef = seller.",props:{style:{color:"#D8DEE9FF"}}},{content:"getCapability",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"public",props:{style:{color:"#D8DEE9FF"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"NFTSale",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}},{content:"!",props:{style:{color:"#81A1C1"}}}]},{tokens:[{content:"                            .borrow",props:{style:{color:"#D8DEE9FF"}}},{content:"<",props:{style:{color:"#81A1C1"}}},{content:"&AnyResource",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}},{content:"ExampleMarketplace.SalePublic",props:{style:{color:"#D8DEE9FF"}}},{content:"}",props:{style:{color:"#ECEFF4"}}},{content:">",props:{style:{color:"#81A1C1"}}},{content:"()",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"                            ?? ",props:{style:{color:"#81A1C1"}}},{content:"panic",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"Could not borrow seller's sale reference",props:{style:{color:"#A3BE8C"}}},{content:'")',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        // purchase the NFT the seller is selling, giving them the capability",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        // to your NFT collection and giving them the tokens to buy it",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        saleRef.",props:{style:{color:"#D8DEE9FF"}}},{content:"purchase",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"tokenID",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#ECEFF4"}}},{content:"1",props:{style:{color:"#B48EAD"}}},{content:", ",props:{style:{color:"#D8DEE9FF"}}},{content:"recipient",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#ECEFF4"}}},{content:"self",props:{style:{color:"#81A1C1"}}},{content:".collectionCapability, ",props:{style:{color:"#D8DEE9FF"}}},{content:"buyTokens",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#ECEFF4"}}},{content:"<-self",props:{style:{color:"#81A1C1"}}},{content:".temporaryVault",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        log",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"Token 1 has been bought by account 2!",props:{style:{color:"#A3BE8C"}}},{content:'")',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"}",props:{style:{color:"#ECEFF4"}}}]}],lang:"cadence"},annotations:[]}]}),"\n",(0,n.jsx)(t.p,{children:"This transaction:"}),"\n",(0,n.jsxs)(t.ol,{children:["\n",(0,n.jsx)(t.li,{children:"Gets the capability to the buyer's NFT receiver"}),"\n",(0,n.jsx)(t.li,{children:"Get a reference to their token vault and withdraws the sale purchase amount"}),"\n",(0,n.jsxs)(t.li,{children:["Gets the public account object for account ",(0,n.jsx)(t.code,{children:"0x01"})]}),"\n",(0,n.jsx)(t.li,{children:"Gets the reference to the seller's public sale"}),"\n",(0,n.jsxs)(t.li,{children:["Calls the ",(0,n.jsx)(t.code,{children:"purchase"})," function, passing in the tokens and the ",(0,n.jsx)(t.code,{children:"Collection"})," reference. Then ",(0,n.jsx)(t.code,{children:"purchase"})," deposits the bought NFT directly into the buyer's collection."]}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"verifying-the-nft-was-purchased-correctly",children:"Verifying the NFT Was Purchased Correctly"}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.p,{children:"You can run now run a script to verify that the NFT was purchased correctly because:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["account ",(0,n.jsx)(t.code,{children:"0x01"})," has 50 tokens and does not have any NFTs for sale or in their collection and account"]}),"\n",(0,n.jsxs)(t.li,{children:["account ",(0,n.jsx)(t.code,{children:"0x02"})," has 10 tokens and an NFT with id=1"]}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"To run a script that verifies the NFT was purchased correctly, follow these steps:"}),"\n",(0,n.jsx)(e,{type:"info",children:(0,n.jsxs)(t.ol,{children:["\n",(0,n.jsxs)(t.li,{children:["Open Script 3: ",(0,n.jsx)(t.code,{children:"VerifyAfterPurchase.cdc"}),(0,n.jsx)("br",{})]}),"\n",(0,n.jsxs)(t.li,{children:["Click the ",(0,n.jsx)(t.code,{children:"Execute"})," button"]}),"\n"]})}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.code,{children:"VerifyAfterPurchase.cdc"})," should contain the following code:"]}),"\n",(0,n.jsx)(E.Code,{codeConfig:y,northPanel:{tabs:["Script3.cdc"],active:"Script3.cdc",heightRatio:1},files:[{name:"Script3.cdc",focus:"",code:{lines:[{tokens:[{content:"// VerifyAfterPurchase.cdc",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"import",props:{style:{color:"#81A1C1"}}},{content:" ExampleToken ",props:{style:{color:"#D8DEE9FF"}}},{content:"from ",props:{style:{color:"#81A1C1"}}},{content:"0x01",props:{style:{color:"#B48EAD"}}}]},{tokens:[{content:"import",props:{style:{color:"#81A1C1"}}},{content:" ExampleNFT ",props:{style:{color:"#D8DEE9FF"}}},{content:"from ",props:{style:{color:"#81A1C1"}}},{content:"0x02",props:{style:{color:"#B48EAD"}}}]},{tokens:[{content:"import",props:{style:{color:"#81A1C1"}}},{content:" ExampleMarketplace ",props:{style:{color:"#D8DEE9FF"}}},{content:"from ",props:{style:{color:"#81A1C1"}}},{content:"0x03",props:{style:{color:"#B48EAD"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"// This script checks that the Vault balances and NFT collections are correct",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"// for both accounts.",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"//",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"// Account 1: Vault balance = 50, No NFTs",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"// Account 2: Vault balance = 10, NFT ID=1",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"fun ",props:{style:{color:"#81A1C1"}}},{content:"main",props:{style:{color:"#88C0D0"}}},{content:"() {",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    // Get the accounts' public account objects",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    let",props:{style:{color:"#81A1C1"}}},{content:" acct1 = ",props:{style:{color:"#D8DEE9FF"}}},{content:"getAccount",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"0x01",props:{style:{color:"#B48EAD"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    let",props:{style:{color:"#81A1C1"}}},{content:" acct2 = ",props:{style:{color:"#D8DEE9FF"}}},{content:"getAccount",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"0x02",props:{style:{color:"#B48EAD"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    // Get references to the account's receivers",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    // by getting their public capability",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    // and borrowing a reference from the capability",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    let",props:{style:{color:"#81A1C1"}}},{content:" acct1ReceiverRef = acct1.",props:{style:{color:"#D8DEE9FF"}}},{content:"getCapability",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"public",props:{style:{color:"#D8DEE9FF"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"CadenceFungibleTokenTutorialReceiver",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"                           .borrow",props:{style:{color:"#D8DEE9FF"}}},{content:"<",props:{style:{color:"#81A1C1"}}},{content:"&ExampleToken.Vault",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}},{content:"ExampleToken.Balance",props:{style:{color:"#D8DEE9FF"}}},{content:"}",props:{style:{color:"#ECEFF4"}}},{content:">",props:{style:{color:"#81A1C1"}}},{content:"()",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"                           ?? ",props:{style:{color:"#81A1C1"}}},{content:"panic",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"Could not borrow acct1 vault reference",props:{style:{color:"#A3BE8C"}}},{content:'")',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    let",props:{style:{color:"#81A1C1"}}},{content:" acct2ReceiverRef = acct2.",props:{style:{color:"#D8DEE9FF"}}},{content:"getCapability",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"public",props:{style:{color:"#D8DEE9FF"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"CadenceFungibleTokenTutorialReceiver",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"                            .borrow",props:{style:{color:"#D8DEE9FF"}}},{content:"<",props:{style:{color:"#81A1C1"}}},{content:"&ExampleToken.Vault",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}},{content:"ExampleToken.Balance",props:{style:{color:"#D8DEE9FF"}}},{content:"}",props:{style:{color:"#ECEFF4"}}},{content:">",props:{style:{color:"#81A1C1"}}},{content:"()",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"                            ?? ",props:{style:{color:"#81A1C1"}}},{content:"panic",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"Could not borrow acct2 vault reference",props:{style:{color:"#A3BE8C"}}},{content:'")',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    // Log the Vault balance of both accounts and ensure they are",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    // the correct numbers.",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    // Account 0x01 should have 50.",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    // Account 0x02 should have 10.",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    log",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"Account 1 Balance",props:{style:{color:"#A3BE8C"}}},{content:'")',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"\tlog",props:{style:{color:"#88C0D0"}}},{content:"(acct1ReceiverRef.balance",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    log",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"Account 2 Balance",props:{style:{color:"#A3BE8C"}}},{content:'")',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    log",props:{style:{color:"#88C0D0"}}},{content:"(acct2ReceiverRef.balance",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    // verify that the balances are correct",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    if",props:{style:{color:"#81A1C1"}}},{content:" acct1ReceiverRef.balance ",props:{style:{color:"#D8DEE9FF"}}},{content:"!= ",props:{style:{color:"#81A1C1"}}},{content:"50",props:{style:{color:"#B48EAD"}}},{content:".",props:{style:{color:"#D8DEE9FF"}}},{content:"0 ",props:{style:{color:"#B48EAD"}}},{content:"||",props:{style:{color:"#81A1C1"}}},{content:" acct2ReceiverRef.balance ",props:{style:{color:"#D8DEE9FF"}}},{content:"!= ",props:{style:{color:"#81A1C1"}}},{content:"10",props:{style:{color:"#B48EAD"}}},{content:".",props:{style:{color:"#D8DEE9FF"}}},{content:"0 ",props:{style:{color:"#B48EAD"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        panic",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"Wrong balances!",props:{style:{color:"#A3BE8C"}}},{content:'")',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    // Find the public Receiver capability for their Collections",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    let",props:{style:{color:"#81A1C1"}}},{content:" acct1Capability = acct1.",props:{style:{color:"#D8DEE9FF"}}},{content:"getCapability",props:{style:{color:"#88C0D0"}}},{content:"(ExampleNFT.CollectionPublicPath",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    let",props:{style:{color:"#81A1C1"}}},{content:" acct2Capability = acct2.",props:{style:{color:"#D8DEE9FF"}}},{content:"getCapability",props:{style:{color:"#88C0D0"}}},{content:"(ExampleNFT.CollectionPublicPath",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    // borrow references from the capabilities",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    let",props:{style:{color:"#81A1C1"}}},{content:" nft1Ref = acct1Capability.borrow",props:{style:{color:"#D8DEE9FF"}}},{content:"<",props:{style:{color:"#81A1C1"}}},{content:"&",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}},{content:"ExampleNFT.NFTReceiver",props:{style:{color:"#D8DEE9FF"}}},{content:"}",props:{style:{color:"#ECEFF4"}}},{content:">",props:{style:{color:"#81A1C1"}}},{content:"()",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        ?? ",props:{style:{color:"#81A1C1"}}},{content:"panic",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"Could not borrow acct1 nft collection reference",props:{style:{color:"#A3BE8C"}}},{content:'")',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    let",props:{style:{color:"#81A1C1"}}},{content:" nft2Ref = acct2Capability.borrow",props:{style:{color:"#D8DEE9FF"}}},{content:"<",props:{style:{color:"#81A1C1"}}},{content:"&",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}},{content:"ExampleNFT.NFTReceiver",props:{style:{color:"#D8DEE9FF"}}},{content:"}",props:{style:{color:"#ECEFF4"}}},{content:">",props:{style:{color:"#81A1C1"}}},{content:"()",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        ?? ",props:{style:{color:"#81A1C1"}}},{content:"panic",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"Could not borrow acct2 nft collection reference",props:{style:{color:"#A3BE8C"}}},{content:'")',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    // Print both collections as arrays of IDs",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    log",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"Account 1 NFTs",props:{style:{color:"#A3BE8C"}}},{content:'")',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    log",props:{style:{color:"#88C0D0"}}},{content:"(nft1Ref.",props:{style:{color:"#D8DEE9FF"}}},{content:"getIDs",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"))",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    log",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"Account 2 NFTs",props:{style:{color:"#A3BE8C"}}},{content:'")',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    log",props:{style:{color:"#88C0D0"}}},{content:"(nft2Ref.",props:{style:{color:"#D8DEE9FF"}}},{content:"getIDs",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"))",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    // verify that the collections are correct",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    if",props:{style:{color:"#81A1C1"}}},{content:" nft2Ref.",props:{style:{color:"#D8DEE9FF"}}},{content:"getIDs",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}},{content:"[",props:{style:{color:"#D8DEE9FF"}}},{content:"0",props:{style:{color:"#B48EAD"}}},{content:"] ",props:{style:{color:"#D8DEE9FF"}}},{content:"!= ",props:{style:{color:"#81A1C1"}}},{content:"1 ",props:{style:{color:"#B48EAD"}}},{content:"||",props:{style:{color:"#81A1C1"}}},{content:" nft1Ref.",props:{style:{color:"#D8DEE9FF"}}},{content:"getIDs",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}},{content:".length ",props:{style:{color:"#D8DEE9FF"}}},{content:"!= ",props:{style:{color:"#81A1C1"}}},{content:"0 ",props:{style:{color:"#B48EAD"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        panic",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"Wrong Collections!",props:{style:{color:"#A3BE8C"}}},{content:'")',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    // Get the public sale reference for Account 0x01",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    let",props:{style:{color:"#81A1C1"}}},{content:" acct1SaleRef = acct1.",props:{style:{color:"#D8DEE9FF"}}},{content:"getCapability",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"public",props:{style:{color:"#D8DEE9FF"}}},{content:"/",props:{style:{color:"#81A1C1"}}},{content:"NFTSale",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"                       .borrow",props:{style:{color:"#D8DEE9FF"}}},{content:"<",props:{style:{color:"#81A1C1"}}},{content:"&AnyResource",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}},{content:"ExampleMarketplace.SalePublic",props:{style:{color:"#D8DEE9FF"}}},{content:"}",props:{style:{color:"#ECEFF4"}}},{content:">",props:{style:{color:"#81A1C1"}}},{content:"()",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"                       ?? ",props:{style:{color:"#81A1C1"}}},{content:"panic",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"Could not borrow acct1 nft sale reference",props:{style:{color:"#A3BE8C"}}},{content:'")',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    // Print the NFTs that account 0x01 has for sale",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    log",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"Account 1 NFTs for sale",props:{style:{color:"#A3BE8C"}}},{content:'")',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    log",props:{style:{color:"#88C0D0"}}},{content:"(acct1SaleRef.",props:{style:{color:"#D8DEE9FF"}}},{content:"getIDs",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"))",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    if",props:{style:{color:"#81A1C1"}}},{content:" acct1SaleRef.",props:{style:{color:"#D8DEE9FF"}}},{content:"getIDs",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}},{content:".length ",props:{style:{color:"#D8DEE9FF"}}},{content:"!= ",props:{style:{color:"#81A1C1"}}},{content:"0 ",props:{style:{color:"#B48EAD"}}},{content:"{ ",props:{style:{color:"#ECEFF4"}}},{content:"panic",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"Sale should be empty!",props:{style:{color:"#A3BE8C"}}},{content:'") }',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"}",props:{style:{color:"#ECEFF4"}}}]}],lang:"cadence"},annotations:[]}]}),"\n",(0,n.jsx)(t.p,{children:"If you did everything correctly, the transaction should succeed and it should print something similar to this:"}),"\n",(0,n.jsx)(E.Code,{codeConfig:y,northPanel:{tabs:[""],active:"",heightRatio:1},files:[{name:"",focus:"",code:{lines:[{tokens:[{content:'"Account 1 Vault Balance"',props:{}}]},{tokens:[{content:"50",props:{}}]},{tokens:[{content:'"Account 2 Vault Balance"',props:{}}]},{tokens:[{content:"10",props:{}}]},{tokens:[{content:'"Account 1 NFTs"',props:{}}]},{tokens:[{content:"[]",props:{}}]},{tokens:[{content:'"Account 2 NFTs"',props:{}}]},{tokens:[{content:"[1]",props:{}}]},{tokens:[{content:'"Account 1 NFTs for Sale"',props:{}}]},{tokens:[{content:"[]",props:{}}]}],lang:"text"},annotations:[]}]}),"\n",(0,n.jsx)(t.p,{children:"Congratulations, you have successfully implemented a simple marketplace in Cadence and used it to allow one account to buy an NFT from another!"}),"\n",(0,n.jsx)(t.h2,{id:"scaling-the-marketplace",children:"Scaling the Marketplace"}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.p,{children:"A user can hold a sale in their account with these resources and transactions.\nSupport for a central marketplace where users can discover sales is relatively easy to implement and can build on what we already have.\nIf we wanted to build a central marketplace on-chain, we could use a contract that looks something like this:"}),"\n",(0,n.jsx)(E.Code,{codeConfig:y,northPanel:{tabs:["CentralMarketplace.cdc"],active:"CentralMarketplace.cdc",heightRatio:1},files:[{name:"CentralMarketplace.cdc",focus:"",code:{lines:[{tokens:[{content:"// Marketplace would be the central contract where people can post their sale",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"// references so that anyone can access them",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"contract",props:{style:{color:"#81A1C1"}}},{content:" Marketplace ",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    // Data structure to store active sales",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"var",props:{style:{color:"#81A1C1"}}},{content:" tokensForSale: {",props:{style:{color:"#D8DEE9FF"}}},{content:"Address",props:{style:{color:"#81A1C1"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"Capability",props:{style:{color:"#81A1C1"}}},{content:"<&",props:{style:{color:"#D8DEE9FF"}}},{content:"SaleCollection",props:{style:{color:"#81A1C1"}}},{content:">)}",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    // listSaleCollection lists a users sale reference in the array",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    // and returns the index of the sale so that users can know",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    // how to remove it from the marketplace",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"fun ",props:{style:{color:"#81A1C1"}}},{content:"listSaleCollection",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#ECEFF4"}}},{content:"collection",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"Capability",props:{style:{color:"#81A1C1"}}},{content:"<&",props:{style:{color:"#D8DEE9FF"}}},{content:"SaleCollection",props:{style:{color:"#81A1C1"}}},{content:">",props:{style:{color:"#D8DEE9FF"}}},{content:") {",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        let",props:{style:{color:"#81A1C1"}}},{content:" saleRef = collection.",props:{style:{color:"#D8DEE9FF"}}},{content:"borrow",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"            ?? ",props:{style:{color:"#81A1C1"}}},{content:"panic",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"Invalid sale collection capability",props:{style:{color:"#A3BE8C"}}},{content:'")',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        self",props:{style:{color:"#81A1C1"}}},{content:".tokensForSale[saleRef.owner",props:{style:{color:"#D8DEE9FF"}}},{content:"!",props:{style:{color:"#81A1C1"}}},{content:".address] ",props:{style:{color:"#D8DEE9FF"}}},{content:"=",props:{style:{color:"#81A1C1"}}},{content:" collection",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    // removeSaleCollection removes a user's sale from the array",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    // of sale references",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    access",props:{style:{color:"#88C0D0"}}},{content:"(all",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"fun ",props:{style:{color:"#81A1C1"}}},{content:"removeSaleCollection",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#ECEFF4"}}},{content:"owner",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"Address",props:{style:{color:"#81A1C1"}}},{content:") {",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        self",props:{style:{color:"#81A1C1"}}},{content:".tokensForSale[owner] ",props:{style:{color:"#D8DEE9FF"}}},{content:"= nil",props:{style:{color:"#81A1C1"}}}]},{tokens:[{content:"    }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"}",props:{style:{color:"#ECEFF4"}}}]}],lang:"cadence"},annotations:[]}]}),"\n",(0,n.jsx)(t.p,{children:"This contract isn't meant to be a working or production-ready contract, but it could be extended to make a complete central marketplace by having:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["Sellers list a capability to their ",(0,n.jsx)(t.code,{children:"SaleCollection"})," in this contract"]}),"\n",(0,n.jsx)(t.li,{children:"Other functions that buyers could call to get info about all the different sales and to make purchases."}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"A central marketplace in an off-chain application is easier to implement because:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:"The app could host the marketplace and a user would simply log in to the app and give the app its account address."}),"\n",(0,n.jsx)(t.li,{children:"The app could read the user's public storage and find their sale reference."}),"\n",(0,n.jsx)(t.li,{children:"With the sale reference, the app could get all the information they need about how to display the sales on their website."}),"\n",(0,n.jsx)(t.li,{children:"Any buyer could discover the sale in the app and login with their account, which gives the app access to their public references."}),"\n",(0,n.jsx)(t.li,{children:"When the buyer wants to buy a specific NFT, the app would automatically generate the proper transaction to purchase the NFT from the seller."}),"\n"]}),"\n",(0,n.jsxs)(t.h2,{id:"creating-a-marketplace-for-any-generic-nft",children:["Creating a ",(0,n.jsx)(t.strong,{children:"Marketplace for Any Generic NFT"})]}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsx)(t.p,{children:"The previous examples show how a simple marketplace could be created for a specific class of NFTs.\nHowever, users will want to have a marketplace where they can buy and sell any NFT they want, regardless of its type.\nThere are a few good examples of generic marketplaces on Flow right now."}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["The Flow team has created a completely decentralized example of a generic marketplace in the ",(0,n.jsx)(t.a,{href:"https://github.com/onflow/nft-storefront",children:"NFT storefront repo."}),"\nThis contract is already deployed to testnet and mainnet and can be used by anyone for any generic NFT sale!"]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.a,{href:"https://viv3.com/",children:"VIV3"})," is a company that has a generic NFT marketplace."]}),"\n"]}),"\n",(0,n.jsx)(t.h2,{id:"composable-resources-on-flow",children:"Composable Resources on Flow"}),"\n",(0,n.jsx)(t.hr,{}),"\n",(0,n.jsxs)(t.p,{children:["Now that you have an understanding of how composable smart contracts and the marketplace work on Flow, you're ready to play with composable resources!\nCheck out the ",(0,n.jsx)(t.a,{href:"/docs/next/cadence/tutorial/resources-compose",children:"Kitty Hats tutorial!"})]})]})}const d=function(o){void 0===o&&(o={});const{wrapper:t}=Object.assign({},(0,r.ah)(),o.components);return t?(0,n.jsx)(t,Object.assign({},o,{children:(0,n.jsx)(F,o)})):F(o)};function u(o,t){throw new Error("Expected "+(t?"component":"object")+" `"+o+"` to be defined: you likely forgot to import, pass, or provide it.")}}}]);