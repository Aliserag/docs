"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[7211],{3905:(t,e,n)=>{n.d(e,{Zo:()=>k,kt:()=>g});var a=n(67294);function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?r(Object(n),!0).forEach((function(e){o(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function i(t,e){if(null==t)return{};var n,a,o=function(t,e){if(null==t)return{};var n,a,o={},r=Object.keys(t);for(a=0;a<r.length;a++)n=r[a],e.indexOf(n)>=0||(o[n]=t[n]);return o}(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(a=0;a<r.length;a++)n=r[a],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}var s=a.createContext({}),d=function(t){var e=a.useContext(s),n=e;return t&&(n="function"==typeof t?t(e):l(l({},e),t)),n},k=function(t){var e=d(t.components);return a.createElement(s.Provider,{value:e},t.children)},c="mdxType",p={inlineCode:"code",wrapper:function(t){var e=t.children;return a.createElement(a.Fragment,{},e)}},u=a.forwardRef((function(t,e){var n=t.components,o=t.mdxType,r=t.originalType,s=t.parentName,k=i(t,["components","mdxType","originalType","parentName"]),c=d(n),u=o,g=c["".concat(s,".").concat(u)]||c[u]||p[u]||r;return n?a.createElement(g,l(l({ref:e},k),{},{components:n})):a.createElement(g,l({ref:e},k))}));function g(t,e){var n=arguments,o=e&&e.mdxType;if("string"==typeof t||o){var r=n.length,l=new Array(r);l[0]=u;var i={};for(var s in e)hasOwnProperty.call(e,s)&&(i[s]=e[s]);i.originalType=t,i[c]="string"==typeof t?t:o,l[1]=i;for(var d=2;d<r;d++)l[d]=n[d];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},22473:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>s,contentTitle:()=>l,default:()=>g,frontMatter:()=>r,metadata:()=>i,toc:()=>d});var a=n(87462),o=(n(67294),n(3905));const r={title:"Manage a Staking Collection",sidebar_title:"Staking Collection Guide"},l=void 0,i={unversionedId:"nodes/staking/staking-collection",id:"nodes/staking/staking-collection",title:"Manage a Staking Collection",description:"This document outlines the steps a token holder can take to stake",source:"@site/docs/nodes/staking/staking-collection.mdx",sourceDirName:"nodes/staking",slug:"/nodes/staking/staking-collection",permalink:"/nodes/staking/staking-collection",draft:!1,tags:[],version:"current",lastUpdatedBy:"Tom Haile",lastUpdatedAt:1682618007,formattedLastUpdatedAt:"Apr 27, 2023",frontMatter:{title:"Manage a Staking Collection",sidebar_title:"Staking Collection Guide"},sidebar:"tutorialSidebar",previous:{title:"Stake Slashing",permalink:"/nodes/staking/stake-slashing"},next:{title:"Options for Building Staking Integrations",permalink:"/nodes/staking/staking-options"}},s={},d=[{value:"Staker Object Fields",id:"staker-object-fields",level:2},{value:"Vault Capability Fields",id:"vault-capability-fields",level:2},{value:"Machine Account Support",id:"machine-account-support",level:2},{value:"Staking Collection Public Getter Methods",id:"staking-collection-public-getter-methods",level:2},{value:"Setup",id:"setup",level:2},{value:"Setup a Staking Collection",id:"setup-a-staking-collection",level:3},{value:"Create a Machine Account for an existing Node",id:"create-a-machine-account-for-an-existing-node",level:3},{value:"Register Stakers",id:"register-stakers",level:2},{value:"Register a New Staked Node",id:"register-a-new-staked-node",level:3},{value:"Register a New Staked Delegator",id:"register-a-new-staked-delegator",level:3},{value:"Staking Operations",id:"staking-operations",level:2},{value:"Stake New Tokens",id:"stake-new-tokens",level:3},{value:"Re-stake Unstaked Tokens",id:"re-stake-unstaked-tokens",level:3},{value:"Re-stake Rewarded Tokens",id:"re-stake-rewarded-tokens",level:3},{value:"Request to Unstake Tokens at the end of the Epoch",id:"request-to-unstake-tokens-at-the-end-of-the-epoch",level:3},{value:"Unstake All Tokens",id:"unstake-all-tokens",level:3},{value:"Withdraw Unstaked Tokens",id:"withdraw-unstaked-tokens",level:3},{value:"Withdraw Rewarded Tokens",id:"withdraw-rewarded-tokens",level:3},{value:"Staking Collection Modification",id:"staking-collection-modification",level:2},{value:"Close a Node or Delegator",id:"close-a-node-or-delegator",level:3},{value:"Transfer a Node",id:"transfer-a-node",level:3},{value:"Transfer a Delegator",id:"transfer-a-delegator",level:3},{value:"Update A Node&#39;s Networking Address",id:"update-a-nodes-networking-address",level:3},{value:"Get All Node Info",id:"get-all-node-info",level:3},{value:"Get All Delegator Info",id:"get-all-delegator-info",level:3},{value:"Get All Node Ids",id:"get-all-node-ids",level:3},{value:"Get All Delegator Ids",id:"get-all-delegator-ids",level:3},{value:"Get Locked Tokens Used",id:"get-locked-tokens-used",level:3},{value:"Get Unlocked Tokens Used",id:"get-unlocked-tokens-used",level:3},{value:"Get Does Stake Exist",id:"get-does-stake-exist",level:3},{value:"Get Machine Account Info",id:"get-machine-account-info",level:3}],k=(c="Callout",function(t){return console.warn("Component "+c+" was not imported, exported, or provided by MDXProvider as global scope"),(0,o.kt)("div",t)});var c;const p={toc:d},u="wrapper";function g(t){let{components:e,...n}=t;return(0,o.kt)(u,(0,a.Z)({},p,n,{components:e,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"This document outlines the steps a token holder can take to stake\nusing ",(0,o.kt)("a",{parentName:"p",href:"/core-contracts/staking-contract-reference/"},"the ",(0,o.kt)("inlineCode",{parentName:"a"},"FlowIDTableStaking")," contract"),"\nand ",(0,o.kt)("a",{parentName:"p",href:"/core-contracts/staking-collection/"},"the ",(0,o.kt)("inlineCode",{parentName:"a"},"FlowStakingCollection")," contract."),"\nThis is the recommended and most supported way to stake FLOW.\nIt supports any number of nodes and delegators per account, supports locked and unlocked FLOW,\nand supports easily interaction with a node's machine account for collector and consensus nodes."),(0,o.kt)("h1",{id:"staking-collection-overview"},"Staking Collection Overview"),(0,o.kt)("p",null,"A Staking Collection is a resource that allows its owner to manage multiple staking\nobjects in a single account via a single storage path, and perform staking actions\nusing both locked and unlocked Flow."),(0,o.kt)("p",null,"Before the staking collection, accounts could use the instructions in\n",(0,o.kt)("a",{parentName:"p",href:"https://docs.onflow.org/staking/unlocked-staking-guide/"},"the unlocked staking guide"),"\nto stake with tokens. This was a bit restrictive, because that guide (and the corresponding transactions)\nonly supports one node and one delegator object\nper account. If a user wanted to have more than one per account,\nthey would either have to use custom transactions with custom storage paths for each object,\nor they would have had to use multiple accounts, which comes with many hassles of its own."),(0,o.kt)("p",null,"The same applies to the ",(0,o.kt)("a",{parentName:"p",href:"https://docs.onflow.org/staking/locked-staking-guide/"},"locked tokens staking guide"),".\nThis only had built-in support for one node and one delegator per account,\nand did not cleanly support users with only unlocked FLOW."),(0,o.kt)("p",null,"The staking collection is a solution to both of these deficiencies.\nWhen an account is set up to use a staking collection, the staking collection recognizes\nthe existing locked account capabilities (if they exist) and unlocked account staking objects,\nand incorporates their functionality so any user can stake for a node or stake as a delegator\nthrough a single common interface, regardless of if they have a brand new account,\nor have been staking through the locked account or unlocked account before."),(0,o.kt)("p",null,"The staking collection also easily allows a user to transfer their node or delegator objects\nto other accounts without interrupting the staking process!"),(0,o.kt)("h2",{id:"staker-object-fields"},"Staker Object Fields"),(0,o.kt)("p",null,"The staking collection resource has two main fields, "),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-cadence"},"access(self) var nodeStakers: @{String: FlowIDTableStaking.NodeStaker}\naccess(self) var nodeDelegators: @{String: FlowIDTableStaking.NodeDelegator}\n")),(0,o.kt)("p",null,"These dictionaries store the staking objects that are managed by the staking collection.\nAccess to these dictionaries are mediated by the staking methods.\nWhen a user wants to perform a staking operation,\nthey specify the nodeID and/or delegatorID they want to stake for, and the function routes the function\ncall to the correct staking object and performs the specified operation."),(0,o.kt)("h2",{id:"vault-capability-fields"},"Vault Capability Fields"),(0,o.kt)("p",null,"The staking collection also has a field that stores a capability for\nthe unlocked FLOW Vault and locked FLOW vault (if applicable)"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-cadence"},"/// unlocked vault\naccess(self) var unlockedVault: Capability<&FlowToken.Vault>\n\n/// locked vault\n/// will be nil if the account has no corresponding locked account\naccess(self) var lockedVault: Capability<&FlowToken.Vault>?\n")),(0,o.kt)("p",null,"When a user performs staking operations like staking new tokens,\nthe staking collection tracks the number of unlocked tokens\nand locked tokens (if applicable) that are used by the staking objects in the collection.\nThe collection will always try to stake any available locked tokens first.\nOnce all locked tokens are staked, if the user requested to stake more than the locked token balance,\nthe collection will then dip into the unlocked balance for the remaining tokens.\nIf the user has no locked tokens, the staking collection\nwill simply ignore the locked tokens part of the functionality and only use unlocked tokens."),(0,o.kt)("p",null,"When a user withdraws tokens from a staking object, the collection\nwill always try to withdraw unlocked tokens first.\nAny unlocked tokens are then deposited directly into the vault on the unlocked account,\nand remaining locked tokens are deposited to the vault in the locked account."),(0,o.kt)("h2",{id:"machine-account-support"},"Machine Account Support"),(0,o.kt)("p",null,"The staking collection also supports an important feature for epochs, machine accounts.\nMachine accounts are where node operators store important resource objects\nthat are critical to the functionality of the epoch preparation protocol.\nEvery collector and consensus node should have an associated machine account that stores these objects,\nand the staking collection helps the user create and manage these accounts."),(0,o.kt)("p",null,"When a user registers a new collector or consensus node,\nthe staking collection also creates a machine account for them and registers\nthe required object that needs to go in the machine account.\nThe node operator is then responsible for adding keys to the account.\n(the ",(0,o.kt)("strong",{parentName:"p"},"Register Node")," transaction includes this step)."),(0,o.kt)("p",null,"Once the machine account is created and set up, the node operator just has to\nconnect it to their node software and make sure the account has enough FLOW\nto pay for transaction fees, which can be handled simply by submitting\na regular FLOW transfer to the machine account's address"),(0,o.kt)("h2",{id:"staking-collection-public-getter-methods"},"Staking Collection Public Getter Methods"),(0,o.kt)("p",null,"The staking collection also defines many getter methods to query information\nabout an account's staking collection. You can simply call one of these methods on the contract,\nproviding the account address, and the contract will retreive\nthe relevant info for you, like so:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-cadence"},"import FlowStakingCollection from 0xSTAKINGCOLLECTIONADDRESS\nimport FlowIDTableStaking from 0xIDENTITYTABLEADDRESS\n\n/// Gets an array of all the delegator metadata for delegators stored in the staking collection\npub fun main(address: Address): [FlowIDTableStaking.DelegatorInfo] {\n    return FlowStakingCollection.getAllDelegatorInfo(address: address)\n}\n")),(0,o.kt)("p",null,"Remember: A Staking Collection does not require an account\nto have a secondary locked account or locked FLOW.\nHowever, if an account does have an associated locked account, when the Staking Collection is initialized,\nit will connect to that locked account's node and delegator objects\nas well as it's locked token vault allowing it to perform staking actions with locked and unlocked FLOW."),(0,o.kt)(k,{type:"info",mdxType:"Callout"},"Staking Collection is backwards compatible with other methods of staking on Flow. Existing accounts with associated locked accounts will still be able to stake in the same way as before, but they will also be able to use the staking collection, if desired."),(0,o.kt)("h1",{id:"how-to-use-the-staking-collection"},"How to use the Staking Collection"),(0,o.kt)("p",null,"There is a standard set of transactions provided with the staking collection."),(0,o.kt)("h2",{id:"setup"},"Setup"),(0,o.kt)("h3",{id:"setup-a-staking-collection"},"Setup a Staking Collection"),(0,o.kt)("p",null,"To set up a Staking Collection, you must run the ",(0,o.kt)("strong",{parentName:"p"},"Setup Staking Collection")," (",(0,o.kt)("a",{parentName:"p",href:"/core-contracts/staking-collection"},"SCO.01"),") transaction."),(0,o.kt)("p",null,"This transaction requires no arguments and will perform the following actions:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Create private capabilities for the unlocked vault and locked vault (if applicable)."),(0,o.kt)("li",{parentName:"ol"},"Create a new staking collection resource object, initializing it with the unlocked and locked vault capabilities."),(0,o.kt)("li",{parentName:"ol"},"Store the staking collection at a pre-defined storage path."),(0,o.kt)("li",{parentName:"ol"},"Create a public link to the staking collection so others can query metadata about it."),(0,o.kt)("li",{parentName:"ol"},"If there are any node or delegator objects in the unlocked account, the transaction stores those in the staking collection\nso they can be used through the same interface as usual.")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"No arguments")," are required for the ",(0,o.kt)("strong",{parentName:"p"},"Setup Staking Collection")," transaction."),(0,o.kt)("p",null,"Once this transaction is complete, your existing staking objects (if any) from your unlocked account and locked account\nwill be available via the staking collection and you can use all the transactions described below to access them."),(0,o.kt)("h3",{id:"create-a-machine-account-for-an-existing-node"},"Create a Machine Account for an existing Node"),(0,o.kt)("p",null,"Many nodes will have been created before the staking collection was set up and before epochs were enabled,\nmeaning that they don't already have an associated machine account.\nThese nodes need a new transaction to create the machine account for the node and save it to the staking collection."),(0,o.kt)("p",null,"To create a machine account for a node that doesn't already have one,\nyou must submit the ",(0,o.kt)("strong",{parentName:"p"},"Create Machine Account")," (",(0,o.kt)("a",{parentName:"p",href:"/core-contracts/staking-collection"},"SCO.03"),")\ntransaction with the following arguments:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Argument"),(0,o.kt)("th",{parentName:"tr",align:null},"Type"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"nodeID")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"String")),(0,o.kt)("td",{parentName:"tr",align:null},"The ID of the node.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"publicKeys")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"[String]")),(0,o.kt)("td",{parentName:"tr",align:null},"The public keys to add to the machine account.")))),(0,o.kt)("p",null,"If the node is a collector or consensus node, this transaction creates the associated machine account,\nregisters the QC or DKG object, stores it in the machine account,\nand adds the provided public key(s) to the machine account.\nIf no public keys are provided, the transaction will fail."),(0,o.kt)("h2",{id:"register-stakers"},"Register Stakers"),(0,o.kt)("h3",{id:"register-a-new-staked-node"},"Register a New Staked Node"),(0,o.kt)("p",null,"To register a new staked node, you must submit the ",(0,o.kt)("strong",{parentName:"p"},"Register Node")," (",(0,o.kt)("a",{parentName:"p",href:"/core-contracts/staking-collection"},"SCO.03"),")\ntransaction with the following arguments:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Argument"),(0,o.kt)("th",{parentName:"tr",align:null},"Type"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"id")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"String")),(0,o.kt)("td",{parentName:"tr",align:null},"The ID of the new node. It must be a 32 byte ",(0,o.kt)("inlineCode",{parentName:"td"},"String"),". The operator is free to choose this value, but it must be unique across all nodes. A recommended process to generate this is to hash the staking public key.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"role")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"UInt8")),(0,o.kt)("td",{parentName:"tr",align:null},"The role of the new node. (1: collection, 2: consensus, 3: execution, 4: verification, 5: access)")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"networkingAddress")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"String")),(0,o.kt)("td",{parentName:"tr",align:null},"The IP address of the new node.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"networkingKey")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"String")),(0,o.kt)("td",{parentName:"tr",align:null},"The networking public key as a hex-encoded string.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"stakingKey")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"String")),(0,o.kt)("td",{parentName:"tr",align:null},"The staking public key as a hex-encoded string.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"stakingKeyPoP")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"String")),(0,o.kt)("td",{parentName:"tr",align:null},"The staking key Proof-of-Possesion as a hex-encoded string.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"amount")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"UFix64")),(0,o.kt)("td",{parentName:"tr",align:null},"The number of FLOW tokens to stake.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"publicKeys")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"[String]?")),(0,o.kt)("td",{parentName:"tr",align:null},"The public keys to add to the machine account. ",(0,o.kt)("inlineCode",{parentName:"td"},"nil")," if no machine account")))),(0,o.kt)("p",null,"This transaction registers the account as a staker with the specified node information\nand attaches a ",(0,o.kt)("inlineCode",{parentName:"p"},"NodeStaker")," resource to the ",(0,o.kt)("inlineCode",{parentName:"p"},"Staking Collection"),".\nThis ",(0,o.kt)("inlineCode",{parentName:"p"},"NodeStaker")," resourece can then later be used to perform staking actions via the staking collection staking methods."),(0,o.kt)("p",null,"If the node is a collector or consensus node, it also creates the associated machine account,\nregisters the QC or DKG object, stores it in the machine account,\nand adds the provided public key(s) to the machine account.\nIf the node requires a machine account and no public keys are provided, the transaction will fail."),(0,o.kt)("p",null,"Once the account has registered their node using their Staking Collection,\ntheir tokens and node information are committed to the central staking contract for the next epoch."),(0,o.kt)("p",null,"At this point, the Staking Collection now has access to various staking operations that they can perform,\nassuming they have the correct number of tokens to perform the action."),(0,o.kt)("h3",{id:"register-a-new-staked-delegator"},"Register a New Staked Delegator"),(0,o.kt)("p",null,"To register a new delegator, you must submit the ",(0,o.kt)("strong",{parentName:"p"},"Register Delegator")," (",(0,o.kt)("a",{parentName:"p",href:"/core-contracts/staking-collection"},"SCO.02"),")\ntransaction with the following arguments:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Argument"),(0,o.kt)("th",{parentName:"tr",align:null},"Type"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"id")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"String")),(0,o.kt)("td",{parentName:"tr",align:null},"The ID of the node to delegate to.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"amount")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"UFix64")),(0,o.kt)("td",{parentName:"tr",align:null},"The number of FLOW tokens to delegate.")))),(0,o.kt)("p",null,"This transaction registers the account as a delegator to the node identified by the supplied node id.\nIt also attaches a ",(0,o.kt)("inlineCode",{parentName:"p"},"NodeDelegator")," resource to the ",(0,o.kt)("inlineCode",{parentName:"p"},"Staking Collection"),".\nThis ",(0,o.kt)("inlineCode",{parentName:"p"},"NodeDelegator")," resourece can then later be used to perform delegation actions."),(0,o.kt)("p",null,"Once the account has registered their new delegator using their Staking Collection,\ntheir tokens are committed to the central staking contract for the next epoch."),(0,o.kt)("p",null,"At this point, the Staking Collection now has access to various delegator operations that they can perform,\nassuming they have the correct number of tokens to perform the action."),(0,o.kt)("h2",{id:"staking-operations"},"Staking Operations"),(0,o.kt)("p",null,"These transactions perform actions that directly interact with the staking contract.\nMost of them will only succeed during the Staking Auction phase of the epoch."),(0,o.kt)("h3",{id:"stake-new-tokens"},"Stake New Tokens"),(0,o.kt)("p",null,"The Staking Collection can stake additional tokens for any Node or Delegator managed by it at any time."),(0,o.kt)("p",null,"The owner of a Staking Collection can use the ",(0,o.kt)("strong",{parentName:"p"},"Stake New Tokens")," (",(0,o.kt)("a",{parentName:"p",href:"/core-contracts/staking-collection"},"SCO.06"),")\ntransaction with the following arguments:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Argument"),(0,o.kt)("th",{parentName:"tr",align:null},"Type"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"nodeID")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"String")),(0,o.kt)("td",{parentName:"tr",align:null},"The nodeID of the node to stake new tokens to.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"delegatorID")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"Optional(UInt32)")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"nil")," if staking for a node. If staking for a delegator, the delegator ID.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"amount")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"UFix64")),(0,o.kt)("td",{parentName:"tr",align:null},"The number of FLOW tokens to stake.")))),(0,o.kt)(k,{type:"info",mdxType:"Callout"},"To stake new tokens for an active node, leave the ",(0,o.kt)("b",null,"delegatorID")," arguement as ",(0,o.kt)("b",null,"nil"),".",(0,o.kt)("p",null,"If staking for a delegator, ",(0,o.kt)("b",null,"delegatorID")," should be the delegator ID you are staking for.")),(0,o.kt)("p",null,"The amount may be any number of tokens up to the sum of an accounts locked and unlocked FLOW."),(0,o.kt)("h3",{id:"re-stake-unstaked-tokens"},"Re-stake Unstaked Tokens"),(0,o.kt)("p",null,"After tokens become unstaked, the owner of a Staking Collection can choose\nto re-stake the unstaked tokens to the same Node or Delegator."),(0,o.kt)("p",null,"The owner of a Staking Collection can use the ",(0,o.kt)("strong",{parentName:"p"},"Stake Unstaked Tokens")," (",(0,o.kt)("a",{parentName:"p",href:"/core-contracts/staking-collection"},"SCO.08"),")\ntransaction with the following arguments:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Argument"),(0,o.kt)("th",{parentName:"tr",align:null},"Type"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"nodeID")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"String")),(0,o.kt)("td",{parentName:"tr",align:null},"The nodeID of the node to stake the unstaked tokens to.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"delegatorID")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"Optional(UInt32)")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"nil")," if staking for a node. If staking for a delegator, the delegator ID.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"amount")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"UFix64")),(0,o.kt)("td",{parentName:"tr",align:null},"The number of FLOW tokens to restake.")))),(0,o.kt)(k,{type:"info",mdxType:"Callout"},"To stake unstaked tokens for an active node, leave the ",(0,o.kt)("b",null,"delegatorID")," arguement as ",(0,o.kt)("b",null,"nil"),".",(0,o.kt)("p",null,"If staking for a delegator, ",(0,o.kt)("b",null,"delegatorID")," should be the delegator ID you are staking for.")),(0,o.kt)("h3",{id:"re-stake-rewarded-tokens"},"Re-stake Rewarded Tokens"),(0,o.kt)("p",null,"After earning rewards from staking, the owner of a Staking Collection\ncan choose to re-stake the rewarded tokens to the same node or delegator."),(0,o.kt)("p",null,"The owner of a Staking Collection can use the ",(0,o.kt)("strong",{parentName:"p"},"Stake Unstaked Tokens")," (",(0,o.kt)("a",{parentName:"p",href:"/core-contracts/staking-collection"},"SCO.07"),")\ntransaction with the following arguments:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Argument"),(0,o.kt)("th",{parentName:"tr",align:null},"Type"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"nodeID")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"String")),(0,o.kt)("td",{parentName:"tr",align:null},"The nodeID of the node to stake the rewarded tokens to.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"delegatorID")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"Optional(UInt32)")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"nil")," if staking for a node. If staking for a delegator, the delegator ID.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"amount")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"UFix64")),(0,o.kt)("td",{parentName:"tr",align:null},"The number of FLOW tokens to restake.")))),(0,o.kt)(k,{type:"info",mdxType:"Callout"},"To stake rewarded tokens for an active node, leave the ",(0,o.kt)("b",null,"delegatorID")," arguement as ",(0,o.kt)("b",null,"nil"),"."),(0,o.kt)("h3",{id:"request-to-unstake-tokens-at-the-end-of-the-epoch"},"Request to Unstake Tokens at the end of the Epoch"),(0,o.kt)("p",null,"The owner of a Staking Collection can submit a request to unstake their tokens at any time for any Node or Delegator in their collection."),(0,o.kt)("p",null,"If the tokens aren't staked yet, they will be uncommitted and available to withdraw."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Note: unstaked tokens will be held by the central staking contract until the end of the following epoch."),"\n",(0,o.kt)("em",{parentName:"p"},"Once the tokens are released (unstaked), they can be claimed via the ",(0,o.kt)("a",{parentName:"em",href:"#withdraw-unstaked-tokens"},"Withdraw Unstaked Tokens")," action below.")),(0,o.kt)("p",null,"The owner of a Staking Collection can use the ",(0,o.kt)("strong",{parentName:"p"},"Unstake Tokens")," (",(0,o.kt)("a",{parentName:"p",href:"/core-contracts/staking-collection"},"SCO.05"),")\ntransaction with the following arguments:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Argument"),(0,o.kt)("th",{parentName:"tr",align:null},"Type"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"nodeID")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"String")),(0,o.kt)("td",{parentName:"tr",align:null},"The nodeID of the chosen node.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"delegatorID")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"Optional(UInt32)")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"nil")," if staking for a node. If staking for a delegator, the delegator ID.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"amount")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"UFix64")),(0,o.kt)("td",{parentName:"tr",align:null},"The number of FLOW tokens to restake.")))),(0,o.kt)(k,{type:"info",mdxType:"Callout"},"To unstake tokens from an active node, leave the ",(0,o.kt)("b",null,"delegatorID")," arguement as ",(0,o.kt)("b",null,"nil"),"."),(0,o.kt)("h3",{id:"unstake-all-tokens"},"Unstake All Tokens"),(0,o.kt)("p",null,"The owner of a Staking Collection can use the ",(0,o.kt)("strong",{parentName:"p"},"Unstake All")," (",(0,o.kt)("a",{parentName:"p",href:"/core-contracts/staking-collection"},"SCO.09"),")\ntransaction with the following arguments:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Argument"),(0,o.kt)("th",{parentName:"tr",align:null},"Type"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"nodeID")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"String")),(0,o.kt)("td",{parentName:"tr",align:null},"The nodeID of the node to unstake all tokens from.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"delegatorID")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"Optional(UInt32)")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"nil")," if staking for a node. If staking for a delegator, the delegator ID.")))),(0,o.kt)("h3",{id:"withdraw-unstaked-tokens"},"Withdraw Unstaked Tokens"),(0,o.kt)("p",null,"After tokens for an active Node or Delegator become unstaked,\nthe ownder of Staking Collection can withdraw them from the central staking contract."),(0,o.kt)("p",null,"The owner of a Staking Collection can use the ",(0,o.kt)("strong",{parentName:"p"},"Withdraw Unstaked Tokens")," (",(0,o.kt)("a",{parentName:"p",href:"/core-contracts/staking-collection"},"SCO.11"),")\ntransaction with the following arguments:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Argument"),(0,o.kt)("th",{parentName:"tr",align:null},"Type"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"nodeID")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"String")),(0,o.kt)("td",{parentName:"tr",align:null},"The nodeID of the node to withdraw the unstaked tokens from.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"delegatorID")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"Optional(UInt32)")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"nil")," if staking for a node. If staking for a delegator, the delegator ID.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"amount")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"UFix64")),(0,o.kt)("td",{parentName:"tr",align:null},"The number of FLOW tokens to withdraw.")))),(0,o.kt)(k,{type:"info",mdxType:"Callout"},"To withdraw unstaked tokens from an active node, leave the ",(0,o.kt)("b",null,"delegatorID")," arguement as ",(0,o.kt)("b",null,"nil"),"."),(0,o.kt)("h3",{id:"withdraw-rewarded-tokens"},"Withdraw Rewarded Tokens"),(0,o.kt)("p",null,"After earning rewards from staking, the token holder can withdraw them from the central staking contract."),(0,o.kt)("p",null,"The owner of a Staking Collection can use the ",(0,o.kt)("strong",{parentName:"p"},"Withdraw Rewarded Tokens")," (",(0,o.kt)("a",{parentName:"p",href:"/core-contracts/staking-collection"},"SCO.10"),")\ntransaction with the following arguments:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Argument"),(0,o.kt)("th",{parentName:"tr",align:null},"Type"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"nodeID")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"String")),(0,o.kt)("td",{parentName:"tr",align:null},"The nodeID of the node to withdraw the rewarded tokens from.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"delegatorID")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"Optional(UInt32)")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"nil")," if staking for a node. If staking for a delegator, the delegator ID.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"amount")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"UFix64")),(0,o.kt)("td",{parentName:"tr",align:null},"The number of FLOW tokens to withdraw.")))),(0,o.kt)(k,{type:"info",mdxType:"Callout"},"To withdraw rewarded tokens from an active node, leave the ",(0,o.kt)("b",null,"delegatorID")," arguement as ",(0,o.kt)("b",null,"nil"),"."),(0,o.kt)("h2",{id:"staking-collection-modification"},"Staking Collection Modification"),(0,o.kt)("h3",{id:"close-a-node-or-delegator"},"Close a Node or Delegator"),(0,o.kt)("p",null,"Once a Node or Delegator has no tokens staked, comitted or in an unstaking state, it is eligible to be closed."),(0,o.kt)("p",null,"Closing a Node or Delegator first returns any unstaked or rewarded tokens\nto the account for which the Staking Collection is stored in.\nIt then destroys the NodeStaker or NodeDelegator object from within the Staking Collection."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Note: Once a Node or Delegator has been closed, it cannot be accessed again,"),"\n",(0,o.kt)("em",{parentName:"p"},"and no staking or delegation actions can be futher preformed on it.")),(0,o.kt)("p",null,"The owner of a Staking Collection can use the ",(0,o.kt)("strong",{parentName:"p"},"Close Stake")," (",(0,o.kt)("a",{parentName:"p",href:"/core-contracts/staking-collection"},"SCO.12"),")\ntransaction with the following arguments:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Argument"),(0,o.kt)("th",{parentName:"tr",align:null},"Type"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"nodeID")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"String")),(0,o.kt)("td",{parentName:"tr",align:null},"The nodeID of the node to close.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"delegatorID")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"Optional(UInt32)")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"nil")," if staking for a node. If staking for a delegator, the delegator ID.")))),(0,o.kt)(k,{type:"info",mdxType:"Callout"},"To close an active node, leave the ",(0,o.kt)("b",null,"delegatorID")," arguement as ",(0,o.kt)("b",null,"nil"),"."),(0,o.kt)("h3",{id:"transfer-a-node"},"Transfer a Node"),(0,o.kt)("p",null,"A user may transfer an existing Node to another another account's Staking Collection."),(0,o.kt)("p",null,"The account to transfer the Node to must have a valid Staking Collection set up."),(0,o.kt)("p",null,"Transferring a Node will remove it from the authorizer's Staking Collection\nand deposit it to the receiver's Staking Collection."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Note: Once a Node or Delegator has been transferred, it cannot be accessed again by the sender."),"\n",(0,o.kt)("em",{parentName:"p"},"As well, all staked tokens will be considered staked by the receiver's Staking Collection.")),(0,o.kt)(k,{type:"warning",mdxType:"Callout"},"Transferring a Node will result in loss of custody of any Staked tokens for the sender."),(0,o.kt)("p",null,"The owner of a Staking Collection can use the ",(0,o.kt)("strong",{parentName:"p"},"Transfer Node")," (",(0,o.kt)("a",{parentName:"p",href:"/core-contracts/staking-collection"},"SCO.13"),")\ntransaction with the following arguments:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Argument"),(0,o.kt)("th",{parentName:"tr",align:null},"Type"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"nodeID")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"String")),(0,o.kt)("td",{parentName:"tr",align:null},"The nodeID of the node to transfer.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"to")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"Address")),(0,o.kt)("td",{parentName:"tr",align:null},"The address of the account which contains the Staking Collection to transfer the Node to.")))),(0,o.kt)("h3",{id:"transfer-a-delegator"},"Transfer a Delegator"),(0,o.kt)("p",null,"A user may transfer an existing Delegator to another another account's Staking Collection."),(0,o.kt)("p",null,"The account to transfer the Delegator to must have a valid Staking Collection set up."),(0,o.kt)("p",null,"Transferring a Delegator will remove it from the authorizer's Staking Collection\nand deposit it to the receiver's Staking Collection."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Note: Once a Node or Delegator has been transferred, it cannot be accessed again by the sender."),"\n",(0,o.kt)("em",{parentName:"p"},"As well, all staked tokens will be considered staked by the receiver's Staking Collection.")),(0,o.kt)(k,{type:"warning",mdxType:"Callout"},"Transferring a Delegator will result in loss of custody of any Staked tokens for the sender."),(0,o.kt)("p",null,"The owner of a Staking Collection can use the ",(0,o.kt)("strong",{parentName:"p"},"Transfer Delegator")," (",(0,o.kt)("a",{parentName:"p",href:"/core-contracts/staking-collection"},"SCO.14"),")\ntransaction with the following arguments:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Argument"),(0,o.kt)("th",{parentName:"tr",align:null},"Type"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"nodeID")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"String")),(0,o.kt)("td",{parentName:"tr",align:null},"The nodeID of the delegator to transfer.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"delegatorID")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"UInt32")),(0,o.kt)("td",{parentName:"tr",align:null},"The delegatorID of the delegator to transfer.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"to")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"Address")),(0,o.kt)("td",{parentName:"tr",align:null},"The address of the account which contains the Staking Collection to transfer the Delegator to.")))),(0,o.kt)("h3",{id:"update-a-nodes-networking-address"},"Update A Node's Networking Address"),(0,o.kt)("p",null,"A user may update their node's networking address if it has become inconsistent with the protocol state."),(0,o.kt)("p",null,"This operation can only be performed in the staking auction phase of an epoch."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"Note: Currently, if a node updates its networking address and the new address does not match"),"\n",(0,o.kt)("em",{parentName:"p"},"what is stored in the protocol state for the node, the node will not be able to participate in the upcoming epoch"),"\n",(0,o.kt)("em",{parentName:"p"},"Only update your networking address if you have already confirmed with the Flow team that you can."),"\n",(0,o.kt)("em",{parentName:"p"},"This restriction will be removed once fully automated epochs are completely implemented")),(0,o.kt)("p",null,"The owner of a Staking Collection can use the ",(0,o.kt)("strong",{parentName:"p"},"Update Networking Address")," (",(0,o.kt)("a",{parentName:"p",href:"/core-contracts/staking-collection"},"SCO.22"),")\ntransaction with the following arguments:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Argument"),(0,o.kt)("th",{parentName:"tr",align:null},"Type"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"nodeID")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"String")),(0,o.kt)("td",{parentName:"tr",align:null},"The nodeID of the node to update.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"newAddress")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"String")),(0,o.kt)("td",{parentName:"tr",align:null},"The new networking address")))),(0,o.kt)("h1",{id:"staking-collection-scripts"},"Staking Collection Scripts"),(0,o.kt)("p",null,"These scripts allow anyone to query information about an account's staking collection"),(0,o.kt)("h3",{id:"get-all-node-info"},"Get All Node Info"),(0,o.kt)("p",null,"To return an array of structs representing the information associated with each node managed by an account's Staking Collection, anyone\ncan use the ",(0,o.kt)("strong",{parentName:"p"},"Get All Node Info")," (",(0,o.kt)("a",{parentName:"p",href:"/core-contracts/staking-collection"},"SCO.15"),") script with the following arguments:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Argument"),(0,o.kt)("th",{parentName:"tr",align:null},"Type"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"address")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"Addresss")),(0,o.kt)("td",{parentName:"tr",align:null},"The Address of the account holding the Staking Collection to query from")))),(0,o.kt)("p",null,"This script returns an array of ",(0,o.kt)("inlineCode",{parentName:"p"},"FlowIDTableStaking.NodeInfo")," ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/onflow/flow-core-contracts/blob/master/contracts/FlowIDTableStaking.cdc#L264"},"structs"),"\nrepresenting the nodes managed by an accounts Staking Collection."),(0,o.kt)("h3",{id:"get-all-delegator-info"},"Get All Delegator Info"),(0,o.kt)("p",null,"To return an array of structs representing the information associated with each delegator managed by an account's Staking Collection, anyone\ncan use the ",(0,o.kt)("strong",{parentName:"p"},"Get All Delegator Info")," (",(0,o.kt)("a",{parentName:"p",href:"/core-contracts/staking-collection"},"SCO.16"),") script with the following arguments:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Argument"),(0,o.kt)("th",{parentName:"tr",align:null},"Type"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"address")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"Addresss")),(0,o.kt)("td",{parentName:"tr",align:null},"The Address of the account holding the Staking Collection to query from")))),(0,o.kt)("p",null,"This script returns an array of ",(0,o.kt)("inlineCode",{parentName:"p"},"FlowIDTableStaking.DelegatorInfo")," ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/onflow/flow-core-contracts/blob/master/contracts/FlowIDTableStaking.cdc#L264"},"structs"),"\nrepresenting the delegators managed by an accounts Staking Collection."),(0,o.kt)("h3",{id:"get-all-node-ids"},"Get All Node Ids"),(0,o.kt)("p",null,"To return an array of Strings representing the ids associated with each node managed by an account's Staking Collection, anyone\ncan use the ",(0,o.kt)("strong",{parentName:"p"},"Get All Node Ids")," (",(0,o.kt)("a",{parentName:"p",href:"/core-contracts/staking-collection"},"SCO.17"),") script with the following arguments:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Argument"),(0,o.kt)("th",{parentName:"tr",align:null},"Type"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"address")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"Addresss")),(0,o.kt)("td",{parentName:"tr",align:null},"The Address of the account holding the Staking Collection to query from")))),(0,o.kt)("p",null,"This script returns an array of ",(0,o.kt)("inlineCode",{parentName:"p"},"String"),"\nrepresenting each id of each node managed by an accounts Staking Collection."),(0,o.kt)("h3",{id:"get-all-delegator-ids"},"Get All Delegator Ids"),(0,o.kt)("p",null,"To return an array of structs representing the delegator ids associated with each delegation managed by an account's Staking Collection, anyone\ncan use the ",(0,o.kt)("strong",{parentName:"p"},"Get All Delegator Ids")," (",(0,o.kt)("a",{parentName:"p",href:"/core-contracts/staking-collection"},"SCO.16"),") script with the following arguments:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Argument"),(0,o.kt)("th",{parentName:"tr",align:null},"Type"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"address")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"Addresss")),(0,o.kt)("td",{parentName:"tr",align:null},"The Address of the account holding the Staking Collection to query from")))),(0,o.kt)("p",null,"This script returns an array of ",(0,o.kt)("inlineCode",{parentName:"p"},"FlowStakingCollection.DelegatorIDs")," ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/onflow/flow-core-contracts/blob/master/contracts/FlowStakingCollection.cdc#L29"},"structs"),"\nrepresenting the delegator Ids of each delegator managed by an accounts Staking Collection."),(0,o.kt)("h3",{id:"get-locked-tokens-used"},"Get Locked Tokens Used"),(0,o.kt)("p",null,"To query how many Locked FLOW tokens an account has staked using their Staking Collection, anyone\ncan use the ",(0,o.kt)("strong",{parentName:"p"},"Get Locked Tokens Used")," (",(0,o.kt)("a",{parentName:"p",href:"/core-contracts/staking-collection"},"SCO.19"),") script with the following arguments:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Argument"),(0,o.kt)("th",{parentName:"tr",align:null},"Type"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"address")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"Addresss")),(0,o.kt)("td",{parentName:"tr",align:null},"The Address of the account holding the Staking Collection to query from")))),(0,o.kt)("p",null,"This script returns a ",(0,o.kt)("inlineCode",{parentName:"p"},"UFix64")," representing the number of Locked FLOW tokens staked using an accounts Staking Collection."),(0,o.kt)(k,{type:"info",mdxType:"Callout"},"Note: This number does not include Locked FLOW tokens staked not through an accounts Staking Collection."),(0,o.kt)("h3",{id:"get-unlocked-tokens-used"},"Get Unlocked Tokens Used"),(0,o.kt)("p",null,"To query how many Unlocked FLOW tokens an account has staked using their Staking Collection, anyone\ncan use the ",(0,o.kt)("strong",{parentName:"p"},"Get Unlocked Tokens Used")," (",(0,o.kt)("a",{parentName:"p",href:"/core-contracts/staking-collection"},"SCO.20"),") script with the following arguments:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Argument"),(0,o.kt)("th",{parentName:"tr",align:null},"Type"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"address")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"Addresss")),(0,o.kt)("td",{parentName:"tr",align:null},"The Address of the account holding the Staking Collection to query from")))),(0,o.kt)("p",null,"This script returns a ",(0,o.kt)("inlineCode",{parentName:"p"},"UFix64")," representing the number of Unlocked FLOW tokens staked using an accounts Staking Collection."),(0,o.kt)(k,{type:"info",mdxType:"Callout"},"Note: This number does not include Unlocked FLOW tokens staked not through an accounts Staking Collection."),(0,o.kt)("h3",{id:"get-does-stake-exist"},"Get Does Stake Exist"),(0,o.kt)("p",null,"To query if a Node or Delegator is managed by an accounts Staking Collection, anyone\ncan use the ",(0,o.kt)("strong",{parentName:"p"},"Get Does Node Exist")," (",(0,o.kt)("a",{parentName:"p",href:"/core-contracts/staking-collection"},"SCO.21"),") script with the following arguments:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Argument"),(0,o.kt)("th",{parentName:"tr",align:null},"Type"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"address")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"Addresss")),(0,o.kt)("td",{parentName:"tr",align:null},"The Address of the account holding the Staking Collection to query from")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"nodeID")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"String")),(0,o.kt)("td",{parentName:"tr",align:null},"The nodeID of the node to check, or the nodeID of the node delegating to to check.")),(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"delegatorID")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"Optional(UInt32)")),(0,o.kt)("td",{parentName:"tr",align:null},"The delegatorID of the delegator to check, if checking for a delegator.")))),(0,o.kt)("p",null,"This script returns a ",(0,o.kt)("inlineCode",{parentName:"p"},"Bool"),"."),(0,o.kt)(k,{type:"info",mdxType:"Callout"},"To query if a Node is managed by an accounts Staking Collection, leave the ",(0,o.kt)("b",null,"delegatorID")," arguement as ",(0,o.kt)("b",null,"nil"),". Otherwise, fill it in with the ",(0,o.kt)("b",null,"delegatorID")," of the Delegator."),(0,o.kt)("h3",{id:"get-machine-account-info"},"Get Machine Account Info"),(0,o.kt)("p",null,"To query the machine account information for an account's staking collection, anyone\ncan use the ",(0,o.kt)("strong",{parentName:"p"},"Get Machine Account Info")," (",(0,o.kt)("a",{parentName:"p",href:"/core-contracts/staking-collection"},"SCO.21"),") script with the following arguments:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Argument"),(0,o.kt)("th",{parentName:"tr",align:null},"Type"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"address")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"Addresss")),(0,o.kt)("td",{parentName:"tr",align:null},"The Address of the account holding the Staking Collection to query from")))),(0,o.kt)("p",null,"This script returns a ",(0,o.kt)("inlineCode",{parentName:"p"},"{String: FlowStakingCollection.MachineAccountInfo}"),",\nwhich is a mapping of nodeIDs to the ",(0,o.kt)("inlineCode",{parentName:"p"},"FlowStakingCollection.MachineAccountInfo")," struct."))}g.isMDXComponent=!0}}]);