"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[2567],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>m});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=a.createContext({}),l=function(e){var t=a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=l(e.components);return a.createElement(c.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},f=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,c=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=l(n),f=r,m=u["".concat(c,".").concat(f)]||u[f]||d[f]||o;return n?a.createElement(m,i(i({ref:t},p),{},{components:n})):a.createElement(m,i({ref:t},p))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=f;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s[u]="string"==typeof e?e:r,i[1]=s;for(var l=2;l<o;l++)i[l]=n[l];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}f.displayName="MDXCreateElement"},53968:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>d,frontMatter:()=>o,metadata:()=>s,toc:()=>l});var a=n(87462),r=(n(67294),n(3905));const o={},i="Transactions",s={unversionedId:"Tooling/fcl-js/transactions",id:"Tooling/fcl-js/transactions",title:"Transactions",description:"Transactions let you send Cadence code to the Flow blockchain that permanently alters its state.",source:"@site/docs/Tooling/fcl-js/transactions.mdx",sourceDirName:"Tooling/fcl-js",slug:"/Tooling/fcl-js/transactions",permalink:"/docs/Tooling/fcl-js/transactions",draft:!1,tags:[],version:"current",lastUpdatedBy:"Alex",lastUpdatedAt:1683063625,formattedLastUpdatedAt:"May 2, 2023",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"sdk-guidelines",permalink:"/docs/Tooling/fcl-js/sdk-guidelines"},next:{title:"Signing and Verifying Arbitrary Data",permalink:"/docs/Tooling/fcl-js/user-signatures"}},c={},l=[],p={toc:l},u="wrapper";function d(e){let{components:t,...n}=e;return(0,r.kt)(u,(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"transactions"},"Transactions"),(0,r.kt)("p",null,"Transactions let you send Cadence code to the Flow blockchain that permanently alters its state."),(0,r.kt)("p",null,"We are assuming you have read the ",(0,r.kt)("a",{parentName:"p",href:"https://docs.onflow.org/fcl/reference/scripts/"},"Scripts Documentation")," before this, as transactions are sort of scripts with more required things."),(0,r.kt)("p",null,"While ",(0,r.kt)("inlineCode",{parentName:"p"},"query")," is used for sending scripts to the chain, ",(0,r.kt)("inlineCode",{parentName:"p"},"mutate")," is used for building and sending transactions. Just like ",(0,r.kt)("a",{parentName:"p",href:"https://docs.onflow.org/fcl/reference/scripts/"},"scripts"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"fcl.mutate")," is a ",(0,r.kt)("a",{parentName:"p",href:"https://styled-components.com/docs/advanced#tagged-template-literals"},"JavaScript Tagged Template Literal")," that we can pass Cadence code into."),(0,r.kt)("p",null,"Unlike scripts, they require a little more information, things like a proposer, authorizations and a payer, which may be a little confusing and overwhelming."),(0,r.kt)("h1",{id:"sending-your-first-transaction"},"Sending your first Transaction"),(0,r.kt)("p",null,"There is a lot to unpack in the following code snippet.\nIt sends a transaction to the Flow blockchain. For the transaction, the current user is authorizing it as both the ",(0,r.kt)("inlineCode",{parentName:"p"},"proposer")," and the ",(0,r.kt)("inlineCode",{parentName:"p"},"payer"),".\nSomething that is unique to Flow is the one paying for the transaction doesn't always need to be the one performing the transaction.\nProposers and Payers are special kinds of authorizations that are always required for a transaction.\nThe ",(0,r.kt)("inlineCode",{parentName:"p"},"proposer")," acts similar to the ",(0,r.kt)("inlineCode",{parentName:"p"},"nonce")," in Ethereum transactions, and helps prevent repeat attacks.\nThe ",(0,r.kt)("inlineCode",{parentName:"p"},"payer")," is who will be paying for the transaction.\nIf these are not set, FCL defaults to using the current user for all roles."),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"fcl.mutate")," will return a ",(0,r.kt)("inlineCode",{parentName:"p"},"transactionId"),". We can pass the response directly to ",(0,r.kt)("inlineCode",{parentName:"p"},"fcl.tx")," and then use the ",(0,r.kt)("inlineCode",{parentName:"p"},"onceSealed")," method which resolves a promise when the transaction is sealed."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},'import * as fcl from "@onflow/fcl"\n\nconst transactionId = await fcl.mutate({\n  cadence: `\n    transaction {\n      execute {\n        log("Hello from execute")\n      }\n    }\n  `,\n  proposer: fcl.currentUser,\n  payer: fcl.currentUser,\n  limit: 50\n})\n\nconst transaction = await fcl.tx(transactionId).onceSealed()\nconsole.log(transaction) // The transactions status and events after being sealed\n')),(0,r.kt)("h1",{id:"authorizing-a-transaction"},"Authorizing a transaction"),(0,r.kt)("p",null,"The below code snippet is the same as the above one, except for one extremely important difference.\nOur Cadence code this time has a prepare statement, and we are using the ",(0,r.kt)("inlineCode",{parentName:"p"},"fcl.currentUser")," when constructing our transaction."),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"prepare")," statement's arguments directly map to the order of the authorizations in the ",(0,r.kt)("inlineCode",{parentName:"p"},"authorizations")," array.\nFour authorizations means four ",(0,r.kt)("inlineCode",{parentName:"p"},"AuthAccount"),"s as arguments passed to ",(0,r.kt)("inlineCode",{parentName:"p"},"prepare"),". In this case though there is only one, and it is the ",(0,r.kt)("inlineCode",{parentName:"p"},"currentUser"),"."),(0,r.kt)("p",null,"These authorizations are important as you can only access/modify an accounts storage if you have the said accounts authorization."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-javascript"},'import * as fcl from "@onflow/fcl"\n\nconst transactionId = await fcl.mutate({\n  cadence: `\n    transaction {\n      prepare(acct: AuthAccount) {\n        log("Hello from prepare")\n      }\n      execute {\n        log("Hello from execute")\n      }\n    }\n  `,\n  proposer: fcl.currentUser,\n  payer: fcl.currentUser,\n  authorizations: [fcl.currentUser],\n  limit: 50\n})\n\nconst transaction = await fcl.tx(transactionId).onceSealed()\nconsole.log(transaction) // The transactions status and events after being sealed\n')),(0,r.kt)("p",null,"To learn more about ",(0,r.kt)("inlineCode",{parentName:"p"},"mutate"),", check out the ",(0,r.kt)("a",{parentName:"p",href:"/docs/Tooling/fcl-js/api#mutate"},"API documentation"),"."))}d.isMDXComponent=!0}}]);