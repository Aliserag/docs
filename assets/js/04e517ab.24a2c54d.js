"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[553],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>g});var a=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=a.createContext({}),c=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},u=function(e){var t=c(e.components);return a.createElement(l.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},h=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),p=c(n),h=o,g=p["".concat(l,".").concat(h)]||p[h]||d[h]||i;return n?a.createElement(g,r(r({ref:t},u),{},{components:n})):a.createElement(g,r({ref:t},u))}));function g(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,r=new Array(i);r[0]=h;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[p]="string"==typeof e?e:o,r[1]=s;for(var c=2;c<i;c++)r[c]=n[c];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}h.displayName="MDXCreateElement"},98475:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>d,frontMatter:()=>i,metadata:()=>s,toc:()=>c});var a=n(87462),o=(n(67294),n(3905));const i={title:"Walletless Onboarding"},r=void 0,s={unversionedId:"hybrid-custody/guides/walletless-onboarding",id:"hybrid-custody/guides/walletless-onboarding",title:"Walletless Onboarding",description:"Walletless onboarding is an approach through which developers can meet new users where they are in their Web3 journey, delivering a familiar experience while they progressively expose new users to the benefits of Web3. On Flow, developers can help users realize the benefits of both custodial and non-custodial experiences with a seamless path to real ownership and self-sovereignty at a user\u2019s own pace.",source:"@site/docs/hybrid-custody/guides/walletless-onboarding.md",sourceDirName:"hybrid-custody/guides",slug:"/hybrid-custody/guides/walletless-onboarding",permalink:"/hybrid-custody/guides/walletless-onboarding",draft:!1,tags:[],version:"current",lastUpdatedBy:"Tom Haile",lastUpdatedAt:1682618171,formattedLastUpdatedAt:"Apr 27, 2023",frontMatter:{title:"Walletless Onboarding"},sidebar:"tutorialSidebar",previous:{title:"Linking Accounts",permalink:"/hybrid-custody/guides/linking-accounts"},next:{title:"intro",permalink:"/intro"}},l={},c=[{value:"Overview",id:"overview",level:2},{value:"Introduction",id:"introduction",level:2},{value:"Design Considerations",id:"design-considerations",level:2},{value:"<strong>Account Creation</strong>",id:"account-creation",level:3},{value:"<strong>NFT Minting and Purchase</strong>",id:"nft-minting-and-purchase",level:3},{value:"<strong>Connecting Wallets</strong>",id:"connecting-wallets",level:3},{value:"<strong>General Considerations</strong>",id:"general-considerations",level:3},{value:"Example Apps",id:"example-apps",level:2}],u={toc:c},p="wrapper";function d(e){let{components:t,...n}=e;return(0,o.kt)(p,(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Walletless onboarding is an approach through which developers can meet new users where they are in their Web3 journey, delivering a familiar experience while they progressively expose new users to the benefits of Web3. On Flow, developers can help users realize the benefits of both custodial and non-custodial experiences with a seamless path to real ownership and self-sovereignty at a user\u2019s own pace."),(0,o.kt)("h2",{id:"overview"},"Overview"),(0,o.kt)("p",null,"At a high level, implementing walletless onboarding is effectively a process of abstracting away the complexities of getting started in Web3. Your app will handle account creation, key management, and transaction signing behind a familiar Web2 authentication scheme and fiat denominated payments."),(0,o.kt)("p",null,"There are a number of business & regulatory considerations that come along with the totality of that abstraction, and this doc will seek to highlight those considerations and provide guidance as well as point to existing tools and services where possible."),(0,o.kt)("p",null,"How you subsidize account creation will ultimately be up to you, and the custodial pattern you choose will likely involve regulatory implications based on where you and your customers reside. You'll also want to consider whether you or your users will subsidize transaction & account storage fees."),(0,o.kt)("p",null,"With that said, our ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/onflow/walletless-arcade-example"},"Walletless Arcade example app")," implemented a simple in-app custodial method and funded account creation, transaction, and storage fees with a backend developer account. Don't let these non-technical considerations keep you from building awesome apps!"),(0,o.kt)("p",null,"If you're a smart contract developer looking to get started straight away with an example walletless onboarding transaction, take a look at the ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/onflow/linked-accounts"},"@onflow/linked-accounts repo"),"."),(0,o.kt)("h2",{id:"introduction"},"Introduction"),(0,o.kt)("p",null,"To build a walletless onboarding experience, developers can design their first-time user experiences in a way that abstracts away the existence of an underlying blockchain from the user, so users don\u2019t have to worry about wallets right away. Apps can leverage familiar Web2 onboarding features, such as social/email login and payments via credit card in order to help users experience the value of the app up front."),(0,o.kt)("p",null,"Underneath these onboarding features, developers can provide new users with an in-app custodial Flow account and handle all transactions on behalf of the user so that the user can begin using your app without the need to immediately set up a wallet. In this case, any collectibles that a user acquires through the use of the app are held within this app custody account."),(0,o.kt)("p",null,"While this approach can deliver an effective onboarding experience for users new to Web3, it\u2019s important to provide these users with a seamless path to real ownership and control over the digital items that they\u2019ve acquired. Given the benefits of an app custody experience (seamless on-chain transactions), we\u2019ll want to establish this transition in a way that combines these benefits with those of self-custody (real ownership, portability of assets, composability at owner's discretion)."),(0,o.kt)("p",null,"On Flow, developers can establish this state of hybrid custody - where a user realizes the benefits of both app and self custody through shared control between app custody and self custody accounts. With hybrid custody, users can continue to seamlessly use your app without needing to approve transactions while having full control to take their digital items elsewhere in the ecosystem without the need to transfer them out of your app."),(0,o.kt)("p",null,"Hybrid custody is enabled on Flow through Account Linking & Delegation. With Account Linking & Delegation, your app establishes a parent-child relationship by allowing the app custody account (child) to opt into being controlled by the self-custody account (parent). Read Account Linking & Delegation for more details on how hybrid custody is established on Flow."),(0,o.kt)("h2",{id:"design-considerations"},"Design Considerations"),(0,o.kt)("p",null,"While developers will choose the best solution to onboard new users to their app, there are some considerations to take into account when designing a walletless onboarding experience."),(0,o.kt)("h3",{id:"account-creation"},(0,o.kt)("strong",{parentName:"h3"},"Account Creation")),(0,o.kt)("p",null,"In order to use a Web3 account built on Flow, a user will need to have a Flow account. In apps where users bring their own wallet, it can simplify things quite a bit for developers, as they don\u2019t need to worry about account creation and custody of keys. But with a walletless onboarding flow, we\u2019re enabling users to use the app without a wallet - so developers will need to handle account creation and custody on behalf of the user."),(0,o.kt)("p",null,"For most apps, developers will create a Flow account for each user and associate this account with the user\u2019s account in the app itself. ",(0,o.kt)("a",{parentName:"p",href:"https://developers.flow.com/cadence/language/accounts#account-creation"},"Account creation on Flow")," requires a payer, so developers will need to determine whether they subsidize creation of Flow accounts or if they\u2019ll require users to pay to sign up for the app."),(0,o.kt)("p",null,"Additionally, since the user\u2019s Flow account will be managed by the app, developers will need to consider their preferred approach for secure storage and management of the keys for each account."),(0,o.kt)("details",null,(0,o.kt)("summary",null,"Example account creation transaction"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"import FlowToken from \"../../contracts/utility/FlowToken.cdc\"\nimport FungibleToken from \"../../contracts/utility/FungibleToken.cdc\"\n\n/// This transaction creates an account, funding creation via the signer and\n/// adding the provided public key. You'll notice this transaction is pretty\n/// much your standard account creation. The magic for you will be how you custody\n/// the key for this account (locally, KMS, wallet service, etc.) in a manner that\n/// allows your dapp to mediate on-chain interactions on behalf of your user.\n/// **NOTE:** Custodial patterns have regulatory implications you'll want to consult a \n/// legal professional about.\n///\n/// In your dapp's walletless transaction, you'll likely also want to configure\n/// the new account with resources & capabilities relevant for your use case after\n/// account creation & optional funding.\n///\n/// For more examples like this, check out the @onflow/linked-accounts repo\n/// https://github.com/onflow/linked-accounts\n///\ntransaction(\n    pubKey: String,\n    initialFundingAmt: UFix64,\n  ) {\n    \n    prepare(signer: AuthAccount) {\n\n        /* --- Account Creation (your dApp may choose to separate creation depending on your custodial model) --- */\n        //\n        // Create the child account, funding via the signer\n        let newAccount = AuthAccount(payer: signer)\n        // Create a public key for the proxy account from string value in the provided arg\n        // **NOTE:** You may want to specify a different signature algo for your use case\n        let key = PublicKey(\n            publicKey: pubKey.decodeHex(),\n            signatureAlgorithm: SignatureAlgorithm.ECDSA_P256\n        )\n        // Add the key to the new account\n        // **NOTE:** You may want to specify a different hash algo & weight best for your use case\n        newAccount.keys.add(\n            publicKey: key,\n            hashAlgorithm: HashAlgorithm.SHA3_256,\n            weight: 1000.0\n        )\n\n        /* --- (Optional) Additional Account Funding --- */\n        //\n        // Fund the new account if specified\n        if initialFundingAmt > 0.0 {\n            // Get a vault to fund the new account\n            let fundingProvider = signer.borrow<&FlowToken.Vault{FungibleToken.Provider}>(\n                    from: /storage/flowTokenVault\n                )!\n            // Fund the new account with the initialFundingAmount specified\n            newAccount.getCapability<&FlowToken.Vault{FungibleToken.Receiver}>(\n                /public/flowTokenReceiver\n            ).borrow()!\n            .deposit(\n                from: <-fundingProvider.withdraw(\n                    amount: initialFundingAmt\n                )\n            )\n        }\n\n        /* --- Continue with use case specific setup --- */\n        //\n        // At this point, the newAccount can further be configured as suitable for\n        // use in your dapp (e.g. Setup a Collection, Mint NFT, Configure Vault, etc.)\n        // ...\n    }\n}\n"))),(0,o.kt)("h3",{id:"nft-minting-and-purchase"},(0,o.kt)("strong",{parentName:"h3"},"NFT Minting and Purchase")),(0,o.kt)("p",null,"In the walletless onboarding flow, developers will need to provide an abstracted way for users to purchase NFTs without interacting with a wallet or handling crypto. This approach will require developers to enable users to purchase using Web2 methods such as credit card or in-app payments and handle all relevant interactions with the Flow blockchain on the user\u2019s behalf. If the user is purchasing a new NFT, developers will need to handle minting and transfer of the NFTs to the user\u2019s account managed within the app."),(0,o.kt)("h3",{id:"connecting-wallets"},(0,o.kt)("strong",{parentName:"h3"},"Connecting Wallets")),(0,o.kt)("p",null,"To facilitate a user transitioning to a state of hybrid custody in the app, developers will need to design a path for users to connect a self-custody wallet. Developers should aim to design this step in context for users, so there is a clear benefit to how hybrid custody benefits the user and how connecting a wallet unlocks new experiences."),(0,o.kt)("p",null,"Read Account Linking & Delegation for more details on how hybrid custody is established on Flow."),(0,o.kt)("h3",{id:"general-considerations"},(0,o.kt)("strong",{parentName:"h3"},"General Considerations")),(0,o.kt)("p",null,"The following questions might be helpful to ask yourself as you think through your walletless onboarding solution:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"What sort of familiar app authentication can I leverage to make for frictionless signup?"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"SMS Authentication"),(0,o.kt)("li",{parentName:"ul"},"Email address"),(0,o.kt)("li",{parentName:"ul"},"Social Authentication - Google, Twitter, Facebook, etc."))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"How will I handle key management for app accounts?"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Cloud-based KMS"),(0,o.kt)("li",{parentName:"ul"},"In-app local storage"),(0,o.kt)("li",{parentName:"ul"},"Custodial service"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"How will new app accounts be funded?"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Backend account funding creation"),(0,o.kt)("li",{parentName:"ul"},"Custodial service"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Who will fund ongoing transaction & account storage fees?"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Payer service"),(0,o.kt)("li",{parentName:"ul"},"Custodial service"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"How can I allow users to pay for on-chain assets with fiat?"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Fiat-to-crypto payment APIs - Stripe, Paypal, etc.")))),(0,o.kt)("h2",{id:"example-apps"},"Example Apps"),(0,o.kt)("p",null,"To help demonstrate a walletless onboarding experience, we\u2019ve ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/onflow/walletless-arcade-example"},"built a pair of sample apps")," that showcase the end-to-end flow of a user journey that begins in a walletless, app custody experience and ends with a hybrid custody state where a user can seamlessly use their digital items in other apps."))}d.isMDXComponent=!0}}]);