"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[9877],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>m});var o=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},s=Object.keys(e);for(o=0;o<s.length;o++)n=s[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(o=0;o<s.length;o++)n=s[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=o.createContext({}),c=function(e){var t=o.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},d=function(e){var t=c(e.components);return o.createElement(l.Provider,{value:t},e.children)},h="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},u=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,s=e.originalType,l=e.parentName,d=i(e,["components","mdxType","originalType","parentName"]),h=c(n),u=a,m=h["".concat(l,".").concat(u)]||h[u]||p[u]||s;return n?o.createElement(m,r(r({ref:t},d),{},{components:n})):o.createElement(m,r({ref:t},d))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var s=n.length,r=new Array(s);r[0]=u;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i[h]="string"==typeof e?e:a,r[1]=i;for(var c=2;c<s;c++)r[c]=n[c];return o.createElement.apply(null,r)}return o.createElement.apply(null,n)}u.displayName="MDXCreateElement"},16371:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>p,frontMatter:()=>s,metadata:()=>i,toc:()=>c});var o=n(87462),a=(n(67294),n(3905));const s={title:"Flow Smart Contract Project Development Standards",description:"Learn how to effectively organize and manage a Cadence project"},r="Smart Contract Project Development Standards",i={unversionedId:"cadence/styleguide/project-development-tips",id:"cadence/styleguide/project-development-tips",title:"Flow Smart Contract Project Development Standards",description:"Learn how to effectively organize and manage a Cadence project",source:"@site/docs/cadence/styleguide/project-development-tips.md",sourceDirName:"cadence/styleguide",slug:"/cadence/styleguide/project-development-tips",permalink:"/cadence/styleguide/project-development-tips",draft:!1,tags:[],version:"current",lastUpdatedBy:"Tom Haile",lastUpdatedAt:1682618007,formattedLastUpdatedAt:"Apr 27, 2023",frontMatter:{title:"Flow Smart Contract Project Development Standards",description:"Learn how to effectively organize and manage a Cadence project"},sidebar:"tutorialSidebar",previous:{title:"Guide for Solidity developers",permalink:"/cadence/solidity-to-cadence"},next:{title:"subtyping",permalink:"/cadence/subtyping"}},l={},c=[{value:"Context",id:"context",level:2},{value:"Implementing These Practices",id:"implementing-these-practices",level:3},{value:"Design Process",id:"design-process",level:2},{value:"Projects should ensure that there is strong technical leadership for ther smart contracts",id:"projects-should-ensure-that-there-is-strong-technical-leadership-for-ther-smart-contracts",level:3},{value:"Projects should maintain a well-organized open source Repo for their smart contracts",id:"projects-should-maintain-a-well-organized-open-source-repo-for-their-smart-contracts",level:3},{value:"Development Process Recommendations",id:"development-process-recommendations",level:2},{value:"The Development process should be iterative, if possible",id:"the-development-process-should-be-iterative-if-possible",level:3},{value:"Comments and field/function descriptions are essential!",id:"comments-and-fieldfunction-descriptions-are-essential",level:3},{value:"Testing Recommendations",id:"testing-recommendations",level:2},{value:"Managing Project Keys and Deployments",id:"managing-project-keys-and-deployments",level:2},{value:"Private Keys should be stored securely",id:"private-keys-should-be-stored-securely",level:3},{value:"Deployments to Testnet or Mainnet should be handled transparently",id:"deployments-to-testnet-or-mainnet-should-be-handled-transparently",level:3},{value:"Responsibilities to the Community",id:"responsibilities-to-the-community",level:2},{value:"Projects should have thorough documentation",id:"projects-should-have-thorough-documentation",level:3},{value:"Projects should engage with and respond to their own Community",id:"projects-should-engage-with-and-respond-to-their-own-community",level:3},{value:"Projects should contribute to the greater Flow and Cadence community",id:"projects-should-contribute-to-the-greater-flow-and-cadence-community",level:3}],d={toc:c},h="wrapper";function p(e){let{components:t,...n}=e;return(0,a.kt)(h,(0,o.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"smart-contract-project-development-standards"},"Smart Contract Project Development Standards"),(0,a.kt)("h2",{id:"context"},"Context"),(0,a.kt)("p",null,"Smart Contracts are the bedrock piece of security for many important parts\nof the Flow blockchain, as well as for any project that is deployed to a blockchain."),(0,a.kt)("p",null,"They are also the most visible technical parts of any project,\nsince users will be querying them for data, building other smart contracts that interact with them,\nand using them as learning materials and templates for future projects.\nFurthermore, when deployed they are publicly available code on the blockchain\nand often also in public Github repos."),(0,a.kt)("p",null,"Therefore, the process around designing, building, testing, documenting,\nand managing these projects needs to reflect the critical importance they hold in the ecosystem."),(0,a.kt)("p",null,"Every software project strikes a balance between effort spent on product/feature delivery\nvs the many other demands of the software development lifecycle, whether testing, technical debt,\nautomation, refactoring, or documentation etc. Building in Web3 we face the same trade-offs,\nbut in a higher risk and consequence environment than what is typical for most software.\nA mismanaged or untested smart contract may result in ",(0,a.kt)("strong",{parentName:"p"},"significant")," financial losses\nas a result of vulnerabilities which were overlooked then exploited.\nWe highly recommend builders adopt these best practices to help mitigate these risks."),(0,a.kt)("p",null,"If they do so, they will be able to build better smart contracts, avoid potential bugs,\nsupport user and third-party adoption of their projects, and increase their chances of success\nby being a model for good software design. Additionally, the more projects that adopt\ngood software design and management standards normalizes this behavior,\nencouraging other projects in the ecosystem to do the same which creates a healthier\nand more vibrant community."),(0,a.kt)("p",null,"Ensuring appropriate levels of testing results in better smart contracts which have\npro-actively modeled threats and engineered against them. Ensuring appropriate levels\nof standards adoption (",(0,a.kt)("a",{parentName:"p",href:"https://github.com/onflow/flow-ft"},"FungibleToken"),",\n",(0,a.kt)("a",{parentName:"p",href:"https://www.flow-nft-catalog.com/"},"NFT Catalog"),", ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/onflow/nft-storefront"},"NFT StoreFront"),", etc) by dapp\nbuilders amplifies the network effects for all in the ecosystem. NFTs in one dapp can be\nreadily consumed by other dapps through on-chain events with no new integration\nrequired. With your help and participation we can further accelerate healthy and vibrant\nnetwork effects across the Flow ecosystem!"),(0,a.kt)("p",null,"Some of these suggestions might seem somewhat unnecessary,\nbut it is important to model what a project can do to manage its smart contracts the best\nso that hopefully all of the other projects follow suit."),(0,a.kt)("p",null,"This also assumes standard software design best practices also apply.\nIndeed, many of these suggestions are more general software design best practices,\nbut there may be others that are assumed but not included here."),(0,a.kt)("h3",{id:"implementing-these-practices"},"Implementing These Practices"),(0,a.kt)("p",null,"This document serves as mostly an outline of best practices the projects should follow.\nAs with all best practices, teams will choose which applies to them and their work process,\nhowever, we recommend that teams explicitly define a minimum acceptable set of standards\nfor themselves along with the mechanisms to ensure they are being observed."),(0,a.kt)("p",null,"Some teams may also have their own set of development standards that acheive a similar goal\nto these. These recommendations are not meant to be the only paths to success,\nso if a team disagrees with some of these and wants to do things their own way,\nthey are welcome to pursue that. This document just shows some generic suggestions\nfor teams who might not know how they want to manage their project."),(0,a.kt)("h2",{id:"design-process"},"Design Process"),(0,a.kt)("p",null,"Smart contracts usually manage a lot of value, have many users, and are difficult to upgrade\nfor a variety of reasons. Therefore, it is important to have a clearly defined design\nprocess for the smart contracts before much code is written so that the team\ncan set themselves up for success."),(0,a.kt)("p",null,"Here are some recommendations for how projects can organize the foundations of their projects."),(0,a.kt)("h3",{id:"projects-should-ensure-that-there-is-strong-technical-leadership-for-ther-smart-contracts"},"Projects should ensure that there is strong technical leadership for ther smart contracts"),(0,a.kt)("p",null,"Developing a dapp requires a clear vision for the role of the smart contract and how it's integrated.\nSecurity vulnerabilities may arise from bugs directly in smart contract code (and elsewhere in the system).\nAsynchronous interaction vectors may lead to forms of malicious abuse,\nDOS etc in a contract triggering explosive gas costs for the developer or other problems."),(0,a.kt)("p",null,"We recommend that engineers leading a project and deploying to mainnet have an understanding\nof software and security engineering fundamentals and have been thorough\nin their Cadence skills development. More in-depth resources for learning Cadence\nare available ",(0,a.kt)("a",{parentName:"p",href:"https://developers.flow.com/cadence"},"here"),"."),(0,a.kt)("p",null,"The technical leader should be someone who understands Cadence well and has written Cadence smart contracts\nbefore. Production-level smart contracts are not the place for beginners to get their start."),(0,a.kt)("p",null,"It should be this person\u2019s responsibility to lead design discussions\nwith product managers and the community, write most of the code and tests,\nsolicit reviews, make requested changes and make sure the project gets completed in a timely manner."),(0,a.kt)("p",null,"The leader should also understand how to sign transactions with the CLI\nto deploy/upgrade smart contracts, run admin transactions, and troubleshoot problems, etc.\nIf something goes wrong in relation to the smart contract\nthat needs to be handled with a bespoke transaction, it is important that the owner\nknows how to build and run transactions and scripts safely to address the issues\nand/or upgrade the smart contracts."),(0,a.kt)("p",null,"The project should also have a clear plan of succession in case the original owner\nis not available or leaves the project. It is important that there are others who\ncan fill in who have a clear understanding of the code and requirements so they can give good feedback,\nperform effective reviews, and make changes where needed."),(0,a.kt)("h3",{id:"projects-should-maintain-a-well-organized-open-source-repo-for-their-smart-contracts"},"Projects should maintain a well-organized open source Repo for their smart contracts"),(0,a.kt)("p",null,"As projects like NBA Topshot have shown, when a blockchain product becomes successful\nothers can and do to build on top of what you are doing.\nWhether that is analytics, tools, or other value adds that could help grow your project ecosystem,\ncomposability is key and that depends on open source development.\nIf there isn\u2019t already an open source repo, builders should consider creating one."),(0,a.kt)("p",null,"Builders can start from the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/onflow/open-source-template"},"the Flow open source template"),"\nand make sure all of their repo is set up with some initial documentation for what the repo is for\nbefore any code is written. External developers and users should have an easily accessible home page\nto go to to understand any given project."),(0,a.kt)("p",null,"The repo should also have some sort of high-level design document that lays out\nthe intended design and architecture of the smart contract.\nThe project leads should determine what is best for them to include in the document,\nbut some useful things to include are basic user stories, architecture of the smart contracts,\nand any questions that still need to be answered about it."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"- Where applicable, diagrams should be made describing state machines, user flows, etc.\n- This document should be shared in an issue in the open source repo\nwhere the contracts or features are being developed,\nthen later moved to the README or another important docs page.\n")),(0,a.kt)("p",null,"A high level design is a key opportunity to model threats\nand understand the risks of the system. The process of collaborating\nand reviewing designs together helps ensure that more edge-cases are captured and addressed.\nIt's also a lot less effort to iterate on a design than on hundreds of lines of Cadence.    "),(0,a.kt)("h2",{id:"development-process-recommendations"},"Development Process Recommendations"),(0,a.kt)("h3",{id:"the-development-process-should-be-iterative-if-possible"},"The Development process should be iterative, if possible"),(0,a.kt)("p",null,"The project should develop an MVP first, get reviews, and test thoroughly,\nthen add additional features with tests. This ensures that the core features are designed\nthoughtfully and makes the review process easier because they can focus on each feature\none at a time instead of being overwhelmed by a huge block of code."),(0,a.kt)("h3",{id:"comments-and-fieldfunction-descriptions-are-essential"},"Comments and field/function descriptions are essential!"),(0,a.kt)("p",null,"Our experience writing many Cadence smart contracts has taught us how important documentation\nis. It especially matters what is documented and for whom, and in that way we are no different from\nany software language. The Why is super important, if for example something - an event - that\nhappens in one contract leads to outcomes in a different contract. The What helps give context,\nthe reason for the code turning out the way it is. The How, you don't document - you've written\nthe code. Comments should be directed to those who will follow after you in changing the code. "),(0,a.kt)("p",null,"Comments should be written at the same time (or even before) the code is written.\nThis helps the developer and reviewers understand the work-in-progress code better,\nas well as the intentions of the design (for testing and reviewing).\nFunctions should be commented with a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"- Description\n- Parameter descriptions\n- Return value descriptions\n")),(0,a.kt)("p",null,"Top Level comments and comments for types, fields, events,\nand functions should use ",(0,a.kt)("inlineCode",{parentName:"p"},"///")," (three slashes) to be recognised by the\n",(0,a.kt)("a",{parentName:"p",href:"https://github.com/onflow/cadence-tools/tree/master/docgen"},"Cadence Documentation Generator"),".\nRegular comments within functions should only use two slashes (",(0,a.kt)("inlineCode",{parentName:"p"},"//"),")"),(0,a.kt)("h2",{id:"testing-recommendations"},"Testing Recommendations"),(0,a.kt)("p",null,"Summarized below is a list of testing related recommendations\nwhich are noteworthy to mention for a typical smart contract project."),(0,a.kt)("p",null,"Popular testing frameworks to use for cadence are listed here:\nJavascript: ",(0,a.kt)("a",{parentName:"p",href:"https://developers.flow.com/tools/flow-js-testing"},"Flow JS Testing"),"\nGo: ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/bjartek/overflow"},"Overflow"),"\nCadence: ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/onflow/cadence/blob/ac05b6a0d6005cde468573f0a7a2e3a67f49bd90/docs/testing-framework.mdx"},"Cadence Testing Framework"),"\nTests written in Cadence!"),(0,a.kt)("p",null,"The same person who writes the code should also write the tests.\nThey have the clearest understanding of the code paths and edge cases."),(0,a.kt)("p",null,"Tests should be ",(0,a.kt)("strong",{parentName:"p"},"mandatory"),", not optional, even if the contract is copied from somewhere else.\nThere should be thorough emulator unit tests in the public repo.\n",(0,a.kt)("a",{parentName:"p",href:"https://github.com/onflow/flow-ft/tree/master/lib/js/test"},"See the flow fungible token repo"),"\nfor an example of unit tests in javascript."),(0,a.kt)("p",null,"Every time there is a new Cadence version or emulator version,\nthe dependencies of the repo should be updated to make sure the tests are all still passing."),(0,a.kt)("p",null,"Tests should avoid being monolithic;\nIndividual test cases should be set up for each part of the contract to test them in isolation.\nSee the ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/onflow/flow-core-contracts/blob/master/lib/go/test/flow_epoch_test.go"},(0,a.kt)("inlineCode",{parentName:"a"},"FlowEpoch")," smart contract tests"),"\nfor examples written in Go where test cases are split\ninto separate blocks for different features.\nThere are some exceptions, like contracts that have to run through a state machine\nto test different cases. Positive and negative cases need to be tested."),(0,a.kt)("p",null,"Integration tests should also be written to ensure that your app and/or backend can interact\nproperly with the smart contracts."),(0,a.kt)("h2",{id:"managing-project-keys-and-deployments"},"Managing Project Keys and Deployments"),(0,a.kt)("p",null,"Smart contract keys and deployments are very important and need to be treated as such."),(0,a.kt)("h3",{id:"private-keys-should-be-stored-securely"},"Private Keys should be stored securely"),(0,a.kt)("p",null,"Private Keys for the contract and/or admin accounts should not be kept in plain text format anywhere.\nProjects should determine a secure solution that works best for them to store their private keys.\nWe recommend storing them in a secure key store such as google KMS or something similar."),(0,a.kt)("h3",{id:"deployments-to-testnet-or-mainnet-should-be-handled-transparently"},"Deployments to Testnet or Mainnet should be handled transparently"),(0,a.kt)("p",null,"As projects become more successful, communities around them grow.\nIn a trustless ecosystem, that also means more of others building on your contracts.\nBefore deploying or upgrading a contract, it is important to maintain\nclear community communications with sufficient notice, since changes will always bring added risk.\nGiving community members time to review and address issues with upgrades\nbefore they happen builds trust and confidence in projects.\nHere are a few suggestions for how to manage a deployment or upgrade."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Communicate to all stake-holders well in advance",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Share the proposal with the community at least a week in advance (unless it is a critical bug fix)",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Examples of places to share are your project's chat, forum, blog, email list, etc."),(0,a.kt)("li",{parentName:"ul"},"This will allow the community and other stakeholders to have plenty of time\nto view the upcoming changes and provide feedback if neccessary."))),(0,a.kt)("li",{parentName:"ul"},"Share the time of the deployment and the deployment transaction with branch/commit hash information to ensure the transaction itself is correct."),(0,a.kt)("li",{parentName:"ul"},"Coordinate deployment with stakeholders to make sure it is done correctly and on time.")))),(0,a.kt)("h2",{id:"responsibilities-to-the-community"},"Responsibilities to the Community"),(0,a.kt)("p",null,"Web3 brings tremendous possibilities for engineering applications with trustlessness\nand composability in mind, with Cadence and Flow offering unique features to achieve this.\nIf every project treats their community and the Flow community with respect and care,\nthe things we can all build together will be very powerful."),(0,a.kt)("h3",{id:"projects-should-have-thorough-documentation"},"Projects should have thorough documentation"),(0,a.kt)("p",null,"Encouraging adoption of project contracts to the broader ecosystem\nraises the bar around code providing clear high-level descriptions,\nwith detailed and useful comments within contracts, transactions, and scripts.\nThe more that a project can be understood, that it adheres to standards,\nand can be built upon with ease, the more likely others will build against it in turn. "),(0,a.kt)("p",null,"Each project should have a detailed README.md with these sections:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"- Explanation of the project itself with links to the app\n- Addresses on various networks\n- High-level technical description of the contracts with emphasis on important types and functionality\n- Architecture diagram (if applicable)\n- Include links to tutorials if they are external\n- Flow smart contract standards that a project implements\n")),(0,a.kt)("p",null,"Additionally, each contract, transaction, and script should have high-level descriptions\nat the top of their files. This way, anyone in the community can easily\ncome in and understand what each one is doing without having to parse confusing code."),(0,a.kt)("h3",{id:"projects-should-engage-with-and-respond-to-their-own-community"},"Projects should engage with and respond to their own Community"),(0,a.kt)("p",null,"Once a contract is deployed, the work doesn\u2019t stop there.\nProject communities require ongoing nurturing and support.\nAs the developer of a public project on a public blockchain,\nthe owners have an obligation to be helpful and responsive to the community\nso that they can encourage composability and third party interactions."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Keep issues open in the repo."),(0,a.kt)("li",{parentName:"ul"},"The owner should turn on email notifications for new issue creation in the repo."),(0,a.kt)("li",{parentName:"ul"},"Respond to issues quickly and clean up unimportant ones."),(0,a.kt)("li",{parentName:"ul"},"Consider blog posts to share more details on technical aspects of the project and upcoming changes.")),(0,a.kt)("h3",{id:"projects-should-contribute-to-the-greater-flow-and-cadence-community"},"Projects should contribute to the greater Flow and Cadence community"),(0,a.kt)("p",null,"Flow has a vibrant and growing community of contributors around the world.\nThrough our mutual collaboration we've had numerous community Flow Improvement Proposals\n(",(0,a.kt)("a",{parentName:"p",href:"https://github.com/onflow/flow/tree/master/flips"},"FLIP"),"s) shipped.\nIf you have an interest in a particular improvement for Flow or Cadence,\nwe host open meetings which you are welcome to join (announced on discord)\nand can participate anytime on any of the FLIPs\n",(0,a.kt)("a",{parentName:"p",href:"https://github.com/onflow/flow/pulls?q=is%3Aopen+is%3Apr+label%3AFLIP"},"already proposed"),"."),(0,a.kt)("p",null,"Responsible project maintainers should contribute to discussions\nabout important proposals (new cadence features, standard smart contracts, metadata, etc)\nand generally be aware about evolving best practices and anti-pattern understandings.\nProjects who contribute to these discussions are able to influence them to ensure\nthat the language/protocol changes are favorable to them\nand the rest of the app developers in the ecosystem.\nIt also helps the owner to promote the project and themselves."),(0,a.kt)("p",null,"Resources for Best Practices:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://developers.flow.com/cadence/design-patterns"},"https://developers.flow.com/cadence/design-pattern"),"s"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://developers.flow.com/cadence/anti-patterns"},"https://developers.flow.com/cadence/anti-patterns")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"https://developers.flow.com/cadence/security-best-practices"},"https://developers.flow.com/cadence/security-best-practices"))),(0,a.kt)("p",null,"Composability and extensibility should also be priorities while designing, developing,\nand documenting their projects. (Documentation for these topics coming soon)"),(0,a.kt)("p",null,"If you have any feedback about these guidelines, please create an issue in the onflow/cadence-style-guide repo or make a PR updating the guidelines so we can start a discussion."))}p.isMDXComponent=!0}}]);