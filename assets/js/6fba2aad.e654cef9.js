"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[3648],{3905:(e,t,n)=>{n.d(t,{Zo:()=>l,kt:()=>k});var a=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var i=a.createContext({}),u=function(e){var t=a.useContext(i),n=t;return e&&(n="function"==typeof e?e(t):c(c({},t),e)),n},l=function(e){var t=u(e.components);return a.createElement(i.Provider,{value:t},e.children)},d="mdxType",p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},h=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,i=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),d=u(n),h=o,k=d["".concat(i,".").concat(h)]||d[h]||p[h]||r;return n?a.createElement(k,c(c({ref:t},l),{},{components:n})):a.createElement(k,c({ref:t},l))}));function k(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,c=new Array(r);c[0]=h;var s={};for(var i in t)hasOwnProperty.call(t,i)&&(s[i]=t[i]);s.originalType=e,s[d]="string"==typeof e?e:o,c[1]=s;for(var u=2;u<r;u++)c[u]=n[u];return a.createElement.apply(null,c)}return a.createElement.apply(null,n)}h.displayName="MDXCreateElement"},8230:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>i,contentTitle:()=>c,default:()=>k,frontMatter:()=>r,metadata:()=>s,toc:()=>u});var a=n(87462),o=(n(67294),n(3905));const r={title:"Leased FLOW Account Setup",description:"Configure an account to hold leased FLOW"},c=void 0,s={unversionedId:"nodes/node-operation/leased-account-setup",id:"nodes/node-operation/leased-account-setup",title:"Leased FLOW Account Setup",description:"Configure an account to hold leased FLOW",source:"@site/docs/nodes/node-operation/leased-account-setup.mdx",sourceDirName:"nodes/node-operation",slug:"/nodes/node-operation/leased-account-setup",permalink:"/docs/nodes/node-operation/leased-account-setup",draft:!1,tags:[],version:"current",lastUpdatedBy:"Alex Ni",lastUpdatedAt:1682708799,formattedLastUpdatedAt:"Apr 28, 2023",frontMatter:{title:"Leased FLOW Account Setup",description:"Configure an account to hold leased FLOW"},sidebar:"tutorialSidebar",previous:{title:"Starting Your Nodes",permalink:"/docs/nodes/node-operation/guides/starting-nodes"},next:{title:"Machine Accounts for Existing Node Operators",permalink:"/docs/nodes/node-operation/machine-existing-operator"}},i={},u=[{value:"Introduction",id:"introduction",level:2},{value:"Setup",id:"setup",level:2},{value:"Configure a Creator Account",id:"configure-a-creator-account",level:3},{value:"Receive Account Creator Capability",id:"receive-account-creator-capability",level:3},{value:"Account Creation",id:"account-creation",level:2},{value:"1. Create Both Accounts for the User",id:"1-create-both-accounts-for-the-user",level:3},{value:"2. Create the Shared Account for an Existing User Account",id:"2-create-the-shared-account-for-an-existing-user-account",level:3},{value:"Summary",id:"summary",level:2}],l=(d="Callout",function(e){return console.warn("Component "+d+" was not imported, exported, or provided by MDXProvider as global scope"),(0,o.kt)("div",e)});var d;const p={toc:u},h="wrapper";function k(e){let{components:t,...n}=e;return(0,o.kt)(h,(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)(l,{type:"warning",mdxType:"Callout"},(0,o.kt)("p",null,"  This guide is for custodians and wallet providers who wish to create user accounts\nthat can hold locked FLOW tokens from the Flow token sale."),(0,o.kt)("p",null,"  If you already have an account and wish to stake tokens,\nplease see our guides on staking ",(0,o.kt)("a",{parentName:"p",href:"/staking/"},"here"),".")),(0,o.kt)("h2",{id:"introduction"},"Introduction"),(0,o.kt)("p",null,"This guide covers the technical integration required for custodians to create\naccounts that store locked FLOW tokens for users."),(0,o.kt)("p",null,"Before discussing the account creation process, some terminology needs to be defined:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Flow Token Admin")," - The user who controls the locked and vesting tokens from the\nFlow Token sale. This user maintains a record of users, their account addresses,\nand how many Flow tokens they will receive according to their vesting schedule.\nThis user also is required to co-sign any transactions that transfer locked tokens\nbefore they have been unlocked via the vesting schedule.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"User")," - A user who has bought Flow tokens in the Flow token sale or auction.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Custody/Wallet Provider")," - A service that is managing accounts on behalf of users."))),(0,o.kt)("p",null,"Every user who holds locked FLOW tokens gets two accounts."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Account 1 - User Account:")," This is the user's normal Flow account.\nThis account is completely controlled by the user. It can have already been created by\nthe custody provider or can be created along with the user's second account.")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Account 2 - Lease Admin Account:")," This account holds leased tokens used to stake your node. The key for this\naccount belongs to the lease provider (1000 weight). Any transactions that directly access this account need to be signed\nby this key."))),(0,o.kt)("p",null,"The ",(0,o.kt)("strong",{parentName:"p"},"User Account")," will include an object that manages access to\nthe staking functionality contained in the lease admin account."),(0,o.kt)("h2",{id:"setup"},"Setup"),(0,o.kt)("h3",{id:"configure-a-creator-account"},"Configure a Creator Account"),(0,o.kt)("p",null,"As the custodian, you must configure a Flow account that you will use to\ncreate user accounts. This is called your ",(0,o.kt)("strong",{parentName:"p"},"creator account"),"."),(0,o.kt)("p",null,"You can convert an existing account into a ",(0,o.kt)("strong",{parentName:"p"},"creator account")," by running\nthe ",(0,o.kt)("strong",{parentName:"p"},"Set Up Creator Account")," (",(0,o.kt)("a",{parentName:"p",href:"/core-contracts/locked-tokens/#custodian"},"C.01"),") transaction."),(0,o.kt)("p",null,"This transaction creates an ",(0,o.kt)("inlineCode",{parentName:"p"},"AccountCreator")," object and stores it in the custodian's account.\nIt also publishes a capability that allows the token admin to grant the custodian\nthe authority to register locked token accounts."),(0,o.kt)("h3",{id:"receive-account-creator-capability"},"Receive Account Creator Capability"),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},(0,o.kt)("strong",{parentName:"em"},"Note: Once you reach this step, please contact the token admin."))),(0,o.kt)("p",null,"After you have set up your creator account,\nthe token admin needs to submit one more transaction\nto enable your account to register new user accounts to receive locked tokens."),(0,o.kt)("p",null,"The ",(0,o.kt)("strong",{parentName:"p"},"Deposit Account Creator")," (",(0,o.kt)("a",{parentName:"p",href:"/core-contracts/locked-tokens/#token-admin"},"TA.06"),") transaction\nmust be signed and authorized by the token admin account. It requires the\nfollowing arguments:"),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},"Argument"),(0,o.kt)("th",{parentName:"tr",align:null},"Type"),(0,o.kt)("th",{parentName:"tr",align:null},"Description"))),(0,o.kt)("tbody",{parentName:"table"},(0,o.kt)("tr",{parentName:"tbody"},(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("strong",{parentName:"td"},"custodyProviderAddress")),(0,o.kt)("td",{parentName:"tr",align:null},(0,o.kt)("inlineCode",{parentName:"td"},"Address")),(0,o.kt)("td",{parentName:"tr",align:null},"The address of the custodian's account.")))),(0,o.kt)("p",null,"This transaction gives the account registration capability to the custodian's creator account\nthat was configured in the previous transaction."),(0,o.kt)("h2",{id:"account-creation"},"Account Creation"),(0,o.kt)("p",null,"When a custodian uses these transactions, they must also ensure that\nthe token admin knows which account addresses map to which users. This is so the token\nadmin knows which accounts correspond to which lease recipient. "),(0,o.kt)("h3",{id:"1-create-both-accounts-for-the-user"},"1. Create Both Accounts for the User"),(0,o.kt)("p",null,"If your user does not have a regular account created for them yet, you must\ncreate both accounts using the ",(0,o.kt)("strong",{parentName:"p"},"Create Shared Lease Accounts")," (",(0,o.kt)("a",{parentName:"p",href:"/core-contracts/locked-tokens/#custodian"},"C.02"),")\ntransaction with the following arguments:"),(0,o.kt)("h3",{id:"2-create-the-shared-account-for-an-existing-user-account"},"2. Create the Shared Account for an Existing User Account"),(0,o.kt)("p",null,"If your user already has a personal account allocated to them, you can run a transaction\nthat creates the shared account."),(0,o.kt)(l,{type:"warning",mdxType:"Callout"},(0,o.kt)("p",null,"  This transaction ",(0,o.kt)("strong",{parentName:"p"},"MUST")," also be signed and authorized by the existing user account.\nIt needs this because it needs to have access to the user's private storage and Authorized access.")),(0,o.kt)("p",null,"To attach a shared account to an existing user account,\nrun the ",(0,o.kt)("strong",{parentName:"p"},"Create Only Shared Account")," (",(0,o.kt)("a",{parentName:"p",href:"/core-contracts/locked-tokens/#custodian"},"C.03"),")\ntransaction with the following arguments:"),(0,o.kt)("p",null,"TODO: Key setup for leased token account"),(0,o.kt)("h2",{id:"summary"},"Summary"),(0,o.kt)("p",null,"TODO: Summary"))}k.isMDXComponent=!0}}]);