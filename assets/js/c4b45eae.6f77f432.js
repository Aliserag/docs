"use strict";(self.webpackChunkdocusaurus=self.webpackChunkdocusaurus||[]).push([[61592],{4548:(e,o,t)=>{t.r(o),t.d(o,{CH:()=>d,assets:()=>i,chCodeConfig:()=>u,contentTitle:()=>a,default:()=>g,frontMatter:()=>c,metadata:()=>l,toc:()=>p});t(67294);var n=t(85893),r=t(11151),s=t(59794);const c={title:"Working With Parent Accounts",sidebar_position:2},a=void 0,l={unversionedId:"concepts/account-linking/parent-accounts",id:"concepts/account-linking/parent-accounts",title:"Working With Parent Accounts",description:"In this doc, we'll continue from the perspective of a wallet or marketplace app seeking to facilitate a unified account experience,",source:"@site/docs/concepts/account-linking/parent-accounts.mdx",sourceDirName:"concepts/account-linking",slug:"/concepts/account-linking/parent-accounts",permalink:"/docs/next/concepts/account-linking/parent-accounts",draft:!1,editUrl:"https://github.com/onflow/docs/tree/main/docs/concepts/account-linking/parent-accounts.mdx",tags:[],version:"current",lastUpdatedBy:"Tom Haile",lastUpdatedAt:1693343200,formattedLastUpdatedAt:"Aug 29, 2023",sidebarPosition:2,frontMatter:{title:"Working With Parent Accounts",sidebar_position:2},sidebar:"concepts",previous:{title:"Building Walletless Applications Using Child Accounts",permalink:"/docs/next/concepts/account-linking/child-accounts"}},i={},p=[{value:"Objectives",id:"objectives",level:2},{value:"Design Overview",id:"design-overview",level:2},{value:"Identifying Account Hierarchy",id:"identifying-account-hierarchy",level:3},{value:"Restricted vs. Owned Accounts",id:"restricted-vs-owned-accounts",level:4},{value:"Considerations",id:"considerations",level:3},{value:"Implementation",id:"implementation",level:2},{value:"Examples",id:"examples",level:2},{value:"Query Whether an Address Has Associated Accounts",id:"query-whether-an-address-has-associated-accounts",level:3},{value:"Query All Accounts Associated with Address",id:"query-all-accounts-associated-with-address",level:3},{value:"Query All Owned NFT Metadata",id:"query-all-owned-nft-metadata",level:3},{value:"Query All Account FungibleToken Balances",id:"query-all-account-fungibletoken-balances",level:3},{value:"Access NFT in Child Account from Parent Account",id:"access-nft-in-child-account-from-parent-account",level:3},{value:"Revoking Secondary Access on a Linked Account",id:"revoking-secondary-access-on-a-linked-account",level:3},{value:"Remove a Child Account",id:"remove-a-child-account",level:3}],d={annotations:s.ds,Code:s.EK},u={staticMediaQuery:"not screen, (max-width: 768px)",theme:{name:"nord",type:"dark",semanticHighlighting:!0,colors:{focusBorder:"#3b4252",foreground:"#d8dee9","activityBar.background":"#2e3440","activityBar.dropBackground":"#3b4252","activityBar.foreground":"#d8dee9","activityBar.activeBorder":"#88c0d0","activityBar.activeBackground":"#3b4252","activityBarBadge.background":"#88c0d0","activityBarBadge.foreground":"#2e3440","badge.foreground":"#2e3440","badge.background":"#88c0d0","button.background":"#88c0d0ee","button.foreground":"#2e3440","button.hoverBackground":"#88c0d0","button.secondaryBackground":"#434c5e","button.secondaryForeground":"#d8dee9","button.secondaryHoverBackground":"#4c566a","charts.red":"#bf616a","charts.blue":"#81a1c1","charts.yellow":"#ebcb8b","charts.orange":"#d08770","charts.green":"#a3be8c","charts.purple":"#b48ead","charts.foreground":"#d8dee9","charts.lines":"#88c0d0","debugConsole.infoForeground":"#88c0d0","debugConsole.warningForeground":"#ebcb8b","debugConsole.errorForeground":"#bf616a","debugConsole.sourceForeground":"#616e88","debugConsoleInputIcon.foreground":"#81a1c1","debugExceptionWidget.background":"#4c566a","debugExceptionWidget.border":"#2e3440","debugToolBar.background":"#3b4252",descriptionForeground:"#d8dee9e6","diffEditor.insertedTextBackground":"#81a1c133","diffEditor.removedTextBackground":"#bf616a4d","dropdown.background":"#3b4252","dropdown.border":"#3b4252","dropdown.foreground":"#d8dee9","editorActiveLineNumber.foreground":"#d8dee9cc","editorCursor.foreground":"#d8dee9","editorHint.border":"#ebcb8b00","editorHint.foreground":"#ebcb8b","editorIndentGuide.background":"#434c5eb3","editorIndentGuide.activeBackground":"#4c566a","editorInlayHint.background":"#434c5e","editorInlayHint.foreground":"#d8dee9","editorLineNumber.foreground":"#4c566a","editorLineNumber.activeForeground":"#d8dee9","editorWhitespace.foreground":"#4c566ab3","editorWidget.background":"#2e3440","editorWidget.border":"#3b4252","editor.background":"#2e3440","editor.foreground":"#d8dee9","editor.hoverHighlightBackground":"#3b4252","editor.findMatchBackground":"#88c0d066","editor.findMatchHighlightBackground":"#88c0d033","editor.findRangeHighlightBackground":"#88c0d033","editor.lineHighlightBackground":"#3b4252","editor.lineHighlightBorder":"#3b4252","editor.inactiveSelectionBackground":"#434c5ecc","editor.inlineValuesBackground":"#4c566a","editor.inlineValuesForeground":"#eceff4","editor.selectionBackground":"#434c5ecc","editor.selectionHighlightBackground":"#434c5ecc","editor.rangeHighlightBackground":"#434c5e52","editor.wordHighlightBackground":"#81a1c166","editor.wordHighlightStrongBackground":"#81a1c199","editor.stackFrameHighlightBackground":"#5e81ac","editor.focusedStackFrameHighlightBackground":"#5e81ac","editorError.foreground":"#bf616a","editorError.border":"#bf616a00","editorWarning.foreground":"#ebcb8b","editorWarning.border":"#ebcb8b00","editorBracketMatch.background":"#2e344000","editorBracketMatch.border":"#88c0d0","editorBracketHighlight.foreground1":"#8fbcbb","editorBracketHighlight.foreground2":"#88c0d0","editorBracketHighlight.foreground3":"#81a1c1","editorBracketHighlight.foreground4":"#5e81ac","editorBracketHighlight.foreground5":"#8fbcbb","editorBracketHighlight.foreground6":"#88c0d0","editorBracketHighlight.unexpectedBracket.foreground":"#bf616a","editorCodeLens.foreground":"#4c566a","editorGroup.background":"#2e3440","editorGroup.border":"#3b425201","editorGroup.dropBackground":"#3b425299","editorGroupHeader.border":"#3b425200","editorGroupHeader.noTabsBackground":"#2e3440","editorGroupHeader.tabsBackground":"#2e3440","editorGroupHeader.tabsBorder":"#3b425200","editorGutter.background":"#2e3440","editorGutter.modifiedBackground":"#ebcb8b","editorGutter.addedBackground":"#a3be8c","editorGutter.deletedBackground":"#bf616a","editorHoverWidget.background":"#3b4252","editorHoverWidget.border":"#3b4252","editorLink.activeForeground":"#88c0d0","editorMarkerNavigation.background":"#5e81acc0","editorMarkerNavigationError.background":"#bf616ac0","editorMarkerNavigationWarning.background":"#ebcb8bc0","editorOverviewRuler.border":"#3b4252","editorOverviewRuler.currentContentForeground":"#3b4252","editorOverviewRuler.incomingContentForeground":"#3b4252","editorOverviewRuler.findMatchForeground":"#88c0d066","editorOverviewRuler.rangeHighlightForeground":"#88c0d066","editorOverviewRuler.selectionHighlightForeground":"#88c0d066","editorOverviewRuler.wordHighlightForeground":"#88c0d066","editorOverviewRuler.wordHighlightStrongForeground":"#88c0d066","editorOverviewRuler.modifiedForeground":"#ebcb8b","editorOverviewRuler.addedForeground":"#a3be8c","editorOverviewRuler.deletedForeground":"#bf616a","editorOverviewRuler.errorForeground":"#bf616a","editorOverviewRuler.warningForeground":"#ebcb8b","editorOverviewRuler.infoForeground":"#81a1c1","editorRuler.foreground":"#434c5e","editorSuggestWidget.background":"#2e3440","editorSuggestWidget.border":"#3b4252","editorSuggestWidget.foreground":"#d8dee9","editorSuggestWidget.focusHighlightForeground":"#88c0d0","editorSuggestWidget.highlightForeground":"#88c0d0","editorSuggestWidget.selectedBackground":"#434c5e","editorSuggestWidget.selectedForeground":"#d8dee9","extensionButton.prominentForeground":"#d8dee9","extensionButton.prominentBackground":"#434c5e","extensionButton.prominentHoverBackground":"#4c566a",errorForeground:"#bf616a","gitDecoration.modifiedResourceForeground":"#ebcb8b","gitDecoration.deletedResourceForeground":"#bf616a","gitDecoration.untrackedResourceForeground":"#a3be8c","gitDecoration.ignoredResourceForeground":"#d8dee966","gitDecoration.conflictingResourceForeground":"#5e81ac","gitDecoration.submoduleResourceForeground":"#8fbcbb","gitDecoration.stageDeletedResourceForeground":"#bf616a","gitDecoration.stageModifiedResourceForeground":"#ebcb8b","input.background":"#3b4252","input.foreground":"#d8dee9","input.placeholderForeground":"#d8dee999","input.border":"#3b4252","inputOption.activeBackground":"#5e81ac","inputOption.activeBorder":"#5e81ac","inputOption.activeForeground":"#eceff4","inputValidation.errorBackground":"#bf616a","inputValidation.errorBorder":"#bf616a","inputValidation.infoBackground":"#81a1c1","inputValidation.infoBorder":"#81a1c1","inputValidation.warningBackground":"#d08770","inputValidation.warningBorder":"#d08770","keybindingLabel.background":"#4c566a","keybindingLabel.border":"#4c566a","keybindingLabel.bottomBorder":"#4c566a","keybindingLabel.foreground":"#d8dee9","list.activeSelectionBackground":"#88c0d0","list.activeSelectionForeground":"#2e3440","list.inactiveSelectionBackground":"#434c5e","list.inactiveSelectionForeground":"#d8dee9","list.inactiveFocusBackground":"#434c5ecc","list.hoverForeground":"#eceff4","list.focusForeground":"#d8dee9","list.focusBackground":"#88c0d099","list.focusHighlightForeground":"#eceff4","list.hoverBackground":"#3b4252","list.dropBackground":"#88c0d099","list.highlightForeground":"#88c0d0","list.errorForeground":"#bf616a","list.warningForeground":"#ebcb8b","merge.currentHeaderBackground":"#81a1c166","merge.currentContentBackground":"#81a1c14d","merge.incomingHeaderBackground":"#8fbcbb66","merge.incomingContentBackground":"#8fbcbb4d","merge.border":"#3b425200","minimap.background":"#2e3440","minimap.errorHighlight":"#bf616acc","minimap.findMatchHighlight":"#88c0d0","minimap.selectionHighlight":"#88c0d0cc","minimap.warningHighlight":"#ebcb8bcc","minimapGutter.addedBackground":"#a3be8c","minimapGutter.deletedBackground":"#bf616a","minimapGutter.modifiedBackground":"#ebcb8b","minimapSlider.activeBackground":"#434c5eaa","minimapSlider.background":"#434c5e99","minimapSlider.hoverBackground":"#434c5eaa","notification.background":"#3b4252","notification.buttonBackground":"#434c5e","notification.buttonForeground":"#d8dee9","notification.buttonHoverBackground":"#4c566a","notification.errorBackground":"#bf616a","notification.errorForeground":"#2e3440","notification.foreground":"#d8dee9","notification.infoBackground":"#88c0d0","notification.infoForeground":"#2e3440","notification.warningBackground":"#ebcb8b","notification.warningForeground":"#2e3440","notificationCenter.border":"#3b425200","notificationCenterHeader.background":"#2e3440","notificationCenterHeader.foreground":"#88c0d0","notificationLink.foreground":"#88c0d0","notifications.background":"#3b4252","notifications.border":"#2e3440","notifications.foreground":"#d8dee9","notificationToast.border":"#3b425200","panel.background":"#2e3440","panel.border":"#3b4252","panelTitle.activeBorder":"#88c0d000","panelTitle.activeForeground":"#88c0d0","panelTitle.inactiveForeground":"#d8dee9","peekView.border":"#4c566a","peekViewEditor.background":"#2e3440","peekViewEditorGutter.background":"#2e3440","peekViewEditor.matchHighlightBackground":"#88c0d04d","peekViewResult.background":"#2e3440","peekViewResult.fileForeground":"#88c0d0","peekViewResult.lineForeground":"#d8dee966","peekViewResult.matchHighlightBackground":"#88c0d0cc","peekViewResult.selectionBackground":"#434c5e","peekViewResult.selectionForeground":"#d8dee9","peekViewTitle.background":"#3b4252","peekViewTitleDescription.foreground":"#d8dee9","peekViewTitleLabel.foreground":"#88c0d0","pickerGroup.border":"#3b4252","pickerGroup.foreground":"#88c0d0","progressBar.background":"#88c0d0","quickInputList.focusBackground":"#88c0d0","quickInputList.focusForeground":"#2e3440","sash.hoverBorder":"#88c0d0","scrollbar.shadow":"#00000066","scrollbarSlider.activeBackground":"#434c5eaa","scrollbarSlider.background":"#434c5e99","scrollbarSlider.hoverBackground":"#434c5eaa","selection.background":"#88c0d099","sideBar.background":"#2e3440","sideBar.foreground":"#d8dee9","sideBar.border":"#3b4252","sideBarSectionHeader.background":"#3b4252","sideBarSectionHeader.foreground":"#d8dee9","sideBarTitle.foreground":"#d8dee9","statusBar.background":"#3b4252","statusBar.debuggingBackground":"#5e81ac","statusBar.debuggingForeground":"#d8dee9","statusBar.noFolderForeground":"#d8dee9","statusBar.noFolderBackground":"#3b4252","statusBar.foreground":"#d8dee9","statusBarItem.activeBackground":"#4c566a","statusBarItem.hoverBackground":"#434c5e","statusBarItem.prominentBackground":"#3b4252","statusBarItem.prominentHoverBackground":"#434c5e","statusBarItem.errorBackground":"#3b4252","statusBarItem.errorForeground":"#bf616a","statusBarItem.warningBackground":"#ebcb8b","statusBarItem.warningForeground":"#2e3440","statusBar.border":"#3b425200","tab.activeBackground":"#3b4252","tab.activeForeground":"#d8dee9","tab.border":"#3b425200","tab.activeBorder":"#88c0d000","tab.unfocusedActiveBorder":"#88c0d000","tab.inactiveBackground":"#2e3440","tab.inactiveForeground":"#d8dee966","tab.unfocusedActiveForeground":"#d8dee999","tab.unfocusedInactiveForeground":"#d8dee966","tab.hoverBackground":"#3b4252cc","tab.unfocusedHoverBackground":"#3b4252b3","tab.hoverBorder":"#88c0d000","tab.unfocusedHoverBorder":"#88c0d000","tab.activeBorderTop":"#88c0d000","tab.unfocusedActiveBorderTop":"#88c0d000","tab.lastPinnedBorder":"#4c566a","terminal.background":"#2e3440","terminal.foreground":"#d8dee9","terminal.ansiBlack":"#3b4252","terminal.ansiRed":"#bf616a","terminal.ansiGreen":"#a3be8c","terminal.ansiYellow":"#ebcb8b","terminal.ansiBlue":"#81a1c1","terminal.ansiMagenta":"#b48ead","terminal.ansiCyan":"#88c0d0","terminal.ansiWhite":"#e5e9f0","terminal.ansiBrightBlack":"#4c566a","terminal.ansiBrightRed":"#bf616a","terminal.ansiBrightGreen":"#a3be8c","terminal.ansiBrightYellow":"#ebcb8b","terminal.ansiBrightBlue":"#81a1c1","terminal.ansiBrightMagenta":"#b48ead","terminal.ansiBrightCyan":"#8fbcbb","terminal.ansiBrightWhite":"#eceff4","terminal.tab.activeBorder":"#88c0d0","textBlockQuote.background":"#3b4252","textBlockQuote.border":"#81a1c1","textCodeBlock.background":"#4c566a","textLink.activeForeground":"#88c0d0","textLink.foreground":"#88c0d0","textPreformat.foreground":"#8fbcbb","textSeparator.foreground":"#eceff4","titleBar.activeBackground":"#2e3440","titleBar.activeForeground":"#d8dee9","titleBar.border":"#2e344000","titleBar.inactiveBackground":"#2e3440","titleBar.inactiveForeground":"#d8dee966","tree.indentGuidesStroke":"#616e88","walkThrough.embeddedEditorBackground":"#2e3440","welcomePage.buttonBackground":"#434c5e","welcomePage.buttonHoverBackground":"#4c566a","widget.shadow":"#00000066"},tokenColors:[{settings:{foreground:"#d8dee9ff",background:"#2e3440ff"}},{scope:"emphasis",settings:{fontStyle:"italic"}},{scope:"strong",settings:{fontStyle:"bold"}},{name:"Comment",scope:"comment",settings:{foreground:"#616E88"}},{name:"Constant Character",scope:"constant.character",settings:{foreground:"#EBCB8B"}},{name:"Constant Character Escape",scope:"constant.character.escape",settings:{foreground:"#EBCB8B"}},{name:"Constant Language",scope:"constant.language",settings:{foreground:"#81A1C1"}},{name:"Constant Numeric",scope:"constant.numeric",settings:{foreground:"#B48EAD"}},{name:"Constant Regexp",scope:"constant.regexp",settings:{foreground:"#EBCB8B"}},{name:"Entity Name Class/Type",scope:["entity.name.class","entity.name.type.class"],settings:{foreground:"#8FBCBB"}},{name:"Entity Name Function",scope:"entity.name.function",settings:{foreground:"#88C0D0"}},{name:"Entity Name Tag",scope:"entity.name.tag",settings:{foreground:"#81A1C1"}},{name:"Entity Other Attribute Name",scope:"entity.other.attribute-name",settings:{foreground:"#8FBCBB"}},{name:"Entity Other Inherited Class",scope:"entity.other.inherited-class",settings:{fontStyle:"bold",foreground:"#8FBCBB"}},{name:"Invalid Deprecated",scope:"invalid.deprecated",settings:{foreground:"#D8DEE9",background:"#EBCB8B"}},{name:"Invalid Illegal",scope:"invalid.illegal",settings:{foreground:"#D8DEE9",background:"#BF616A"}},{name:"Keyword",scope:"keyword",settings:{foreground:"#81A1C1"}},{name:"Keyword Operator",scope:"keyword.operator",settings:{foreground:"#81A1C1"}},{name:"Keyword Other New",scope:"keyword.other.new",settings:{foreground:"#81A1C1"}},{name:"Markup Bold",scope:"markup.bold",settings:{fontStyle:"bold"}},{name:"Markup Changed",scope:"markup.changed",settings:{foreground:"#EBCB8B"}},{name:"Markup Deleted",scope:"markup.deleted",settings:{foreground:"#BF616A"}},{name:"Markup Inserted",scope:"markup.inserted",settings:{foreground:"#A3BE8C"}},{name:"Meta Preprocessor",scope:"meta.preprocessor",settings:{foreground:"#5E81AC"}},{name:"Punctuation",scope:"punctuation",settings:{foreground:"#ECEFF4"}},{name:"Punctuation Definition Parameters",scope:["punctuation.definition.method-parameters","punctuation.definition.function-parameters","punctuation.definition.parameters"],settings:{foreground:"#ECEFF4"}},{name:"Punctuation Definition Tag",scope:"punctuation.definition.tag",settings:{foreground:"#81A1C1"}},{name:"Punctuation Definition Comment",scope:["punctuation.definition.comment","punctuation.end.definition.comment","punctuation.start.definition.comment"],settings:{foreground:"#616E88"}},{name:"Punctuation Section",scope:"punctuation.section",settings:{foreground:"#ECEFF4"}},{name:"Punctuation Section Embedded",scope:["punctuation.section.embedded.begin","punctuation.section.embedded.end"],settings:{foreground:"#81A1C1"}},{name:"Punctuation Terminator",scope:"punctuation.terminator",settings:{foreground:"#81A1C1"}},{name:"Punctuation Variable",scope:"punctuation.definition.variable",settings:{foreground:"#81A1C1"}},{name:"Storage",scope:"storage",settings:{foreground:"#81A1C1"}},{name:"String",scope:"string",settings:{foreground:"#A3BE8C"}},{name:"String Regexp",scope:"string.regexp",settings:{foreground:"#EBCB8B"}},{name:"Support Class",scope:"support.class",settings:{foreground:"#8FBCBB"}},{name:"Support Constant",scope:"support.constant",settings:{foreground:"#81A1C1"}},{name:"Support Function",scope:"support.function",settings:{foreground:"#88C0D0"}},{name:"Support Function Construct",scope:"support.function.construct",settings:{foreground:"#81A1C1"}},{name:"Support Type",scope:"support.type",settings:{foreground:"#8FBCBB"}},{name:"Support Type Exception",scope:"support.type.exception",settings:{foreground:"#8FBCBB"}},{name:"Token Debug",scope:"token.debug-token",settings:{foreground:"#b48ead"}},{name:"Token Error",scope:"token.error-token",settings:{foreground:"#bf616a"}},{name:"Token Info",scope:"token.info-token",settings:{foreground:"#88c0d0"}},{name:"Token Warning",scope:"token.warn-token",settings:{foreground:"#ebcb8b"}},{name:"Variable",scope:"variable.other",settings:{foreground:"#D8DEE9"}},{name:"Variable Language",scope:"variable.language",settings:{foreground:"#81A1C1"}},{name:"Variable Parameter",scope:"variable.parameter",settings:{foreground:"#D8DEE9"}},{name:"[C/CPP] Punctuation Separator Pointer-Access",scope:"punctuation.separator.pointer-access.c",settings:{foreground:"#81A1C1"}},{name:"[C/CPP] Meta Preprocessor Include",scope:["source.c meta.preprocessor.include","source.c string.quoted.other.lt-gt.include"],settings:{foreground:"#8FBCBB"}},{name:"[C/CPP] Conditional Directive",scope:["source.cpp keyword.control.directive.conditional","source.cpp punctuation.definition.directive","source.c keyword.control.directive.conditional","source.c punctuation.definition.directive"],settings:{foreground:"#5E81AC",fontStyle:"bold"}},{name:"[CSS] Constant Other Color RGB Value",scope:"source.css constant.other.color.rgb-value",settings:{foreground:"#B48EAD"}},{name:"[CSS](Function) Meta Property-Value",scope:"source.css meta.property-value",settings:{foreground:"#88C0D0"}},{name:"[CSS] Media Queries",scope:["source.css keyword.control.at-rule.media","source.css keyword.control.at-rule.media punctuation.definition.keyword"],settings:{foreground:"#D08770"}},{name:"[CSS] Punctuation Definition Keyword",scope:"source.css punctuation.definition.keyword",settings:{foreground:"#81A1C1"}},{name:"[CSS] Support Type Property Name",scope:"source.css support.type.property-name",settings:{foreground:"#D8DEE9"}},{name:"[diff] Meta Range Context",scope:"source.diff meta.diff.range.context",settings:{foreground:"#8FBCBB"}},{name:"[diff] Meta Header From-File",scope:"source.diff meta.diff.header.from-file",settings:{foreground:"#8FBCBB"}},{name:"[diff] Punctuation Definition From-File",scope:"source.diff punctuation.definition.from-file",settings:{foreground:"#8FBCBB"}},{name:"[diff] Punctuation Definition Range",scope:"source.diff punctuation.definition.range",settings:{foreground:"#8FBCBB"}},{name:"[diff] Punctuation Definition Separator",scope:"source.diff punctuation.definition.separator",settings:{foreground:"#81A1C1"}},{name:"[Elixir](JakeBecker.elixir-ls) module names",scope:"entity.name.type.module.elixir",settings:{foreground:"#8FBCBB"}},{name:"[Elixir](JakeBecker.elixir-ls) module attributes",scope:"variable.other.readwrite.module.elixir",settings:{foreground:"#D8DEE9",fontStyle:"bold"}},{name:"[Elixir](JakeBecker.elixir-ls) atoms",scope:"constant.other.symbol.elixir",settings:{foreground:"#D8DEE9",fontStyle:"bold"}},{name:"[Elixir](JakeBecker.elixir-ls) modules",scope:"variable.other.constant.elixir",settings:{foreground:"#8FBCBB"}},{name:"[Go] String Format Placeholder",scope:"source.go constant.other.placeholder.go",settings:{foreground:"#EBCB8B"}},{name:"[Java](JavaDoc) Comment Block Documentation HTML Entities",scope:"source.java comment.block.documentation.javadoc punctuation.definition.entity.html",settings:{foreground:"#81A1C1"}},{name:"[Java](JavaDoc) Constant Other",scope:"source.java constant.other",settings:{foreground:"#D8DEE9"}},{name:"[Java](JavaDoc) Keyword Other Documentation",scope:"source.java keyword.other.documentation",settings:{foreground:"#8FBCBB"}},{name:"[Java](JavaDoc) Keyword Other Documentation Author",scope:"source.java keyword.other.documentation.author.javadoc",settings:{foreground:"#8FBCBB"}},{name:"[Java](JavaDoc) Keyword Other Documentation Directive/Custom",scope:["source.java keyword.other.documentation.directive","source.java keyword.other.documentation.custom"],settings:{foreground:"#8FBCBB"}},{name:"[Java](JavaDoc) Keyword Other Documentation See",scope:"source.java keyword.other.documentation.see.javadoc",settings:{foreground:"#8FBCBB"}},{name:"[Java] Meta Method-Call",scope:"source.java meta.method-call meta.method",settings:{foreground:"#88C0D0"}},{name:"[Java](JavaDoc) Meta Tag Template Link",scope:["source.java meta.tag.template.link.javadoc","source.java string.other.link.title.javadoc"],settings:{foreground:"#8FBCBB"}},{name:"[Java](JavaDoc) Meta Tag Template Value",scope:"source.java meta.tag.template.value.javadoc",settings:{foreground:"#88C0D0"}},{name:"[Java](JavaDoc) Punctuation Definition Keyword",scope:"source.java punctuation.definition.keyword.javadoc",settings:{foreground:"#8FBCBB"}},{name:"[Java](JavaDoc) Punctuation Definition Tag",scope:["source.java punctuation.definition.tag.begin.javadoc","source.java punctuation.definition.tag.end.javadoc"],settings:{foreground:"#616E88"}},{name:"[Java] Storage Modifier Import",scope:"source.java storage.modifier.import",settings:{foreground:"#8FBCBB"}},{name:"[Java] Storage Modifier Package",scope:"source.java storage.modifier.package",settings:{foreground:"#8FBCBB"}},{name:"[Java] Storage Type",scope:"source.java storage.type",settings:{foreground:"#8FBCBB"}},{name:"[Java] Storage Type Annotation",scope:"source.java storage.type.annotation",settings:{foreground:"#D08770"}},{name:"[Java] Storage Type Generic",scope:"source.java storage.type.generic",settings:{foreground:"#8FBCBB"}},{name:"[Java] Storage Type Primitive",scope:"source.java storage.type.primitive",settings:{foreground:"#81A1C1"}},{name:"[JavaScript] Decorator",scope:["source.js punctuation.decorator","source.js meta.decorator variable.other.readwrite","source.js meta.decorator entity.name.function"],settings:{foreground:"#D08770"}},{name:"[JavaScript] Meta Object-Literal Key",scope:"source.js meta.object-literal.key",settings:{foreground:"#88C0D0"}},{name:"[JavaScript](JSDoc) Storage Type Class",scope:"source.js storage.type.class.jsdoc",settings:{foreground:"#8FBCBB"}},{name:"[JavaScript] String Template Literals Punctuation",scope:["source.js string.quoted.template punctuation.quasi.element.begin","source.js string.quoted.template punctuation.quasi.element.end","source.js string.template punctuation.definition.template-expression"],settings:{foreground:"#81A1C1"}},{name:"[JavaScript] Interpolated String Template Punctuation Functions",scope:"source.js string.quoted.template meta.method-call.with-arguments",settings:{foreground:"#ECEFF4"}},{name:"[JavaScript] String Template Literal Variable",scope:["source.js string.template meta.template.expression support.variable.property","source.js string.template meta.template.expression variable.other.object"],settings:{foreground:"#D8DEE9"}},{name:"[JavaScript] Support Type Primitive",scope:"source.js support.type.primitive",settings:{foreground:"#81A1C1"}},{name:"[JavaScript] Variable Other Object",scope:"source.js variable.other.object",settings:{foreground:"#D8DEE9"}},{name:"[JavaScript] Variable Other Read-Write Alias",scope:"source.js variable.other.readwrite.alias",settings:{foreground:"#8FBCBB"}},{name:"[JavaScript] Parentheses in Template Strings",scope:["source.js meta.embedded.line meta.brace.square","source.js meta.embedded.line meta.brace.round","source.js string.quoted.template meta.brace.square","source.js string.quoted.template meta.brace.round"],settings:{foreground:"#ECEFF4"}},{name:"[HTML] Constant Character Entity",scope:"text.html.basic constant.character.entity.html",settings:{foreground:"#EBCB8B"}},{name:"[HTML] Constant Other Inline-Data",scope:"text.html.basic constant.other.inline-data",settings:{foreground:"#D08770",fontStyle:"italic"}},{name:"[HTML] Meta Tag SGML Doctype",scope:"text.html.basic meta.tag.sgml.doctype",settings:{foreground:"#5E81AC"}},{name:"[HTML] Punctuation Definition Entity",scope:"text.html.basic punctuation.definition.entity",settings:{foreground:"#81A1C1"}},{name:"[INI] Entity Name Section Group-Title",scope:"source.properties entity.name.section.group-title.ini",settings:{foreground:"#88C0D0"}},{name:"[INI] Punctuation Separator Key-Value",scope:"source.properties punctuation.separator.key-value.ini",settings:{foreground:"#81A1C1"}},{name:"[Markdown] Markup Fenced Code Block",scope:["text.html.markdown markup.fenced_code.block","text.html.markdown markup.fenced_code.block punctuation.definition"],settings:{foreground:"#8FBCBB"}},{name:"[Markdown] Markup Heading",scope:"markup.heading",settings:{foreground:"#88C0D0"}},{name:"[Markdown] Markup Inline",scope:["text.html.markdown markup.inline.raw","text.html.markdown markup.inline.raw punctuation.definition.raw"],settings:{foreground:"#8FBCBB"}},{name:"[Markdown] Markup Italic",scope:"text.html.markdown markup.italic",settings:{fontStyle:"italic"}},{name:"[Markdown] Markup Link",scope:"text.html.markdown markup.underline.link",settings:{fontStyle:"underline"}},{name:"[Markdown] Markup List Numbered/Unnumbered",scope:"text.html.markdown beginning.punctuation.definition.list",settings:{foreground:"#81A1C1"}},{name:"[Markdown] Markup Quote Punctuation Definition",scope:"text.html.markdown beginning.punctuation.definition.quote",settings:{foreground:"#8FBCBB"}},{name:"[Markdown] Markup Quote Punctuation Definition",scope:"text.html.markdown markup.quote",settings:{foreground:"#616E88"}},{name:"[Markdown] Markup Math Constant",scope:"text.html.markdown constant.character.math.tex",settings:{foreground:"#81A1C1"}},{name:"[Markdown] Markup Math Definition Marker",scope:["text.html.markdown punctuation.definition.math.begin","text.html.markdown punctuation.definition.math.end"],settings:{foreground:"#5E81AC"}},{name:"[Markdown] Markup Math Function Definition Marker",scope:"text.html.markdown punctuation.definition.function.math.tex",settings:{foreground:"#88C0D0"}},{name:"[Markdown] Markup Math Operator",scope:"text.html.markdown punctuation.math.operator.latex",settings:{foreground:"#81A1C1"}},{name:"[Markdown] Punctuation Definition Heading",scope:"text.html.markdown punctuation.definition.heading",settings:{foreground:"#81A1C1"}},{name:"[Markdown] Punctuation Definition Constant/String",scope:["text.html.markdown punctuation.definition.constant","text.html.markdown punctuation.definition.string"],settings:{foreground:"#81A1C1"}},{name:"[Markdown] String Other Link Description/Title",scope:["text.html.markdown constant.other.reference.link","text.html.markdown string.other.link.description","text.html.markdown string.other.link.title"],settings:{foreground:"#88C0D0"}},{name:"[Perl] Perl Sigils",scope:"source.perl punctuation.definition.variable",settings:{foreground:"#D8DEE9"}},{name:"[PHP] Meta Function-Call Object",scope:["source.php meta.function-call","source.php meta.function-call.object"],settings:{foreground:"#88C0D0"}},{name:"[Python] Decorator",scope:["source.python entity.name.function.decorator","source.python meta.function.decorator support.type"],settings:{foreground:"#D08770"}},{name:"[Python] Function Call",scope:"source.python meta.function-call.generic",settings:{foreground:"#88C0D0"}},{name:"[Python] Support Type",scope:"source.python support.type",settings:{foreground:"#88C0D0"}},{name:"[Python] Function Parameter",scope:["source.python variable.parameter.function.language"],settings:{foreground:"#D8DEE9"}},{name:"[Python] Function Parameter Special",scope:["source.python meta.function.parameters variable.parameter.function.language.special.self"],settings:{foreground:"#81A1C1"}},{name:"[Rust] Entity types",scope:"source.rust entity.name.type",settings:{foreground:"#8FBCBB"}},{name:"[Rust] Macro",scope:"source.rust meta.macro entity.name.function",settings:{fontStyle:"bold",foreground:"#88C0D0"}},{name:"[Rust] Attributes",scope:["source.rust meta.attribute","source.rust meta.attribute punctuation","source.rust meta.attribute keyword.operator"],settings:{foreground:"#5E81AC"}},{name:"[Rust] Traits",scope:"source.rust entity.name.type.trait",settings:{fontStyle:"bold"}},{name:"[Rust] Interpolation Bracket Curly",scope:"source.rust punctuation.definition.interpolation",settings:{foreground:"#EBCB8B"}},{name:"[SCSS] Punctuation Definition Interpolation Bracket Curly",scope:["source.css.scss punctuation.definition.interpolation.begin.bracket.curly","source.css.scss punctuation.definition.interpolation.end.bracket.curly"],settings:{foreground:"#81A1C1"}},{name:"[SCSS] Variable Interpolation",scope:"source.css.scss variable.interpolation",settings:{foreground:"#D8DEE9",fontStyle:"italic"}},{name:"[TypeScript] Decorators",scope:["source.ts punctuation.decorator","source.ts meta.decorator variable.other.readwrite","source.ts meta.decorator entity.name.function","source.tsx punctuation.decorator","source.tsx meta.decorator variable.other.readwrite","source.tsx meta.decorator entity.name.function"],settings:{foreground:"#D08770"}},{name:"[TypeScript] Object-literal keys",scope:["source.ts meta.object-literal.key","source.tsx meta.object-literal.key"],settings:{foreground:"#D8DEE9"}},{name:"[TypeScript] Object-literal functions",scope:["source.ts meta.object-literal.key entity.name.function","source.tsx meta.object-literal.key entity.name.function"],settings:{foreground:"#88C0D0"}},{name:"[TypeScript] Type/Class",scope:["source.ts support.class","source.ts support.type","source.ts entity.name.type","source.ts entity.name.class","source.tsx support.class","source.tsx support.type","source.tsx entity.name.type","source.tsx entity.name.class"],settings:{foreground:"#8FBCBB"}},{name:"[TypeScript] Static Class Support",scope:["source.ts support.constant.math","source.ts support.constant.dom","source.ts support.constant.json","source.tsx support.constant.math","source.tsx support.constant.dom","source.tsx support.constant.json"],settings:{foreground:"#8FBCBB"}},{name:"[TypeScript] Variables",scope:["source.ts support.variable","source.tsx support.variable"],settings:{foreground:"#D8DEE9"}},{name:"[TypeScript] Parentheses in Template Strings",scope:["source.ts meta.embedded.line meta.brace.square","source.ts meta.embedded.line meta.brace.round","source.tsx meta.embedded.line meta.brace.square","source.tsx meta.embedded.line meta.brace.round"],settings:{foreground:"#ECEFF4"}},{name:"[XML] Entity Name Tag Namespace",scope:"text.xml entity.name.tag.namespace",settings:{foreground:"#8FBCBB"}},{name:"[XML] Keyword Other Doctype",scope:"text.xml keyword.other.doctype",settings:{foreground:"#5E81AC"}},{name:"[XML] Meta Tag Preprocessor",scope:"text.xml meta.tag.preprocessor entity.name.tag",settings:{foreground:"#5E81AC"}},{name:"[XML] Entity Name Tag Namespace",scope:["text.xml string.unquoted.cdata","text.xml string.unquoted.cdata punctuation.definition.string"],settings:{foreground:"#D08770",fontStyle:"italic"}},{name:"[YAML] Entity Name Tag",scope:"source.yaml entity.name.tag",settings:{foreground:"#8FBCBB"}}]},lineNumbers:!0,showCopyButton:!0,autoImport:!0,skipLanguages:[],filepath:"/home/runner/work/docs/docs/docs/concepts/account-linking/parent-accounts.mdx"};function y(e){const o=Object.assign({p:"p",h2:"h2",ul:"ul",li:"li",a:"a",code:"code",h3:"h3",img:"img",h4:"h4",ol:"ol"},(0,r.ah)(),e.components),{Callout:s}=o;return d||F("CH",!1),d.Code||F("CH.Code",!0),s||F("Callout",!0),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.p,{children:"In this doc, we'll continue from the perspective of a wallet or marketplace app seeking to facilitate a unified account experience,\nabstracting away the partitioned access between accounts into a single dashboard for user interactions on all their\nowned assets."}),"\n",(0,n.jsx)(o.h2,{id:"objectives",children:"Objectives"}),"\n",(0,n.jsxs)(o.ul,{children:["\n",(0,n.jsx)(o.li,{children:"Understand the Hybrid Custody account model"}),"\n",(0,n.jsx)(o.li,{children:"Differentiate between restricted child accounts and unrestricted owned accounts"}),"\n",(0,n.jsx)(o.li,{children:"Get your app to recognize \u201cparent\u201d accounts along with any associated \u201cchild\u201d accounts"}),"\n",(0,n.jsx)(o.li,{children:"View Fungible and NonFungible Token metadata relating to assets across all of a user's associated accounts - their\nwallet-mediated \u201cparent\u201d account and any hybrid custody model \u201cchild\u201d accounts"}),"\n",(0,n.jsx)(o.li,{children:"Facilitate transactions acting on assets in child accounts"}),"\n"]}),"\n",(0,n.jsx)(o.h2,{id:"design-overview",children:"Design Overview"}),"\n",(0,n.jsx)(s,{type:"info",children:(0,n.jsxs)(o.p,{children:["TL;DR: An account's ",(0,n.jsx)(o.a,{href:"https://github.com/onflow/hybrid-custody/blob/main/contracts/HybridCustody.cdc",children:(0,n.jsx)(o.code,{children:"HybridCustody.Manager"})}),"\nis the entry point for all of a user's associated accounts."]})}),"\n",(0,n.jsxs)(o.p,{children:["The basic idea in the ",(0,n.jsx)(o.a,{href:"https://forum.onflow.org/t/account-linking-authaccount-capabilities-management/4314",children:"(currently proposed)\nstandard"})," is relatively simple. A\nparent account is one that has received delegated (albeit restricted) access on another account. The account which has\ndelegated authority over itself to the parent account is the child account."]}),"\n",(0,n.jsxs)(o.p,{children:["In the ",(0,n.jsx)(o.a,{href:"https://forum.onflow.org/t/hybrid-custody/4016",children:"Hybrid Custody Model"}),", this child account would have shared\naccess between the app - the entity which created likely custodies the account - and the linked parent account."]}),"\n",(0,n.jsxs)(o.p,{children:["How does this delegation occur? Typically when we think of shared account access in crypto, we think keys. However,\nCadence enables ",(0,n.jsx)(o.a,{href:"https://github.com/onflow/cadence/issues/2151",children:"accounts to link Capabilities to themselves"})," and issue\nthose Capabilities to other parties (more on ",(0,n.jsx)(o.a,{href:"https://developers.flow.com/cadence/language/capability-based-access-control",children:"capability-based access\nhere"}),")."]}),"\n",(0,n.jsx)(o.p,{children:"We've leveraged this feature in a (proposed) standard so that apps can implement a hybrid custody model whereby the\napp creates an account it controls, then later delegates access on that account to the user once they've authenticated\nwith their wallet."}),"\n",(0,n.jsxs)(o.p,{children:["All related constructs are used together in the ",(0,n.jsxs)(o.a,{href:"https://testnet.contractbrowser.com/A.96b15ff6dfde11fe.HybridCustody",children:[(0,n.jsx)(o.code,{children:"HybridCustody"}),"\ncontract"]})," to define the standard."]}),"\n",(0,n.jsxs)(o.p,{children:["Parent accounts own a ",(0,n.jsx)(o.code,{children:"Manager"})," resource which stores Capabilities to ",(0,n.jsx)(o.code,{children:"ChildAccount"})," (restricted access) and\n",(0,n.jsx)(o.code,{children:"OwnedAccount"})," (unrestricted access) resources, both of which are stored in any given child account."]}),"\n",(0,n.jsxs)(o.p,{children:["Therefore, the presence of a ",(0,n.jsx)(o.code,{children:"Manager"})," in an account implies there are potentially associated accounts for which the\nowning account has delegated access. This resource is intended to be configured with a public Capability that enables\nquerying of an account's child account addresses via ",(0,n.jsx)(o.code,{children:"getAccountAddresses()"})," and ",(0,n.jsx)(o.code,{children:"getOwnedAccountAddresses()"}),'.As you\ncan deduce from these two methods, there is a notion of "owned" accounts which we\'ll expand on in a bit.']}),"\n",(0,n.jsxs)(o.p,{children:["A wallet or marketplace wishing to discover all of a user's accounts and assets within them can do so by first looking\nto the user's ",(0,n.jsx)(o.code,{children:"Manager"}),"."]}),"\n",(0,n.jsx)(o.h3,{id:"identifying-account-hierarchy",children:"Identifying Account Hierarchy"}),"\n",(0,n.jsxs)(o.p,{children:["To clarify, insofar as the standard is concerned, an account is a parent account if it contains a ",(0,n.jsx)(o.code,{children:"Manager"})," resource,\nand an account is a child account if it contains at minimum an ",(0,n.jsx)(o.code,{children:"OwnedAccount"})," or additionally a ",(0,n.jsx)(o.code,{children:"ChildAccount"})," resource."]}),"\n",(0,n.jsxs)(o.p,{children:["Within a user's ",(0,n.jsx)(o.code,{children:"Manager"}),", its mapping of ",(0,n.jsx)(o.code,{children:"childAccounts"})," points to the addresses of its child accounts in each index,\nwith corresponding values giving the Manager access to those accounts via corresponding",(0,n.jsx)(o.code,{children:"ChildAccount"})," Capability."]}),"\n",(0,n.jsx)(o.p,{children:(0,n.jsx)(o.img,{src:t(22534).Z+"",loading:"lazy",alt:"HybridCustody Conceptual Overview",width:"2240",height:"1828"})}),"\n",(0,n.jsxs)(o.p,{children:["Likewise, the child account's ",(0,n.jsx)(o.code,{children:"ChildAccount.parentAddress"})," (which owns a ",(0,n.jsx)(o.code,{children:"Manager"}),") points to the user's account as its\nparent address. This makes it easy to both identify whether an account is a parent, child, or both, and its associated\nparent/child account(s)."]}),"\n",(0,n.jsxs)(o.p,{children:[(0,n.jsx)(o.code,{children:"OwnedAccount"})," resources underly all account delegations, so can have multiple parents whereas ",(0,n.jsx)(o.code,{children:"ChildAccount"}),"s are 1:1.\nThis provides more granular revocation as each parent account has its own Capability path on which its access relies."]}),"\n",(0,n.jsx)(o.h4,{id:"restricted-vs-owned-accounts",children:"Restricted vs. Owned Accounts"}),"\n",(0,n.jsxs)(o.p,{children:["It's worth noting here that ",(0,n.jsx)(o.code,{children:"ChildAccount"})," Capabilities enable access to the underlying account according to rules\nconfigured by the child account delegating access. The ",(0,n.jsx)(o.code,{children:"ChildAccount"})," maintains these rules along with an ",(0,n.jsx)(o.code,{children:"OwnedAccount"}),"\nCapability within which the ",(0,n.jsx)(o.code,{children:"AuthAccount"})," Capability is stored. Anyone with access to the surface level ",(0,n.jsx)(o.code,{children:"ChildAccount"}),"\ncan then access the underlying ",(0,n.jsx)(o.code,{children:"AuthAccount"}),", but only according the pre-defined rule set. These rules are fundamentally\na list of Types that can/cannot be retrieved from an account."]}),"\n",(0,n.jsxs)(o.p,{children:["The app developer can codify these rule sets on allowable Capability types in a\n",(0,n.jsx)(o.a,{href:"https://testnet.contractbrowser.com/A.96b15ff6dfde11fe.CapabilityFilter",children:(0,n.jsx)(o.code,{children:"CapabilityFilter"})})," along with a\n",(0,n.jsx)(o.a,{href:"https://testnet.contractbrowser.com/A.96b15ff6dfde11fe.CapabilityFactory",children:(0,n.jsx)(o.code,{children:"CapabilityFactory"})})," defining retrieval\npatterns for those Capabilities. When delegation occurs, the developer would provide the ",(0,n.jsx)(o.code,{children:"CapabilityFilter"})," and\n",(0,n.jsx)(o.code,{children:"CapabilityFactory"})," Capabilities to an ",(0,n.jsx)(o.code,{children:"OwnedAccount"})," resource which stores them in a ",(0,n.jsx)(o.code,{children:"ChildAccount"})," resource.  Then,\ncapabilities are created for the ",(0,n.jsx)(o.code,{children:"OwnedAccount"})," and ",(0,n.jsx)(o.code,{children:"ChildAccount"})," resource and are given to the specified parent\naccount."]}),"\n",(0,n.jsxs)(o.p,{children:["So, if an app developer wants to enable Hybrid Custody but doesn't want to allow parent accounts to access FungibleToken\nVaults, for example, the app developer can codify rule sets enumerating allowable Capability types in a\n",(0,n.jsx)(o.code,{children:"CapabilityFilter"})," along with a ",(0,n.jsx)(o.code,{children:"CapabilityFactory"})," defining retrieval patterns for those Capabilities."]}),"\n",(0,n.jsxs)(o.p,{children:["When delegation occurs, they would provide the ",(0,n.jsx)(o.code,{children:"CapabilityFilter"})," and ",(0,n.jsx)(o.code,{children:"CapabilityFactory"})," Capabilities to an\n",(0,n.jsx)(o.code,{children:"OwnedAccount"}),". This ",(0,n.jsx)(o.code,{children:"OwnedAccount"})," then wraps the given filter & factory Capabilities in a ",(0,n.jsx)(o.code,{children:"ChildAccount"})," along with a\nCapability to itself before publishing the new ",(0,n.jsx)(o.code,{children:"ChildAccount"})," Capability for the specified parent account to claim."]}),"\n",(0,n.jsx)(s,{type:"info",children:(0,n.jsxs)(o.p,{children:["Note that by enumerating allowable Types in your ",(0,n.jsx)(o.code,{children:"CapabilityFilter.Filter"})," implementation, you're by default excluding\naccess to anything other than the Types you declare as allowable."]})}),"\n",(0,n.jsxs)(o.p,{children:["As mentioned earlier, ",(0,n.jsx)(o.code,{children:"Manager"}),'s also maintain access to "owned" accounts - accounts which define unrestricted access as\nthey allow direct retrieval of encapsulated AuthAccount objects. These owned accounts, found in ',(0,n.jsx)(o.code,{children:"Manager.ownedAccounts"}),",\nare simply ",(0,n.jsx)(o.code,{children:"OwnedAccount"})," Capabilities instead of ",(0,n.jsx)(o.code,{children:"ChildAccount"})," Capabilities."]}),"\n",(0,n.jsx)(o.p,{children:(0,n.jsx)(o.img,{src:t(96449).Z+"",loading:"lazy",alt:"HybridCustody Total Overview",width:"6368",height:"4840"})}),"\n",(0,n.jsx)(o.h3,{id:"considerations",children:"Considerations"}),"\n",(0,n.jsx)(o.p,{children:"Do note that this construction does not prevent an account from having multiple parent accounts or a child account from\nbeing the parent to other accounts. While initial intuition might lead one to believe that account associations are a\ntree with the user at the root, the graph of associated accounts among child accounts may lead to cycles of association."}),"\n",(0,n.jsx)(o.p,{children:"We believe it would be unlikely for a use case to demand a user delegates authority over their main account (in fact\nwe'd discourage such constructions), but delegating access between child accounts could be useful. As an example,\nconsider a set of local game clients across mobile and web platforms, each with self-custodied app accounts having\ndelegated authority to each other while both are child accounts of the user's main account."}),"\n",(0,n.jsx)(o.p,{children:"Ultimately, it will be up to the implementing wallet/marketplace how far down the graph of account associations they'd\nwant to traverse and display to the user."}),"\n",(0,n.jsx)(o.h2,{id:"implementation",children:"Implementation"}),"\n",(0,n.jsx)(o.p,{children:"From the perspective of a wallet or marketplace app, some relevant things to know about the user are:"}),"\n",(0,n.jsxs)(o.ul,{children:["\n",(0,n.jsx)(o.li,{children:"Does this account have associated linked (child) accounts?"}),"\n",(0,n.jsx)(o.li,{children:"What are those associated linked accounts, if any?"}),"\n",(0,n.jsx)(o.li,{children:"What NFTs are owned by this user across all associated accounts?"}),"\n",(0,n.jsx)(o.li,{children:"What are the balances of all FungibleTokens across all associated accounts?"}),"\n"]}),"\n",(0,n.jsx)(o.p,{children:"And with respect to acting on the assets of child accounts and managing child accounts themselves:"}),"\n",(0,n.jsxs)(o.ul,{children:["\n",(0,n.jsx)(o.li,{children:"Accessing an NFT from a linked account's Collection"}),"\n",(0,n.jsx)(o.li,{children:"Removing a linked account"}),"\n"]}),"\n",(0,n.jsx)(o.h2,{id:"examples",children:"Examples"}),"\n",(0,n.jsx)(o.h3,{id:"query-whether-an-address-has-associated-accounts",children:"Query Whether an Address Has Associated Accounts"}),"\n",(0,n.jsxs)(o.p,{children:["This script will return ",(0,n.jsx)(o.code,{children:"true"})," if a ",(0,n.jsx)(o.code,{children:"HybridCustody.Manager"})," is stored and ",(0,n.jsx)(o.code,{children:"false"})," otherwise"]}),"\n",(0,n.jsx)(d.Code,{codeConfig:u,northPanel:{tabs:["get_child_addresses.cdc"],active:"get_child_addresses.cdc",heightRatio:1},files:[{name:"get_child_addresses.cdc",focus:"",code:{lines:[{tokens:[{content:"import ",props:{style:{color:"#81A1C1"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"HybridCustody",props:{style:{color:"#A3BE8C"}}},{content:'"',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"pub fun ",props:{style:{color:"#81A1C1"}}},{content:"main",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#ECEFF4"}}},{content:"parent",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"Address",props:{style:{color:"#81A1C1"}}},{content:")",props:{style:{color:"#ECEFF4"}}},{content:": Bool ",props:{style:{color:"#81A1C1"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    let",props:{style:{color:"#81A1C1"}}},{content:" acct = ",props:{style:{color:"#D8DEE9FF"}}},{content:"getAuthAccount",props:{style:{color:"#88C0D0"}}},{content:"(parent",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    if let",props:{style:{color:"#81A1C1"}}},{content:" manager = acct.borrow",props:{style:{color:"#D8DEE9FF"}}},{content:"<",props:{style:{color:"#81A1C1"}}},{content:"&HybridCustody.Manager",props:{style:{color:"#D8DEE9FF"}}},{content:">",props:{style:{color:"#81A1C1"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"from",props:{style:{color:"#81A1C1"}}},{content:": HybridCustody.ManagerStoragePath) ",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        return",props:{style:{color:"#81A1C1"}}},{content:" manager.",props:{style:{color:"#D8DEE9FF"}}},{content:"getChildAddresses",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}},{content:".length ",props:{style:{color:"#D8DEE9FF"}}},{content:"> ",props:{style:{color:"#81A1C1"}}},{content:"0",props:{style:{color:"#B48EAD"}}}]},{tokens:[{content:"    }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    return false",props:{style:{color:"#81A1C1"}}}]},{tokens:[{content:"}",props:{style:{color:"#ECEFF4"}}}]}],lang:"cadence"},annotations:[]}]}),"\n",(0,n.jsx)(o.h3,{id:"query-all-accounts-associated-with-address",children:"Query All Accounts Associated with Address"}),"\n",(0,n.jsx)(o.p,{children:"The following script will return an array of addresses associated with a given account's address, inclusive of the\nprovided address."}),"\n",(0,n.jsx)(d.Code,{codeConfig:u,northPanel:{tabs:["get_child_addresses.cdc"],active:"get_child_addresses.cdc",heightRatio:1},files:[{name:"get_child_addresses.cdc",focus:"",code:{lines:[{tokens:[{content:"import ",props:{style:{color:"#81A1C1"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"HybridCustody",props:{style:{color:"#A3BE8C"}}},{content:'"',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"pub fun ",props:{style:{color:"#81A1C1"}}},{content:"main",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#ECEFF4"}}},{content:"parent",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"Address",props:{style:{color:"#81A1C1"}}},{content:")",props:{style:{color:"#ECEFF4"}}},{content:":",props:{style:{color:"#81A1C1"}}},{content:" [",props:{style:{color:"#D8DEE9FF"}}},{content:"Address",props:{style:{color:"#81A1C1"}}},{content:"] ",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    let",props:{style:{color:"#81A1C1"}}},{content:" acct = ",props:{style:{color:"#D8DEE9FF"}}},{content:"getAuthAccount",props:{style:{color:"#88C0D0"}}},{content:"(parent",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    let",props:{style:{color:"#81A1C1"}}},{content:" manager = acct.borrow",props:{style:{color:"#D8DEE9FF"}}},{content:"<",props:{style:{color:"#81A1C1"}}},{content:"&HybridCustody.Manager",props:{style:{color:"#D8DEE9FF"}}},{content:">",props:{style:{color:"#81A1C1"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"from",props:{style:{color:"#81A1C1"}}},{content:": HybridCustody.ManagerStoragePath)",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        ?? ",props:{style:{color:"#81A1C1"}}},{content:"panic",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"manager not found",props:{style:{color:"#A3BE8C"}}},{content:'")',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    return",props:{style:{color:"#81A1C1"}}},{content:" manager.",props:{style:{color:"#D8DEE9FF"}}},{content:"getChildAddresses",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"// Could also call getOwnedAddresses() for owned account addresses",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"}",props:{style:{color:"#ECEFF4"}}}]}],lang:"cadence"},annotations:[]}]}),"\n",(0,n.jsx)(o.h3,{id:"query-all-owned-nft-metadata",children:"Query All Owned NFT Metadata"}),"\n",(0,n.jsx)(o.p,{children:"While it is possible to iterate over the storage of all associated accounts in a single script, memory limits prevent\nthis approach from scaling well."}),"\n",(0,n.jsx)(o.p,{children:"Since some accounts hold thousands of NFTs, we recommend breaking up iteration, utilizing several queries to iterate\nover accounts and the storage of each account. Batching queries on individual accounts may even be required based on the\nnumber of NFTs held."}),"\n",(0,n.jsxs)(o.ol,{children:["\n",(0,n.jsx)(o.li,{children:"Get all associated account addresses (see above)"}),"\n",(0,n.jsx)(o.li,{children:"Looping over each associated account address client-side, get each address's owned NFT metadata"}),"\n"]}),"\n",(0,n.jsx)(o.p,{children:"For simplicity, we'll show a condensed query, returning NFT display views from all accounts associated with a given\naddress for a specified NFT Collection path."}),"\n",(0,n.jsx)(d.Code,{codeConfig:u,northPanel:{tabs:["get_nft_display_view_from_public.cdc"],active:"get_nft_display_view_from_public.cdc",heightRatio:1},files:[{name:"get_nft_display_view_from_public.cdc",focus:"",code:{lines:[{tokens:[{content:"import ",props:{style:{color:"#81A1C1"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"NonFungibleToken",props:{style:{color:"#A3BE8C"}}},{content:'"',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"import ",props:{style:{color:"#81A1C1"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"MetadataViews",props:{style:{color:"#A3BE8C"}}},{content:'"',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"import ",props:{style:{color:"#81A1C1"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"HybridCustody",props:{style:{color:"#A3BE8C"}}},{content:'"',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"/// Returns resolved Display from given address at specified path for each ID or nil if ResolverCollection is not found",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"///",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"pub fun ",props:{style:{color:"#81A1C1"}}},{content:"getViews",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#ECEFF4"}}},{content:"_ ",props:{style:{color:"#88C0D0"}}},{content:"address",props:{style:{color:"#D8DEE9"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"Address",props:{style:{color:"#81A1C1"}}},{content:", ",props:{style:{color:"#D8DEE9FF"}}},{content:"_ ",props:{style:{color:"#88C0D0"}}},{content:"resolverCollectionPath",props:{style:{color:"#D8DEE9"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"PublicPath",props:{style:{color:"#81A1C1"}}},{content:")",props:{style:{color:"#ECEFF4"}}},{content:":",props:{style:{color:"#81A1C1"}}},{content:" {",props:{style:{color:"#D8DEE9FF"}}},{content:"UInt64",props:{style:{color:"#81A1C1"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"MetadataViews",props:{style:{color:"#81A1C1"}}},{content:".",props:{style:{color:"#D8DEE9FF"}}},{content:"Display",props:{style:{color:"#81A1C1"}}},{content:"} ",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    let",props:{style:{color:"#81A1C1"}}},{content:" account: ",props:{style:{color:"#D8DEE9FF"}}},{content:"PublicAccount",props:{style:{color:"#81A1C1"}}},{content:" = ",props:{style:{color:"#D8DEE9FF"}}},{content:"getAccount",props:{style:{color:"#88C0D0"}}},{content:"(address",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    let",props:{style:{color:"#81A1C1"}}},{content:" views: {",props:{style:{color:"#D8DEE9FF"}}},{content:"UInt64",props:{style:{color:"#81A1C1"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"MetadataViews",props:{style:{color:"#81A1C1"}}},{content:".",props:{style:{color:"#D8DEE9FF"}}},{content:"Display",props:{style:{color:"#81A1C1"}}},{content:"} = ",props:{style:{color:"#D8DEE9FF"}}},{content:"{}",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    // Borrow the Collection",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    if let",props:{style:{color:"#81A1C1"}}},{content:" collection = account",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        .getCapability",props:{style:{color:"#D8DEE9FF"}}},{content:"<",props:{style:{color:"#81A1C1"}}},{content:"&",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}},{content:"NonFungibleToken.CollectionPublic, MetadataViews.ResolverCollection",props:{style:{color:"#D8DEE9FF"}}},{content:"}",props:{style:{color:"#ECEFF4"}}},{content:">",props:{style:{color:"#81A1C1"}}},{content:"(resolverCollectionPath).",props:{style:{color:"#D8DEE9FF"}}},{content:"borrow",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:") {",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        // Iterate over IDs & resolve the view",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        for",props:{style:{color:"#81A1C1"}}},{content:" id ",props:{style:{color:"#D8DEE9FF"}}},{content:"in",props:{style:{color:"#81A1C1"}}},{content:" collection.",props:{style:{color:"#D8DEE9FF"}}},{content:"getIDs",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:") {",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"            if let",props:{style:{color:"#81A1C1"}}},{content:" display = collection.",props:{style:{color:"#D8DEE9FF"}}},{content:"borrowViewResolver",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"id",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" id",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}},{content:".",props:{style:{color:"#D8DEE9FF"}}},{content:"resolveView",props:{style:{color:"#88C0D0"}}},{content:"(Type",props:{style:{color:"#D8DEE9FF"}}},{content:"<",props:{style:{color:"#81A1C1"}}},{content:"MetadataViews.Display",props:{style:{color:"#D8DEE9FF"}}},{content:">",props:{style:{color:"#81A1C1"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}},{content:") as",props:{style:{color:"#D8DEE9FF"}}},{content:"?",props:{style:{color:"#81A1C1"}}},{content:" MetadataViews.Display ",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"                views.",props:{style:{color:"#D8DEE9FF"}}},{content:"insert",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"key",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" id, display",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"            }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    return",props:{style:{color:"#81A1C1"}}},{content:" views",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"}",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"/// Queries for MetadataViews.Display each NFT across all associated accounts from Collections at the provided",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"/// PublicPath",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"///",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"pub fun ",props:{style:{color:"#81A1C1"}}},{content:"main",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#ECEFF4"}}},{content:"address",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"Address",props:{style:{color:"#81A1C1"}}},{content:", ",props:{style:{color:"#D8DEE9FF"}}},{content:"resolverCollectionPath",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"PublicPath",props:{style:{color:"#81A1C1"}}},{content:")",props:{style:{color:"#ECEFF4"}}},{content:":",props:{style:{color:"#81A1C1"}}},{content:" {",props:{style:{color:"#D8DEE9FF"}}},{content:"Address",props:{style:{color:"#81A1C1"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}},{content:"UInt64: MetadataViews.Display",props:{style:{color:"#D8DEE9FF"}}},{content:"}",props:{style:{color:"#ECEFF4"}}},{content:"} ",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    let",props:{style:{color:"#81A1C1"}}},{content:" allViews: {",props:{style:{color:"#D8DEE9FF"}}},{content:"Address",props:{style:{color:"#81A1C1"}}},{content:": {",props:{style:{color:"#D8DEE9FF"}}},{content:"UInt64",props:{style:{color:"#81A1C1"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"MetadataViews",props:{style:{color:"#81A1C1"}}},{content:".",props:{style:{color:"#D8DEE9FF"}}},{content:"Display",props:{style:{color:"#81A1C1"}}},{content:"}} = ",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}},{content:"address: ",props:{style:{color:"#D8DEE9FF"}}},{content:"getViews",props:{style:{color:"#88C0D0"}}},{content:"(address, resolverCollectionPath",props:{style:{color:"#D8DEE9FF"}}},{content:")}",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    let",props:{style:{color:"#81A1C1"}}},{content:" seen: [",props:{style:{color:"#D8DEE9FF"}}},{content:"Address",props:{style:{color:"#81A1C1"}}},{content:"] = [address]",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    /* Iterate over any associated accounts */",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    //",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    if let",props:{style:{color:"#81A1C1"}}},{content:" managerRef = ",props:{style:{color:"#D8DEE9FF"}}},{content:"getAuthAccount",props:{style:{color:"#88C0D0"}}},{content:"(address",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}},{content:".borrow",props:{style:{color:"#D8DEE9FF"}}},{content:"<",props:{style:{color:"#81A1C1"}}},{content:"&HybridCustody.Manager",props:{style:{color:"#D8DEE9FF"}}},{content:">",props:{style:{color:"#81A1C1"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"from",props:{style:{color:"#81A1C1"}}},{content:": HybridCustody.ManagerStoragePath) ",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        for",props:{style:{color:"#81A1C1"}}},{content:" childAccount ",props:{style:{color:"#D8DEE9FF"}}},{content:"in",props:{style:{color:"#81A1C1"}}},{content:" managerRef.",props:{style:{color:"#D8DEE9FF"}}},{content:"getChildAddresses",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:") {",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"            allViews.",props:{style:{color:"#D8DEE9FF"}}},{content:"insert",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"key",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" childAccount, ",props:{style:{color:"#D8DEE9FF"}}},{content:"getViews",props:{style:{color:"#88C0D0"}}},{content:"(address, resolverCollectionPath",props:{style:{color:"#D8DEE9FF"}}},{content:"))",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"            seen.",props:{style:{color:"#D8DEE9FF"}}},{content:"append",props:{style:{color:"#88C0D0"}}},{content:"(childAccount",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        for",props:{style:{color:"#81A1C1"}}},{content:" ownedAccount ",props:{style:{color:"#D8DEE9FF"}}},{content:"in",props:{style:{color:"#81A1C1"}}},{content:" managerRef.",props:{style:{color:"#D8DEE9FF"}}},{content:"getOwnedAddresses",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:") {",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"            if",props:{style:{color:"#81A1C1"}}},{content:" seen.",props:{style:{color:"#D8DEE9FF"}}},{content:"contains",props:{style:{color:"#88C0D0"}}},{content:"(ownedAccount",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"== false ",props:{style:{color:"#81A1C1"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"                allViews.",props:{style:{color:"#D8DEE9FF"}}},{content:"insert",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"key",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" ownedAccount, ",props:{style:{color:"#D8DEE9FF"}}},{content:"getViews",props:{style:{color:"#88C0D0"}}},{content:"(address, resolverCollectionPath",props:{style:{color:"#D8DEE9FF"}}},{content:"))",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"                seen.",props:{style:{color:"#D8DEE9FF"}}},{content:"append",props:{style:{color:"#88C0D0"}}},{content:"(ownedAccount",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"            }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    return",props:{style:{color:"#81A1C1"}}},{content:" allViews",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"}",props:{style:{color:"#ECEFF4"}}}]}],lang:"cadence"},annotations:[]}]}),"\n",(0,n.jsxs)(o.p,{children:["At the end of this query, the caller will have a mapping of ",(0,n.jsx)(o.code,{children:"Display"})," views indexed on the NFT ID and grouped by account\nAddress. Note that this script does not take batching into consideration and assumes that each NFT resolves the\n",(0,n.jsx)(o.code,{children:"MetadataViews.Display"})," view type."]}),"\n",(0,n.jsx)(o.h3,{id:"query-all-account-fungibletoken-balances",children:"Query All Account FungibleToken Balances"}),"\n",(0,n.jsx)(o.p,{children:"Similar to the previous example, we recommend breaking up this task due to memory limits."}),"\n",(0,n.jsxs)(o.ol,{children:["\n",(0,n.jsx)(o.li,{children:"Get all linked account addresses (see above)"}),"\n",(0,n.jsx)(o.li,{children:"Looping over each associated account address client-side, get each address's owned FungibleToken Vault metadata"}),"\n"]}),"\n",(0,n.jsx)(o.p,{children:"However, we'll condense both of these steps down into one script for simplicity:"}),"\n",(0,n.jsx)(d.Code,{codeConfig:u,northPanel:{tabs:["get_all_vault_bal_from_storage.cdc"],active:"get_all_vault_bal_from_storage.cdc",heightRatio:1},files:[{name:"get_all_vault_bal_from_storage.cdc",focus:"",code:{lines:[{tokens:[{content:"import ",props:{style:{color:"#81A1C1"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"FungibleToken",props:{style:{color:"#A3BE8C"}}},{content:'"',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"import ",props:{style:{color:"#81A1C1"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"MetadataViews",props:{style:{color:"#A3BE8C"}}},{content:'"',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"import ",props:{style:{color:"#81A1C1"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"HybridCustody",props:{style:{color:"#A3BE8C"}}},{content:'"',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"/// Returns a mapping of balances indexed on the Type of resource containing the balance",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"///",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"pub fun ",props:{style:{color:"#81A1C1"}}},{content:"getAllBalancesInStorage",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#ECEFF4"}}},{content:"_ ",props:{style:{color:"#88C0D0"}}},{content:"address",props:{style:{color:"#D8DEE9"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"Address",props:{style:{color:"#81A1C1"}}},{content:")",props:{style:{color:"#ECEFF4"}}},{content:":",props:{style:{color:"#81A1C1"}}},{content:" {",props:{style:{color:"#D8DEE9FF"}}},{content:"Type",props:{style:{color:"#81A1C1"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"UFix64",props:{style:{color:"#81A1C1"}}},{content:"} ",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    // Get the account",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    let",props:{style:{color:"#81A1C1"}}},{content:" account: ",props:{style:{color:"#D8DEE9FF"}}},{content:"AuthAccount",props:{style:{color:"#81A1C1"}}},{content:" = ",props:{style:{color:"#D8DEE9FF"}}},{content:"getAuthAccount",props:{style:{color:"#88C0D0"}}},{content:"(address",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    // Init for return value",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    let",props:{style:{color:"#81A1C1"}}},{content:" balances: {",props:{style:{color:"#D8DEE9FF"}}},{content:"Type",props:{style:{color:"#81A1C1"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"UFix64",props:{style:{color:"#81A1C1"}}},{content:"} = ",props:{style:{color:"#D8DEE9FF"}}},{content:"{}",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    // Track seen Types in array",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    let",props:{style:{color:"#81A1C1"}}},{content:" seen: [",props:{style:{color:"#D8DEE9FF"}}},{content:"Type",props:{style:{color:"#81A1C1"}}},{content:"] = []",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    // Assign the type we'll need",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    let",props:{style:{color:"#81A1C1"}}},{content:" balanceType: ",props:{style:{color:"#D8DEE9FF"}}},{content:"Type",props:{style:{color:"#81A1C1"}}},{content:" = Type",props:{style:{color:"#D8DEE9FF"}}},{content:"<",props:{style:{color:"#81A1C1"}}},{content:"@",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}},{content:"FungibleToken.Balance",props:{style:{color:"#D8DEE9FF"}}},{content:"}",props:{style:{color:"#ECEFF4"}}},{content:">",props:{style:{color:"#81A1C1"}}},{content:"()",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    // Iterate over all stored items & get the path if the type is what we're looking for",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    account.",props:{style:{color:"#D8DEE9FF"}}},{content:"forEachStored",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"fun",props:{style:{color:"#88C0D0"}}},{content:" (",props:{style:{color:"#D8DEE9FF"}}},{content:"path",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" StoragePath, ",props:{style:{color:"#D8DEE9FF"}}},{content:"type",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" Type",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}},{content:": Bool {",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        if type.",props:{style:{color:"#D8DEE9FF"}}},{content:"isInstance",props:{style:{color:"#88C0D0"}}},{content:"(balanceType",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"||",props:{style:{color:"#81A1C1"}}},{content:" type.",props:{style:{color:"#D8DEE9FF"}}},{content:"isSubtype",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"of",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" balanceType",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}},{content:" {",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"            // Get a reference to the resource & its balance",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"            let vaultRef ",props:{style:{color:"#D8DEE9FF"}}},{content:"=",props:{style:{color:"#81A1C1"}}},{content:" account.borrow",props:{style:{color:"#D8DEE9FF"}}},{content:"<",props:{style:{color:"#81A1C1"}}},{content:"&{FungibleToken.Balance}",props:{style:{color:"#D8DEE9FF"}}},{content:">",props:{style:{color:"#81A1C1"}}},{content:"(from: path",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}},{content:"!",props:{style:{color:"#81A1C1"}}}]},{tokens:[{content:"            // Insert a new values if it's the first time we've seen the type",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"            if !",props:{style:{color:"#81A1C1"}}},{content:"seen.",props:{style:{color:"#D8DEE9FF"}}},{content:"contains",props:{style:{color:"#88C0D0"}}},{content:"(type",props:{style:{color:"#D8DEE9FF"}}},{content:") {",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"                balances.",props:{style:{color:"#D8DEE9FF"}}},{content:"insert",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"key",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" type, vaultRef.balance",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"            } ",props:{style:{color:"#ECEFF4"}}},{content:"else ",props:{style:{color:"#81A1C1"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"                // Otherwise just update the balance of the vault (unlikely we'll see the same type twice in",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"                // the same account, but we want to cover the case)",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"                balances[type] ",props:{style:{color:"#D8DEE9FF"}}},{content:"=",props:{style:{color:"#81A1C1"}}},{content:" balances[type]",props:{style:{color:"#D8DEE9FF"}}},{content:"! +",props:{style:{color:"#81A1C1"}}},{content:" vaultRef.balance",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"            }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        return true",props:{style:{color:"#81A1C1"}}}]},{tokens:[{content:"    })",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    return",props:{style:{color:"#81A1C1"}}},{content:" balances",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"}",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"/// Queries for FT.Vault balance of all FT.Vaults in the specified account and all of its associated accounts",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"///",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"pub fun ",props:{style:{color:"#81A1C1"}}},{content:"main",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#ECEFF4"}}},{content:"address",props:{style:{color:"#88C0D0"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"Address",props:{style:{color:"#81A1C1"}}},{content:")",props:{style:{color:"#ECEFF4"}}},{content:":",props:{style:{color:"#81A1C1"}}},{content:" {",props:{style:{color:"#D8DEE9FF"}}},{content:"Address",props:{style:{color:"#81A1C1"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}},{content:"Type: UFix64",props:{style:{color:"#D8DEE9FF"}}},{content:"}",props:{style:{color:"#ECEFF4"}}},{content:"} ",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    // Get the balance for the given address",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    let",props:{style:{color:"#81A1C1"}}},{content:" balances: {",props:{style:{color:"#D8DEE9FF"}}},{content:"Address",props:{style:{color:"#81A1C1"}}},{content:": {",props:{style:{color:"#D8DEE9FF"}}},{content:"Type",props:{style:{color:"#81A1C1"}}},{content:": ",props:{style:{color:"#D8DEE9FF"}}},{content:"UFix64",props:{style:{color:"#81A1C1"}}},{content:"}} = ",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}},{content:" address: ",props:{style:{color:"#D8DEE9FF"}}},{content:"getAllBalancesInStorage",props:{style:{color:"#88C0D0"}}},{content:"(address",props:{style:{color:"#D8DEE9FF"}}},{content:") }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    // Tracking Addresses we've come across to prevent overwriting balances (more efficient than checking dict entries (?))",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    let",props:{style:{color:"#81A1C1"}}},{content:" seen: [",props:{style:{color:"#D8DEE9FF"}}},{content:"Address",props:{style:{color:"#81A1C1"}}},{content:"] = [address]",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    /* Iterate over any associated accounts */",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    //",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    if let",props:{style:{color:"#81A1C1"}}},{content:" managerRef = ",props:{style:{color:"#D8DEE9FF"}}},{content:"getAuthAccount",props:{style:{color:"#88C0D0"}}},{content:"(address",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        .borrow",props:{style:{color:"#D8DEE9FF"}}},{content:"<",props:{style:{color:"#81A1C1"}}},{content:"&HybridCustody.Manager",props:{style:{color:"#D8DEE9FF"}}},{content:">",props:{style:{color:"#81A1C1"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"from",props:{style:{color:"#81A1C1"}}},{content:": HybridCustody.ManagerStoragePath) ",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        for",props:{style:{color:"#81A1C1"}}},{content:" childAccount ",props:{style:{color:"#D8DEE9FF"}}},{content:"in",props:{style:{color:"#81A1C1"}}},{content:" managerRef.",props:{style:{color:"#D8DEE9FF"}}},{content:"getChildAddresses",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:") {",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"            balances.",props:{style:{color:"#D8DEE9FF"}}},{content:"insert",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"key",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" childAccount, ",props:{style:{color:"#D8DEE9FF"}}},{content:"getAllBalancesInStorage",props:{style:{color:"#88C0D0"}}},{content:"(address",props:{style:{color:"#D8DEE9FF"}}},{content:"))",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"            seen.",props:{style:{color:"#D8DEE9FF"}}},{content:"append",props:{style:{color:"#88C0D0"}}},{content:"(childAccount",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        for",props:{style:{color:"#81A1C1"}}},{content:" ownedAccount ",props:{style:{color:"#D8DEE9FF"}}},{content:"in",props:{style:{color:"#81A1C1"}}},{content:" managerRef.",props:{style:{color:"#D8DEE9FF"}}},{content:"getOwnedAddresses",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:") {",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"            if",props:{style:{color:"#81A1C1"}}},{content:" seen.",props:{style:{color:"#D8DEE9FF"}}},{content:"contains",props:{style:{color:"#88C0D0"}}},{content:"(ownedAccount",props:{style:{color:"#D8DEE9FF"}}},{content:") ",props:{style:{color:"#ECEFF4"}}},{content:"== false ",props:{style:{color:"#81A1C1"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"                balances.",props:{style:{color:"#D8DEE9FF"}}},{content:"insert",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"key",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" ownedAccount, ",props:{style:{color:"#D8DEE9FF"}}},{content:"getAllBalancesInStorage",props:{style:{color:"#88C0D0"}}},{content:"(address",props:{style:{color:"#D8DEE9FF"}}},{content:"))",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"                seen.",props:{style:{color:"#D8DEE9FF"}}},{content:"append",props:{style:{color:"#88C0D0"}}},{content:"(ownedAccount",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"            }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    return",props:{style:{color:"#81A1C1"}}},{content:" balances",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"}",props:{style:{color:"#ECEFF4"}}}]}],lang:"cadence"},annotations:[]}]}),"\n",(0,n.jsx)(o.p,{children:"The above script returns a dictionary of balances indexed on the type and further grouped by account Address."}),"\n",(0,n.jsx)(o.p,{children:"The returned data at the end of address iteration should be sufficient to achieve a unified balance of all Vaults of\nsimilar types across all of a user's associated account as well as a more granular per account view."}),"\n",(0,n.jsxs)(o.p,{children:["You might consider resolving\n",(0,n.jsx)(o.a,{href:"https://github.com/onflow/flow-ft/blob/master/contracts/FungibleTokenMetadataViews.cdc",children:(0,n.jsx)(o.code,{children:"FungibleTokenMetadataViews"})}),"\nto aggregate more information about the underlying Vaults."]}),"\n",(0,n.jsx)(o.h3,{id:"access-nft-in-child-account-from-parent-account",children:"Access NFT in Child Account from Parent Account"}),"\n",(0,n.jsxs)(o.p,{children:["A user with NFTs in their child accounts will likely want to utilize said NFTs. In this example, the user will sign a\ntransaction a transaction with their authenticated account that retrieves a reference to a child account's\n",(0,n.jsx)(o.code,{children:"NonFungibleToken.Provider"}),", enabling withdrawal from the child account having signed with the parent account."]}),"\n",(0,n.jsx)(d.Code,{codeConfig:u,northPanel:{tabs:["withdraw_nft_from_child.cdc"],active:"withdraw_nft_from_child.cdc",heightRatio:1},files:[{name:"withdraw_nft_from_child.cdc",focus:"",code:{lines:[{tokens:[{content:"import ",props:{style:{color:"#81A1C1"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"NonFungibleToken",props:{style:{color:"#A3BE8C"}}},{content:'"',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"import ",props:{style:{color:"#81A1C1"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"FlowToken",props:{style:{color:"#A3BE8C"}}},{content:'"',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"import ",props:{style:{color:"#81A1C1"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"HybridCustody",props:{style:{color:"#A3BE8C"}}},{content:'"',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"transaction",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"childAddress",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" Address, ",props:{style:{color:"#D8DEE9FF"}}},{content:"providerPath",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" PrivatePath, ",props:{style:{color:"#D8DEE9FF"}}},{content:"withdrawID",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" UInt64",props:{style:{color:"#D8DEE9FF"}}},{content:") {",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    let",props:{style:{color:"#81A1C1"}}},{content:" providerRef: &{",props:{style:{color:"#D8DEE9FF"}}},{content:"NonFungibleToken",props:{style:{color:"#81A1C1"}}},{content:".",props:{style:{color:"#D8DEE9FF"}}},{content:"Provider",props:{style:{color:"#81A1C1"}}},{content:"}",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    prepare",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"signer",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" AuthAccount",props:{style:{color:"#D8DEE9FF"}}},{content:") {",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        // Get a reference to the signer's HybridCustody.Manager from storage",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        let",props:{style:{color:"#81A1C1"}}},{content:" managerRef: &",props:{style:{color:"#D8DEE9FF"}}},{content:"HybridCustody",props:{style:{color:"#81A1C1"}}},{content:".",props:{style:{color:"#D8DEE9FF"}}},{content:"Manager",props:{style:{color:"#81A1C1"}}},{content:" = signer.borrow",props:{style:{color:"#D8DEE9FF"}}},{content:"<",props:{style:{color:"#81A1C1"}}},{content:"&HybridCustody.Manager",props:{style:{color:"#D8DEE9FF"}}},{content:">",props:{style:{color:"#81A1C1"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"                from",props:{style:{color:"#81A1C1"}}},{content:": HybridCustody.ManagerStoragePath",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"            ) ",props:{style:{color:"#D8DEE9FF"}}},{content:"?? ",props:{style:{color:"#81A1C1"}}},{content:"panic",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"Could not borrow reference to HybridCustody.Manager in signer's account at expected path!",props:{style:{color:"#A3BE8C"}}},{content:'")',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        // Borrow a reference to the signer's specified child account",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        let",props:{style:{color:"#81A1C1"}}},{content:" account: &{",props:{style:{color:"#D8DEE9FF"}}},{content:"AccountPrivate",props:{style:{color:"#81A1C1"}}},{content:", ",props:{style:{color:"#D8DEE9FF"}}},{content:"AccountPublic",props:{style:{color:"#81A1C1"}}},{content:", ",props:{style:{color:"#D8DEE9FF"}}},{content:"MetadataViews",props:{style:{color:"#81A1C1"}}},{content:".",props:{style:{color:"#D8DEE9FF"}}},{content:"Resolver",props:{style:{color:"#81A1C1"}}},{content:"}? = managerRef",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"            .",props:{style:{color:"#D8DEE9FF"}}},{content:"borrowAccount",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"addr",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" childAddress",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"            ?? ",props:{style:{color:"#81A1C1"}}},{content:"panic",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"Signer does not have access to specified child account",props:{style:{color:"#A3BE8C"}}},{content:'")',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        // Get a reference to the child NFT Provider and assign to the transaction scope variable",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        let",props:{style:{color:"#81A1C1"}}},{content:" cap: ",props:{style:{color:"#D8DEE9FF"}}},{content:"Capability",props:{style:{color:"#81A1C1"}}},{content:" = account.",props:{style:{color:"#D8DEE9FF"}}},{content:"getCapability",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"                path",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" providerPath,",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"                type",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" Type",props:{style:{color:"#D8DEE9FF"}}},{content:"<",props:{style:{color:"#81A1C1"}}},{content:"&{NonFungibleToken.Provider}",props:{style:{color:"#D8DEE9FF"}}},{content:">",props:{style:{color:"#81A1C1"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"            ) ",props:{style:{color:"#D8DEE9FF"}}},{content:"?? ",props:{style:{color:"#81A1C1"}}},{content:"panic",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"Cannot access NonFungibleToken.Provider from this child account",props:{style:{color:"#A3BE8C"}}},{content:'")',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"        // We'll need to cast the Capability - this is possible thanks to CapabilityFactory, though we'll rely on the relevant",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        // Factory having been configured for this Type or it won't be castable",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        self",props:{style:{color:"#81A1C1"}}},{content:".providerRef ",props:{style:{color:"#D8DEE9FF"}}},{content:"=",props:{style:{color:"#81A1C1"}}},{content:" cap as",props:{style:{color:"#D8DEE9FF"}}},{content:"!",props:{style:{color:"#81A1C1"}}},{content:" Capability",props:{style:{color:"#D8DEE9FF"}}},{content:"<",props:{style:{color:"#81A1C1"}}},{content:"&",props:{style:{color:"#D8DEE9FF"}}},{content:"{",props:{style:{color:"#ECEFF4"}}},{content:"NonFungibleToken.Provider",props:{style:{color:"#D8DEE9FF"}}},{content:"}",props:{style:{color:"#ECEFF4"}}},{content:">",props:{style:{color:"#81A1C1"}}}]},{tokens:[{content:"    }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"    execute ",props:{style:{color:"#81A1C1"}}},{content:"{",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        // Withdraw the NFT from the Collection",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        let",props:{style:{color:"#81A1C1"}}},{content:" nft <- ",props:{style:{color:"#D8DEE9FF"}}},{content:"self",props:{style:{color:"#81A1C1"}}},{content:".providerRef.",props:{style:{color:"#D8DEE9FF"}}},{content:"withdraw",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"withdrawID",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" withdrawID",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        // Do stuff with the NFT",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"        // ...",props:{style:{color:"#616E88"}}}]},{tokens:[{content:"    }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"}",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]}],lang:"cadence"},annotations:[]}]}),"\n",(0,n.jsxs)(o.p,{children:["At the end of this transaction, you withdrew an NFT from the specified account using an NFT ",(0,n.jsx)(o.code,{children:"Provider"})," Capability. A\nsimilar approach could get you any allowable Capabilities from a signer's child account."]}),"\n",(0,n.jsx)(o.h3,{id:"revoking-secondary-access-on-a-linked-account",children:"Revoking Secondary Access on a Linked Account"}),"\n",(0,n.jsx)(o.p,{children:"The expected uses of child accounts for progressive onboarding implies that they will be accounts with shared access. A\nuser may decide that they no longer want secondary parties to have access to the child account."}),"\n",(0,n.jsxs)(o.p,{children:["There are two ways a party can have delegated access to an account - keys and AuthAccount Capability. With\n",(0,n.jsx)(o.code,{children:"ChildAccount"})," mediated access, a user wouldn't be able to revoke anyone's access except for their own. With\nunrestricted access via ",(0,n.jsx)(o.code,{children:"OwnedAccount"}),", one could remove parents (",(0,n.jsx)(o.code,{children:"OwnedAccount.removeParent(parent: Address)"}),") thereby\nunlinking relevant Capabilities and further destroying their ",(0,n.jsx)(o.code,{children:"ChildAccount"})," and ",(0,n.jsx)(o.code,{children:"CapabilityDelegator"})," resources."]}),"\n",(0,n.jsxs)(o.p,{children:["Ultimately, things are not entirely straightforward with respect to ",(0,n.jsx)(o.code,{children:"AuthAccount"})," Capabilities, at least not until\nCapability Controllers enter the picture. This is discussed in more detail in ",(0,n.jsx)(o.a,{href:"https://forum.onflow.org/t/account-linking-authaccount-capabilities-management/4314",children:"the\nFlip"}),". For now, we recommend that\nif users want to revoke secondary access, they transfer any assets from the relevant child account and remove it from\ntheir ",(0,n.jsx)(o.code,{children:"Manager"})," altogether."]}),"\n",(0,n.jsx)(o.h3,{id:"remove-a-child-account",children:"Remove a Child Account"}),"\n",(0,n.jsxs)(o.p,{children:["As mentioned above, if a user no longer wishes to share access with another party, it's recommended that desired assets\nbe transferred from that account to either their main account or other linked accounts and the linked account be removed\nfrom their ",(0,n.jsx)(o.code,{children:"HybridCustody.Manager"}),". Let's see how to complete that removal."]}),"\n",(0,n.jsx)(d.Code,{codeConfig:u,northPanel:{tabs:["remove_child_account.cdc"],active:"remove_child_account.cdc",heightRatio:1},files:[{name:"remove_child_account.cdc",focus:"",code:{lines:[{tokens:[{content:"import ",props:{style:{color:"#81A1C1"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"HybridCustody",props:{style:{color:"#A3BE8C"}}},{content:'"',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"transaction",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"child",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" Address",props:{style:{color:"#D8DEE9FF"}}},{content:") {",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    prepare",props:{style:{color:"#88C0D0"}}},{content:" (",props:{style:{color:"#D8DEE9FF"}}},{content:"acct",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" AuthAccount",props:{style:{color:"#D8DEE9FF"}}},{content:") {",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        let",props:{style:{color:"#81A1C1"}}},{content:" manager = acct.borrow",props:{style:{color:"#D8DEE9FF"}}},{content:"<",props:{style:{color:"#81A1C1"}}},{content:"&HybridCustody.Manager",props:{style:{color:"#D8DEE9FF"}}},{content:">",props:{style:{color:"#81A1C1"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"from",props:{style:{color:"#81A1C1"}}},{content:": HybridCustody.ManagerStoragePath)",props:{style:{color:"#D8DEE9FF"}}}]},{tokens:[{content:"            ?? ",props:{style:{color:"#81A1C1"}}},{content:"panic",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:'"',props:{style:{color:"#ECEFF4"}}},{content:"manager not found",props:{style:{color:"#A3BE8C"}}},{content:'")',props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"        manager.",props:{style:{color:"#D8DEE9FF"}}},{content:"removeChild",props:{style:{color:"#88C0D0"}}},{content:"(",props:{style:{color:"#D8DEE9FF"}}},{content:"addr",props:{style:{color:"#88C0D0"}}},{content:":",props:{style:{color:"#ECEFF4"}}},{content:" child",props:{style:{color:"#D8DEE9FF"}}},{content:")",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"    }",props:{style:{color:"#ECEFF4"}}}]},{tokens:[{content:"}",props:{style:{color:"#ECEFF4"}}}]}],lang:"cadence"},annotations:[]}]}),"\n",(0,n.jsxs)(o.p,{children:["After removal, the signer no longer has delegated access to the removed account via their ",(0,n.jsx)(o.code,{children:"Manager"})," and the caller is\nremoved as a parent of the removed child."]}),"\n",(0,n.jsx)(o.p,{children:"Note also that it's possible for a child account to remove a parent. This is necessary to give application developers\nand ultimately the owners of these child accounts the ability to revoke secondary access on owned accounts."})]})}const g=function(e){void 0===e&&(e={});const{wrapper:o}=Object.assign({},(0,r.ah)(),e.components);return o?(0,n.jsx)(o,Object.assign({},e,{children:(0,n.jsx)(y,e)})):y(e)};function F(e,o){throw new Error("Expected "+(o?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},22534:(e,o,t)=>{t.d(o,{Z:()=>n});const n=t.p+"assets/images/hybrid_custody_conceptual_overview-975cb40510eeea3228a84e5d0ba5bb89.png"},96449:(e,o,t)=>{t.d(o,{Z:()=>n});const n=t.p+"assets/images/hybrid_custody_low_level-10bdf2339a83715b9c2752366df5e002.png"}}]);