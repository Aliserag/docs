<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-cadence/testing-framework">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.0">
<title data-rh="true">Cadence Testing Framework | Flow Developer Portal</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://onflow.github.io/docs/img/FlowDocs_Logo_FlowLogo_Horizontal_Green_BlackText.svg"><meta data-rh="true" name="twitter:image" content="https://onflow.github.io/docs/img/FlowDocs_Logo_FlowLogo_Horizontal_Green_BlackText.svg"><meta data-rh="true" property="og:url" content="https://onflow.github.io/docs/next/cadence/testing-framework"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Cadence Testing Framework | Flow Developer Portal"><meta data-rh="true" name="description" content="The Cadence testing framework provides a convenient way to write tests for Cadence programs in Cadence."><meta data-rh="true" property="og:description" content="The Cadence testing framework provides a convenient way to write tests for Cadence programs in Cadence."><link data-rh="true" rel="icon" href="/docs/favicon.ico"><link data-rh="true" rel="canonical" href="https://onflow.github.io/docs/next/cadence/testing-framework"><link data-rh="true" rel="alternate" href="https://onflow.github.io/docs/next/cadence/testing-framework" hreflang="en"><link data-rh="true" rel="alternate" href="https://onflow.github.io/docs/next/cadence/testing-framework" hreflang="x-default"><link rel="search" type="application/opensearchdescription+xml" title="Flow Developer Portal" href="/docs/opensearch.xml">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous">
<script src="/mixpanel.js" async onload="if (&#39;776159d170484f49f19c3c2f7339f297&#39; &amp;&amp; &#39;776159d170484f49f19c3c2f7339f297&#39; !== &#39;undefined&#39;) {
  window.mixpanel.init(&#39;776159d170484f49f19c3c2f7339f297&#39;);

  const viwedPayload = {
    &#39;Page Name&#39;: document.title,
    &#39;Page URL&#39;: window.location.pathname,
  }
  window.mixpanel.track(&#39;Page Viewed&#39;, viwedPayload);

  const playUrl = &#39;play.onflow.org&#39;;
  const links = document.querySelectorAll(&#39;a&#39;) || [];
  const isPlayPage = Array.from(links).some((link) =&gt; link.href.includes(playUrl));

  if (isPlayPage) {
    window.mixpanel.track(&#39;Play Page Viewed&#39;, viwedPayload);
  }
  
  window.document.addEventListener(&#39;click&#39;, function (event) {
    var target = event.target;
  
    // Check if the clicked element is a link with an href attribute
    if (target.tagName === &#39;A&#39; &amp;&amp; target.hasAttribute(&#39;href&#39;)) {
      if (window.mixpanel) {
        const payload = {
          href: target.getAttribute(&#39;href&#39;),
          id: target.id,
          class: target.className,
        }
        window.mixpanel.track(&#39;Link clicked&#39;, payload);
        const isPlay = payload.href.includes(&#39;play.onflow.org&#39;);
        if (isPlay) {
          window.mixpanel.track(&#39;Play Link clicked&#39;, payload);        
        }
      }
    }
  });
}"></script>
<script src="https://widget.kapa.ai/kapa-widget.bundle.js" data-website-id="0f0b3ed1-7761-4986-851e-09336ea6ef1c" data-project-name="Flow" data-project-color="#2E8555" data-project-logo="https://cryptologos.cc/logos/flow-flow-logo.png" async></script>
<script src="/hotjar.js" async></script>
<script src="https://widget.kapa.ai/kapa-widget.bundle.js" data-website-id="0f0b3ed1-7761-4986-851e-09336ea6ef1c" data-project-name="Flow" data-project-color="#2E8555" data-project-logo="https://cryptologos.cc/logos/flow-flow-logo.png" async></script><link rel="stylesheet" href="/docs/assets/css/styles.8d07a146.css">
<link rel="preload" href="/docs/assets/js/runtime~main.98ec6519.js" as="script">
<link rel="preload" href="/docs/assets/js/main.0789a803.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs/"><div class="navbar__logo"><img src="/docs/img/flow-docs-logo-dark.png" alt="Flow Developer Portal Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/docs/img/flow-docs-logo-light.png" alt="Flow Developer Portal Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" href="/docs/building-on-flow">Build</a><a class="navbar__item navbar__link" href="/docs/guides">Guides</a><a class="navbar__item navbar__link" href="/docs/cadence/intro">Cadence</a><a class="navbar__item navbar__link" href="/docs/tools">Tools</a><a class="navbar__item navbar__link" href="/docs/references">References</a><a class="navbar__item navbar__link" href="/docs/community-resources">Resources</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/next/overview">Next</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/next/cadence/testing-framework">Next</a></li><li><a class="dropdown__link" href="/docs/cadence/testing-framework">Current</a></li></ul></div><a href="https://github.com/onflow" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link h-8 desktop:p-1"><img src="" alt="GitHub" id="navbar-github" class="box-content h-32 w-32"><span class="p-2 desktop:hidden">Github</span></a><a href="https://onflow.org/discord" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link h-8 desktop:p-1"><img src="" alt="Discord" id="navbar-discord" class="box-content h-32 w-32"><span class="p-2 desktop:hidden">Discord</span></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/next/cadence/design-patterns">Design Patterns</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/next/cadence">index</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/next/cadence/anti-patterns">Anti-Patterns</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/next/cadence/security-best-practices">Security Best Practices</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/next/cadence/tutorial/first-steps">Tutorial</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/next/cadence/contract-upgrades">Contract Upgrades with Incompatible Changes</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/next/cadence/language">Language Reference</a><button aria-label="Toggle the collapsible sidebar category &#x27;Language Reference&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/next/cadence/project-development-tips">Development Standards</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/next/cadence/solidity-to-cadence">Guide for Solidity Developers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/next/cadence/json-cadence-spec">JSON-Cadence format</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/next/cadence/measuring-time">Measuring Time</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/docs/next/cadence/testing-framework">Testing</a></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is unreleased documentation for <!-- -->Flow Developer Portal<!-- --> <b>Next</b> version.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/docs/cadence/testing-framework">latest version</a></b> (<!-- -->Current<!-- -->).</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Testing</span><meta itemprop="position" content="1"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: Next</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Cadence Testing Framework</h1></header><p>The Cadence testing framework provides a convenient way to write tests for Cadence programs in Cadence.
This functionality is provided by the built-in <code>Test</code> contract.</p>
<div class="theme-admonition theme-admonition-info alert alert--info admonition_WoCw"><div class="admonitionHeading_TMsN"><span class="admonitionIcon_Ibzs"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_vXIg"><p>The testing framework can only be used off-chain, e.g. by using the <a href="/docs/next/tools/flow-cli">Flow CLI</a>.</p></div></div>
<p>Tests must be written in the form of a Cadence script.
A test script may contain testing functions that starts with the <code>test</code> prefix,
a <code>setup</code> function that always runs before the tests,
a <code>tearDown</code> function that always runs at the end of all test cases,
a <code>beforeEach</code> function that runs before each test case,
and an <code>afterEach</code> function that runs after each test case.
All the above four functions are optional.</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->34</span><div style="display:inline-block;margin-left:16px"><span>// A `setup` function that always runs before the rest of the test cases.</span></div></div><div><span class="ch-code-line-number">_<!-- -->34</span><div style="display:inline-block;margin-left:16px"><span>// Can be used to initialize things that would be used across the test cases.</span></div></div><div><span class="ch-code-line-number">_<!-- -->34</span><div style="display:inline-block;margin-left:16px"><span>// e.g: initialling a blockchain backend, initializing a contract, etc.</span></div></div><div><span class="ch-code-line-number">_<!-- -->34</span><div style="display:inline-block;margin-left:16px"><span>access(all) fun setup() {</span></div></div><div><span class="ch-code-line-number">_<!-- -->34</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><span class="ch-code-line-number">_<!-- -->34</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->34</span><div style="display:inline-block;margin-left:16px"><span>// The `beforeEach` function runs before each test case. Can be used to perform</span></div></div><div><span class="ch-code-line-number">_<!-- -->34</span><div style="display:inline-block;margin-left:16px"><span>// some state cleanup before each test case, among other things.</span></div></div><div><span class="ch-code-line-number">_<!-- -->34</span><div style="display:inline-block;margin-left:16px"><span>access(all) fun beforeEach() {</span></div></div><div><span class="ch-code-line-number">_<!-- -->34</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><span class="ch-code-line-number">_<!-- -->34</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->34</span><div style="display:inline-block;margin-left:16px"><span>// The `afterEach` function runs after each test case.  Can be used to perform</span></div></div><div><span class="ch-code-line-number">_<!-- -->34</span><div style="display:inline-block;margin-left:16px"><span>// some state cleanup after each test case, among other things.</span></div></div><div><span class="ch-code-line-number">_<!-- -->34</span><div style="display:inline-block;margin-left:16px"><span>access(all) fun afterEach() {</span></div></div><div><span class="ch-code-line-number">_<!-- -->34</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><span class="ch-code-line-number">_<!-- -->34</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->34</span><div style="display:inline-block;margin-left:16px"><span>// Valid test functions start with the &#x27;test&#x27; prefix.</span></div></div><div><span class="ch-code-line-number">_<!-- -->34</span><div style="display:inline-block;margin-left:16px"><span>access(all) fun testSomething() {</span></div></div><div><span class="ch-code-line-number">_<!-- -->34</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><span class="ch-code-line-number">_<!-- -->34</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->34</span><div style="display:inline-block;margin-left:16px"><span>access(all) fun testAnotherThing() {</span></div></div><div><span class="ch-code-line-number">_<!-- -->34</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><span class="ch-code-line-number">_<!-- -->34</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->34</span><div style="display:inline-block;margin-left:16px"><span>access(all) fun testMoreThings() {</span></div></div><div><span class="ch-code-line-number">_<!-- -->34</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><span class="ch-code-line-number">_<!-- -->34</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->34</span><div style="display:inline-block;margin-left:16px"><span>// Test functions cannot have any arguments or return values.</span></div></div><div><span class="ch-code-line-number">_<!-- -->34</span><div style="display:inline-block;margin-left:16px"><span>access(all) fun testInvalidSignature(message: String): Bool {</span></div></div><div><span class="ch-code-line-number">_<!-- -->34</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><span class="ch-code-line-number">_<!-- -->34</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->34</span><div style="display:inline-block;margin-left:16px"><span>// A `tearDown` function that always runs at the end of all test cases.</span></div></div><div><span class="ch-code-line-number">_<!-- -->34</span><div style="display:inline-block;margin-left:16px"><span>// e.g: Can be used to stop the blockchain back-end used for tests, etc. or any cleanup.</span></div></div><div><span class="ch-code-line-number">_<!-- -->34</span><div style="display:inline-block;margin-left:16px"><span>access(all) fun tearDown() {</span></div></div><div><span class="ch-code-line-number">_<!-- -->34</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="test-standard-library">Test Standard Library<a href="#test-standard-library" class="hash-link" aria-label="Direct link to Test Standard Library" title="Direct link to Test Standard Library">​</a></h2>
<p>The testing framework can be used by importing the built-in <code>Test</code> contract:</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>import Test</span></div></div><br></code></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="assertions">Assertions<a href="#assertions" class="hash-link" aria-label="Direct link to Assertions" title="Direct link to Assertions">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="testassert">Test.assert<a href="#testassert" class="hash-link" aria-label="Direct link to Test.assert" title="Direct link to Test.assert">​</a></h3>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>fun assert(_ condition: Bool, message: String)</span></div></div><br></code></div></div>
<p>Fails a test-case if the given condition is false, and reports a message which explains why the condition is false.</p>
<p>The message argument is optional.</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>import Test</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>access(all) fun testExample() {</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>    Test.assert(2 == 2)</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>    Test.assert([1, 2, 3].length == 0, message: &quot;Array length is not 0&quot;)</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="testfail">Test.fail<a href="#testfail" class="hash-link" aria-label="Direct link to Test.fail" title="Direct link to Test.fail">​</a></h3>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>fun fail(message: String)</span></div></div><br></code></div></div>
<p>Immediately fails a test-case, with a message explaining the reason to fail the test.</p>
<p>The message argument is optional.</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>import Test</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>access(all) fun testExample() {</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>    let array = [1, 2, 3]</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>    if array.length != 0 {</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>        Test.fail(message: &quot;Array length is not 0&quot;)</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="testexpect">Test.expect<a href="#testexpect" class="hash-link" aria-label="Direct link to Test.expect" title="Direct link to Test.expect">​</a></h3>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>fun expect(_ value: AnyStruct, _ matcher: Matcher)</span></div></div><br></code></div></div>
<p>The <code>expect</code> function tests a value against a matcher (see <a href="#matchers">matchers</a> section), and fails the test if it&#x27;s not a match.</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>import Test</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>access(all) fun testExample() {</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>    let array = [1, 2, 3]</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>    Test.expect(array.length, Test.equal(3))</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="testassertequal">Test.assertEqual<a href="#testassertequal" class="hash-link" aria-label="Direct link to Test.assertEqual" title="Direct link to Test.assertEqual">​</a></h3>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>fun assertEqual(_ expected: AnyStruct, _ actual: AnyStruct)</span></div></div><br></code></div></div>
<p>The <code>assertEqual</code> function fails the test-case if the given values are not equal, and
reports a message which explains how the two values differ.</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>import Test</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>access(all) struct Foo {</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>    access(all) let answer: Int</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>    init(answer: Int) {</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>        self.answer = answer</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>access(all) fun testExample() {</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>    Test.assertEqual(&quot;this string&quot;, &quot;this string&quot;)</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>    Test.assertEqual(21, 21)</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>    Test.assertEqual(true, true)</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>    Test.assertEqual([1, 2, 3], [1, 2, 3])</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>    Test.assertEqual(</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>        {1: true, 2: false, 3: true},</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>        {1: true, 2: false, 3: true}</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>    )</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>    let address1 = Address(0xf8d6e0586b0a20c7)</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>    let address2 = Address(0xf8d6e0586b0a20c7)</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>    Test.assertEqual(address1, address2)</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>    let foo1 = Foo(answer: 42)</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>    let foo2 = Foo(answer: 42)</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>    Test.assertEqual(foo1, foo2)</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>    let number1: Int64 = 100</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>    let number2: UInt64 = 100</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>    // Note that the two values need to have exactly the same type,</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>    // and not just value, otherwise the assertion fails:</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>    // assertion failed: not equal: expected: 100, actual: 100</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>    Test.assertEqual(number1, number2)</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="testexpectfailure">Test.expectFailure<a href="#testexpectfailure" class="hash-link" aria-label="Direct link to Test.expectFailure" title="Direct link to Test.expectFailure">​</a></h3>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>fun expectFailure(_ functionWrapper: ((): Void), errorMessageSubstring: String)</span></div></div><br></code></div></div>
<p>The <code>expectFailure</code> function wraps a function call in a closure, and expects it to fail with
an error message that contains the given error message portion.</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->24</span><div style="display:inline-block;margin-left:16px"><span>import Test</span></div></div><div><span class="ch-code-line-number">_<!-- -->24</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->24</span><div style="display:inline-block;margin-left:16px"><span>access(all) struct Foo {</span></div></div><div><span class="ch-code-line-number">_<!-- -->24</span><div style="display:inline-block;margin-left:16px"><span>    access(self) let answer: UInt8</span></div></div><div><span class="ch-code-line-number">_<!-- -->24</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->24</span><div style="display:inline-block;margin-left:16px"><span>    init(answer: UInt8) {</span></div></div><div><span class="ch-code-line-number">_<!-- -->24</span><div style="display:inline-block;margin-left:16px"><span>        self.answer = answer</span></div></div><div><span class="ch-code-line-number">_<!-- -->24</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->24</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->24</span><div style="display:inline-block;margin-left:16px"><span>    access(all) fun correctAnswer(_ input: UInt8): Bool {</span></div></div><div><span class="ch-code-line-number">_<!-- -->24</span><div style="display:inline-block;margin-left:16px"><span>        if self.answer != input {</span></div></div><div><span class="ch-code-line-number">_<!-- -->24</span><div style="display:inline-block;margin-left:16px"><span>            panic(&quot;wrong answer!&quot;)</span></div></div><div><span class="ch-code-line-number">_<!-- -->24</span><div style="display:inline-block;margin-left:16px"><span>        }</span></div></div><div><span class="ch-code-line-number">_<!-- -->24</span><div style="display:inline-block;margin-left:16px"><span>        return true</span></div></div><div><span class="ch-code-line-number">_<!-- -->24</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->24</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><span class="ch-code-line-number">_<!-- -->24</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->24</span><div style="display:inline-block;margin-left:16px"><span>access(all) fun testExample() {</span></div></div><div><span class="ch-code-line-number">_<!-- -->24</span><div style="display:inline-block;margin-left:16px"><span>    let foo = Foo(answer: 42)</span></div></div><div><span class="ch-code-line-number">_<!-- -->24</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->24</span><div style="display:inline-block;margin-left:16px"><span>    Test.expectFailure(fun(): Void {</span></div></div><div><span class="ch-code-line-number">_<!-- -->24</span><div style="display:inline-block;margin-left:16px"><span>        foo.correctAnswer(43)</span></div></div><div><span class="ch-code-line-number">_<!-- -->24</span><div style="display:inline-block;margin-left:16px"><span>    }, errorMessageSubstring: &quot;wrong answer!&quot;)</span></div></div><div><span class="ch-code-line-number">_<!-- -->24</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="matchers">Matchers<a href="#matchers" class="hash-link" aria-label="Direct link to Matchers" title="Direct link to Matchers">​</a></h2>
<p>A matcher is an object that consists of a test function and associated utility functionality.</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->26</span><div style="display:inline-block;margin-left:16px"><span>access(all) struct Matcher {</span></div></div><div><span class="ch-code-line-number">_<!-- -->26</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->26</span><div style="display:inline-block;margin-left:16px"><span>    access(all) let test: fun(AnyStruct): Bool</span></div></div><div><span class="ch-code-line-number">_<!-- -->26</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->26</span><div style="display:inline-block;margin-left:16px"><span>    access(all) init(test: fun(AnyStruct): Bool) {</span></div></div><div><span class="ch-code-line-number">_<!-- -->26</span><div style="display:inline-block;margin-left:16px"><span>        self.test = test</span></div></div><div><span class="ch-code-line-number">_<!-- -->26</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->26</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->26</span><div style="display:inline-block;margin-left:16px"><span>    /// Combine this matcher with the given matcher.</span></div></div><div><span class="ch-code-line-number">_<!-- -->26</span><div style="display:inline-block;margin-left:16px"><span>    /// Returns a new matcher that succeeds if this and the given matcher succeed.</span></div></div><div><span class="ch-code-line-number">_<!-- -->26</span><div style="display:inline-block;margin-left:16px"><span>    ///</span></div></div><div><span class="ch-code-line-number">_<!-- -->26</span><div style="display:inline-block;margin-left:16px"><span>    access(all) fun and(_ other: Matcher): Matcher {</span></div></div><div><span class="ch-code-line-number">_<!-- -->26</span><div style="display:inline-block;margin-left:16px"><span>        return Matcher(test: fun (value: AnyStruct): Bool {</span></div></div><div><span class="ch-code-line-number">_<!-- -->26</span><div style="display:inline-block;margin-left:16px"><span>            return self.test(value) &amp;&amp; other.test(value)</span></div></div><div><span class="ch-code-line-number">_<!-- -->26</span><div style="display:inline-block;margin-left:16px"><span>        })</span></div></div><div><span class="ch-code-line-number">_<!-- -->26</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->26</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->26</span><div style="display:inline-block;margin-left:16px"><span>    /// Combine this matcher with the given matcher.</span></div></div><div><span class="ch-code-line-number">_<!-- -->26</span><div style="display:inline-block;margin-left:16px"><span>    /// Returns a new matcher that succeeds if this or the given matcher succeeds.</span></div></div><div><span class="ch-code-line-number">_<!-- -->26</span><div style="display:inline-block;margin-left:16px"><span>    ///</span></div></div><div><span class="ch-code-line-number">_<!-- -->26</span><div style="display:inline-block;margin-left:16px"><span>    access(all) fun or(_ other: Matcher): Matcher {</span></div></div><div><span class="ch-code-line-number">_<!-- -->26</span><div style="display:inline-block;margin-left:16px"><span>        return Matcher(test: fun (value: AnyStruct): Bool {</span></div></div><div><span class="ch-code-line-number">_<!-- -->26</span><div style="display:inline-block;margin-left:16px"><span>            return self.test(value) || other.test(value)</span></div></div><div><span class="ch-code-line-number">_<!-- -->26</span><div style="display:inline-block;margin-left:16px"><span>        })</span></div></div><div><span class="ch-code-line-number">_<!-- -->26</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->26</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<p>The <code>test</code> function defines the evaluation criteria for a value, and returns a boolean indicating whether the value
conforms to the test criteria defined in the function.</p>
<p>The <code>and</code> and <code>or</code> functions can be used to combine this matcher with another matcher to produce a new matcher with
multiple testing criteria.
The <code>and</code> method returns a new matcher that succeeds if both this and the given matcher are succeeded.
The <code>or</code> method returns a new matcher that succeeds if at-least this or the given matcher is succeeded.</p>
<p>A matcher that accepts a generic-typed test function can be constructed using the <code>newMatcher</code> function.</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>fun newMatcher&lt;T: AnyStruct&gt;(_ test: fun(T): Bool): Test.Matcher</span></div></div><br></code></div></div>
<p>The type parameter <code>T</code> is bound to <code>AnyStruct</code> type. It is also optional.</p>
<p>For example, a matcher that checks whether a given integer value is negative can be defined as follows:</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>import Test</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>access(all) fun testExample() {</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>    let isNegative = Test.newMatcher(fun (_ value: Int): Bool {</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>        return value &lt; 0</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>    })</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>    Test.expect(-15, isNegative)</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>    // Alternatively, we can use `Test.assert` and the matcher&#x27;s `test` function.</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>    Test.assert(isNegative.test(-15), message: &quot;number is not negative&quot;)</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>access(all) fun testCustomMatcherUntyped() {</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>    let matcher = Test.newMatcher(fun (_ value: AnyStruct): Bool {</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>        if !value.getType().isSubtype(of: Type&lt;Int&gt;()) {</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>            return false</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>        }</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>        return (value as! Int) &gt; 5</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>    })</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>    Test.expect(8, matcher)</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>access(all) fun testCustomMatcherTyped() {</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>    let matcher = Test.newMatcher&lt;Int&gt;(fun (_ value: Int): Bool {</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>        return value == 7</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>    })</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>    Test.expect(7, matcher)</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<p>The <code>Test</code> contract provides some built-in matcher functions for convenience.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="testequal">Test.equal<a href="#testequal" class="hash-link" aria-label="Direct link to Test.equal" title="Direct link to Test.equal">​</a></h3>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>fun equal(_ value: AnyStruct): Matcher</span></div></div><br></code></div></div>
<p>The <code>equal</code> function returns a matcher that succeeds if the tested value is equal to the given value.
Accepts an <code>AnyStruct</code> value.</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>import Test</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>access(all) fun testExample() {</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>    let array = [1, 2, 3]</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>    Test.expect([1, 2, 3], Test.equal(array))</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="testbegreaterthan">Test.beGreaterThan<a href="#testbegreaterthan" class="hash-link" aria-label="Direct link to Test.beGreaterThan" title="Direct link to Test.beGreaterThan">​</a></h3>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>fun beGreaterThan(_ value: Number): Matcher</span></div></div><br></code></div></div>
<p>The <code>beGreaterThan</code> function returns a matcher that succeeds if the tested value is a number and
greater than the given number.</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>import Test</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>access(all) fun testExample() {</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>    let str = &quot;Hello, there&quot;</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>    Test.expect(str.length, Test.beGreaterThan(5))</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="testbelessthan">Test.beLessThan<a href="#testbelessthan" class="hash-link" aria-label="Direct link to Test.beLessThan" title="Direct link to Test.beLessThan">​</a></h3>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>fun beLessThan(_ value: Number): Matcher</span></div></div><br></code></div></div>
<p>The <code>beLessThan</code> function returns a matcher that succeeds if the tested value is a number and
less than the given number.</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>import Test</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>access(all) fun testExample() {</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>    let str = &quot;Hello, there&quot;</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>    Test.expect(str.length, Test.beLessThan(15))</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="testbenil">Test.beNil<a href="#testbenil" class="hash-link" aria-label="Direct link to Test.beNil" title="Direct link to Test.beNil">​</a></h3>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>fun beNil(): Matcher</span></div></div><br></code></div></div>
<p>The <code>beNil</code> function returns a new matcher that checks if the given test value is nil.</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>import Test</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>access(all) fun testExample() {</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>    let message: String? = nil</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>    Test.expect(message, Test.beNil())</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="testbeempty">Test.beEmpty<a href="#testbeempty" class="hash-link" aria-label="Direct link to Test.beEmpty" title="Direct link to Test.beEmpty">​</a></h3>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>fun beEmpty(): Matcher</span></div></div><br></code></div></div>
<p>The <code>beEmpty</code> function returns a matcher that succeeds if the tested value is an array or dictionary,
and the tested value contains no elements.</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span>import Test</span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span>access(all) fun testExample() {</span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span>    let array: [String] = []</span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span>    Test.expect(array, Test.beEmpty())</span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span>    let dictionary: {String: String} = {}</span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span>    Test.expect(dictionary, Test.beEmpty())</span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="testhaveelementcount">Test.haveElementCount<a href="#testhaveelementcount" class="hash-link" aria-label="Direct link to Test.haveElementCount" title="Direct link to Test.haveElementCount">​</a></h3>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>fun haveElementCount(_ count: Int): Matcher</span></div></div><br></code></div></div>
<p>The <code>haveElementCount</code> function returns a matcher that succeeds if the tested value is an array or dictionary,
and has the given number of elements.</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span>import Test</span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span>access(all) fun testExample() {</span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span>    let array: [String] = [&quot;one&quot;, &quot;two&quot;, &quot;three&quot;]</span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span>    Test.expect(array, Test.haveElementCount(3))</span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span>    let dictionary: {String: Int} = {&quot;one&quot;: 1, &quot;two&quot;: 2, &quot;three&quot;: 3}</span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span>    Test.expect(dictionary, Test.haveElementCount(3))</span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="testcontain">Test.contain<a href="#testcontain" class="hash-link" aria-label="Direct link to Test.contain" title="Direct link to Test.contain">​</a></h3>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>fun contain(_ element: AnyStruct): Matcher</span></div></div><br></code></div></div>
<p>The <code>contain</code> function returns a matcher that succeeds if the tested value is an array that contains
a value that is equal to the given value, or the tested value is a dictionary
that contains an entry where the key is equal to the given value.</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>access(all) fun testExample() {</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>    let array: [String] = [&quot;one&quot;, &quot;two&quot;, &quot;three&quot;]</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>    Test.expect(array, Test.contain(&quot;one&quot;))</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>    let dictionary: {String: Int} = {&quot;one&quot;: 1, &quot;two&quot;: 2, &quot;three&quot;: 3}</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>    Test.expect(dictionary, Test.contain(&quot;two&quot;))</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="testbesucceeded">Test.beSucceeded<a href="#testbesucceeded" class="hash-link" aria-label="Direct link to Test.beSucceeded" title="Direct link to Test.beSucceeded">​</a></h3>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>fun beSucceeded(): Matcher</span></div></div><br></code></div></div>
<p>The <code>beSucceeded</code> function returns a new matcher that checks if the given test value is either
a ScriptResult or TransactionResult and the ResultStatus is succeeded.
Returns false in any other case.</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->12</span><div style="display:inline-block;margin-left:16px"><span>import Test</span></div></div><div><span class="ch-code-line-number">_<!-- -->12</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->12</span><div style="display:inline-block;margin-left:16px"><span>access(all) fun testExample() {</span></div></div><div><span class="ch-code-line-number">_<!-- -->12</span><div style="display:inline-block;margin-left:16px"><span>    let blockchain = Test.newEmulatorBlockchain()</span></div></div><div><span class="ch-code-line-number">_<!-- -->12</span><div style="display:inline-block;margin-left:16px"><span>    let result = blockchain.executeScript(</span></div></div><div><span class="ch-code-line-number">_<!-- -->12</span><div style="display:inline-block;margin-left:16px"><span>        &quot;access(all) fun main(): Int {  return 2 + 3 }&quot;,</span></div></div><div><span class="ch-code-line-number">_<!-- -->12</span><div style="display:inline-block;margin-left:16px"><span>        []</span></div></div><div><span class="ch-code-line-number">_<!-- -->12</span><div style="display:inline-block;margin-left:16px"><span>    )</span></div></div><div><span class="ch-code-line-number">_<!-- -->12</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->12</span><div style="display:inline-block;margin-left:16px"><span>    Test.expect(result, Test.beSucceeded())</span></div></div><div><span class="ch-code-line-number">_<!-- -->12</span><div style="display:inline-block;margin-left:16px"><span>    Test.assertEqual(5, result.returnValue! as! Int)</span></div></div><div><span class="ch-code-line-number">_<!-- -->12</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="testbefailed">Test.beFailed<a href="#testbefailed" class="hash-link" aria-label="Direct link to Test.beFailed" title="Direct link to Test.beFailed">​</a></h3>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>fun beFailed(): Matcher</span></div></div><br></code></div></div>
<p>The <code>beFailed</code> function returns a new matcher that checks if the given test value is either
a ScriptResult or TransactionResult and the ResultStatus is failed.
Returns false in any other case.</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->17</span><div style="display:inline-block;margin-left:16px"><span>import Test</span></div></div><div><span class="ch-code-line-number">_<!-- -->17</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->17</span><div style="display:inline-block;margin-left:16px"><span>access(all) fun testExample() {</span></div></div><div><span class="ch-code-line-number">_<!-- -->17</span><div style="display:inline-block;margin-left:16px"><span>    let blockchain = Test.newEmulatorBlockchain()</span></div></div><div><span class="ch-code-line-number">_<!-- -->17</span><div style="display:inline-block;margin-left:16px"><span>    let account = blockchain.createAccount()</span></div></div><div><span class="ch-code-line-number">_<!-- -->17</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->17</span><div style="display:inline-block;margin-left:16px"><span>    let tx = Test.Transaction(</span></div></div><div><span class="ch-code-line-number">_<!-- -->17</span><div style="display:inline-block;margin-left:16px"><span>        code: &quot;transaction { execute{ panic(\&quot;some error\&quot;) } }&quot;,</span></div></div><div><span class="ch-code-line-number">_<!-- -->17</span><div style="display:inline-block;margin-left:16px"><span>        authorizers: [],</span></div></div><div><span class="ch-code-line-number">_<!-- -->17</span><div style="display:inline-block;margin-left:16px"><span>        signers: [account],</span></div></div><div><span class="ch-code-line-number">_<!-- -->17</span><div style="display:inline-block;margin-left:16px"><span>        arguments: [],</span></div></div><div><span class="ch-code-line-number">_<!-- -->17</span><div style="display:inline-block;margin-left:16px"><span>    )</span></div></div><div><span class="ch-code-line-number">_<!-- -->17</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->17</span><div style="display:inline-block;margin-left:16px"><span>    let result = blockchain.executeTransaction(tx)</span></div></div><div><span class="ch-code-line-number">_<!-- -->17</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->17</span><div style="display:inline-block;margin-left:16px"><span>    Test.expect(result, Test.beFailed())</span></div></div><div><span class="ch-code-line-number">_<!-- -->17</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="matcher-combinators">Matcher combinators<a href="#matcher-combinators" class="hash-link" aria-label="Direct link to Matcher combinators" title="Direct link to Matcher combinators">​</a></h2>
<p>The built-in matchers, as well as custom matchers, can be combined with the three available combinators:</p>
<ul>
<li><code>not</code>,</li>
<li><code>or</code>,</li>
<li><code>and</code></li>
</ul>
<p>in order to create more elaborate matchers and increase re-usability.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="not">not<a href="#not" class="hash-link" aria-label="Direct link to not" title="Direct link to not">​</a></h3>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>fun not(_ matcher: Matcher): Matcher</span></div></div><br></code></div></div>
<p>The <code>not</code> function returns a new matcher that negates the test of the given matcher.</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->14</span><div style="display:inline-block;margin-left:16px"><span>import Test</span></div></div><div><span class="ch-code-line-number">_<!-- -->14</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->14</span><div style="display:inline-block;margin-left:16px"><span>access(all) fun testExample() {</span></div></div><div><span class="ch-code-line-number">_<!-- -->14</span><div style="display:inline-block;margin-left:16px"><span>    let isEven = Test.newMatcher&lt;Int&gt;(fun (_ value: Int): Bool {</span></div></div><div><span class="ch-code-line-number">_<!-- -->14</span><div style="display:inline-block;margin-left:16px"><span>        return value % 2 == 0</span></div></div><div><span class="ch-code-line-number">_<!-- -->14</span><div style="display:inline-block;margin-left:16px"><span>    })</span></div></div><div><span class="ch-code-line-number">_<!-- -->14</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->14</span><div style="display:inline-block;margin-left:16px"><span>    Test.expect(8, isEven)</span></div></div><div><span class="ch-code-line-number">_<!-- -->14</span><div style="display:inline-block;margin-left:16px"><span>    Test.expect(7, Test.not(isEven))</span></div></div><div><span class="ch-code-line-number">_<!-- -->14</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->14</span><div style="display:inline-block;margin-left:16px"><span>    let isNotEmpty = Test.not(Test.beEmpty())</span></div></div><div><span class="ch-code-line-number">_<!-- -->14</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->14</span><div style="display:inline-block;margin-left:16px"><span>    Test.expect([1, 2, 3], isNotEmpty)</span></div></div><div><span class="ch-code-line-number">_<!-- -->14</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="or">or<a href="#or" class="hash-link" aria-label="Direct link to or" title="Direct link to or">​</a></h3>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>fun or(_ other: Matcher): Matcher</span></div></div><br></code></div></div>
<p>The <code>Matcher.or</code> function combines this matcher with the given matcher.
Returns a new matcher that succeeds if this or the given matcher succeed.
If this matcher succeeds, then the other matcher would not be tested.</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>import Test</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>access(all) fun testExample() {</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>    let one = Test.equal(1)</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>    let two = Test.equal(2)</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>    let oneOrTwo = one.or(two)</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>    Test.expect(2, oneOrTwo)</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="and">and<a href="#and" class="hash-link" aria-label="Direct link to and" title="Direct link to and">​</a></h3>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>fun and(_ other: Matcher): Matcher</span></div></div><br></code></div></div>
<p>The <code>Matcher.and</code> function combines this matcher with the given matcher.
Returns a new matcher that succeeds if this and the given matcher succeed.</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->14</span><div style="display:inline-block;margin-left:16px"><span>import Test</span></div></div><div><span class="ch-code-line-number">_<!-- -->14</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->14</span><div style="display:inline-block;margin-left:16px"><span>access(all) fun testExample() {</span></div></div><div><span class="ch-code-line-number">_<!-- -->14</span><div style="display:inline-block;margin-left:16px"><span>    let sevenOrMore = Test.newMatcher&lt;Int&gt;(fun (_ value: Int): Bool {</span></div></div><div><span class="ch-code-line-number">_<!-- -->14</span><div style="display:inline-block;margin-left:16px"><span>        return value &gt;= 7</span></div></div><div><span class="ch-code-line-number">_<!-- -->14</span><div style="display:inline-block;margin-left:16px"><span>    })</span></div></div><div><span class="ch-code-line-number">_<!-- -->14</span><div style="display:inline-block;margin-left:16px"><span>    let lessThanTen = Test.newMatcher&lt;Int&gt;(fun (_ value: Int): Bool {</span></div></div><div><span class="ch-code-line-number">_<!-- -->14</span><div style="display:inline-block;margin-left:16px"><span>        return value &lt;= 10</span></div></div><div><span class="ch-code-line-number">_<!-- -->14</span><div style="display:inline-block;margin-left:16px"><span>    })</span></div></div><div><span class="ch-code-line-number">_<!-- -->14</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->14</span><div style="display:inline-block;margin-left:16px"><span>    let betweenSevenAndTen = sevenOrMore.and(lessThanTen)</span></div></div><div><span class="ch-code-line-number">_<!-- -->14</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->14</span><div style="display:inline-block;margin-left:16px"><span>    Test.expect(8, betweenSevenAndTen)</span></div></div><div><span class="ch-code-line-number">_<!-- -->14</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="blockchain">Blockchain<a href="#blockchain" class="hash-link" aria-label="Direct link to Blockchain" title="Direct link to Blockchain">​</a></h2>
<p>A blockchain is an environment to which transactions can be submitted to, and against which scripts can be run.
It imitates the behavior of a real network, for testing.</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>/// Blockchain emulates a real network.</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>///</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>access(all) struct Blockchain {</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    access(all) let backend: AnyStruct{BlockchainBackend}</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    init(backend: AnyStruct{BlockchainBackend}) {</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>        self.backend = backend</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    /// Executes a script and returns the script return value and the status.</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    /// `returnValue` field of the result will be `nil` if the script failed.</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    ///</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    access(all) fun executeScript(_ script: String, _ arguments: [AnyStruct]): ScriptResult {</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>        return self.backend.executeScript(script, arguments)</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    /// Creates a signer account by submitting an account creation transaction.</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    /// The transaction is paid by the service account.</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    /// The returned account can be used to sign and authorize transactions.</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    ///</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    access(all) fun createAccount(): Account {</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>        return self.backend.createAccount()</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    /// Add a transaction to the current block.</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    ///</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    access(all) fun addTransaction(_ tx: Transaction) {</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>        self.backend.addTransaction(tx)</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    /// Executes the next transaction in the block, if any.</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    /// Returns the result of the transaction, or nil if no transaction was scheduled.</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    ///</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    access(all) fun executeNextTransaction(): TransactionResult? {</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>        return self.backend.executeNextTransaction()</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    /// Commit the current block.</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    /// Committing will fail if there are un-executed transactions in the block.</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    ///</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    access(all) fun commitBlock() {</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>        self.backend.commitBlock()</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    /// Executes a given transaction and commits the current block.</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    ///</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    access(all) fun executeTransaction(_ tx: Transaction): TransactionResult {</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>        self.addTransaction(tx)</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>        let txResult = self.executeNextTransaction()!</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>        self.commitBlock()</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>        return txResult</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    /// Executes a given set of transactions and commits the current block.</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    ///</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    access(all) fun executeTransactions(_ transactions: [Transaction]): [TransactionResult] {</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>        for tx in transactions {</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>            self.addTransaction(tx)</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>        }</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>        var results: [TransactionResult] = []</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>        for tx in transactions {</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>            let txResult = self.executeNextTransaction()!</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>            results.append(txResult)</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>        }</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>        self.commitBlock()</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>        return results</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    /// Deploys a given contract, and initializes it with the arguments.</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    ///</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    access(all) fun deployContract(</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>        name: String,</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>        code: String,</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>        account: Account,</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>        arguments: [AnyStruct]</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    ): Error? {</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>        return self.backend.deployContract(</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>            name: name,</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>            code: code,</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>            account: account,</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>            arguments: arguments</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>        )</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    /// Set the configuration to be used by the blockchain.</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    /// Overrides any existing configuration.</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    ///</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    access(all) fun useConfiguration(_ configuration: Configuration) {</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>        self.backend.useConfiguration(configuration)</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    /// Returns all the logs from the blockchain, up to the calling point.</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    ///</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    access(all) fun logs(): [String] {</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>        return self.backend.logs()</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    /// Returns the service account of the blockchain. Can be used to sign</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    /// transactions with this account.</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    ///</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    access(all) fun serviceAccount(): Account {</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>        return self.backend.serviceAccount()</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    /// Returns all events emitted from the blockchain.</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    ///</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    access(all) fun events(): [AnyStruct] {</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>        return self.backend.events(nil)</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    /// Returns all events emitted from the blockchain,</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    /// filtered by type.</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    ///</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    access(all) fun eventsOfType(_ type: Type): [AnyStruct] {</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>        return self.backend.events(type)</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    /// Resets the state of the blockchain to the given height.</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    ///</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    access(all) fun reset(to height: UInt64) {</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>        self.backend.reset(to: height)</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    /// Moves the time of the blockchain by the given delta,</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    /// which should be passed in the form of seconds.</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    ///</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    access(all) fun moveTime(by delta: Fix64) {</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>        self.backend.moveTime(by: delta)</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->133</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<p>The <code>BlockchainBackend</code> provides the actual functionality of the blockchain.</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->33</span><div style="display:inline-block;margin-left:16px"><span>/// BlockchainBackend is the interface to be implemented by the backend providers.</span></div></div><div><span class="ch-code-line-number">_<!-- -->33</span><div style="display:inline-block;margin-left:16px"><span>///</span></div></div><div><span class="ch-code-line-number">_<!-- -->33</span><div style="display:inline-block;margin-left:16px"><span>access(all) struct interface BlockchainBackend {</span></div></div><div><span class="ch-code-line-number">_<!-- -->33</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->33</span><div style="display:inline-block;margin-left:16px"><span>    access(all) fun executeScript(_ script: String, _ arguments: [AnyStruct]): ScriptResult</span></div></div><div><span class="ch-code-line-number">_<!-- -->33</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->33</span><div style="display:inline-block;margin-left:16px"><span>    access(all) fun createAccount(): Account</span></div></div><div><span class="ch-code-line-number">_<!-- -->33</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->33</span><div style="display:inline-block;margin-left:16px"><span>    access(all) fun addTransaction(_ tx: Transaction)</span></div></div><div><span class="ch-code-line-number">_<!-- -->33</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->33</span><div style="display:inline-block;margin-left:16px"><span>    access(all) fun executeNextTransaction(): TransactionResult?</span></div></div><div><span class="ch-code-line-number">_<!-- -->33</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->33</span><div style="display:inline-block;margin-left:16px"><span>    access(all) fun commitBlock()</span></div></div><div><span class="ch-code-line-number">_<!-- -->33</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->33</span><div style="display:inline-block;margin-left:16px"><span>    access(all) fun deployContract(</span></div></div><div><span class="ch-code-line-number">_<!-- -->33</span><div style="display:inline-block;margin-left:16px"><span>        name: String,</span></div></div><div><span class="ch-code-line-number">_<!-- -->33</span><div style="display:inline-block;margin-left:16px"><span>        code: String,</span></div></div><div><span class="ch-code-line-number">_<!-- -->33</span><div style="display:inline-block;margin-left:16px"><span>        account: Account,</span></div></div><div><span class="ch-code-line-number">_<!-- -->33</span><div style="display:inline-block;margin-left:16px"><span>        arguments: [AnyStruct]</span></div></div><div><span class="ch-code-line-number">_<!-- -->33</span><div style="display:inline-block;margin-left:16px"><span>    ): Error?</span></div></div><div><span class="ch-code-line-number">_<!-- -->33</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->33</span><div style="display:inline-block;margin-left:16px"><span>    access(all) fun useConfiguration(_ configuration: Configuration)</span></div></div><div><span class="ch-code-line-number">_<!-- -->33</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->33</span><div style="display:inline-block;margin-left:16px"><span>    access(all) fun logs(): [String]</span></div></div><div><span class="ch-code-line-number">_<!-- -->33</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->33</span><div style="display:inline-block;margin-left:16px"><span>    access(all) fun serviceAccount(): Account</span></div></div><div><span class="ch-code-line-number">_<!-- -->33</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->33</span><div style="display:inline-block;margin-left:16px"><span>    access(all) fun events(_ type: Type?): [AnyStruct]</span></div></div><div><span class="ch-code-line-number">_<!-- -->33</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->33</span><div style="display:inline-block;margin-left:16px"><span>    access(all) fun reset(to height: UInt64)</span></div></div><div><span class="ch-code-line-number">_<!-- -->33</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->33</span><div style="display:inline-block;margin-left:16px"><span>    access(all) fun moveTime(by delta: Fix64)</span></div></div><div><span class="ch-code-line-number">_<!-- -->33</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="creating-a-blockchain">Creating a blockchain<a href="#creating-a-blockchain" class="hash-link" aria-label="Direct link to Creating a blockchain" title="Direct link to Creating a blockchain">​</a></h3>
<p>A new blockchain instance can be created using the <code>Test.newEmulatorBlockchain</code> method.
It returns a <code>Blockchain</code> which is backed by a new <a href="/docs/next/tools/emulator">Flow Emulator</a> instance.</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>import Test</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>access(all) let blockchain = Test.newEmulatorBlockchain()</span></div></div><br></code></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="creating-accounts">Creating accounts<a href="#creating-accounts" class="hash-link" aria-label="Direct link to Creating accounts" title="Direct link to Creating accounts">​</a></h3>
<p>It may be necessary to create accounts during tests for various reasons, such as for deploying contracts, signing transactions, etc.
An account can be created using the <code>createAccount</code> function.</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>import Test</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>access(all) let blockchain = Test.newEmulatorBlockchain()</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>access(all) let account = blockchain.createAccount()</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>access(all) fun testExample() {</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>    log(account.address)</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<p>Running the above command, from the command-line, we would get:</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>flow test tests/test_sample_usage.cdc</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>3:31PM DBG LOG: 0x01cf0e2f2f715450</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>Test results: &quot;tests/test_sample_usage.cdc&quot;</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>- PASS: testExample</span></div></div><br></code></div></div>
<p>The returned account consists of the <code>address</code> of the account, and a <code>publicKey</code> associated with it.</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span>/// Account represents info about the account created on the blockchain.</span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span>///</span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span>access(all) struct Account {</span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span>    access(all) let address: Address</span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span>    access(all) let publicKey: PublicKey</span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span>    init(address: Address, publicKey: PublicKey) {</span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span>        self.address = address</span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span>        self.publicKey = publicKey</span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="executing-scripts">Executing scripts<a href="#executing-scripts" class="hash-link" aria-label="Direct link to Executing scripts" title="Direct link to Executing scripts">​</a></h3>
<p>Scripts can be run with the <code>executeScript</code> function, which returns a <code>ScriptResult</code>.
The function takes script-code as the first argument, and the script-arguments as an array as the second argument.</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->19</span><div style="display:inline-block;margin-left:16px"><span>import Test</span></div></div><div><span class="ch-code-line-number">_<!-- -->19</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->19</span><div style="display:inline-block;margin-left:16px"><span>access(all) let blockchain = Test.newEmulatorBlockchain()</span></div></div><div><span class="ch-code-line-number">_<!-- -->19</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->19</span><div style="display:inline-block;margin-left:16px"><span>access(all) fun testExample() {</span></div></div><div><span class="ch-code-line-number">_<!-- -->19</span><div style="display:inline-block;margin-left:16px"><span>    let code = &quot;access(all) fun main(name: String): String { return \&quot;Hello, \&quot;.concat(name) }&quot;</span></div></div><div><span class="ch-code-line-number">_<!-- -->19</span><div style="display:inline-block;margin-left:16px"><span>    let args = [&quot;Peter&quot;]</span></div></div><div><span class="ch-code-line-number">_<!-- -->19</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->19</span><div style="display:inline-block;margin-left:16px"><span>    let scriptResult = blockchain.executeScript(code, args)</span></div></div><div><span class="ch-code-line-number">_<!-- -->19</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->19</span><div style="display:inline-block;margin-left:16px"><span>    // Assert that the script was successfully executed.</span></div></div><div><span class="ch-code-line-number">_<!-- -->19</span><div style="display:inline-block;margin-left:16px"><span>    Test.expect(scriptResult, Test.beSucceeded())</span></div></div><div><span class="ch-code-line-number">_<!-- -->19</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->19</span><div style="display:inline-block;margin-left:16px"><span>    // returnValue has always the type `AnyStruct`,</span></div></div><div><span class="ch-code-line-number">_<!-- -->19</span><div style="display:inline-block;margin-left:16px"><span>    // so we need to type-cast accordingly.</span></div></div><div><span class="ch-code-line-number">_<!-- -->19</span><div style="display:inline-block;margin-left:16px"><span>    let returnValue = scriptResult.returnValue! as! String</span></div></div><div><span class="ch-code-line-number">_<!-- -->19</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->19</span><div style="display:inline-block;margin-left:16px"><span>    Test.assertEqual(&quot;Hello, Peter&quot;, returnValue)</span></div></div><div><span class="ch-code-line-number">_<!-- -->19</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<p>The script result consists of the <code>status</code> of the script execution, and a <code>returnValue</code> if the script execution was
successful, or an <code>error</code> otherwise (see <a href="#errors">errors</a> section for more details on errors).</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->13</span><div style="display:inline-block;margin-left:16px"><span>/// The result of a script execution.</span></div></div><div><span class="ch-code-line-number">_<!-- -->13</span><div style="display:inline-block;margin-left:16px"><span>///</span></div></div><div><span class="ch-code-line-number">_<!-- -->13</span><div style="display:inline-block;margin-left:16px"><span>access(all) struct ScriptResult {</span></div></div><div><span class="ch-code-line-number">_<!-- -->13</span><div style="display:inline-block;margin-left:16px"><span>    access(all) let status: ResultStatus</span></div></div><div><span class="ch-code-line-number">_<!-- -->13</span><div style="display:inline-block;margin-left:16px"><span>    access(all) let returnValue: AnyStruct?</span></div></div><div><span class="ch-code-line-number">_<!-- -->13</span><div style="display:inline-block;margin-left:16px"><span>    access(all) let error: Error?</span></div></div><div><span class="ch-code-line-number">_<!-- -->13</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->13</span><div style="display:inline-block;margin-left:16px"><span>    init(status: ResultStatus, returnValue: AnyStruct?, error: Error?) {</span></div></div><div><span class="ch-code-line-number">_<!-- -->13</span><div style="display:inline-block;margin-left:16px"><span>        self.status = status</span></div></div><div><span class="ch-code-line-number">_<!-- -->13</span><div style="display:inline-block;margin-left:16px"><span>        self.returnValue = returnValue</span></div></div><div><span class="ch-code-line-number">_<!-- -->13</span><div style="display:inline-block;margin-left:16px"><span>        self.error = error</span></div></div><div><span class="ch-code-line-number">_<!-- -->13</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->13</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="executing-transactions">Executing transactions<a href="#executing-transactions" class="hash-link" aria-label="Direct link to Executing transactions" title="Direct link to Executing transactions">​</a></h3>
<p>A transaction must be created with the transaction code, a list of authorizes,
a list of signers that would sign the transaction, and the transaction arguments.</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->15</span><div style="display:inline-block;margin-left:16px"><span>/// Transaction that can be submitted and executed on the blockchain.</span></div></div><div><span class="ch-code-line-number">_<!-- -->15</span><div style="display:inline-block;margin-left:16px"><span>///</span></div></div><div><span class="ch-code-line-number">_<!-- -->15</span><div style="display:inline-block;margin-left:16px"><span>access(all) struct Transaction {</span></div></div><div><span class="ch-code-line-number">_<!-- -->15</span><div style="display:inline-block;margin-left:16px"><span>    access(all) let code: String</span></div></div><div><span class="ch-code-line-number">_<!-- -->15</span><div style="display:inline-block;margin-left:16px"><span>    access(all) let authorizers: [Address]</span></div></div><div><span class="ch-code-line-number">_<!-- -->15</span><div style="display:inline-block;margin-left:16px"><span>    access(all) let signers: [Account]</span></div></div><div><span class="ch-code-line-number">_<!-- -->15</span><div style="display:inline-block;margin-left:16px"><span>    access(all) let arguments: [AnyStruct]</span></div></div><div><span class="ch-code-line-number">_<!-- -->15</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->15</span><div style="display:inline-block;margin-left:16px"><span>    init(code: String, authorizers: [Address], signers: [Account], arguments: [AnyStruct]) {</span></div></div><div><span class="ch-code-line-number">_<!-- -->15</span><div style="display:inline-block;margin-left:16px"><span>        self.code = code</span></div></div><div><span class="ch-code-line-number">_<!-- -->15</span><div style="display:inline-block;margin-left:16px"><span>        self.authorizers = authorizers</span></div></div><div><span class="ch-code-line-number">_<!-- -->15</span><div style="display:inline-block;margin-left:16px"><span>        self.signers = signers</span></div></div><div><span class="ch-code-line-number">_<!-- -->15</span><div style="display:inline-block;margin-left:16px"><span>        self.arguments = arguments</span></div></div><div><span class="ch-code-line-number">_<!-- -->15</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->15</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<p>The number of authorizers must match the number of <code>AuthAccount</code> arguments in the <code>prepare</code> block of the transaction.</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->39</span><div style="display:inline-block;margin-left:16px"><span>import Test</span></div></div><div><span class="ch-code-line-number">_<!-- -->39</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->39</span><div style="display:inline-block;margin-left:16px"><span>access(all) let blockchain = Test.newEmulatorBlockchain()</span></div></div><div><span class="ch-code-line-number">_<!-- -->39</span><div style="display:inline-block;margin-left:16px"><span>access(all) let account = blockchain.createAccount()</span></div></div><div><span class="ch-code-line-number">_<!-- -->39</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->39</span><div style="display:inline-block;margin-left:16px"><span>// There are two ways to execute the created transaction.</span></div></div><div><span class="ch-code-line-number">_<!-- -->39</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->39</span><div style="display:inline-block;margin-left:16px"><span>access(all) fun testExample() {</span></div></div><div><span class="ch-code-line-number">_<!-- -->39</span><div style="display:inline-block;margin-left:16px"><span>    let tx = Test.Transaction(</span></div></div><div><span class="ch-code-line-number">_<!-- -->39</span><div style="display:inline-block;margin-left:16px"><span>        code: &quot;transaction { prepare(acct: AuthAccount) {} execute{} }&quot;,</span></div></div><div><span class="ch-code-line-number">_<!-- -->39</span><div style="display:inline-block;margin-left:16px"><span>        authorizers: [account.address],</span></div></div><div><span class="ch-code-line-number">_<!-- -->39</span><div style="display:inline-block;margin-left:16px"><span>        signers: [account],</span></div></div><div><span class="ch-code-line-number">_<!-- -->39</span><div style="display:inline-block;margin-left:16px"><span>        arguments: [],</span></div></div><div><span class="ch-code-line-number">_<!-- -->39</span><div style="display:inline-block;margin-left:16px"><span>    )</span></div></div><div><span class="ch-code-line-number">_<!-- -->39</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->39</span><div style="display:inline-block;margin-left:16px"><span>    // Executing the transaction immediately</span></div></div><div><span class="ch-code-line-number">_<!-- -->39</span><div style="display:inline-block;margin-left:16px"><span>    // This may fail if the current block contains</span></div></div><div><span class="ch-code-line-number">_<!-- -->39</span><div style="display:inline-block;margin-left:16px"><span>    // transactions that have not being executed yet.</span></div></div><div><span class="ch-code-line-number">_<!-- -->39</span><div style="display:inline-block;margin-left:16px"><span>    let txResult = blockchain.executeTransaction(tx)</span></div></div><div><span class="ch-code-line-number">_<!-- -->39</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->39</span><div style="display:inline-block;margin-left:16px"><span>    Test.expect(txResult, Test.beSucceeded())</span></div></div><div><span class="ch-code-line-number">_<!-- -->39</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><span class="ch-code-line-number">_<!-- -->39</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->39</span><div style="display:inline-block;margin-left:16px"><span>access(all) fun testExampleTwo() {</span></div></div><div><span class="ch-code-line-number">_<!-- -->39</span><div style="display:inline-block;margin-left:16px"><span>    let tx = Test.Transaction(</span></div></div><div><span class="ch-code-line-number">_<!-- -->39</span><div style="display:inline-block;margin-left:16px"><span>        code: &quot;transaction { prepare(acct: AuthAccount) {} execute{} }&quot;,</span></div></div><div><span class="ch-code-line-number">_<!-- -->39</span><div style="display:inline-block;margin-left:16px"><span>        authorizers: [account.address],</span></div></div><div><span class="ch-code-line-number">_<!-- -->39</span><div style="display:inline-block;margin-left:16px"><span>        signers: [account],</span></div></div><div><span class="ch-code-line-number">_<!-- -->39</span><div style="display:inline-block;margin-left:16px"><span>        arguments: [],</span></div></div><div><span class="ch-code-line-number">_<!-- -->39</span><div style="display:inline-block;margin-left:16px"><span>    )</span></div></div><div><span class="ch-code-line-number">_<!-- -->39</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->39</span><div style="display:inline-block;margin-left:16px"><span>    // Add to the current block</span></div></div><div><span class="ch-code-line-number">_<!-- -->39</span><div style="display:inline-block;margin-left:16px"><span>    blockchain.addTransaction(tx)</span></div></div><div><span class="ch-code-line-number">_<!-- -->39</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->39</span><div style="display:inline-block;margin-left:16px"><span>    // Execute the next transaction in the block</span></div></div><div><span class="ch-code-line-number">_<!-- -->39</span><div style="display:inline-block;margin-left:16px"><span>    let txResult = blockchain.executeNextTransaction()!</span></div></div><div><span class="ch-code-line-number">_<!-- -->39</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->39</span><div style="display:inline-block;margin-left:16px"><span>    Test.expect(txResult, Test.beSucceeded())</span></div></div><div><span class="ch-code-line-number">_<!-- -->39</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<p>The result of a transaction consists of the status of the execution, and an <code>Error</code> if the transaction failed.</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span>/// The result of a transaction execution.</span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span>///</span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span>access(all) struct TransactionResult {</span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span>    access(all) let status: ResultStatus</span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span>    access(all) let error: Error?</span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span>    init(status: ResultStatus, error: Error?) {</span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span>        self.status = status</span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span>        self.error = error</span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span> }</span></div></div><br></code></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="commit-block">Commit block<a href="#commit-block" class="hash-link" aria-label="Direct link to Commit block" title="Direct link to Commit block">​</a></h3>
<p><code>commitBlock</code> block will commit the current block, and will fail if there are any un-executed transactions in the block.</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->20</span><div style="display:inline-block;margin-left:16px"><span>import Test</span></div></div><div><span class="ch-code-line-number">_<!-- -->20</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->20</span><div style="display:inline-block;margin-left:16px"><span>access(all) let blockchain = Test.newEmulatorBlockchain()</span></div></div><div><span class="ch-code-line-number">_<!-- -->20</span><div style="display:inline-block;margin-left:16px"><span>access(all) let account = blockchain.createAccount()</span></div></div><div><span class="ch-code-line-number">_<!-- -->20</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->20</span><div style="display:inline-block;margin-left:16px"><span>access(all) fun testExample() {</span></div></div><div><span class="ch-code-line-number">_<!-- -->20</span><div style="display:inline-block;margin-left:16px"><span>    let tx = Test.Transaction(</span></div></div><div><span class="ch-code-line-number">_<!-- -->20</span><div style="display:inline-block;margin-left:16px"><span>        code: &quot;transaction { prepare(acct: AuthAccount) {} execute{} }&quot;,</span></div></div><div><span class="ch-code-line-number">_<!-- -->20</span><div style="display:inline-block;margin-left:16px"><span>        authorizers: [account.address],</span></div></div><div><span class="ch-code-line-number">_<!-- -->20</span><div style="display:inline-block;margin-left:16px"><span>        signers: [account],</span></div></div><div><span class="ch-code-line-number">_<!-- -->20</span><div style="display:inline-block;margin-left:16px"><span>        arguments: [],</span></div></div><div><span class="ch-code-line-number">_<!-- -->20</span><div style="display:inline-block;margin-left:16px"><span>    )</span></div></div><div><span class="ch-code-line-number">_<!-- -->20</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->20</span><div style="display:inline-block;margin-left:16px"><span>    blockchain.commitBlock()</span></div></div><div><span class="ch-code-line-number">_<!-- -->20</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->20</span><div style="display:inline-block;margin-left:16px"><span>    blockchain.addTransaction(tx)</span></div></div><div><span class="ch-code-line-number">_<!-- -->20</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->20</span><div style="display:inline-block;margin-left:16px"><span>    // This will fail with `error: internal error: pending block with ID 1f9...c0b7740d2 cannot be committed before execution`</span></div></div><div><span class="ch-code-line-number">_<!-- -->20</span><div style="display:inline-block;margin-left:16px"><span>    blockchain.commitBlock()</span></div></div><div><span class="ch-code-line-number">_<!-- -->20</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="deploying-contracts">Deploying contracts<a href="#deploying-contracts" class="hash-link" aria-label="Direct link to Deploying contracts" title="Direct link to Deploying contracts">​</a></h3>
<p>A contract can be deployed using the <code>deployContract</code> function of the <code>Blockchain</code>.</p>
<p>Suppose we have this contract (<code>Foo.cdc</code>):</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span>access(all) contract Foo {</span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span>    access(all) let msg: String</span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span>    init(_ msg: String) {</span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span>        self.msg = msg</span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span>    access(all) fun sayHello(): String {</span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span>        return self.msg</span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->11</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->16</span><div style="display:inline-block;margin-left:16px"><span>import Test</span></div></div><div><span class="ch-code-line-number">_<!-- -->16</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->16</span><div style="display:inline-block;margin-left:16px"><span>access(all) let blockchain = Test.newEmulatorBlockchain()</span></div></div><div><span class="ch-code-line-number">_<!-- -->16</span><div style="display:inline-block;margin-left:16px"><span>access(all) let account = blockchain.createAccount()</span></div></div><div><span class="ch-code-line-number">_<!-- -->16</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->16</span><div style="display:inline-block;margin-left:16px"><span>access(all) fun testExample() {</span></div></div><div><span class="ch-code-line-number">_<!-- -->16</span><div style="display:inline-block;margin-left:16px"><span>    let contractCode = Test.readFile(&quot;Foo.cdc&quot;)</span></div></div><div><span class="ch-code-line-number">_<!-- -->16</span><div style="display:inline-block;margin-left:16px"><span>    let err = blockchain.deployContract(</span></div></div><div><span class="ch-code-line-number">_<!-- -->16</span><div style="display:inline-block;margin-left:16px"><span>        name: &quot;Foo&quot;,</span></div></div><div><span class="ch-code-line-number">_<!-- -->16</span><div style="display:inline-block;margin-left:16px"><span>        code: contractCode,</span></div></div><div><span class="ch-code-line-number">_<!-- -->16</span><div style="display:inline-block;margin-left:16px"><span>        account: account,</span></div></div><div><span class="ch-code-line-number">_<!-- -->16</span><div style="display:inline-block;margin-left:16px"><span>        arguments: [&quot;hello from args&quot;],</span></div></div><div><span class="ch-code-line-number">_<!-- -->16</span><div style="display:inline-block;margin-left:16px"><span>    )</span></div></div><div><span class="ch-code-line-number">_<!-- -->16</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->16</span><div style="display:inline-block;margin-left:16px"><span>    Test.expect(err, Test.beNil())</span></div></div><div><span class="ch-code-line-number">_<!-- -->16</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<p>An <code>Error</code> is returned if the contract deployment fails. Otherwise, a <code>nil</code> is returned.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="configuring-import-addresses">Configuring import addresses<a href="#configuring-import-addresses" class="hash-link" aria-label="Direct link to Configuring import addresses" title="Direct link to Configuring import addresses">​</a></h3>
<p>A common pattern in Cadence projects is to define the imports as file locations and specify the addresses
corresponding to each network in the <a href="/docs/next/tools/flow-cli/flow.json/configuration#contracts">Flow CLI configuration file</a>.
When writing tests for such a project, it may also require to specify the addresses to be used during the tests as well.
However, during tests, since accounts are created dynamically and the addresses are also generated dynamically,
specifying the addresses statically in a configuration file is not an option.</p>
<p>Hence, the test framework provides a way to specify the addresses using the
<code>useConfiguration(_ configuration: Test.Configuration)</code> function in <code>Blockchain</code>.</p>
<p>The <code>Configuration</code> struct consists of a mapping of import locations to their addresses.</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>/// Configuration to be used by the blockchain.</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>/// Can be used to set the address mapping.</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>///</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>access(all) struct Configuration {</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>    access(all) let addresses: {String: Address}</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>    init(addresses: {String: Address}) {</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>        self.addresses = addresses</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<div class="theme-admonition theme-admonition-info alert alert--info admonition_WoCw"><div class="admonitionHeading_TMsN"><span class="admonitionIcon_Ibzs"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_vXIg"><p>The <code>Blockchain.useConfiguration</code> is a run-time alternative for
<a href="/docs/next/tools/flow-cli/flow.json/configuration#advanced-format">statically defining contract addresses in the flow.json config file</a>.</p></div></div>
<p>The configurations can be specified during the test setup as a best-practice.</p>
<p>e.g: Assume running a script that imports the above <code>Foo.cdc</code> contract.
The import location for the contract can be specified using the placeholder <code>&quot;Foo&quot;</code>.
This placeholder can be any unique string.</p>
<p>Suppose this script is saved in <code>say_hello.cdc</code>.</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>import &quot;Foo&quot;</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>access(all) fun main(): String {</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>    return Foo.sayHello()</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<p>Then, before executing the script, the address mapping can be specified as follows:</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>import Test</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>access(all) let blockchain = Test.newEmulatorBlockchain()</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>access(all) let account = blockchain.createAccount()</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>access(all) fun setup() {</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>    blockchain.useConfiguration(Test.Configuration({</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>        &quot;Foo&quot;: account.address</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>    }))</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>    let contractCode = Test.readFile(&quot;Foo.cdc&quot;)</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>    let err = blockchain.deployContract(</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>        name: &quot;Foo&quot;,</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>        code: contractCode,</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>        account: account,</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>        arguments: [&quot;hello from args&quot;],</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>    )</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>    Test.expect(err, Test.beNil())</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>access(all) fun testExample() {</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>    let script = Test.readFile(&quot;say_hello.cdc&quot;)</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>    let scriptResult = blockchain.executeScript(script, [])</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>    Test.expect(scriptResult, Test.beSucceeded())</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>    let returnValue = scriptResult.returnValue! as! String</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>    Test.assertEqual(&quot;hello from args&quot;, returnValue)</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<p>The subsequent operations on the blockchain (e.g: contract deployment, script/transaction execution) will resolve the
import locations to the provided addresses.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="errors">Errors<a href="#errors" class="hash-link" aria-label="Direct link to Errors" title="Direct link to Errors">​</a></h3>
<p>An <code>Error</code> maybe returned when an operation (such as executing a script, executing a transaction, etc.) has failed.
It contains a message indicating why the operation failed.</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>// Error is returned if something has gone wrong.</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>//</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>access(all) struct Error {</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>    access(all) let message: String</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>    init(_ message: String) {</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>        self.message = message</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<p>An <code>Error</code> can be asserted against its presence or absence.</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>import Test</span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>access(all) let blockchain = Test.newEmulatorBlockchain()</span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>access(all) let account = blockchain.createAccount()</span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>access(all) fun testExample() {</span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>    let script = Test.readFile(&quot;say_hello.cdc&quot;)</span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>    let scriptResult = blockchain.executeScript(script, [])</span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>    // If we expect a script to fail, we can use Test.beFailed() instead</span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>    Test.expect(scriptResult, Test.beSucceeded())</span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>    let tx = Test.Transaction(</span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>        code: &quot;transaction { prepare(acct: AuthAccount) {} execute{} }&quot;,</span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>        authorizers: [account.address],</span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>        signers: [account],</span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>        arguments: [],</span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>    )</span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>    let txResult = blockchain.executeTransaction(tx)</span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>    // If we expect a transaction to fail, we can use Test.beFailed() instead</span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>    Test.expect(txResult, Test.beSucceeded())</span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>    let err: Test.Error? = txResult.error</span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>    if err != nil {</span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>        log(err!.message)</span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="blockchain-events">Blockchain events<a href="#blockchain-events" class="hash-link" aria-label="Direct link to Blockchain events" title="Direct link to Blockchain events">​</a></h2>
<p>We can also assert that certain events were emitted from the blockchain, up to the latest block.</p>
<p>Suppose we have this contract (<code>Foo.cdc</code>):</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->14</span><div style="display:inline-block;margin-left:16px"><span>access(all) contract Foo {</span></div></div><div><span class="ch-code-line-number">_<!-- -->14</span><div style="display:inline-block;margin-left:16px"><span>    access(all) let msg: String</span></div></div><div><span class="ch-code-line-number">_<!-- -->14</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->14</span><div style="display:inline-block;margin-left:16px"><span>    access(all) event ContractInitialized(msg: String)</span></div></div><div><span class="ch-code-line-number">_<!-- -->14</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->14</span><div style="display:inline-block;margin-left:16px"><span>    init(_ msg: String) {</span></div></div><div><span class="ch-code-line-number">_<!-- -->14</span><div style="display:inline-block;margin-left:16px"><span>        self.msg = msg</span></div></div><div><span class="ch-code-line-number">_<!-- -->14</span><div style="display:inline-block;margin-left:16px"><span>        emit ContractInitialized(msg: self.msg)</span></div></div><div><span class="ch-code-line-number">_<!-- -->14</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->14</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->14</span><div style="display:inline-block;margin-left:16px"><span>    access(all) fun sayHello(): String {</span></div></div><div><span class="ch-code-line-number">_<!-- -->14</span><div style="display:inline-block;margin-left:16px"><span>        return self.msg</span></div></div><div><span class="ch-code-line-number">_<!-- -->14</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->14</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>import Test</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>access(all) let blockchain = Test.newEmulatorBlockchain()</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>access(all) let account = blockchain.createAccount()</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>access(all) fun setup() {</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>    blockchain.useConfiguration(Test.Configuration({</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>        &quot;Foo&quot;: account.address</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>    }))</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>    let contractCode = Test.readFile(&quot;Foo.cdc&quot;)</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>    let err = blockchain.deployContract(</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>        name: &quot;Foo&quot;,</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>        code: contractCode,</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>        account: account,</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>        arguments: [&quot;hello from args&quot;],</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>    )</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>    Test.expect(err, Test.beNil())</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>    // As of now, we have to construct the composite type by hand,</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>    // until the testing framework allows developers to import</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>    // contract types, e.g.:</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>    // let typ = Type&lt;FooContract.ContractInitialized&gt;()</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>    let typ = CompositeType(&quot;A.01cf0e2f2f715450.Foo.ContractInitialized&quot;)!</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>    let events = blockchain.eventsOfType(typ)</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>    Test.assertEqual(1, events.length)</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>    // We can also fetch all events emitted from the blockchain</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>    log(blockchain.events())</span></div></div><div><span class="ch-code-line-number">_<!-- -->31</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="commonly-used-contracts">Commonly used contracts<a href="#commonly-used-contracts" class="hash-link" aria-label="Direct link to Commonly used contracts" title="Direct link to Commonly used contracts">​</a></h2>
<p>The commonly used contracts are already deployed on the blockchain, and can be imported without any
additional setup.</p>
<p>Suppose this script is saved in <code>get_type_ids.cdc</code>.</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->16</span><div style="display:inline-block;margin-left:16px"><span>import &quot;FungibleToken&quot;</span></div></div><div><span class="ch-code-line-number">_<!-- -->16</span><div style="display:inline-block;margin-left:16px"><span>import &quot;FlowToken&quot;</span></div></div><div><span class="ch-code-line-number">_<!-- -->16</span><div style="display:inline-block;margin-left:16px"><span>import &quot;NonFungibleToken&quot;</span></div></div><div><span class="ch-code-line-number">_<!-- -->16</span><div style="display:inline-block;margin-left:16px"><span>import &quot;MetadataViews&quot;</span></div></div><div><span class="ch-code-line-number">_<!-- -->16</span><div style="display:inline-block;margin-left:16px"><span>import &quot;ViewResolver&quot;</span></div></div><div><span class="ch-code-line-number">_<!-- -->16</span><div style="display:inline-block;margin-left:16px"><span>import &quot;ExampleNFT&quot;</span></div></div><div><span class="ch-code-line-number">_<!-- -->16</span><div style="display:inline-block;margin-left:16px"><span>import &quot;NFTStorefrontV2&quot;</span></div></div><div><span class="ch-code-line-number">_<!-- -->16</span><div style="display:inline-block;margin-left:16px"><span>import &quot;NFTStorefront&quot;</span></div></div><div><span class="ch-code-line-number">_<!-- -->16</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->16</span><div style="display:inline-block;margin-left:16px"><span>access(all) fun main(): [String] {</span></div></div><div><span class="ch-code-line-number">_<!-- -->16</span><div style="display:inline-block;margin-left:16px"><span>    return [</span></div></div><div><span class="ch-code-line-number">_<!-- -->16</span><div style="display:inline-block;margin-left:16px"><span>        Type&lt;FlowToken&gt;().identifier,</span></div></div><div><span class="ch-code-line-number">_<!-- -->16</span><div style="display:inline-block;margin-left:16px"><span>        Type&lt;NonFungibleToken&gt;().identifier,</span></div></div><div><span class="ch-code-line-number">_<!-- -->16</span><div style="display:inline-block;margin-left:16px"><span>        Type&lt;MetadataViews&gt;().identifier</span></div></div><div><span class="ch-code-line-number">_<!-- -->16</span><div style="display:inline-block;margin-left:16px"><span>    ]</span></div></div><div><span class="ch-code-line-number">_<!-- -->16</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->20</span><div style="display:inline-block;margin-left:16px"><span>import Test</span></div></div><div><span class="ch-code-line-number">_<!-- -->20</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->20</span><div style="display:inline-block;margin-left:16px"><span>access(all) let blockchain = Test.newEmulatorBlockchain()</span></div></div><div><span class="ch-code-line-number">_<!-- -->20</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->20</span><div style="display:inline-block;margin-left:16px"><span>access(all) fun testExample() {</span></div></div><div><span class="ch-code-line-number">_<!-- -->20</span><div style="display:inline-block;margin-left:16px"><span>    let script = Test.readFile(&quot;get_type_ids.cdc&quot;)</span></div></div><div><span class="ch-code-line-number">_<!-- -->20</span><div style="display:inline-block;margin-left:16px"><span>    let scriptResult = blockchain.executeScript(script, [])</span></div></div><div><span class="ch-code-line-number">_<!-- -->20</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->20</span><div style="display:inline-block;margin-left:16px"><span>    Test.expect(scriptResult, Test.beSucceeded())</span></div></div><div><span class="ch-code-line-number">_<!-- -->20</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->20</span><div style="display:inline-block;margin-left:16px"><span>    let returnValue = scriptResult.returnValue! as! [String]</span></div></div><div><span class="ch-code-line-number">_<!-- -->20</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->20</span><div style="display:inline-block;margin-left:16px"><span>    let expected = [</span></div></div><div><span class="ch-code-line-number">_<!-- -->20</span><div style="display:inline-block;margin-left:16px"><span>        &quot;A.0ae53cb6e3f42a79.FlowToken&quot;,</span></div></div><div><span class="ch-code-line-number">_<!-- -->20</span><div style="display:inline-block;margin-left:16px"><span>        &quot;A.f8d6e0586b0a20c7.NonFungibleToken&quot;,</span></div></div><div><span class="ch-code-line-number">_<!-- -->20</span><div style="display:inline-block;margin-left:16px"><span>        &quot;A.f8d6e0586b0a20c7.MetadataViews&quot;</span></div></div><div><span class="ch-code-line-number">_<!-- -->20</span><div style="display:inline-block;margin-left:16px"><span>    ]</span></div></div><div><span class="ch-code-line-number">_<!-- -->20</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->20</span><div style="display:inline-block;margin-left:16px"><span>    Test.assertEqual(expected, returnValue)</span></div></div><div><span class="ch-code-line-number">_<!-- -->20</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="reading-from-files">Reading from files<a href="#reading-from-files" class="hash-link" aria-label="Direct link to Reading from files" title="Direct link to Reading from files">​</a></h2>
<p>Writing tests often require constructing source-code of contracts/transactions/scripts in the test script.
Testing framework provides a convenient way to load programs from a local file, without having to manually construct
them within the test script.</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>let contractCode = Test.readFile(&quot;./sample/contracts/FooContract.cdc&quot;)</span></div></div><br></code></div></div>
<p><code>readFile</code> returns the content of the file as a string.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="logging">Logging<a href="#logging" class="hash-link" aria-label="Direct link to Logging" title="Direct link to Logging">​</a></h2>
<p>The <code>log</code> function is available for usage both in test scripts, as well as contracts/scripts/transactions.</p>
<p>The <code>Blockchain.logs()</code> method aggregates all logs from contracts/scripts/transactions.</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->18</span><div style="display:inline-block;margin-left:16px"><span>import Test</span></div></div><div><span class="ch-code-line-number">_<!-- -->18</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->18</span><div style="display:inline-block;margin-left:16px"><span>access(all) let blockchain = Test.newEmulatorBlockchain()</span></div></div><div><span class="ch-code-line-number">_<!-- -->18</span><div style="display:inline-block;margin-left:16px"><span>access(all) let account = blockchain.createAccount()</span></div></div><div><span class="ch-code-line-number">_<!-- -->18</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->18</span><div style="display:inline-block;margin-left:16px"><span>access(all) fun testExample() {</span></div></div><div><span class="ch-code-line-number">_<!-- -->18</span><div style="display:inline-block;margin-left:16px"><span>    let tx = Test.Transaction(</span></div></div><div><span class="ch-code-line-number">_<!-- -->18</span><div style="display:inline-block;margin-left:16px"><span>        code: &quot;transaction { prepare(acct: AuthAccount) {} execute{ log(\&quot;in a transaction\&quot;) } }&quot;,</span></div></div><div><span class="ch-code-line-number">_<!-- -->18</span><div style="display:inline-block;margin-left:16px"><span>        authorizers: [account.address],</span></div></div><div><span class="ch-code-line-number">_<!-- -->18</span><div style="display:inline-block;margin-left:16px"><span>        signers: [account],</span></div></div><div><span class="ch-code-line-number">_<!-- -->18</span><div style="display:inline-block;margin-left:16px"><span>        arguments: [],</span></div></div><div><span class="ch-code-line-number">_<!-- -->18</span><div style="display:inline-block;margin-left:16px"><span>    )</span></div></div><div><span class="ch-code-line-number">_<!-- -->18</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->18</span><div style="display:inline-block;margin-left:16px"><span>    let txResult = blockchain.executeTransaction(tx)</span></div></div><div><span class="ch-code-line-number">_<!-- -->18</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->18</span><div style="display:inline-block;margin-left:16px"><span>    Test.expect(txResult, Test.beSucceeded())</span></div></div><div><span class="ch-code-line-number">_<!-- -->18</span><div style="display:inline-block;margin-left:16px"><span>    Test.assertEqual([&quot;in a transaction&quot;], blockchain.logs())</span></div></div><div><span class="ch-code-line-number">_<!-- -->18</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="examples">Examples<a href="#examples" class="hash-link" aria-label="Direct link to Examples" title="Direct link to Examples">​</a></h2>
<p>This <a href="https://github.com/m-Peter/flow-code-coverage" target="_blank" rel="noopener noreferrer">repository</a> contains some functional examples
that demonstrate most of the above features, both for contrived and real-world smart contracts.
It also contains a detailed explanation on using code coverage from within the testing framework.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/onflow/docs/tree/main/docs/cadence/testing-framework.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2023-09-19T02:09:25.000Z">Sep 19, 2023</time></b> by <b>Alex</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/next/cadence/measuring-time"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Measuring Time</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#test-standard-library" class="table-of-contents__link toc-highlight">Test Standard Library</a></li><li><a href="#assertions" class="table-of-contents__link toc-highlight">Assertions</a><ul><li><a href="#testassert" class="table-of-contents__link toc-highlight">Test.assert</a></li><li><a href="#testfail" class="table-of-contents__link toc-highlight">Test.fail</a></li><li><a href="#testexpect" class="table-of-contents__link toc-highlight">Test.expect</a></li><li><a href="#testassertequal" class="table-of-contents__link toc-highlight">Test.assertEqual</a></li><li><a href="#testexpectfailure" class="table-of-contents__link toc-highlight">Test.expectFailure</a></li></ul></li><li><a href="#matchers" class="table-of-contents__link toc-highlight">Matchers</a><ul><li><a href="#testequal" class="table-of-contents__link toc-highlight">Test.equal</a></li><li><a href="#testbegreaterthan" class="table-of-contents__link toc-highlight">Test.beGreaterThan</a></li><li><a href="#testbelessthan" class="table-of-contents__link toc-highlight">Test.beLessThan</a></li><li><a href="#testbenil" class="table-of-contents__link toc-highlight">Test.beNil</a></li><li><a href="#testbeempty" class="table-of-contents__link toc-highlight">Test.beEmpty</a></li><li><a href="#testhaveelementcount" class="table-of-contents__link toc-highlight">Test.haveElementCount</a></li><li><a href="#testcontain" class="table-of-contents__link toc-highlight">Test.contain</a></li><li><a href="#testbesucceeded" class="table-of-contents__link toc-highlight">Test.beSucceeded</a></li><li><a href="#testbefailed" class="table-of-contents__link toc-highlight">Test.beFailed</a></li></ul></li><li><a href="#matcher-combinators" class="table-of-contents__link toc-highlight">Matcher combinators</a><ul><li><a href="#not" class="table-of-contents__link toc-highlight">not</a></li><li><a href="#or" class="table-of-contents__link toc-highlight">or</a></li><li><a href="#and" class="table-of-contents__link toc-highlight">and</a></li></ul></li><li><a href="#blockchain" class="table-of-contents__link toc-highlight">Blockchain</a><ul><li><a href="#creating-a-blockchain" class="table-of-contents__link toc-highlight">Creating a blockchain</a></li><li><a href="#creating-accounts" class="table-of-contents__link toc-highlight">Creating accounts</a></li><li><a href="#executing-scripts" class="table-of-contents__link toc-highlight">Executing scripts</a></li><li><a href="#executing-transactions" class="table-of-contents__link toc-highlight">Executing transactions</a></li><li><a href="#commit-block" class="table-of-contents__link toc-highlight">Commit block</a></li><li><a href="#deploying-contracts" class="table-of-contents__link toc-highlight">Deploying contracts</a></li><li><a href="#configuring-import-addresses" class="table-of-contents__link toc-highlight">Configuring import addresses</a></li><li><a href="#errors" class="table-of-contents__link toc-highlight">Errors</a></li></ul></li><li><a href="#blockchain-events" class="table-of-contents__link toc-highlight">Blockchain events</a></li><li><a href="#commonly-used-contracts" class="table-of-contents__link toc-highlight">Commonly used contracts</a></li><li><a href="#reading-from-files" class="table-of-contents__link toc-highlight">Reading from files</a></li><li><a href="#logging" class="table-of-contents__link toc-highlight">Logging</a></li><li><a href="#examples" class="table-of-contents__link toc-highlight">Examples</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Documentation</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/getting-started">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/tools">SDK&#x27;s &amp; Tools</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/cadence/intro">Cadence</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/building-on-flow/mobile">Mobile</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/tools/clients/fcl-js">FCL</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/tools/flow-js-testing">JS Testing Library</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/tools/flow-cli">CLI</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/tools/emulator">Emulator</a></li><li class="footer__item"><a href="https://github.com/onflow/fcl-dev-wallet" target="_blank" rel="noopener noreferrer" class="footer__link-item">Dev Wallet<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/docs/tools/vscode-extension">VS Code Extension</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/community-resources">Ecosystem</a></li><li class="footer__item"><a href="https://port.onflow.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Flow Port<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/onflow/developer-grants" target="_blank" rel="noopener noreferrer" class="footer__link-item">Developer Grants<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://flow.com/flow-responsible-disclosure" target="_blank" rel="noopener noreferrer" class="footer__link-item">Responsible Disclosure<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://forum.onflow.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Forum<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.flowverse.co/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Flowverse<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://academy.ecdao.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Emerald Academy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://floats.city/" target="_blank" rel="noopener noreferrer" class="footer__link-item">FLOATs (Attendance NFTs)<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Start Building</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://play.onflow.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Flow Playground<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/docs/cadence/tutorial/first-steps">Cadence Tutorials</a></li><li class="footer__item"><a href="https://open-cadence.onflow.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Cadence Cookbook<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/docs/build/core-contracts">Core Contracts &amp; Standards</a></li><li class="footer__item"><a href="https://academy.ecdao.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Emerald DAO Bootcamp<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Network</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://status.onflow.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Network Status<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://flowscan.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Flowscan Mainnet<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://testnet.flowscan.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Flowscan Testnet<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/docs/node-ops/node-operation/past-sporks">Past Sporks</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/node-ops/node-operation/upcoming-sporks">Upcoming Sporks</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/node-ops/node-operation">Node Operation</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/node-ops/node-operation/spork">Spork Information</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/onflow" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://onflow.org/discord" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://forum.onflow.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Forum<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://onflow.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">OnFlow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://flow.com/blog" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Flow, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/docs/assets/js/runtime~main.98ec6519.js"></script>
<script src="/docs/assets/js/main.0789a803.js"></script>
</body>
</html>