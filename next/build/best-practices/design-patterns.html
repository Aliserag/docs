<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-build/best-practices/design-patterns">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.0">
<title data-rh="true">Cadence Design Patterns | Flow Developer Portal</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://onflow.github.io/docs/img/FlowDocs_Logo_FlowLogo_Horizontal_Green_BlackText.svg"><meta data-rh="true" name="twitter:image" content="https://onflow.github.io/docs/img/FlowDocs_Logo_FlowLogo_Horizontal_Green_BlackText.svg"><meta data-rh="true" property="og:url" content="https://onflow.github.io/docs/next/build/best-practices/design-patterns"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Cadence Design Patterns | Flow Developer Portal"><meta data-rh="true" name="description" content="This is a selection of software design patterns developed by core Flow developers"><meta data-rh="true" property="og:description" content="This is a selection of software design patterns developed by core Flow developers"><link data-rh="true" rel="icon" href="/docs/favicon.ico"><link data-rh="true" rel="canonical" href="https://onflow.github.io/docs/next/build/best-practices/design-patterns"><link data-rh="true" rel="alternate" href="https://onflow.github.io/docs/next/build/best-practices/design-patterns" hreflang="en"><link data-rh="true" rel="alternate" href="https://onflow.github.io/docs/next/build/best-practices/design-patterns" hreflang="x-default"><link rel="search" type="application/opensearchdescription+xml" title="Flow Developer Portal" href="/docs/opensearch.xml">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous">
<script src="/mixpanel.js" async onload="if (&#39;776159d170484f49f19c3c2f7339f297&#39; &amp;&amp; &#39;776159d170484f49f19c3c2f7339f297&#39; !== &#39;undefined&#39;) {
  window.mixpanel.init(&#39;776159d170484f49f19c3c2f7339f297&#39;);

  const viwedPayload = {
    &#39;Page Name&#39;: document.title,
    &#39;Page URL&#39;: window.location.pathname,
  }
  window.mixpanel.track(&#39;Page Viewed&#39;, viwedPayload);

  const playUrl = &#39;play.onflow.org&#39;;
  const links = document.querySelectorAll(&#39;a&#39;) || [];
  const isPlayPage = Array.from(links).some((link) =&gt; link.href.includes(playUrl));

  if (isPlayPage) {
    window.mixpanel.track(&#39;Play Page Viewed&#39;, viwedPayload);
  }
  
  window.document.addEventListener(&#39;click&#39;, function (event) {
    var target = event.target;
  
    // Check if the clicked element is a link with an href attribute
    if (target.tagName === &#39;A&#39; &amp;&amp; target.hasAttribute(&#39;href&#39;)) {
      if (window.mixpanel) {
        const payload = {
          href: target.getAttribute(&#39;href&#39;),
          id: target.id,
          class: target.className,
        }
        window.mixpanel.track(&#39;Link clicked&#39;, payload);
        const isPlay = payload.href.includes(&#39;play.onflow.org&#39;);
        if (isPlay) {
          window.mixpanel.track(&#39;Play Link clicked&#39;, payload);        
        }
      }
    }
  });
}"></script>
<script src="https://widget.kapa.ai/kapa-widget.bundle.js" data-website-id="0f0b3ed1-7761-4986-851e-09336ea6ef1c" data-project-name="Flow" data-project-color="#2E8555" data-project-logo="https://cryptologos.cc/logos/flow-flow-logo.png" async></script>
<script src="/hotjar.js" async></script>
<script src="https://widget.kapa.ai/kapa-widget.bundle.js" data-website-id="0f0b3ed1-7761-4986-851e-09336ea6ef1c" data-project-name="Flow" data-project-color="#2E8555" data-project-logo="https://cryptologos.cc/logos/flow-flow-logo.png" async></script><link rel="stylesheet" href="/docs/assets/css/styles.8d07a146.css">
<link rel="preload" href="/docs/assets/js/runtime~main.03b096d0.js" as="script">
<link rel="preload" href="/docs/assets/js/main.cc7ab7d7.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs/"><div class="navbar__logo"><img src="/docs/img/flow-docs-logo-dark.png" alt="Flow Developer Portal Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/docs/img/flow-docs-logo-light.png" alt="Flow Developer Portal Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" href="/docs/concepts/start-here">Concepts</a><a class="navbar__item navbar__link" href="/docs/building-on-flow">Build</a><a class="navbar__item navbar__link" href="/docs/guides">Guides</a><a class="navbar__item navbar__link" href="/docs/cadence/intro">Cadence</a><a class="navbar__item navbar__link" href="/docs/tools">Tools</a><a class="navbar__item navbar__link" href="/docs/references">References</a><a class="navbar__item navbar__link" href="/docs/community-resources">Resources</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/docs/next/overview">Next</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/docs/next/build/best-practices/design-patterns">Next</a></li><li><a class="dropdown__link" href="/docs/concepts/start-here">Current</a></li></ul></div><a href="https://github.com/onflow" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link h-8 desktop:p-1"><img src="" alt="GitHub" id="navbar-github" class="box-content h-32 w-32"><span class="p-2 desktop:hidden">Github</span></a><a href="https://onflow.org/discord" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link h-8 desktop:p-1"><img src="" alt="Discord" id="navbar-discord" class="box-content h-32 w-32"><span class="p-2 desktop:hidden">Discord</span></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/next/build">index</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/next/build/key-concepts/blocks">Concepts</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/next/build/core-contracts">Flow Core Contracts</a><button aria-label="Toggle the collapsible sidebar category &#x27;Flow Core Contracts&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/next/build/advanced-concepts/account-linking">advanced-concepts</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/next/build/best-practices/design-patterns">best-practices</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/next/build/best-practices/design-patterns">Design Patterns</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/build/best-practices/anti-patterns">Anti-Patterns</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/build/best-practices/security-best-practices">Security Best Practices</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/build/best-practices/contract-upgrades">Contract Upgrades with Incompatible Changes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/build/best-practices/project-development-tips">Development Standards</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/next/build/getting-started/hello-world/tutorial/first-steps">getting-started</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is unreleased documentation for <!-- -->Flow Developer Portal<!-- --> <b>Next</b> version.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/docs/concepts/start-here">latest version</a></b> (<!-- -->Current<!-- -->).</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">best-practices</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Design Patterns</span><meta itemprop="position" content="2"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: Next</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Cadence Design Patterns</h1></header><p>This is a selection of software design patterns developed by core Flow developers
while writing Cadence code for deployment to Flow Mainnet.</p>
<p>Many of these design patters apply to most other programming languages, but some are specific to Cadence.</p>
<p><a href="https://en.wikipedia.org/wiki/Software_design_pattern" target="_blank" rel="noopener noreferrer">Design patterns</a> are building blocks for software development.
They may provide a solution to a problem that you encounter when writing smart contracts in Cadence.
If they do not clearly fit, these patterns may not be the right solution for a given situation or problem.
They are not meant to be rules to be followed strictly, especially where a better solution presents itself.</p>
<h1>General</h1>
<p>These are general patterns to follow when writing smart contracts.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="use-named-value-fields-for-constants-instead-of-hard-coding">Use named value fields for constants instead of hard-coding<a href="#use-named-value-fields-for-constants-instead-of-hard-coding" class="hash-link" aria-label="Direct link to Use named value fields for constants instead of hard-coding" title="Direct link to Use named value fields for constants instead of hard-coding">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="problem">Problem<a href="#problem" class="hash-link" aria-label="Direct link to Problem" title="Direct link to Problem">​</a></h3>
<p>Your contracts, resources, and scripts all have to refer to the same value.
A number, a string, a storage path, etc.
Entering these values manually in transactions and scripts is a potential source of error.
See <a href="https://en.wikipedia.org/wiki/Magic_number_(programming)" target="_blank" rel="noopener noreferrer">Wikipedia&#x27;s page on magic numbers</a></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="solution">Solution<a href="#solution" class="hash-link" aria-label="Direct link to Solution" title="Direct link to Solution">​</a></h3>
<p>Add a public (<code>access(all)</code>), constant (<code>let</code>) field, e.g. a <code>Path</code> , to the contract responsible for the value,
and set it in the contract&#x27;s initializer.
Refer to that value via this public field rather than specifying it manually.</p>
<p>Example Snippet:</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->25</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->25</span><div style="display:inline-block;margin-left:16px"><span>// BAD Practice: Do not hard code storage paths</span></div></div><div><span class="ch-code-line-number">_<!-- -->25</span><div style="display:inline-block;margin-left:16px"><span>access(all) contract NamedFields {</span></div></div><div><span class="ch-code-line-number">_<!-- -->25</span><div style="display:inline-block;margin-left:16px"><span>    access(all) resource Test {}</span></div></div><div><span class="ch-code-line-number">_<!-- -->25</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->25</span><div style="display:inline-block;margin-left:16px"><span>    init() {</span></div></div><div><span class="ch-code-line-number">_<!-- -->25</span><div style="display:inline-block;margin-left:16px"><span>        // BAD: Hard-coded storage path</span></div></div><div><span class="ch-code-line-number">_<!-- -->25</span><div style="display:inline-block;margin-left:16px"><span>        self.account.save(&lt;-create Test(), to: /storage/testStorage)</span></div></div><div><span class="ch-code-line-number">_<!-- -->25</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->25</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><span class="ch-code-line-number">_<!-- -->25</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->25</span><div style="display:inline-block;margin-left:16px"><span>// GOOD practice: Instead, use a field</span></div></div><div><span class="ch-code-line-number">_<!-- -->25</span><div style="display:inline-block;margin-left:16px"><span>//</span></div></div><div><span class="ch-code-line-number">_<!-- -->25</span><div style="display:inline-block;margin-left:16px"><span>access(all) contract NamedFields {</span></div></div><div><span class="ch-code-line-number">_<!-- -->25</span><div style="display:inline-block;margin-left:16px"><span>    access(all) resource Test {}</span></div></div><div><span class="ch-code-line-number">_<!-- -->25</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->25</span><div style="display:inline-block;margin-left:16px"><span>    // GOOD: field storage path</span></div></div><div><span class="ch-code-line-number">_<!-- -->25</span><div style="display:inline-block;margin-left:16px"><span>    access(all) let TestStoragePath: StoragePath</span></div></div><div><span class="ch-code-line-number">_<!-- -->25</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->25</span><div style="display:inline-block;margin-left:16px"><span>    init() {</span></div></div><div><span class="ch-code-line-number">_<!-- -->25</span><div style="display:inline-block;margin-left:16px"><span>        // assign and access the field here and in transactions</span></div></div><div><span class="ch-code-line-number">_<!-- -->25</span><div style="display:inline-block;margin-left:16px"><span>        self.TestStoragePath = /storage/testStorage</span></div></div><div><span class="ch-code-line-number">_<!-- -->25</span><div style="display:inline-block;margin-left:16px"><span>        self.account.save(&lt;-create Test(), to: self.TestStoragePath)</span></div></div><div><span class="ch-code-line-number">_<!-- -->25</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->25</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<p><a href="https://github.com/onflow/flow-core-contracts/blob/master/contracts/LockedTokens.cdc#L718" target="_blank" rel="noopener noreferrer">Example Code</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="script-accessible-public-fieldfunction">Script-Accessible public field/function<a href="#script-accessible-public-fieldfunction" class="hash-link" aria-label="Direct link to Script-Accessible public field/function" title="Direct link to Script-Accessible public field/function">​</a></h2>
<p>Data availability is important in a blockchain environment.
It is useful to publicize information about your smart contract and the assets it controls
so other smart contracts and apps can easily query it.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="problem-1">Problem<a href="#problem-1" class="hash-link" aria-label="Direct link to Problem" title="Direct link to Problem">​</a></h3>
<p>Your contract, resource or struct has a field or resource that will need to be read and used on or off-chain, often in bulk.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="solution-1">Solution<a href="#solution-1" class="hash-link" aria-label="Direct link to Solution" title="Direct link to Solution">​</a></h3>
<p>Make sure that the field can be accessed from a script (using a <code>PublicAccount</code>)
rather than requiring a transaction (using an <code>AuthAccount</code>).
This saves the time and fees required to read a property using a transaction.
Making the field or function <code>access(all)</code> and exposing it via a <code>/public/</code> capability will allow this.</p>
<p>Be careful not to expose any data or functionality that should be kept private when doing so.</p>
<p>Example:</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>// BAD: Field is private, so it cannot be read by the public</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>access(self) let totalSupply: UFix64</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>// GOOD: Field is public, so it can be read and used by anyone</span></div></div><div><span class="ch-code-line-number">_<!-- -->10</span><div style="display:inline-block;margin-left:16px"><span>access(all) let totalSupply: UFix64</span></div></div><br></code></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="script-accessible-report">Script-Accessible report<a href="#script-accessible-report" class="hash-link" aria-label="Direct link to Script-Accessible report" title="Direct link to Script-Accessible report">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="problem-2">Problem<a href="#problem-2" class="hash-link" aria-label="Direct link to Problem" title="Direct link to Problem">​</a></h3>
<p>Your contract has a resource that you wish to access fields of.
Resources are often stored in private places and are hard to access.
Additionally, scripts cannot return resources to the external context,
so a struct must be used to hold the data.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="solution-2">Solution<a href="#solution-2" class="hash-link" aria-label="Direct link to Solution" title="Direct link to Solution">​</a></h3>
<p>Return a reference to a resource if the data from a single resource is all that is needed.
Otherwise, declare a struct to hold the data that you wish to return from the script.
Write a function that fills out the fields of this struct with the data
from the resource that you wish to access.
Then call this on the resource that you wish to access the fields of in a script,
and return the struct from the script.</p>
<p>See <a href="#script-accessible-public-fieldfunction">Script-Accessible public field/function</a>, above, for how best to expose this capability.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-code">Example Code<a href="#example-code" class="hash-link" aria-label="Direct link to Example Code" title="Direct link to Example Code">​</a></h3>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>access(all) contract AContract {</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>    access(all) let BResourceStoragePath: StoragePath</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>    access(all) let BResourcePublicPath: PublicPath</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>    init() {</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>        self.BResourceStoragePath = /storage/BResource</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>        self.BResourcePublicPath = /public/BResource</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>    // Resource definition</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>    access(all) resource BResource {</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>        access(all) var c: UInt64</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>        access(all) var d: String</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>        // Generate a struct with the same fields</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>        // to return when a script wants to see the fields of the resource</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>        // without having to return the actual resource</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>        access(all) fun generateReport(): BReportStruct {</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>            return BReportStruct(c: self.c, d: self.d)</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>        }</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>        init(c: UInt64, d: String) {</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>            self.c = c</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>            self.d = d</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>        }</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>    // Define a struct with the same fields as the resource</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>    access(all) struct BReportStruct {</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>        access(all) var c: UInt64</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>        access(all) var d: String</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>        init(c: UInt64, d: String) {</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>            self.c = c</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>            self.d = d</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>        }</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>...</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>// Transaction</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>import AContract from 0xAContract</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>transaction {</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>        prepare(acct: AuthAccount) {</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>            //...</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>            acct.link&lt;&amp;AContract.BResource&gt;(AContract.BResourcePublicPath, target: AContract.BResourceStoragePath)</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>        }</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>// Script</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>import AContract from 0xAContract</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>// Return the struct with a script</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>access(all) fun main(account: Address): AContract.BReportStruct {</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>    // borrow the resource</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>    let b = getAccount(account)</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>        .getCapability(AContract.BResourcePublicPath)</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>        .borrow&lt;&amp;AContract.BResource&gt;()</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>    // return the struct</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>    return b.generateReport()</span></div></div><div><span class="ch-code-line-number">_<!-- -->62</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="init-singleton">Init Singleton<a href="#init-singleton" class="hash-link" aria-label="Direct link to Init Singleton" title="Direct link to Init Singleton">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="problem-3">Problem<a href="#problem-3" class="hash-link" aria-label="Direct link to Problem" title="Direct link to Problem">​</a></h3>
<p>An admin resource must be created and delivered to a specified account.
There should not be a function to do this, as that would allow anyone to create an admin resource.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="solution-3">Solution<a href="#solution-3" class="hash-link" aria-label="Direct link to Solution" title="Direct link to Solution">​</a></h3>
<p>Create any one-off resources in the contract&#x27;s <code>init()</code> function
and deliver them to an address or <code>AuthAccount</code> specified as an argument.</p>
<p>See how this is done in the LockedTokens contract init function:</p>
<p><a href="https://github.com/onflow/flow-core-contracts/blob/master/contracts/LockedTokens.cdc#L718" target="_blank" rel="noopener noreferrer">LockedTokens.cdc</a></p>
<p>and in the transaction that is used to deploy it:</p>
<p><a href="https://github.com/onflow/flow-core-contracts/blob/master/transactions/lockedTokens/admin/admin_deploy_contract.cdc" target="_blank" rel="noopener noreferrer">admin_deploy_contract.cdc</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="use-descriptive-names-for-fields-paths-functions-and-variables">Use descriptive names for fields, paths, functions and variables<a href="#use-descriptive-names-for-fields-paths-functions-and-variables" class="hash-link" aria-label="Direct link to Use descriptive names for fields, paths, functions and variables" title="Direct link to Use descriptive names for fields, paths, functions and variables">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="problem-4">Problem<a href="#problem-4" class="hash-link" aria-label="Direct link to Problem" title="Direct link to Problem">​</a></h3>
<p>Smart contracts often are vitally important pieces of a project and often have many other
smart contracts and applications that rely on them.
Therefore, they need to be clearly written and easy to understand.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="solution-4">Solution<a href="#solution-4" class="hash-link" aria-label="Direct link to Solution" title="Direct link to Solution">​</a></h3>
<p>All fields, functions, types, variables, etc., need to have names that clearly describe what they are used for.</p>
<p><code>account</code> / <code>accounts</code> is better than <code>array</code> / <code>element</code>.</p>
<p><code>providerAccount</code> / <code>tokenRecipientAccount</code> is better than <code>acct1</code> / <code>acct2</code>.</p>
<p><code>/storage/bestPracticesDocsCollectionPath</code> is better than <code>/storage/collection</code></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="example">Example<a href="#example" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">​</a></h3>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>// BAD: Unclear naming</span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>//</span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>access(all) contract Tax {</span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>    // Do not use abbreviations unless absolutely necessary</span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>    access(all) var pcnt: UFix64</span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>    // Not clear what the function is calculating or what the parameter should be</span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>    access(all) fun calculate(num: UFix64): UFix64 {</span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>        // What total is this referring to?</span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>        let total = num + (num * self.pcnt)</span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>        return total</span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>// GOOD: Clear naming</span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>//</span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>access(all) contract TaxUtilities {</span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>    // Clearly states what the field is for</span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>    access(all) var taxPercentage: UFix64</span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>    // Clearly states that this function calculates the</span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>    // total cost after tax</span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>    access(all) fun calculateTotalCostPlusTax(preTaxCost: UFix64): UFix64 {</span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>        let postTaxCost = preTaxCost + (preTaxCost * self.taxPercentage)</span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>        return postTaxCost</span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->29</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="include-concrete-types-in-type-constraints-especially-any-types">Include concrete types in type constraints, especially &quot;Any&quot; types<a href="#include-concrete-types-in-type-constraints-especially-any-types" class="hash-link" aria-label="Direct link to Include concrete types in type constraints, especially &quot;Any&quot; types" title="Direct link to Include concrete types in type constraints, especially &quot;Any&quot; types">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="problem-5">Problem<a href="#problem-5" class="hash-link" aria-label="Direct link to Problem" title="Direct link to Problem">​</a></h3>
<p>When specifying type constraints for capabilities or borrows, concrete types often do not get specified,
making it unclear if the developer actually intended it to be unspecified or not.
Paths also use a shared namespace between contracts, so an account may have stored a different object
in a path that you would expect to be used for something else.
Therefore, it is important to be explicit when getting objects or references to resources.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="solution-5">Solution<a href="#solution-5" class="hash-link" aria-label="Direct link to Solution" title="Direct link to Solution">​</a></h3>
<p>A good example of when the code should specify the type is checking the FLOW balance:
The code must borrow <code>&amp;FlowToken.Vault</code>, in order to ensure that it gets a FLOW token balance,
and not just <code>&amp;{FungibleToken.Balance}</code>, any balance – the user could store another object
that conforms to the balance interface and return whatever value as the amount.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="plural-names-for-arrays-and-maps-are-preferable">Plural names for arrays and maps are preferable<a href="#plural-names-for-arrays-and-maps-are-preferable" class="hash-link" aria-label="Direct link to Plural names for arrays and maps are preferable" title="Direct link to Plural names for arrays and maps are preferable">​</a></h2>
<p>e.g. <code>accounts</code> rather than <code>account</code> for an array of accounts.</p>
<p>This signals that the field or variable is not scalar.
It also makes it easier to use the singular form for a variable name during iteration.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="use-transaction-post-conditions-when-applicable">Use transaction post-conditions when applicable<a href="#use-transaction-post-conditions-when-applicable" class="hash-link" aria-label="Direct link to Use transaction post-conditions when applicable" title="Direct link to Use transaction post-conditions when applicable">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="problem-6">Problem<a href="#problem-6" class="hash-link" aria-label="Direct link to Problem" title="Direct link to Problem">​</a></h3>
<p>Transactions can contain any amount of valid Cadence code and access many contracts and accounts.
The power of resources and capabilities means that there may be some behaviors of programs that are not expected.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="solution-6">Solution<a href="#solution-6" class="hash-link" aria-label="Direct link to Solution" title="Direct link to Solution">​</a></h3>
<p>It is usually safe to include post-conditions in transactions to verify the intended outcome.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-1">Example<a href="#example-1" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">​</a></h3>
<p>This could be used when purchasing an NFT to verify that the NFT was deposited in your account&#x27;s collection.</p>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->21</span><div style="display:inline-block;margin-left:16px"><span>// Psuedo-code</span></div></div><div><span class="ch-code-line-number">_<!-- -->21</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->21</span><div style="display:inline-block;margin-left:16px"><span>transaction {</span></div></div><div><span class="ch-code-line-number">_<!-- -->21</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->21</span><div style="display:inline-block;margin-left:16px"><span>    access(all) let buyerCollectionRef: &amp;NonFungibleToken.Collection</span></div></div><div><span class="ch-code-line-number">_<!-- -->21</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->21</span><div style="display:inline-block;margin-left:16px"><span>    prepare(acct: AuthAccount) {</span></div></div><div><span class="ch-code-line-number">_<!-- -->21</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->21</span><div style="display:inline-block;margin-left:16px"><span>        // Get tokens to buy and a collection to deposit the bought NFT to</span></div></div><div><span class="ch-code-line-number">_<!-- -->21</span><div style="display:inline-block;margin-left:16px"><span>        let temporaryVault &lt;- vaultRef.withdraw(amount: 10.0)</span></div></div><div><span class="ch-code-line-number">_<!-- -->21</span><div style="display:inline-block;margin-left:16px"><span>        let self.buyerCollectionRef = acct.borrow(from: /storage/Collection)</span></div></div><div><span class="ch-code-line-number">_<!-- -->21</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->21</span><div style="display:inline-block;margin-left:16px"><span>        // purchase, supplying the buyers collection reference</span></div></div><div><span class="ch-code-line-number">_<!-- -->21</span><div style="display:inline-block;margin-left:16px"><span>        saleRef.purchase(tokenID: 1, recipient: self.buyerCollectionRef, buyTokens: &lt;-temporaryVault)</span></div></div><div><span class="ch-code-line-number">_<!-- -->21</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->21</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->21</span><div style="display:inline-block;margin-left:16px"><span>    post {</span></div></div><div><span class="ch-code-line-number">_<!-- -->21</span><div style="display:inline-block;margin-left:16px"><span>        // verify that the buyer now owns the NFT</span></div></div><div><span class="ch-code-line-number">_<!-- -->21</span><div style="display:inline-block;margin-left:16px"><span>        self.buyerCollectionRef.idExists(1) == true: &quot;Bought NFT ID was not deposited into the buyers collection&quot;</span></div></div><div><span class="ch-code-line-number">_<!-- -->21</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->21</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="avoid-excessive-load-and-save-storage-operations-prefer-in-place-mutations">Avoid excessive load and save storage operations (prefer in-place mutations)<a href="#avoid-excessive-load-and-save-storage-operations-prefer-in-place-mutations" class="hash-link" aria-label="Direct link to Avoid excessive load and save storage operations (prefer in-place mutations)" title="Direct link to Avoid excessive load and save storage operations (prefer in-place mutations)">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="problem-7">Problem<a href="#problem-7" class="hash-link" aria-label="Direct link to Problem" title="Direct link to Problem">​</a></h3>
<p>When modifying data in account storage, <code>load()</code> and <code>save()</code> are costly operations.
This can quickly cause your transaction to reach the gas limit or slow down the network.</p>
<p>This also applies to contract objects and their fields (which are implicitly stored in storage, i.e. read from/written to),
or nested resources. Loading them from their fields just to modify them and save them back
is just as costly.</p>
<p>For example, a collection contains a dictionary of NFTs. There is no need to move the whole dictionary out of the field,
update the dictionary on the stack (e.g. adding or removing an NFT),
and then move the whole dictionary back to the field, it can be updated in-place.
The same goes for a more complex data structure like a dictionary of nested resources:
Each resource can be updated in-place by taking a reference to the nested object instead of loading and saving.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="solution-7">Solution<a href="#solution-7" class="hash-link" aria-label="Direct link to Solution" title="Direct link to Solution">​</a></h3>
<p>For making modifications to values in storage or accessing stored objects,
<code>borrow()</code> should always be used to access them instead of <code>load</code> or <code>save</code> unless absolutely necessary.
<code>borrow()</code> returns a reference to the object at the storage path instead of having to load the entire object.
This reference can be assigned to or can be used to access fields or call methods on stored objects.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-2">Example<a href="#example-2" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">​</a></h3>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>// BAD: Loads and stores a resource to use it</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>//</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>transaction {</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>    prepare(acct: AuthAccount) {</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>        // Removes the vault from storage, a costly operation</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>        let vault &lt;- acct.load&lt;@ExampleToken.Vault&gt;(from: /storage/exampleToken)</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>        // Withdraws tokens</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>        let burnVault &lt;- vault.withdraw(amount: 10)</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>        destroy burnVault</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>        // Saves the used vault back to storage, another costly operation</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>        acct.save(to: /storage/exampleToken)</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>// GOOD: Uses borrow instead to avoid costly operations</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>//</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>transaction {</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>    prepare(acct: AuthAccount) {</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>        // Borrows a reference to the stored vault, much less costly operation</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>        let vault &lt;- acct.borrow&lt;&amp;ExampleToken.Vault&gt;(from: /storage/exampleToken)</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>        let burnVault &lt;- vault.withdraw(amount: 10)</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>        destroy burnVault</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>        // No `save` required because we only used a reference</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->36</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div>
<h1>Capabilities</h1>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="capability-bootstrapping">Capability Bootstrapping<a href="#capability-bootstrapping" class="hash-link" aria-label="Direct link to Capability Bootstrapping" title="Direct link to Capability Bootstrapping">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="problem-8">Problem<a href="#problem-8" class="hash-link" aria-label="Direct link to Problem" title="Direct link to Problem">​</a></h3>
<p>An account must be given a <a href="/docs/next/cadence/language/capabilities">capability</a>
to a resource or contract in another account. To create, i.e. link the capability,
the transaction must be signed by a key which has access to the target account.</p>
<p>To transfer / deliver the capability to the other account, the transaction also needs write access to that one.
It is not as easy to produce a single transaction which is authorized by two accounts
as it is to produce a typical transaction which is authorized by one account.</p>
<p>This prevents a single transaction from fetching the capability
from one account and delivering it to the other.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="solution-8">Solution<a href="#solution-8" class="hash-link" aria-label="Direct link to Solution" title="Direct link to Solution">​</a></h3>
<p>The solution to the bootstrapping problem in Cadence is provided by the <a href="/docs/next/cadence/language/accounts/inbox">Inbox API</a></p>
<p>Account A (which we will call the provider) creates the capability they wish to send to B (which we will call the recipient),
and stores this capability on their account in a place where the recipient can access it using the <code>Inbox.publish</code> function on their account.
They choose a name for the capability that the recipient can later use to identify it, and specify the recipient&#x27;s address when calling <code>publish</code>.
This call to <code>publish</code> will emit an <code>InboxValuePublished</code> event that the recipient can listen for off-chain to know that the Capability is ready for them to claim.</p>
<p>The recipient then later can use the <code>Inbox.claim</code> function to securely grab the capability from the provider&#x27;s account.
They must provide the name and type with which the capability was published, as well as the address of the provider&#x27;s account
(all of this information is available in the <code>InboxValuePublished</code> event emitted on <code>publish</code>).
This will remove the capability from the provider&#x27;s account and emit an <code>InboxValueClaimed</code> event that the provider can listen for off-chain.</p>
<p>One important caveat to this is that the published capability is stored on the provider&#x27;s account until the recipient claims it,
so the provider can also use the <code>Inbox.unpublish</code> function to remove the capability from their account if they no longer wish to pay for storage for it.
This also requires the name and type which the capability was published,
and emits an <code>InboxValueUnpublished</code> event that the recipient can listen for off-chain.</p>
<p>It is also important to note that the recipient becomes the owner of the capability object once they have claimed it,
and can thus store it or copy it anywhere they have access to.
This means providers should only publish capabilities to recipients they trust to use them properly,
or limit the type with which the capability is authorized in order to only give recipients access to the functionality
that the provider is willing to allow them to copy.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="capability-revocation">Capability Revocation<a href="#capability-revocation" class="hash-link" aria-label="Direct link to Capability Revocation" title="Direct link to Capability Revocation">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="problem-9">Problem<a href="#problem-9" class="hash-link" aria-label="Direct link to Problem" title="Direct link to Problem">​</a></h3>
<p>A capability provided by one account to a second account must able to be revoked
by the first account without the co-operation of the second.</p>
<p>See the <a href="https://github.com/onflow/flow/pull/798" target="_blank" rel="noopener noreferrer">Capability Controller FLIP</a> for a proposal to improve this in the future.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="solution-9">Solution<a href="#solution-9" class="hash-link" aria-label="Direct link to Solution" title="Direct link to Solution">​</a></h3>
<p>The first account should create the capability as a link to a capability in <code>/private/</code>,
which then links to a resource in <code>/storage/</code>. That second-order link is then handed
to the second account as the capability for them to use.</p>
<p><strong>Account 1:</strong> <code>/private/capability</code> → <code>/storage/resource</code></p>
<p><code>/private/revokableLink</code> -&gt; <code>/private/capability</code></p>
<p><strong>Account 2:</strong> <code>/storage/capability -&gt; (Capability(→Account 1: /private/revokableLink))</code></p>
<p>If the first account wants to revoke access to the resource in storage,
they should delete the <code>/private/</code> link that the second account&#x27;s capability refers to.
Capabilities use paths rather than resource identifiers, so this will break the capability.</p>
<p>The first account should be careful not to create another link at the same location
in its private storage once the capability has been revoked,
otherwise this will restore the second account&#x27;s capability.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="check-for-existing-links-before-creating-new-ones">Check for existing links before creating new ones<a href="#check-for-existing-links-before-creating-new-ones" class="hash-link" aria-label="Direct link to Check for existing links before creating new ones" title="Direct link to Check for existing links before creating new ones">​</a></h2>
<p>When linking a capability, the link might be already present.
In that case, Cadence will not panic with a runtime error but the link function will return nil.
The documentation states that: The link function does not check if the target path is valid/exists
at the time the capability is created and does not check if the target value conforms to the given type.
In that sense, it is a good practice to check if the link does already exist with <code>AuthAccount.getLinkTarget</code>
before creating it with <code>AuthAccount.link()</code>.
<code>AuthAccount.getLinkTarget</code> will return nil if the link does not exist.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-3">Example<a href="#example-3" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">​</a></h3>
<div class="ch-codeblock not-prose"><div class="ch-code" style="margin:0;padding:0;position:relative;white-space:pre;box-sizing:content-box;opacity:0;overflow:auto"><code class="ch-code-scroll-parent"><br><div><span class="ch-code-line-number">_<!-- -->17</span><div style="display:inline-block;margin-left:16px"><span>transaction {</span></div></div><div><span class="ch-code-line-number">_<!-- -->17</span><div style="display:inline-block;margin-left:16px"><span>    prepare(signer: AuthAccount) {</span></div></div><div><span class="ch-code-line-number">_<!-- -->17</span><div style="display:inline-block;margin-left:16px"><span>        // Create a public capability to the Vault that only exposes</span></div></div><div><span class="ch-code-line-number">_<!-- -->17</span><div style="display:inline-block;margin-left:16px"><span>        // the deposit function through the Receiver interface</span></div></div><div><span class="ch-code-line-number">_<!-- -->17</span><div style="display:inline-block;margin-left:16px"><span>        //</span></div></div><div><span class="ch-code-line-number">_<!-- -->17</span><div style="display:inline-block;margin-left:16px"><span>        // Check to see if there is a link already and unlink it if there is</span></div></div><div><span class="ch-code-line-number">_<!-- -->17</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->17</span><div style="display:inline-block;margin-left:16px"><span>        if signer.getLinkTarget(/public/exampleTokenReceiver) != nil {</span></div></div><div><span class="ch-code-line-number">_<!-- -->17</span><div style="display:inline-block;margin-left:16px"><span>            signer.unlink(/public/exampleTokenReceiver)</span></div></div><div><span class="ch-code-line-number">_<!-- -->17</span><div style="display:inline-block;margin-left:16px"><span>        }</span></div></div><div><span class="ch-code-line-number">_<!-- -->17</span><div style="display:inline-block;margin-left:16px"><span></span></div></div><div><span class="ch-code-line-number">_<!-- -->17</span><div style="display:inline-block;margin-left:16px"><span>        signer.link&lt;&amp;ExampleToken.Vault&gt;(</span></div></div><div><span class="ch-code-line-number">_<!-- -->17</span><div style="display:inline-block;margin-left:16px"><span>            /public/exampleTokenReceiver,</span></div></div><div><span class="ch-code-line-number">_<!-- -->17</span><div style="display:inline-block;margin-left:16px"><span>            target: /storage/exampleTokenVault</span></div></div><div><span class="ch-code-line-number">_<!-- -->17</span><div style="display:inline-block;margin-left:16px"><span>        )</span></div></div><div><span class="ch-code-line-number">_<!-- -->17</span><div style="display:inline-block;margin-left:16px"><span>    }</span></div></div><div><span class="ch-code-line-number">_<!-- -->17</span><div style="display:inline-block;margin-left:16px"><span>}</span></div></div><br></code></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/onflow/docs/tree/main/docs/build/best-practices/design-patterns.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2023-09-18T17:11:06.000Z">Sep 18, 2023</time></b> by <b>Alex</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/next/build/advanced-concepts/account-linking/parent-accounts"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Working With Parent Accounts</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/next/build/best-practices/anti-patterns"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Anti-Patterns</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#use-named-value-fields-for-constants-instead-of-hard-coding" class="table-of-contents__link toc-highlight">Use named value fields for constants instead of hard-coding</a><ul><li><a href="#problem" class="table-of-contents__link toc-highlight">Problem</a></li><li><a href="#solution" class="table-of-contents__link toc-highlight">Solution</a></li></ul></li><li><a href="#script-accessible-public-fieldfunction" class="table-of-contents__link toc-highlight">Script-Accessible public field/function</a><ul><li><a href="#problem-1" class="table-of-contents__link toc-highlight">Problem</a></li><li><a href="#solution-1" class="table-of-contents__link toc-highlight">Solution</a></li></ul></li><li><a href="#script-accessible-report" class="table-of-contents__link toc-highlight">Script-Accessible report</a><ul><li><a href="#problem-2" class="table-of-contents__link toc-highlight">Problem</a></li><li><a href="#solution-2" class="table-of-contents__link toc-highlight">Solution</a></li><li><a href="#example-code" class="table-of-contents__link toc-highlight">Example Code</a></li></ul></li><li><a href="#init-singleton" class="table-of-contents__link toc-highlight">Init Singleton</a><ul><li><a href="#problem-3" class="table-of-contents__link toc-highlight">Problem</a></li><li><a href="#solution-3" class="table-of-contents__link toc-highlight">Solution</a></li></ul></li><li><a href="#use-descriptive-names-for-fields-paths-functions-and-variables" class="table-of-contents__link toc-highlight">Use descriptive names for fields, paths, functions and variables</a><ul><li><a href="#problem-4" class="table-of-contents__link toc-highlight">Problem</a></li><li><a href="#solution-4" class="table-of-contents__link toc-highlight">Solution</a></li><li><a href="#example" class="table-of-contents__link toc-highlight">Example</a></li></ul></li><li><a href="#include-concrete-types-in-type-constraints-especially-any-types" class="table-of-contents__link toc-highlight">Include concrete types in type constraints, especially &quot;Any&quot; types</a><ul><li><a href="#problem-5" class="table-of-contents__link toc-highlight">Problem</a></li><li><a href="#solution-5" class="table-of-contents__link toc-highlight">Solution</a></li></ul></li><li><a href="#plural-names-for-arrays-and-maps-are-preferable" class="table-of-contents__link toc-highlight">Plural names for arrays and maps are preferable</a></li><li><a href="#use-transaction-post-conditions-when-applicable" class="table-of-contents__link toc-highlight">Use transaction post-conditions when applicable</a><ul><li><a href="#problem-6" class="table-of-contents__link toc-highlight">Problem</a></li><li><a href="#solution-6" class="table-of-contents__link toc-highlight">Solution</a></li><li><a href="#example-1" class="table-of-contents__link toc-highlight">Example</a></li></ul></li><li><a href="#avoid-excessive-load-and-save-storage-operations-prefer-in-place-mutations" class="table-of-contents__link toc-highlight">Avoid excessive load and save storage operations (prefer in-place mutations)</a><ul><li><a href="#problem-7" class="table-of-contents__link toc-highlight">Problem</a></li><li><a href="#solution-7" class="table-of-contents__link toc-highlight">Solution</a></li><li><a href="#example-2" class="table-of-contents__link toc-highlight">Example</a></li></ul></li><li><a href="#capability-bootstrapping" class="table-of-contents__link toc-highlight">Capability Bootstrapping</a><ul><li><a href="#problem-8" class="table-of-contents__link toc-highlight">Problem</a></li><li><a href="#solution-8" class="table-of-contents__link toc-highlight">Solution</a></li></ul></li><li><a href="#capability-revocation" class="table-of-contents__link toc-highlight">Capability Revocation</a><ul><li><a href="#problem-9" class="table-of-contents__link toc-highlight">Problem</a></li><li><a href="#solution-9" class="table-of-contents__link toc-highlight">Solution</a></li></ul></li><li><a href="#check-for-existing-links-before-creating-new-ones" class="table-of-contents__link toc-highlight">Check for existing links before creating new ones</a><ul><li><a href="#example-3" class="table-of-contents__link toc-highlight">Example</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Documentation</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/getting-started">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/tools">SDK&#x27;s &amp; Tools</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/cadence/intro">Cadence</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/building-on-flow/mobile">Mobile</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/tools/clients/fcl-js">FCL</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/tools/toolchains/flow-js-testing">JS Testing Library</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/tools/toolchains/flow-cli">CLI</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/tools/toolchains/emulator">Emulator</a></li><li class="footer__item"><a href="https://github.com/onflow/fcl-dev-wallet" target="_blank" rel="noopener noreferrer" class="footer__link-item">Dev Wallet<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/docs/tools/toolchains/vscode-extension">VS Code Extension</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/community-resources">Ecosystem</a></li><li class="footer__item"><a href="https://port.onflow.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Flow Port<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/onflow/developer-grants" target="_blank" rel="noopener noreferrer" class="footer__link-item">Developer Grants<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://flow.com/flow-responsible-disclosure" target="_blank" rel="noopener noreferrer" class="footer__link-item">Responsible Disclosure<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://forum.onflow.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Forum<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.flowverse.co/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Flowverse<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://academy.ecdao.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Emerald Academy<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://floats.city/" target="_blank" rel="noopener noreferrer" class="footer__link-item">FLOATs (Attendance NFTs)<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Start Building</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://play.onflow.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Flow Playground<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/docs/cadence/tutorial/first-steps">Cadence Tutorials</a></li><li class="footer__item"><a href="https://open-cadence.onflow.org" target="_blank" rel="noopener noreferrer" class="footer__link-item">Cadence Cookbook<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/docs/building-on-flow/core-contracts">Core Contracts &amp; Standards</a></li><li class="footer__item"><a href="https://academy.ecdao.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Emerald DAO Bootcamp<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Network</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://status.onflow.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Network Status<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://flowscan.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Flowscan Mainnet<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://testnet.flowscan.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Flowscan Testnet<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a class="footer__link-item" href="/docs/building-on-flow/run-and-secure/nodes/node-operation/past-sporks">Past Sporks</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/building-on-flow/run-and-secure/nodes/node-operation/upcoming-sporks">Upcoming Sporks</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/building-on-flow/run-and-secure/nodes/node-operation">Node Operation</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/building-on-flow/run-and-secure/nodes/node-operation/spork">Spork Information</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/onflow" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://onflow.org/discord" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://forum.onflow.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Forum<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://onflow.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item">OnFlow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://flow.com/blog" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Flow, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/docs/assets/js/runtime~main.03b096d0.js"></script>
<script src="/docs/assets/js/main.cc7ab7d7.js"></script>
</body>
</html>